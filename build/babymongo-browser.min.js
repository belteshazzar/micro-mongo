var l,b={exports:{}};var d=function(){if(l)return b.exports;l=1;var d,Z="object"==typeof Reflect?Reflect:null,c=Z&&"function"==typeof Z.apply?Z.apply:function(l,b,d){return Function.prototype.apply.call(l,b,d)};d=Z&&"function"==typeof Z.ownKeys?Z.ownKeys:Object.getOwnPropertySymbols?function(l){return Object.getOwnPropertyNames(l).concat(Object.getOwnPropertySymbols(l))}:function(l){return Object.getOwnPropertyNames(l)};var i=Number.isNaN||function(l){return l!=l};function m(){m.init.call(this)}b.exports=m,b.exports.once=function(l,b){return new Promise(function(d,Z){function c(d){l.removeListener(b,i),Z(d)}function i(){"function"==typeof l.removeListener&&l.removeListener("error",c),d([].slice.call(arguments))}h(l,b,i,{once:!0}),"error"!==b&&function(l,b,d){"function"==typeof l.on&&h(l,"error",b,d)}(l,c,{once:!0})})},m.EventEmitter=m,m.prototype._events=void 0,m.prototype._eventsCount=0,m.prototype._maxListeners=void 0;var G=10;function X(l){if("function"!=typeof l)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof l)}function t(l){return void 0===l._maxListeners?m.defaultMaxListeners:l._maxListeners}function u(l,b,d,Z){var c,i,m,G;if(X(d),void 0===(i=l._events)?(i=l._events=/* @__PURE__ */Object.create(null),l._eventsCount=0):(void 0!==i.newListener&&(l.emit("newListener",b,d.listener?d.listener:d),i=l._events),m=i[b]),void 0===m)m=i[b]=d,++l._eventsCount;else if("function"==typeof m?m=i[b]=Z?[d,m]:[m,d]:Z?m.unshift(d):m.push(d),(c=t(l))>0&&m.length>c&&!m.warned){m.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+m.length+" "+String(b)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=l,u.type=b,u.count=m.length,G=u,console&&console.warn&&console.warn(G)}return l}function n(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function W(l,b,d){var Z={fired:!1,wrapFn:void 0,target:l,type:b,listener:d},c=n.bind(Z);return c.listener=d,Z.wrapFn=c,c}function a(l,b,d){var Z=l._events;if(void 0===Z)return[];var c=Z[b];return void 0===c?[]:"function"==typeof c?d?[c.listener||c]:[c]:d?function(l){for(var b=new Array(l.length),d=0;d<b.length;++d)b[d]=l[d].listener||l[d];return b}(c):p(c,c.length)}function e(l){var b=this._events;if(void 0!==b){var d=b[l];if("function"==typeof d)return 1;if(void 0!==d)return d.length}return 0}function p(l,b){for(var d=new Array(b),Z=0;Z<b;++Z)d[Z]=l[Z];return d}function h(l,b,d,Z){if("function"==typeof l.on)Z.once?l.once(b,d):l.on(b,d);else{if("function"!=typeof l.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof l);l.addEventListener(b,function c(i){Z.once&&l.removeEventListener(b,c),d(i)})}}return Object.defineProperty(m,"defaultMaxListeners",{enumerable:!0,get:function(){return G},set:function(l){if("number"!=typeof l||l<0||i(l))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+l+".");G=l}}),m.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=/* @__PURE__ */Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},m.prototype.setMaxListeners=function(l){if("number"!=typeof l||l<0||i(l))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+l+".");return this._maxListeners=l,this},m.prototype.getMaxListeners=function(){return t(this)},m.prototype.emit=function(l){for(var b=[],d=1;d<arguments.length;d++)b.push(arguments[d]);var Z="error"===l,i=this._events;if(void 0!==i)Z=Z&&void 0===i.error;else if(!Z)return!1;if(Z){var m;if(b.length>0&&(m=b[0]),m instanceof Error)throw m;var G=new Error("Unhandled error."+(m?" ("+m.message+")":""));throw G.context=m,G}var X=i[l];if(void 0===X)return!1;if("function"==typeof X)c(X,this,b);else{var t=X.length,u=p(X,t);for(d=0;d<t;++d)c(u[d],this,b)}return!0},m.prototype.addListener=function(l,b){return u(this,l,b,!1)},m.prototype.on=m.prototype.addListener,m.prototype.prependListener=function(l,b){return u(this,l,b,!0)},m.prototype.once=function(l,b){return X(b),this.on(l,W(this,l,b)),this},m.prototype.prependOnceListener=function(l,b){return X(b),this.prependListener(l,W(this,l,b)),this},m.prototype.removeListener=function(l,b){var d,Z,c,i,m;if(X(b),void 0===(Z=this._events))return this;if(void 0===(d=Z[l]))return this;if(d===b||d.listener===b)0===--this._eventsCount?this._events=/* @__PURE__ */Object.create(null):(delete Z[l],Z.removeListener&&this.emit("removeListener",l,d.listener||b));else if("function"!=typeof d){for(c=-1,i=d.length-1;i>=0;i--)if(d[i]===b||d[i].listener===b){m=d[i].listener,c=i;break}if(c<0)return this;0===c?d.shift():function(l,b){for(;b+1<l.length;b++)l[b]=l[b+1];l.pop()}(d,c),1===d.length&&(Z[l]=d[0]),void 0!==Z.removeListener&&this.emit("removeListener",l,m||b)}return this},m.prototype.off=m.prototype.removeListener,m.prototype.removeAllListeners=function(l){var b,d,Z;if(void 0===(d=this._events))return this;if(void 0===d.removeListener)return 0===arguments.length?(this._events=/* @__PURE__ */Object.create(null),this._eventsCount=0):void 0!==d[l]&&(0===--this._eventsCount?this._events=/* @__PURE__ */Object.create(null):delete d[l]),this;if(0===arguments.length){var c,i=Object.keys(d);for(Z=0;Z<i.length;++Z)"removeListener"!==(c=i[Z])&&this.removeAllListeners(c);return this.removeAllListeners("removeListener"),this._events=/* @__PURE__ */Object.create(null),this._eventsCount=0,this}if("function"==typeof(b=d[l]))this.removeListener(l,b);else if(void 0!==b)for(Z=b.length-1;Z>=0;Z--)this.removeListener(l,b[Z]);return this},m.prototype.listeners=function(l){return a(this,l,!0)},m.prototype.rawListeners=function(l){return a(this,l,!1)},m.listenerCount=function(l,b){return"function"==typeof l.listenerCount?l.listenerCount(b):e.call(l,b)},m.prototype.listenerCount=e,m.prototype.eventNames=function(){return this._eventsCount>0?d(this._events):[]},b.exports}();const Z={OK:0,INTERNAL_ERROR:1,BAD_VALUE:2,NO_SUCH_KEY:4,GRAPH_CONTAINS_CYCLE:5,HOST_UNREACHABLE:6,HOST_NOT_FOUND:7,UNKNOWN_ERROR:8,FAILED_TO_PARSE:17287,CANNOT_MUTATE_OBJECT:10,USER_NOT_FOUND:11,UNSUPPORTED_FORMAT:12,UNAUTHORIZED:13,TYPE_MISMATCH:14,OVERFLOW:15,INVALID_LENGTH:16,PROTOCOL_ERROR:17,AUTHENTICATION_FAILED:18,ILLEGAL_OPERATION:20,NAMESPACE_NOT_FOUND:26,INDEX_NOT_FOUND:27,PATH_NOT_VIABLE:28,CANNOT_CREATE_INDEX:67,INDEX_ALREADY_EXISTS:68,INDEX_EXISTS:68,COMMAND_NOT_FOUND:59,NAMESPACE_EXISTS:48,INVALID_NAMESPACE:73,INDEX_OPTIONS_CONFLICT:85,INVALID_INDEX_SPECIFICATION_OPTION:197,WRITE_CONFLICT:112,DUPLICATE_KEY:11e3,DUPLICATE_KEY_UPDATE:11001,DOCUMENT_VALIDATION_FAILURE:121,BAD_QUERY:2,CANNOT_INDEX_PARALLEL_ARRAYS:171,CURSOR_NOT_FOUND:43,COLLECTION_IS_EMPTY:26,CANNOT_DO_EXCLUSION_ON_FIELD_ID_IN_INCLUSION_PROJECTION:31254,NOT_IMPLEMENTED:999,OPERATION_NOT_SUPPORTED:998};class c extends Error{constructor(l,b={}){super(l),this.name="MongoError",this.code=b.code||Z.UNKNOWN_ERROR,this.codeName=this._getCodeName(this.code),this.$err=l,b.collection&&(this.collection=b.collection),b.database&&(this.database=b.database),b.operation&&(this.operation=b.operation),b.query&&(this.query=b.query),b.document&&(this.document=b.document),b.field&&(this.field=b.field),b.index&&(this.index=b.index),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}_getCodeName(l){return{0:"OK",1:"InternalError",2:"BadValue",4:"NoSuchKey",5:"GraphContainsCycle",6:"HostUnreachable",7:"HostNotFound",8:"UnknownError",10:"CannotMutateObject",11:"UserNotFound",12:"UnsupportedFormat",13:"Unauthorized",14:"TypeMismatch",15:"Overflow",16:"InvalidLength",17:"ProtocolError",18:"AuthenticationFailed",20:"IllegalOperation",26:"NamespaceNotFound",27:"IndexNotFound",28:"PathNotViable",43:"CursorNotFound",48:"NamespaceExists",59:"CommandNotFound",67:"CannotCreateIndex",68:"IndexExists",73:"InvalidNamespace",85:"IndexOptionsConflict",112:"WriteConflict",121:"DocumentValidationFailure",171:"CannotIndexParallelArrays",197:"InvalidIndexSpecificationOption",998:"OperationNotSupported",999:"NotImplemented",11e3:"DuplicateKey",11001:"DuplicateKeyUpdate",17287:"FailedToParse"}[l]||"UnknownError"}toJSON(){const l={name:this.name,message:this.message,code:this.code,codeName:this.codeName};return this.collection&&(l.collection=this.collection),this.database&&(l.database=this.database),this.operation&&(l.operation=this.operation),this.index&&(l.index=this.index),this.indexName&&(l.indexName=this.indexName),this.field&&(l.field=this.field),this.query&&(l.query=this.query),this.document&&(l.document=this.document),this.namespace&&(l.namespace=this.namespace),this.cursorId&&(l.cursorId=this.cursorId),this.feature&&(l.feature=this.feature),this.keyPattern&&(l.keyPattern=this.keyPattern),this.keyValue&&(l.keyValue=this.keyValue),this.writeErrors&&(l.writeErrors=this.writeErrors),l}}class i extends c{constructor(l,b={}){super(l,b),this.name="MongoServerError"}}class m extends c{constructor(l,b={}){super(l,b),this.name="MongoDriverError",this.code=b.code||Z.INTERNAL_ERROR}}class G extends c{constructor(l,b={}){super(l,b),this.name="WriteError",this.code=b.code||Z.WRITE_CONFLICT}}class X extends G{constructor(l,b={}){const d=JSON.stringify(l);super(`E11000 duplicate key error${b.collection?` collection: ${b.collection}`:""} index: ${d} dup key: ${d}`,{...b,code:Z.DUPLICATE_KEY}),this.name="DuplicateKeyError",this.keyPattern=l,this.keyValue=b.keyValue||l}}class t extends c{constructor(l,b={}){super(l,b),this.name="ValidationError",this.code=b.code||Z.DOCUMENT_VALIDATION_FAILURE,this.validationErrors=b.validationErrors||[]}}class u extends c{constructor(l,b={}){super(l,b),this.name="IndexError"}}class n extends u{constructor(l,b={}){super(`Index with name '${l}' already exists`,{...b,code:Z.INDEX_EXISTS}),this.name="IndexExistsError",this.indexName=l}}class W extends u{constructor(l,b={}){super(`Index '${l}' not found`,{...b,code:Z.INDEX_NOT_FOUND,index:l}),this.name="IndexNotFoundError",this.indexName=l}}class a extends u{constructor(l,b={}){super(`Cannot create index: ${l}`,{...b,code:Z.CANNOT_CREATE_INDEX}),this.name="CannotCreateIndexError"}}class e extends c{constructor(l,b={}){super(l,b),this.name="QueryError",this.code=b.code||Z.BAD_QUERY}}class p extends c{constructor(l,b,d,c={}){super(`Type mismatch for field '${l}': expected ${b}, got ${d}`,{...c,code:Z.TYPE_MISMATCH,field:l}),this.name="TypeMismatchError",this.expectedType=b,this.actualType=d}}class h extends c{constructor(l,b={}){super(l,b),this.name="NamespaceError"}}class o extends h{constructor(l,b={}){super(`Namespace '${l}' not found`,{...b,code:Z.NAMESPACE_NOT_FOUND}),this.name="NamespaceNotFoundError",this.namespace=l}}class s extends h{constructor(l,b,d={}){"object"!=typeof b||d||(d=b,b=void 0);super(b?`Invalid namespace '${l}': ${b}`:`Invalid namespace '${l}'`,{...d,code:Z.INVALID_NAMESPACE}),this.name="InvalidNamespaceError",this.namespace=l}}class V extends c{constructor(l,b={}){super(l,b),this.name="CursorError"}}class y extends V{constructor(l,b={}){super(`Cursor ${l} not found`,{...b,code:Z.CURSOR_NOT_FOUND}),this.name="CursorNotFoundError",this.cursorId=l}}class I extends c{constructor(l,b={}){super(`${l} is not implemented in babymongo`,{...b,code:Z.NOT_IMPLEMENTED}),this.name="NotImplementedError",this.feature=l}}class Y extends c{constructor(l,b,d={}){"object"!=typeof b||d||(d=b,b=void 0);super(b?`Operation '${l}' is not supported: ${b}`:`Operation '${l}' is not supported`,{...d,code:Z.OPERATION_NOT_SUPPORTED,operation:l}),this.name="OperationNotSupportedError"}}class K extends c{constructor(l,b,d,c={}){super(`Bad value for field '${l}': ${d}`,{...c,code:Z.BAD_VALUE,field:l}),this.name="BadValueError",this.value=b}}class R extends c{constructor(l=[],b={}){super(`Bulk write operation error: ${l.length} error(s)`,b),this.name="BulkWriteError",this.writeErrors=l,this.code=b.code||Z.WRITE_CONFLICT}}class r extends c{constructor(l,b={}){super(l,b),this.name="MongoNetworkError",this.code=b.code||Z.HOST_UNREACHABLE}}class J extends d.EventEmitter{static create({bridge:l,database:b,collection:d,streamId:Z,pipeline:c=[],options:i={}}){const m=new J({bridge:l,streamId:Z});if(!Z){let Z,G;null==b?(Z="client",G="watch"):null==d?(Z="db",G="watch"):(Z="collection",G="watch"),l.sendRequest({target:Z,database:b,collection:d,method:G,args:[c,i]}).then(l=>{l&&l.streamId&&(m.streamId=l.streamId)}).catch(()=>{})}return m}constructor({bridge:l,streamId:b}){super(),this.bridge=l,this.streamId=b,this.closed=!1,this._pendingNext=[],this._onEvent=this._onEvent.bind(this),this.bridge.on("event",this._onEvent)}_onEvent(l,b){if("changeStream"!==l)return;if(!b||b.streamId!==this.streamId)return;const{type:d,data:Z}=b;"change"===d&&this.emit("change",Z),"error"===d&&this.emit("error",Z),"close"===d&&(this.emit("close"),this._cleanup())}_cleanup(){this.bridge.off("event",this._onEvent)}async close(){if(!this.closed){this.closed=!0;for(const l of this._pendingNext)l.resolve(null);this._pendingNext=[],this.bridge.sendRequest({target:"changestream",streamId:this.streamId,method:"close"}).catch(()=>{}),this.emit("close"),this._cleanup()}}async next(){return this.closed?null:new Promise((l,b)=>{const d=b=>{this._removePending(i),this.off("change",d),this.off("error",Z),this.off("close",c),l(b)},Z=l=>{this._removePending(i),this.off("change",d),this.off("error",Z),this.off("close",c),b(l)},c=()=>{this._removePending(i),this.off("change",d),this.off("error",Z),this.off("close",c),l(null)},i={resolve:l,reject:b};this._pendingNext.push(i),this.on("change",d),this.on("error",Z),this.on("close",c)})}_removePending(l){const b=this._pendingNext.indexOf(l);-1!==b&&this._pendingNext.splice(b,1)}async*[Symbol.asyncIterator](){for(;!this.closed;){const l=await this.next();if(null===l)break;yield l}}}class C{constructor({bridge:l,cursorId:b,batch:d=[],exhausted:Z=!1,batchSize:c=100,requestPromise:i,requestPayload:m}){this.bridge=l,this.cursorId=b,this.buffer=Array.isArray(d)?d:[],this.exhausted=Z||!1,this._batchSize=c,this._requestPromise=i||null,this._requestPayload=m||null,this._initialized=!i&&!m}async _ensureInitialized(){if(!this._initialized)if(this._requestPayload){const l={};void 0!==this._limit&&(l.limit=this._limit),void 0!==this._skip&&(l.skip=this._skip),void 0!==this._sort&&(l.sort=this._sort),void 0!==this._min&&(l.min=this._min),void 0!==this._max&&(l.max=this._max),void 0!==this._hint&&(l.hint=this._hint),void 0!==this._comment&&(l.comment=this._comment),void 0!==this._maxTimeMS&&(l.maxTimeMS=this._maxTimeMS),void 0!==this._maxScan&&(l.maxScan=this._maxScan),void 0!==this._returnKey&&(l.returnKey=this._returnKey),void 0!==this._showRecordId&&(l.showRecordId=this._showRecordId),void 0!==this._collation&&(l.collation=this._collation),this._requestPayload.cursorOpts=l;const b=await this.bridge.sendRequest(this._requestPayload);this.cursorId=b.cursorId,this.buffer=b.batch||[],this.exhausted=b.exhausted||!1,this._batchSize=b.batchSize||100,this._requestPayload=null,this._initialized=!0}else if(this._requestPromise){const l=await this._requestPromise;this.cursorId=l.cursorId,this.buffer=l.batch||[],this.exhausted=l.exhausted||!1,this._batchSize=l.batchSize||100,this._requestPromise=null,this._initialized=!0}}async hasNext(){return!this._closed&&(await this._ensureInitialized(),this.buffer.length>0||!this.exhausted&&(await this._getMore(),this.buffer.length>0))}async next(){return await this.hasNext()?this.buffer.shift():null}async toArray(){await this._ensureInitialized();const l=[...this.buffer];for(this.buffer=[];!this.exhausted;)await this._getMore(),l.push(...this.buffer),this.buffer=[];return l}async count(){return(await this.toArray()).length}limit(l){return this._limit=l,this}skip(l){return this._skip=l,this}sort(l){return this._sort=l,this}batchSize(l){return this._batchSize=l,this}async close(){return this._closed=!0,await this._closeRemote(),!1}isClosed(){return this._closed||!1}comment(l){return this._comment=l,this}hint(l){return this._hint=l,this}explain(l="queryPlanner"){const b={queryPlanner:{plannerVersion:1,namespace:"unknown",indexFilterSet:!1,parsedQuery:{},winningPlan:{stage:"COLLSCAN"}},ok:1};return"executionStats"!==l&&"allPlansExecution"!==l||(b.executionStats={executionSuccess:!0,nReturned:0,executionTimeMillis:0}),b}async itcount(){let l=0;for(;await this.hasNext();)await this.next(),l++;return l}size(){return this.buffer.length}min(l){return this._min=l,this._minIndexBounds=l,this}max(l){return this._max=l,this._maxIndexBounds=l,this}maxTimeMS(l){return this._maxTimeMS=l,this}maxScan(l){return this._maxScan=l,this}noCursorTimeout(){return this._noCursorTimeout=!0,this}objsLeftInBatch(){return this.buffer.length}pretty(){return this._pretty=!0,this}readConcern(l){return this._readConcern=l,this}readPref(l,b){return this._readPref={mode:l,tagSet:b},this}returnKey(l=!0){return this._returnKey=l,this}showRecordId(l=!0){return this._showRecordId=l,this}allowDiskUse(l=!0){return this._allowDiskUse=l,this}collation(l){return this._collation=l,this}async forEach(l){for(;await this.hasNext();){const b=await this.next();await l(b)}}async map(l){const b=[];for(;await this.hasNext();){const d=await this.next();b.push(await l(d))}return b}async*[Symbol.asyncIterator](){for(;await this.hasNext();)yield await this.next()}async _getMore(){if(this.exhausted)return;const l=await this.bridge.sendRequest({target:"cursor",cursorId:this.cursorId,method:"getMore",args:[{batchSize:this._batchSize}]});this.buffer=l?.batch||[],this.exhausted=!!l?.exhausted,this.exhausted&&await this._closeRemote()}async _closeRemote(){if(this.cursorId){try{await this.bridge.sendRequest({target:"cursor",cursorId:this.cursorId,method:"close"})}catch(l){}this.cursorId=null}}}class S{constructor({dbName:l,name:b,bridge:d,db:Z}){return this.dbName=l,this.name=b,this.bridge=d,this._db=Z,this.indexes=[],new Proxy(this,{get:(l,b,d)=>b in l?Reflect.get(l,b,d):"symbol"==typeof b||String(b).startsWith("_")?void 0:"watch"===b?(...b)=>l._watch(...b):"find"===b||"aggregate"===b?(...d)=>l._cursorMethod(String(b),d):(...d)=>l._call(String(b),d)})}_cursorMethod(l,b=[]){"find"===l&&b.length>=2&&this._validateProjection(b[1]);const d={target:"collection",database:this.dbName,collection:this.name,method:l,args:b},Z=new C({bridge:this.bridge,requestPayload:d});return"aggregate"===l&&(Z.then=function(l,b){return this.toArray().then(l,b)}),Z}_validateProjection(l){if(!l||0===Object.keys(l).length)return;const b=Object.keys(l);let d=!1,c=!1;for(const Z of b)if("_id"!==Z&&(l[Z]?d=!0:c=!0,d&&c))break;if(d&&c)throw new e("Cannot do exclusion on field in inclusion projection",{code:Z.CANNOT_DO_EXCLUSION_ON_FIELD_ID_IN_INCLUSION_PROJECTION,collection:this.name})}_call(l,b=[]){return this.bridge.sendRequest({target:"collection",database:this.dbName,collection:this.name,method:l,args:b}).then(d=>{if(d&&d.cursorId)return new C({bridge:this.bridge,cursorId:d.cursorId,batch:d.batch,exhausted:d.exhausted,batchSize:d.batchSize});if("copyTo"===l&&b.length>0&&this._db&&this._db.collection(b[0]),"createIndex"===l){const l=b[0],d=b[1]||{},Z=d.name||Object.entries(l).map(([l,b])=>`${l}_${b}`).join("_");this.indexes.find(l=>l.name===Z)||this.indexes.push({name:Z,key:l,...d})}if("dropIndex"===l){const l=b[0];this.indexes=this.indexes.filter(b=>b.name!==l)}return"dropIndexes"===l&&(this.indexes=[]),"drop"===l&&(this.indexes=[]),d})}getIndexes(){return this.indexes}_watch(l=[],b={}){return J.create({bridge:this.bridge,database:this.dbName,collection:this.name,pipeline:l,options:b})}}class g{constructor({dbName:l,bridge:b,options:d={}}){this.dbName=l,this.bridge=b,this.options=d,this.collections=/* @__PURE__ */new Map;const Z=/* @__PURE__ */new Set(["getCollectionNames","getCollectionInfos","createCollection","dropCollection","dropDatabase","collection","getCollection","watch"]);return this._methodNames=Z,new Proxy(this,{get:(l,b,d)=>b in l?Reflect.get(l,b,d):"symbol"==typeof b||String(b).startsWith("_")?void 0:Z.has(b)?"createCollection"===b?(...Z)=>{const c=Z[0];return l.collection(c,d),l._call(String(b),Z)}:"dropCollection"===b?(...d)=>{const Z=d[0];return l.collections.delete(Z),l._call(String(b),d)}:"dropDatabase"===b?(...d)=>(l.collections.clear(),l._call(String(b),d)):"watch"===b?(...b)=>l._watch(...b):(...d)=>l._call(String(b),d):l.collection(b,d)})}collection(l,b){if(this.collections.has(l))return this.collections.get(l);const d=new S({dbName:this.dbName,name:l,bridge:this.bridge,db:b||this});return this.collections.set(l,d),d}getCollectionNames(){return Array.from(this.collections.keys())}async close(){}_call(l,b=[]){return this.bridge.sendRequest({target:"db",database:this.dbName,method:l,args:b}).then(l=>l&&l.streamId?J.create({bridge:this.bridge,database:this.dbName,collection:null,streamId:l.streamId}):l)}_watch(l=[],b={}){return J.create({bridge:this.bridge,database:this.dbName,collection:null,pipeline:l,options:b})}}class N extends d.EventEmitter{constructor(l="mongodb://localhost:27017",b={}){if(super(),this.uri=l,this.options=Object.freeze({...b}),this._isConnected=!1,this._defaultDb=this._parseDefaultDbName(l),this._databases=/* @__PURE__ */new Map,!b.workerBridge)throw new Error("workerBridge is required. Create one with: const bridge = await WorkerBridge.create()");this._bridge=b.workerBridge,this._ownsBridge=!1}static async connect(l,b={}){const d=new N(l,b);return await d.connect(),d}async connect(){return this._isConnected||(this._isConnected=!0,this.emit("open",this)),this}db(l,b={}){const d=l||this._defaultDb;if(!d)throw new Error("No database name provided and no default in connection string");if(this._databases.has(d))return this._databases.get(d);const Z=new g({dbName:d,bridge:this._bridge,options:{...this.options,...b}});return this._databases.set(d,Z),Z}async close(){this._bridge&&this._ownsBridge&&(await this._bridge.terminate(),this._bridge=null),this._isConnected=!1,this.emit("close")}async close(l=!1){if(this._isConnected){for(const[l,b]of this._databases)await b.close();this._databases.clear(),this._isConnected=!1,this.emit("close")}}startSession(l={}){return{id:crypto.randomUUID(),endSession:()=>{},withTransaction:async l=>await l(this)}}async withSession(l,b){const d=this.startSession("function"==typeof l?{}:l),Z="function"==typeof l?l:b;try{return await Z(d)}finally{d.endSession()}}get readConcern(){return this.options.readConcern}get writeConcern(){return this.options.writeConcern}get readPreference(){return this.options.readPreference}watch(l=[],b={}){return J.create({bridge:this._bridge,database:null,collection:null,pipeline:l,options:b})}_parseDefaultDbName(l){const b=l.match(/\/([^/?]+)/);return b?b[1]:null}_parseUriParams(l){const b={},d=l.indexOf("?");if(-1===d)return b;const Z=l.substring(d+1).split("&");for(const c of Z){const[l,d]=c.split("=");l&&("true"===d?b[l]=!0:"false"===d?b[l]=!1:isNaN(d)?b[l]=decodeURIComponent(d||""):b[l]=Number(d))}return b}}class L{constructor(l){if(null==l)this.id=L.generate();else if("string"==typeof l){if(!L.isValid(l))throw new Error(`Argument passed in must be a string of 24 hex characters, got: ${l}`);this.id=l.toLowerCase()}else if(l instanceof Uint8Array&&12===l.length)this.id=Array.from(l).map(l=>l.toString(16).padStart(2,"0")).join("");else{if(!(l instanceof L))throw new Error("Argument passed in must be a string of 24 hex characters or an ObjectId");this.id=l.id}}toString(){return this.id}toHexString(){return this.id}getTimestamp(){const l=parseInt(this.id.substring(0,8),16);return new Date(1e3*l)}equals(l){if(!(l instanceof L))throw new Error("Can only compare with another ObjectId");return this.id===l.id}compare(l){if(!(l instanceof L))throw new Error("Can only compare with another ObjectId");return this.id.localeCompare(l.id)}toJSON(){return this.id}inspect(){return`ObjectId("${this.id}")`}toBytes(){const l=new Uint8Array(12);for(let b=0;b<12;b++)l[b]=parseInt(this.id.substring(2*b,2*b+2),16);return l}static isValid(l){return!!l&&("string"==typeof l&&(24===l.length&&/^[0-9a-fA-F]{24}$/.test(l)))}static createFromTime(l){const b=("00000000"+Math.floor(l/1e3).toString(16)).slice(-8);return new L(b+"0000000000000000")}static generate(){const l=Math.floor(Date.now()/1e3),b="undefined"!=typeof crypto&&crypto.getRandomValues?new Uint8Array(8):null;let d="";if(b){crypto.getRandomValues(b);for(let l=0;l<b.length;l++)d+=("0"+b[l].toString(16)).slice(-2)}else d=Math.random().toString(16).slice(2).padEnd(8,"0").slice(0,8)+Math.random().toString(16).slice(2).padEnd(8,"0").slice(0,8);return(("00000000"+l.toString(16)).slice(-8)+d).slice(0,24)}}function x(l,b){return l instanceof L||b instanceof L?l instanceof L&&b instanceof L||l instanceof L&&"string"==typeof b?l.equals(b):b instanceof L&&"string"==typeof l&&b.equals(l):l==b}function H(l,b){for(var d=b.split("."),Z=l[d[0]],c=1;c<d.length;c++){if(null==Z||null==Z)return Z;var i=d[c],m=parseInt(i,10);Z=k(Z)&&!isNaN(m)&&m>=0&&m<Z.length?Z[m]:Z[i]}return Z}function k(l){return Array==l.constructor}function z(l,b){for(var d=0;d<b.length;d++)if(x(b[d],l))return!0;return!1}function F(l,b){if(l.length!=b.length)return!1;for(var d=0;d<l.length;d++)if(!x(l[d],b[d])){if(typeof l[d]!=typeof b[d])return!1;if("object"==typeof l[d]&&null!==l[d]){if(k(l[d])){if(!F(l[d],b[d]))return!1}else if(!v(l[d],b[d]))return!1}else if(!x(l[d],b[d]))return!1}return!0}function v(l,b){for(var d in l)if(l.hasOwnProperty(d)){if(!b.hasOwnProperty(d))return!1;if(!x(l[d],b[d])){if(typeof l[d]!=typeof b[d])return!1;if("object"==typeof l[d]&&null!==l[d]){if(k(l[d])){if(!F(l[d],b[d]))return!1}else if(!v(l[d],b[d]))return!1}else if(!x(l[d],b[d]))return!1}}for(var d in b)if(b.hasOwnProperty(d)&&!l.hasOwnProperty(d))return!1;return!0}const T={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},U={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},B="[aeiouy]",Q="([^aeiou][^aeiouy]*)",f="("+B+"[aeiou]*)",j=new RegExp("^"+Q+"?"+f+Q),P=new RegExp("^"+Q+"?"+f+Q+f+"?$"),M=new RegExp("^"+Q+"?("+f+Q+"){2,}"),w=new RegExp("^"+Q+"?"+B),O=new RegExp("^"+Q+B+"[^aeiouwxy]$"),E=/ll$/,D=/^(.+?)e$/,A=/^(.+?)y$/,_=/^(.+?(s|t))(ion)$/,$=/^(.+?)(ed|ing)$/,q=/(at|bl|iz)$/,ll=/^(.+?)eed$/,bl=/^.+?[^s]s$/,dl=/^.+?(ss|i)es$/,Zl=/([^aeiouylsz])\1$/,cl=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/,il=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/,ml=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/;const Gl=/* @__PURE__ */new Set(["a","about","after","all","also","am","an","and","another","any","are","around","as","at","be","because","been","before","being","between","both","but","by","came","can","come","could","did","do","each","for","from","get","got","has","had","he","have","her","here","him","himself","his","how","i","if","in","into","is","it","like","make","many","me","might","more","most","much","must","my","never","now","of","on","only","or","other","our","out","over","said","same","see","should","since","some","still","such","take","than","that","the","their","them","then","there","these","they","this","those","through","to","too","under","up","very","was","way","we","well","were","what","where","which","while","who","with","would","you","your"]);function Xl(l,b){if(null==l)return l;if("boolean"==typeof l||"number"==typeof l)return l;if("string"==typeof l)return l.startsWith("$$")?"$$KEEP"===l||"$$PRUNE"===l||"$$DESCEND"===l?l:H(b,l.substring(2)):"$"===l.charAt(0)?H(b,l.substring(1)):l;if("object"==typeof l){if(Array.isArray(l))return l.map(l=>Xl(l,b));const d=Object.keys(l);if(0===d.length)return l;const Z=d[0];if("$"===Z.charAt(0)){return function(l,b,d){switch(l){case"$add":return function(l,b){if(!Array.isArray(l))return null;let d=0;for(const Z of l){const l=Xl(Z,b);l instanceof Date?d+=l.getTime():"number"==typeof l&&(d+=l)}return d}(b,d);case"$subtract":return function(l,b){if(!Array.isArray(l)||2!==l.length)return null;const d=Xl(l[0],b),Z=Xl(l[1],b);if(d instanceof Date&&Z instanceof Date)return d.getTime()-Z.getTime();if(d instanceof Date&&"number"==typeof Z)return new Date(d.getTime()-Z);if("number"==typeof d&&"number"==typeof Z)return d-Z;return null}(b,d);case"$multiply":return function(l,b){if(!Array.isArray(l))return null;let d=1;for(const Z of l){const l=Xl(Z,b);"number"==typeof l&&(d*=l)}return d}(b,d);case"$divide":return function(l,b){if(!Array.isArray(l)||2!==l.length)return null;const d=Xl(l[0],b),Z=Xl(l[1],b);if("number"==typeof d&&"number"==typeof Z&&0!==Z)return d/Z;return null}(b,d);case"$mod":return function(l,b){if(!Array.isArray(l)||2!==l.length)return null;const d=Xl(l[0],b),Z=Xl(l[1],b);if("number"==typeof d&&"number"==typeof Z&&0!==Z)return d%Z;return null}(b,d);case"$pow":return function(l,b){if(!Array.isArray(l)||2!==l.length)return null;const d=Xl(l[0],b),Z=Xl(l[1],b);if("number"==typeof d&&"number"==typeof Z)return Math.pow(d,Z);return null}(b,d);case"$sqrt":return function(l,b){const d=Xl(l,b);if("number"==typeof d&&d>=0)return Math.sqrt(d);return null}(b,d);case"$abs":return function(l,b){const d=Xl(l,b);if("number"==typeof d)return Math.abs(d);return null}(b,d);case"$ceil":return function(l,b){const d=Xl(l,b);if("number"==typeof d)return Math.ceil(d);return null}(b,d);case"$floor":return function(l,b){const d=Xl(l,b);if("number"==typeof d)return Math.floor(d);return null}(b,d);case"$trunc":return function(l,b){const d=Xl(l,b);if("number"==typeof d)return Math.trunc(d);return null}(b,d);case"$round":return function(l,b){const d=Xl(Array.isArray(l)?l[0]:l,b),Z=Array.isArray(l)&&void 0!==l[1]?Xl(l[1],b):0;if("number"==typeof d&&"number"==typeof Z){const l=Math.pow(10,Z);return Math.round(d*l)/l}return null}(b,d);case"$concat":return function(l,b){if(!Array.isArray(l))return null;let d="";for(const Z of l){const l=Xl(Z,b);null!=l&&(d+=String(l))}return d}(b,d);case"$substr":return function(l,b){if(!Array.isArray(l)||l.length<3)return null;const d=String(Xl(l[0],b)||""),Z=Xl(l[1],b),c=Xl(l[2],b);if("number"==typeof Z&&"number"==typeof c)return d.substr(Z,c);return null}(b,d);case"$toLower":return function(l,b){const d=Xl(l,b);return null!=d?String(d).toLowerCase():""}(b,d);case"$toUpper":return function(l,b){const d=Xl(l,b);return null!=d?String(d).toUpperCase():""}(b,d);case"$trim":return function(l,b){const d=Xl("object"==typeof l&&l.input?l.input:l,b),Z=l.chars?Xl(l.chars,b):null;let c=null!=d?String(d):"";if(Z){const l=new RegExp(`^[${tl(Z)}]+|[${tl(Z)}]+$`,"g");return c.replace(l,"")}return c.trim()}(b,d);case"$ltrim":return function(l,b){const d=Xl("object"==typeof l&&l.input?l.input:l,b),Z=l.chars?Xl(l.chars,b):null;let c=null!=d?String(d):"";if(Z){const l=new RegExp(`^[${tl(Z)}]+`,"g");return c.replace(l,"")}return c.replace(/^\s+/,"")}(b,d);case"$rtrim":return function(l,b){const d=Xl("object"==typeof l&&l.input?l.input:l,b),Z=l.chars?Xl(l.chars,b):null;let c=null!=d?String(d):"";if(Z){const l=new RegExp(`[${tl(Z)}]+$`,"g");return c.replace(l,"")}return c.replace(/\s+$/,"")}(b,d);case"$split":return function(l,b){if(!Array.isArray(l)||2!==l.length)return null;const d=String(Xl(l[0],b)||""),Z=String(Xl(l[1],b)||"");return d.split(Z)}(b,d);case"$strLenCP":return function(l,b){const d=Xl(l,b);return null!=d?String(d).length:0}(b,d);case"$strcasecmp":return function(l,b){if(!Array.isArray(l)||2!==l.length)return null;const d=String(Xl(l[0],b)||"").toLowerCase(),Z=String(Xl(l[1],b)||"").toLowerCase();return d<Z?-1:d>Z?1:0}(b,d);case"$indexOfCP":return function(l,b){if(!Array.isArray(l)||l.length<2)return null;const d=String(Xl(l[0],b)||""),Z=String(Xl(l[1],b)||""),c=void 0!==l[2]?Xl(l[2],b):0,i=void 0!==l[3]?Xl(l[3],b):d.length,m=d.substring(c,i).indexOf(Z);return-1===m?-1:m+c}(b,d);case"$replaceOne":return function(l,b){const d=String(Xl(l.input,b)||""),Z=String(Xl(l.find,b)||""),c=String(Xl(l.replacement,b)||"");return d.replace(Z,c)}(b,d);case"$replaceAll":return function(l,b){const d=String(Xl(l.input,b)||""),Z=String(Xl(l.find,b)||""),c=String(Xl(l.replacement,b)||"");return d.split(Z).join(c)}(b,d);case"$cmp":return function(l,b){if(!Array.isArray(l)||2!==l.length)return null;const d=Xl(l[0],b),Z=Xl(l[1],b);return d<Z?-1:d>Z?1:0}(b,d);case"$eq":return function(l,b){if(!Array.isArray(l)||2!==l.length)return null;const d=Xl(l[0],b),Z=Xl(l[1],b);return d===Z}(b,d);case"$ne":return function(l,b){if(!Array.isArray(l)||2!==l.length)return null;const d=Xl(l[0],b),Z=Xl(l[1],b);return d!==Z}(b,d);case"$gt":return function(l,b){if(!Array.isArray(l)||2!==l.length)return null;const d=Xl(l[0],b),Z=Xl(l[1],b);return d>Z}(b,d);case"$gte":return function(l,b){if(!Array.isArray(l)||2!==l.length)return null;const d=Xl(l[0],b),Z=Xl(l[1],b);return d>=Z}(b,d);case"$lt":return function(l,b){if(!Array.isArray(l)||2!==l.length)return null;const d=Xl(l[0],b),Z=Xl(l[1],b);return d<Z}(b,d);case"$lte":return function(l,b){if(!Array.isArray(l)||2!==l.length)return null;const d=Xl(l[0],b),Z=Xl(l[1],b);return d<=Z}(b,d);case"$and":return function(l,b){if(!Array.isArray(l))return null;for(const d of l){if(!Xl(d,b))return!1}return!0}(b,d);case"$or":return function(l,b){if(!Array.isArray(l))return null;for(const d of l){if(Xl(d,b))return!0}return!1}(b,d);case"$not":return function(l,b){const d=Xl(Array.isArray(l)?l[0]:l,b);return!d}(b,d);case"$cond":return function(l,b){let d,Z,c;if(Array.isArray(l)){if(3!==l.length)return null;[d,Z,c]=l}else{if("object"!=typeof l)return null;d=l.if,Z=l.then,c=l.else}const i=Xl(d,b);return Xl(i?Z:c,b)}(b,d);case"$ifNull":return function(l,b){if(!Array.isArray(l)||l.length<2)return null;for(let d=0;d<l.length;d++){const Z=Xl(l[d],b);if(null!=Z)return Z}return null}(b,d);case"$switch":return function(l,b){if("object"!=typeof l||!Array.isArray(l.branches))return null;for(const d of l.branches){if(Xl(d.case,b))return Xl(d.then,b)}return void 0!==l.default?Xl(l.default,b):null}(b,d);case"$year":return function(l,b){const d=Xl(l,b);if(d instanceof Date)return d.getUTCFullYear();return null}(b,d);case"$month":return function(l,b){const d=Xl(l,b);if(d instanceof Date)return d.getUTCMonth()+1;return null}(b,d);case"$dayOfMonth":return function(l,b){const d=Xl(l,b);if(d instanceof Date)return d.getUTCDate();return null}(b,d);case"$dayOfWeek":return function(l,b){const d=Xl(l,b);if(d instanceof Date)return d.getUTCDay()+1;return null}(b,d);case"$dayOfYear":return function(l,b){const d=Xl(l,b);if(d instanceof Date){const l=new Date(Date.UTC(d.getUTCFullYear(),0,0)),b=d-l,Z=864e5;return Math.floor(b/Z)}return null}(b,d);case"$hour":return function(l,b){const d=Xl(l,b);if(d instanceof Date)return d.getUTCHours();return null}(b,d);case"$minute":return function(l,b){const d=Xl(l,b);if(d instanceof Date)return d.getUTCMinutes();return null}(b,d);case"$second":return function(l,b){const d=Xl(l,b);if(d instanceof Date)return d.getUTCSeconds();return null}(b,d);case"$millisecond":return function(l,b){const d=Xl(l,b);if(d instanceof Date)return d.getUTCMilliseconds();return null}(b,d);case"$week":return function(l,b){const d=Xl(l,b);if(d instanceof Date){const l=new Date(Date.UTC(d.getUTCFullYear(),0,1));return Math.ceil(((d-l)/864e5+l.getUTCDay()+1)/7)-1}return null}(b,d);case"$isoWeek":return function(l,b){const d=Xl(l,b);if(d instanceof Date){const l=new Date(d.valueOf()),b=(d.getUTCDay()+6)%7;l.setUTCDate(l.getUTCDate()-b+3);const Z=l.valueOf();return l.setUTCMonth(0,1),4!==l.getUTCDay()&&l.setUTCMonth(0,1+(4-l.getUTCDay()+7)%7),1+Math.ceil((Z-l)/6048e5)}return null}(b,d);case"$isoWeekYear":return function(l,b){const d=Xl(l,b);if(d instanceof Date){const l=new Date(d.valueOf());return l.setUTCDate(l.getUTCDate()-(d.getUTCDay()+6)%7+3),l.getUTCFullYear()}return null}(b,d);case"$dateToString":return function(l,b){const d=l.format?Xl(l.format,b):"%Y-%m-%dT%H:%M:%S.%LZ",Z=Xl(l.date,b);return Z instanceof Date?d.replace("%Y",Z.getUTCFullYear()).replace("%m",String(Z.getUTCMonth()+1).padStart(2,"0")).replace("%d",String(Z.getUTCDate()).padStart(2,"0")).replace("%H",String(Z.getUTCHours()).padStart(2,"0")).replace("%M",String(Z.getUTCMinutes()).padStart(2,"0")).replace("%S",String(Z.getUTCSeconds()).padStart(2,"0")).replace("%L",String(Z.getUTCMilliseconds()).padStart(3,"0")):null}(b,d);case"$toDate":return function(l,b){const d=Xl(l,b);if(d instanceof Date)return d;if("string"==typeof d||"number"==typeof d){const l=new Date(d);return isNaN(l.getTime())?null:l}return null}(b,d);case"$arrayElemAt":return function(l,b){if(!Array.isArray(l)||2!==l.length)return null;const d=Xl(l[0],b),Z=Xl(l[1],b);if(!Array.isArray(d)||"number"!=typeof Z)return null;const c=Z<0?d.length+Z:Z;return d[c]}(b,d);case"$concatArrays":return function(l,b){if(!Array.isArray(l))return null;const d=[];for(const Z of l){const l=Xl(Z,b);Array.isArray(l)&&d.push(...l)}return d}(b,d);case"$filter":return function(l,b){const d=Xl(l.input,b),Z=l.as||"this",c=l.cond;return Array.isArray(d)?d.filter(l=>{const d={...b,[Z]:l};return Xl(c,d)}):null}(b,d);case"$in":return function(l,b){if(!Array.isArray(l)||2!==l.length)return null;const d=Xl(l[0],b),Z=Xl(l[1],b);return!!Array.isArray(Z)&&Z.includes(d)}(b,d);case"$indexOfArray":return function(l,b){if(!Array.isArray(l)||l.length<2)return null;const d=Xl(l[0],b),Z=Xl(l[1],b),c=void 0!==l[2]?Xl(l[2],b):0,i=void 0!==l[3]?Xl(l[3],b):d.length;if(!Array.isArray(d))return null;for(let m=c;m<i&&m<d.length;m++)if(d[m]===Z)return m;return-1}(b,d);case"$isArray":return function(l,b){const d=Xl(l,b);return Array.isArray(d)}(b,d);case"$map":return function(l,b){const d=Xl(l.input,b),Z=l.as||"this",c=l.in;return Array.isArray(d)?d.map(l=>{const d={...b,[Z]:l};return Xl(c,d)}):null}(b,d);case"$reduce":return function(l,b){const d=Xl(l.input,b),Z=Xl(l.initialValue,b),c=l.in;if(!Array.isArray(d))return null;let i=Z;for(const m of d){i=Xl(c,{...b,value:i,this:m})}return i}(b,d);case"$size":return function(l,b){const d=Xl(l,b);return Array.isArray(d)?d.length:null}(b,d);case"$slice":return function(l,b){if(!Array.isArray(l)||l.length<2)return null;const d=Xl(l[0],b);if(!Array.isArray(d))return null;if(2===l.length){const Z=Xl(l[1],b);return Z>=0?d.slice(0,Z):d.slice(Z)}{const Z=Xl(l[1],b),c=Xl(l[2],b);return d.slice(Z,Z+c)}}(b,d);case"$reverseArray":return function(l,b){const d=Xl(l,b);return Array.isArray(d)?d.slice().reverse():null}(b,d);case"$zip":return function(l,b){const d=l.inputs?Xl(l.inputs,b):null,Z=l.useLongestLength||!1,c=l.defaults;if(!Array.isArray(d))return null;const i=d.map(l=>Xl(l,b));if(!i.every(l=>Array.isArray(l)))return null;const m=Math.max(...i.map(l=>l.length)),G=Z?m:Math.min(...i.map(l=>l.length)),X=[];for(let t=0;t<G;t++){const l=[];for(let b=0;b<i.length;b++)t<i[b].length?l.push(i[b][t]):c&&b<c.length?l.push(c[b]):l.push(null);X.push(l)}return X}(b,d);case"$type":return function(l,b){const d=Xl(l,b);return null===d?"null":void 0===d?"missing":"boolean"==typeof d?"bool":"number"==typeof d?Number.isInteger(d)?"int":"double":"string"==typeof d?"string":d instanceof Date?"date":Array.isArray(d)?"array":"object"==typeof d?"object":"unknown"}(b,d);case"$convert":return function(l,b){const d=Xl(l.input,b),Z=l.to,c=l.onError,i=l.onNull;if(null===d)return void 0!==i?Xl(i,b):null;try{switch(Z){case"double":case"decimal":return parseFloat(d);case"int":case"long":return parseInt(d);case"bool":return Boolean(d);case"string":return String(d);case"date":return new Date(d);default:return d}}catch(m){return void 0!==c?Xl(c,b):null}}(b,d);case"$toBool":return function(l,b){const d=Xl(l,b);return Boolean(d)}(b,d);case"$toDecimal":return function(l,b){const d=Xl(l,b);return parseFloat(d)}(b,d);case"$toDouble":return function(l,b){const d=Xl(l,b);return parseFloat(d)}(b,d);case"$toInt":return function(l,b){const d=Xl(l,b);return parseInt(d)}(b,d);case"$toLong":return function(l,b){const d=Xl(l,b);return parseInt(d)}(b,d);case"$toString":return function(l,b){const d=Xl(l,b);return null==d?null:String(d)}(b,d);case"$objectToArray":return function(l,b){const d=Xl(l,b);if("object"!=typeof d||null===d||Array.isArray(d))return null;return Object.keys(d).map(l=>({k:l,v:d[l]}))}(b,d);case"$arrayToObject":return function(l,b){const d=Xl(l,b);if(!Array.isArray(d))return null;const Z={};for(const c of d)Array.isArray(c)&&2===c.length?Z[c[0]]=c[1]:"object"==typeof c&&void 0!==c.k&&void 0!==c.v&&(Z[c.k]=c.v);return Z}(b,d);case"$mergeObjects":return function(l,b){if(!Array.isArray(l))return Xl(l,b);const d={};for(const Z of l){const l=Xl(Z,b);"object"!=typeof l||null===l||Array.isArray(l)||Object.assign(d,l)}return d}(b,d);case"$literal":return b;default:throw new Error(`Unsupported aggregation operator: ${l}`)}}(Z,l[Z],b)}{const Z={};for(const c of d)Z[c]=Xl(l[c],b);return Z}}return l}function tl(l){return l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}const ul={1:"double",2:"string",3:"object",4:"array",5:"binData",6:"undefined",7:"objectId",8:"bool",9:"date",10:"null",11:"regex",13:"javascript",15:"javascriptWithScope",16:"int",17:"timestamp",18:"long",19:"decimal",127:"maxKey","-1":"minKey"},nl=Object.entries(ul).reduce((l,[b,d])=>(l[d]=parseInt(b),l),{});function Wl(l,b){if(k(b)){for(let d=0;d<b.length;d++)if(Wl(l,b[d]))return!0;return!1}const d="number"==typeof b?b:nl[b],Z=ul[d]||b;return null===l?"null"===Z||10===d:void 0===l?"undefined"===Z||6===d:"number"==typeof l?Number.isInteger(l)?"int"===Z||16===d:"double"===Z||1===d:"string"==typeof l?"string"===Z||2===d:"boolean"==typeof l?"bool"===Z||8===d:l instanceof Date?"date"===Z||9===d:l instanceof L?"objectId"===Z||7===d:l instanceof RegExp?"regex"===Z||11===d:k(l)?"array"===Z||4===d:"object"==typeof l?"object"===Z||3===d:typeof l===b}function al(l){if(k(l)){let b=0;for(let d=0;d<l.length;d++)b|=1<<l[d];return b}return"number"==typeof l?l:0}function el(l,b){if("number"!=typeof l)return!1;const d=al(b);return(l&d)===d}function pl(l,b){if("number"!=typeof l)return!1;return 0===(l&al(b))}function hl(l,b){if("number"!=typeof l)return!1;return 0!==(l&al(b))}function ol(l,b){if("number"!=typeof l)return!1;const d=al(b);return(l&d)!==d}function sl(l,b){if(b.type){const d=k(l)?"array":null===l?"null":typeof l;if(b.type!==d)return!1}if(b.required&&k(b.required))for(let d=0;d<b.required.length;d++)if(!(b.required[d]in l))return!1;if(b.properties)for(const d in b.properties){if(!(d in l))return!1;const Z=b.properties[d];if(!sl(l[d],Z))return!1}if(void 0!==b.minimum&&"number"==typeof l&&l<b.minimum)return!1;if(void 0!==b.maximum&&"number"==typeof l&&l>b.maximum)return!1;if(void 0!==b.minLength&&"string"==typeof l&&l.length<b.minLength)return!1;if(void 0!==b.maxLength&&"string"==typeof l&&l.length>b.maxLength)return!1;if(b.pattern&&"string"==typeof l){if(!new RegExp(b.pattern).test(l))return!1}return!(b.enum&&k(b.enum)&&!b.enum.includes(l))}function Vl(l,b){return l instanceof L&&b instanceof L?l.equals(b):l==b}function yl(l,b,d){let Z=l,c=b;switch(l instanceof L&&(Z=l.toString()),b instanceof L&&(c=b.toString()),d){case">":return Z>c;case">=":return Z>=c;case"<":return Z<c;case"<=":return Z<=c;default:return!1}}function Il(l,b){if(void 0===l)return!1;if(null===l)return b(l);if(k(l)){for(var d=0;d<l.length;d++)if(b(l[d]))return!0;return!1}return b(l)}function Yl(l){if("string"!=typeof l)return[];const b=function(l){return"string"!=typeof l?[]:l.toLowerCase().split(/\W+/).filter(l=>l.length>0).filter(l=>!Gl.has(l))}(l);return b.map(l=>function(l){let b=String(l).toLowerCase();if(b.length<3)return b;let d,Z=!1;return 121===b.codePointAt(0)&&(Z=!0,b="Y"+b.slice(1)),dl.test(b)?b=b.slice(0,-2):bl.test(b)&&(b=b.slice(0,-1)),(d=ll.exec(b))?j.test(d[1])&&(b=b.slice(0,-1)):(d=$.exec(b))&&w.test(d[1])&&(b=d[1],q.test(b)?b+="e":Zl.test(b)?b=b.slice(0,-1):O.test(b)&&(b+="e")),(d=A.exec(b))&&w.test(d[1])&&(b=d[1]+"i"),(d=cl.exec(b))&&j.test(d[1])&&(b=d[1]+T[d[2]]),(d=il.exec(b))&&j.test(d[1])&&(b=d[1]+U[d[2]]),(d=ml.exec(b))?M.test(d[1])&&(b=d[1]):(d=_.exec(b))&&M.test(d[1])&&(b=d[1]),(d=D.exec(b))&&(M.test(d[1])||P.test(d[1])&&!O.test(d[1]))&&(b=d[1]),E.test(b)&&M.test(b)&&(b=b.slice(0,-1)),Z&&(b="y"+b.slice(1)),b}(l))}function Kl(l,b){if("string"!=typeof l)return!1;const d=new Set(Yl(l));return Yl(b).some(l=>d.has(l))}function Rl(l,b){try{if(!Array.isArray(b)||2!==b.length)return!1;const d=b[0][0],Z=b[0][1],c=b[1][0];return rl(l,d,c,b[1][1],Z)}catch(d){return!1}}function rl(l,b,d,Z,c){if(!l)return!1;if("FeatureCollection"===l.type&&l.features&&l.features.length>0){for(const i of l.features)if(i.geometry&&!rl(i.geometry,b,d,Z,c))return!1;return!0}if("Feature"===l.type&&l.geometry)return rl(l.geometry,b,d,Z,c);if("Point"===l.type&&l.coordinates){const[i,m]=l.coordinates;if("number"==typeof i&&"number"==typeof m)return i>=b&&i<=d&&m>=Z&&m<=c}if("Polygon"===l.type&&l.coordinates&&l.coordinates.length>0){for(const i of l.coordinates)for(const l of i){const i=l[0],m=l[1];if(i<b||i>d||m<Z||m>c)return!1}return!0}return!1}function Jl(l){if(!l)return null;if("FeatureCollection"===l.type&&l.features&&l.features.length>0){const b=l.features[0];if(b.geometry)return Jl(b.geometry)}if("Feature"===l.type&&l.geometry)return Jl(l.geometry);if("Point"===l.type&&l.coordinates){const[b,d]=l.coordinates;if("number"==typeof b&&"number"==typeof d)return{lat:d,lng:b}}if("Polygon"===l.type&&l.coordinates&&l.coordinates.length>0){const b=l.coordinates[0];if(b.length>0){let l=0,d=0;for(const Z of b)d+=Z[0],l+=Z[1];return{lat:l/b.length,lng:d/b.length}}}return null}function Cl(l,b,d,Z){const c=(d-l)*Math.PI/180,i=(Z-b)*Math.PI/180,m=Math.sin(c/2)*Math.sin(c/2)+Math.cos(l*Math.PI/180)*Math.cos(d*Math.PI/180)*Math.sin(i/2)*Math.sin(i/2);return 6371*(2*Math.atan2(Math.sqrt(m),Math.sqrt(1-m)))}function Sl(l,b,d,Z){const c=Jl(l);if(!c)return!1;return 1e3*Cl(c.lat,c.lng,d,b)<=Z}function gl(l,b){if(!l||!b)return!1;const d=Jl(b);if(!d)return!1;const Z=Jl(l);if(!Z)return!1;if("Polygon"===b.type&&"Point"===l.type)return Nl(Z.lng,Z.lat,b.coordinates[0]);if("Polygon"===l.type&&"Point"===b.type){const d=b.coordinates;return Nl(d[0],d[1],l.coordinates[0])}if("Point"===l.type&&"Point"===b.type){return Cl(Z.lat,Z.lng,d.lat,d.lng)<.001}return!1}function Nl(l,b,d){let Z=!1;for(let c=0,i=d.length-1;c<d.length;i=c++){const m=d[c][0],G=d[c][1],X=d[i][0],t=d[i][1];G>b!=t>b&&l<(X-m)*(b-G)/(t-G)+m&&(Z=!Z)}return Z}function Ll(l,b){var d=Object.keys(b)[0],Z=b[d];if("$"!=d.charAt(0))return xl(l,d,Z);if("$and"==d)return Hl(l,Z);if("$or"==d)return function(l,b){for(var d=0;d<b.length;d++)if(Ll(l,b[d]))return!0;return!1}(l,Z);if("$not"==d)return function(l,b){return!Ll(l,b)}(l,Z);if("$nor"==d)return function(l,b){for(var d=0;d<b.length;d++)if(Ll(l,b[d]))return!1;return!0}(l,Z);if("$where"==d)return function(l,b){if("function"==typeof b)try{return b.call(l)}catch(d){return!1}else if("string"==typeof b)try{return new Function("return "+b).call(l)}catch(d){return!1}return!1}(l,Z);if("$comment"==d)return!0;if("$jsonSchema"==d)return sl(l,Z);if("$text"==d){return function(l,b){return!(!l||"object"!=typeof l)&&function l(d){if("string"==typeof d)return Kl(d,b);if("object"!=typeof d||null===d)return!1;if(k(d)){for(let b=0;b<d.length;b++)if(l(d[b]))return!0;return!1}for(const b in d)if(d.hasOwnProperty(b)&&l(d[b]))return!0;return!1}(l)}(l,Z.$search||Z)}if("$expr"!=d)throw{$err:"Can't canonicalize query: BadValue unknown top level operator: "+d,code:17287};try{return Xl(Z,l)}catch(c){return!1}}function xl(l,b,d){var Z=function(l,b){for(var d=b.split("."),Z=[l],c=0;c<d.length;c++){for(var i=d[c],m=parseInt(i,10),G=[],X=0;X<Z.length;X++){var t=Z[X];if(null!=t&&null!=t)if(k(t)&&!isNaN(m)&&m>=0)m<t.length&&G.push(t[m]);else if(k(t))for(var u=0;u<t.length;u++)null!=t[u]&&null!=t[u]&&"object"==typeof t[u]&&G.push(t[u][i]);else"object"==typeof t&&G.push(t[i])}Z=G}if(0!==(Z=Z.filter(function(l){return void 0!==l})).length)return 1===Z.length?Z[0]:Z}(l,b);if("string"==typeof d)return Il(Z,function(l){return Vl(l,d)});if("number"==typeof d)return Il(Z,function(l){return Vl(l,d)});if("boolean"==typeof d)return Il(Z,function(l){return Vl(l,d)});if(d instanceof L)return Il(Z,function(l){return Vl(l,d)});if("object"==typeof d){if(d instanceof RegExp)return null!=Z&&Il(Z,function(l){return l&&l.match(d)});if(k(d))return null!=Z&&Il(Z,function(l){return l&&F(l,d)});var c=Object.keys(d);if("$"==c[0].charAt(0)){for(var i=0;i<c.length;i++){var m=Object.keys(d)[i],G=d[m];if("$eq"==m){if(!Il(Z,function(l){return Vl(l,G)}))return!1}else if("$gt"==m){if(!Il(Z,function(l){return yl(l,G,">")}))return!1}else if("$gte"==m){if(!Il(Z,function(l){return yl(l,G,">=")}))return!1}else if("$lt"==m){if(!Il(Z,function(l){return yl(l,G,"<")}))return!1}else if("$lte"==m){if(!Il(Z,function(l){return yl(l,G,"<=")}))return!1}else if("$ne"==m){if(!Il(Z,function(l){return!Vl(l,G)}))return!1}else if("$in"==m){if(!Il(Z,function(l){return z(l,G)}))return!1}else if("$nin"==m){if(Il(Z,function(l){return z(l,G)}))return!1}else if("$exists"==m){var X=H(l,b);if(G?null==X:null!=X)return!1}else if("$type"==m){if(void 0===Z){if(6!==("number"==typeof G?G:nl[G]))return!1}else if(!Wl(Z,G))return!1}else if("$mod"==m){if(2!=G.length)throw{$err:"Can't canonicalize query: BadValue malformed mod, not enough elements",code:17287};if(!Il(Z,function(l){return null!=l&&l%G[0]==G[1]}))return!1}else if("$regex"==m){var t=G,u=d.$options||"",n="string"==typeof t?new RegExp(t,u):t;if(!Il(Z,function(l){return null!=l&&n.test(l)}))return!1}else{if("$options"==m)continue;if("$text"==m){if(!Il(Z,function(l){return null!=l&&Kl(l,G)}))return!1}else if("$expr"==m)try{if(!Xl(G,l))return!1}catch(Y){return!1}else if("$geoWithin"==m){if(!Il(Z,function(l){return null!=l&&Rl(l,G)}))return!1}else if("$near"==m||"$nearSphere"==m){let l;if(G.$geometry?l=G.$geometry.coordinates:G.coordinates?l=G.coordinates:Array.isArray(G)&&(l=G),!(l&&l.length>=2))return!1;{const[b,d]=l,c=G.$maxDistance||1e6;if(!Il(Z,function(l){return null!=l&&Sl(l,b,d,c)}))return!1}}else if("$geoIntersects"==m){const l=G.$geometry||G;if(!Il(Z,function(b){return null!=b&&gl(b,l)}))return!1}else if("$not"==m){if(xl(l,b,G))return!1}else if("$all"==m){if(null==(a=H(l,b))||!k(a))return!1;for(var W=0;W<G.length;W++)if(!z(G[W],a))return!1}else if("$elemMatch"==m){var a;if(null==(a=H(l,b))||!k(a))return!1;var e=!1;for(W=0;W<a.length;W++){var p=a[W];if("object"!=typeof p||k(p)){for(var h=!0,o=Object.keys(G),s=0;s<o.length;s++){var V=o[s],y=G[V];("$gte"!=V||p>=y)&&("$gt"!=V||p>y)&&("$lte"!=V||p<=y)&&("$lt"!=V||p<y)?"$eq"==V&&p!=y||"$ne"==V&&p==y?h=!1:"$in"!=V||z(p,y)?"$nin"==V&&z(p,y)&&(h=!1):h=!1:h=!1}if(h){e=!0;break}}else if(kl(p,G)){e=!0;break}}if(!e)return!1}else if("$size"==m){var I=H(l,b);if(null==I||!k(I))return!1;if(I.length!=G)return!1}else if("$bitsAllSet"==m){if(!Il(Z,function(l){return el(l,G)}))return!1}else if("$bitsAllClear"==m){if(!Il(Z,function(l){return pl(l,G)}))return!1}else if("$bitsAnySet"==m){if(!Il(Z,function(l){return hl(l,G)}))return!1}else{if("$bitsAnyClear"!=m)throw{$err:"Can't canonicalize query: BadValue unknown operator: "+m,code:17287};if(!Il(Z,function(l){return ol(l,G)}))return!1}}}return!0}return H(l,b)&&v(H(l,b),d)}}function Hl(l,b){for(var d=0;d<b.length;d++)if(!Ll(l,b[d]))return!1;return!0}function kl(l,b){return Hl(l,function(l){var b=[];for(var d in l)if(l.hasOwnProperty(d)){var Z={};Z[d]=l[d],b.push(Z)}return b}(b))}class zl extends d.EventEmitter{constructor(l,b=[],d={}){super(),this.target=l,this.pipeline=b,this.options=d,this.closed=!1,this._listeners=/* @__PURE__ */new Map,this._changeCounter=0,this._startWatching()}_isDB(l){return l&&"string"==typeof l.dbName&&"function"==typeof l.getCollectionNames&&l.collections instanceof Map}_isServer(l){return l&&l.databases instanceof Map&&"function"==typeof l._getDB}_isMongoClient(l){return l&&"function"==typeof l.connect&&"function"==typeof l.db&&"MongoClient"===l.constructor.name}_startWatching(){if(this.closed)return;const l=this._getCollectionsToWatch();for(const b of l)this._watchCollection(b);this._isServer(this.target)&&this._interceptServerDBCreation(),this._isDB(this.target)&&this._interceptDBCollectionCreation(),this._isMongoClient(this.target)&&this._interceptClientDBCreation()}_getCollectionsToWatch(){const l=[];if(this._isServer(this.target)){for(const[b,d]of this.target.databases){const b=d.getCollectionNames();for(const Z of b){const b=d[Z];b&&b.isCollection&&l.push(b)}}return l}if(this._isMongoClient(this.target))return this._monitorClient(),l;if(this._isDB(this.target)){const b=this.target.getCollectionNames();for(const d of b){const b=this.target[d];b&&b.isCollection&&l.push(b)}this._monitorDB()}return this.target.isCollection&&l.push(this.target),l}_watchCollection(l){if(this.closed)return;if(!l)return;if("function"!=typeof l.on)return;if(!l.isCollection)return;if(this._listeners.has(l))return;const b={insert:b=>this._emitChange("insert",l,b),update:(b,d)=>this._emitChange("update",l,b,d),replace:b=>this._emitChange("replace",l,b),delete:b=>this._emitChange("delete",l,b)};this._listeners.set(l,b),l.on("insert",b.insert),l.on("update",b.update),l.on("replace",b.replace),l.on("delete",b.delete)}_emitChange(l,b,d,Z=null){if(this.closed)return;const c=this._createChangeEvent(l,b,d,Z);this._matchesPipeline(c)&&this.emit("change",c)}_createChangeEvent(l,b,d,Z){const c={_id:{_data:btoa(String(++this._changeCounter))},operationType:l,clusterTime:/* @__PURE__ */new Date,ns:{db:b.db.dbName,coll:b.name},documentKey:{_id:d._id}};switch(l){case"insert":case"replace":c.fullDocument=d;break;case"update":c.updateDescription=Z||{updatedFields:{},removedFields:[],truncatedArrays:[]},"updateLookup"===this.options.fullDocument&&(c.fullDocument=d)}return c}_matchesPipeline(l){if(!this.pipeline||0===this.pipeline.length)return!0;for(const b of this.pipeline)if(b.$match&&!kl(l,b.$match))return!1;return!0}_getNestedValue(l,b){return b.split(".").reduce((l,b)=>l?.[b],l)}_monitorClient(){}_interceptClientDBCreation(){const l=this.target,b=l.db.bind(l),d=this;this._watchedDBs=/* @__PURE__ */new Map,l.db=function(l,Z){const c=b(l,Z),i=c.dbName;if(!d._watchedDBs.has(i)){d._watchedDBs.set(i,c);const l=c.getCollectionNames();for(const b of l){const l=c[b];l&&l.isCollection&&!d._listeners.has(l)&&d._watchCollection(l)}d._interceptDBCollectionCreationForClient(c)}return c},this._originalClientMethods={db:b}}_interceptServerDBCreation(){const l=this.target,b=l._getDB.bind(l),d=this;this._watchedDBs=/* @__PURE__ */new Map,l._getDB=function(l){const Z=b(l);if(!d._watchedDBs.has(l)){d._watchedDBs.set(l,Z);const b=Z.getCollectionNames();for(const l of b){const b=Z[l];b&&b.isCollection&&!d._listeners.has(b)&&d._watchCollection(b)}d._interceptDBCollectionCreationForServer(Z)}return Z},this._originalServerMethods={_getDB:b}}_interceptDBCollectionCreationForServer(l){const b=l.collection.bind(l),d=l.createCollection.bind(l),Z=this;l.collection=function(l){const d=b(l);return d&&d.isCollection&&!Z._listeners.has(d)&&Z._watchCollection(d),d},l.createCollection=function(b){d(b);const c=l[b];c&&c.isCollection&&!Z._listeners.has(c)&&Z._watchCollection(c)}}_interceptDBCollectionCreationForClient(l){const b=l.collection.bind(l),d=l.createCollection.bind(l),Z=this;l.collection=function(l){const d=b(l);return d&&d.isCollection&&!Z._listeners.has(d)&&Z._watchCollection(d),d},l.createCollection=function(b){d(b);const c=l[b];c&&c.isCollection&&!Z._listeners.has(c)&&Z._watchCollection(c)}}_monitorDB(){}_interceptDBCollectionCreation(){const l=this.target,b=l.getCollection.bind(l),d=l.createCollection?l.createCollection.bind(l):null,Z=this;l.getCollection=function(l){const d=b(l);return d&&d.isCollection&&!Z._listeners.has(d)&&Z._watchCollection(d),d},d&&(l.createCollection=function(b){d(b);const c=l[b];c&&c.isCollection&&!Z._listeners.has(c)&&Z._watchCollection(c)}),this._originalDBMethods={getCollection:b,createCollection:d}}close(){if(!this.closed){this.closed=!0;for(const[l,b]of this._listeners)l.off("insert",b.insert),l.off("update",b.update),l.off("replace",b.replace),l.off("delete",b.delete);this._listeners.clear(),this._originalServerMethods&&"Server"===this.target.constructor.name&&(this.target._getDB=this._originalServerMethods._getDB),this._originalDBMethods&&"DB"===this.target.constructor.name&&(this.target.collection=this._originalDBMethods.collection,this.target.createCollection=this._originalDBMethods.createCollection),this._originalClientMethods&&"MongoClient"===this.target.constructor.name&&(this.target.db=this._originalClientMethods.db),this.emit("close"),this.removeAllListeners()}}get isClosed(){return this.closed}async*[Symbol.asyncIterator](){const l=[];let b=null,d=!1;const Z=d=>{b?(b({value:d,done:!1}),b=null):l.push(d)},c=()=>{d=!0,b&&(b({done:!0}),b=null)},i=l=>{b&&(b(Promise.reject(l)),b=null)};this.on("change",Z),this.on("close",c),this.on("error",i);try{for(;!d;)if(l.length>0)yield l.shift();else{const l=await new Promise(l=>{b=l,d&&l({done:!0})});if(l.done)break;yield l.value}}finally{this.off("change",Z),this.off("close",c),this.off("error",i)}}async next(){return new Promise((l,b)=>{const d=b=>{i(),l(b)},Z=()=>{i(),l(null)},c=l=>{i(),b(l)},i=()=>{this.off("change",d),this.off("close",Z),this.off("error",c)};this.closed?l(null):(this.once("change",d),this.once("close",Z),this.once("error",c))})}}class Fl{constructor(l=!1){this.enabled=l,this.timings=[],this.nestedLevel=0}setEnabled(l){this.enabled=l}start(l,b,d={}){return this.enabled?{category:l,operation:b,details:d,startTime:performance.now(),nestedLevel:this.nestedLevel++}:null}end(l,b={}){if(!this.enabled||!l)return;this.nestedLevel>0&&this.nestedLevel--;const d=performance.now()-l.startTime;this.timings.push({category:l.category,operation:l.operation,duration:d,details:{...l.details,...b},nestedLevel:l.nestedLevel,timestamp:l.startTime})}getTimings(){return this.timings}getTimingsByCategory(){const l={};for(const b of this.timings)l[b.category]||(l[b.category]=[]),l[b.category].push(b);return l}getSummary(){const l={};for(const b of this.timings){const d=`${b.category}.${b.operation}`;l[d]||(l[d]={category:b.category,operation:b.operation,count:0,total:0,min:1/0,max:-1/0,avg:0});const Z=l[d];Z.count++,Z.total+=b.duration,Z.min=Math.min(Z.min,b.duration),Z.max=Math.max(Z.max,b.duration),Z.avg=Z.total/Z.count}return Object.values(l)}clear(){this.timings=[],this.nestedLevel=0}formatTimings(){const l=this.getSummary();if(0===l.length)return"No timing data collected";let b="\n"+"=".repeat(80)+"\n";b+="PERFORMANCE TIMING REPORT\n",b+="=".repeat(80)+"\n\n";const d={};for(const Z of l)d[Z.category]||(d[Z.category]=[]),d[Z.category].push(Z);for(const[Z,c]of Object.entries(d)){b+=`${Z.toUpperCase()}\n`,b+="-".repeat(80)+"\n",b+="Operation".padEnd(30)+"Count".padStart(8)+"Total(ms)".padStart(12)+"Avg(ms)".padStart(12)+"Min(ms)".padStart(12)+"Max(ms)".padStart(12)+"\n",b+="-".repeat(80)+"\n";for(const l of c)b+=l.operation.padEnd(30)+l.count.toString().padStart(8)+l.total.toFixed(3).padStart(12)+l.avg.toFixed(3).padStart(12)+l.min.toFixed(3).padStart(12)+l.max.toFixed(3).padStart(12)+"\n";b+="\n"}return b+="=".repeat(80)+"\n",b}}const vl=new Fl(!1);function Tl(l){if(null==l)return l;if("function"==typeof l)return{__function:l.toString()};if(l&&"object"==typeof l&&"function"==typeof l.toString)try{const b=l.toString();if(b&&24===b.length&&/^[0-9a-f]{24}$/i.test(b)&&l.constructor&&"ObjectId"===l.constructor.name)return{__objectId:b}}catch(b){}if(l instanceof L)return{__objectId:l.toString()};if(l instanceof Date)return{__date:l.toISOString()};if(Array.isArray(l))return l.map(Tl);if("object"==typeof l){const b={};for(const[d,Z]of Object.entries(l))b[d]=Tl(Z);return b}return l}function Ul(l){if(null==l)return l;if("object"==typeof l&&l.__function)return"string"==typeof l.__function?`(${l.__function}).call(this)`:void 0;if("object"==typeof l&&l.__objectId)return new L(l.__objectId);if("object"==typeof l&&l.__date)return new Date(l.__date);if(Array.isArray(l))return l.map(Ul);if("object"==typeof l){const b={};for(const[d,Z]of Object.entries(l))b[d]=Ul(Z);return b}return l}class Bl extends d.EventEmitter{constructor(l){super(),this.worker=l,this._nextId=1,this._pending=/* @__PURE__ */new Map,this._terminating=!1,this._handleMessage=this._handleMessage.bind(this),this._handleError=this._handleError.bind(this),this._attach()}static async create(l={}){if("undefined"!=typeof window&&void 0!==globalThis.Worker)return new Ql(l);const{Worker:b}=await import("worker_threads"),{fileURLToPath:d}=await import("url");let Z=l.workerPath;if(!Z){Z=d(new URL("data:text/javascript;base64,dmFyIGUsdD17ZXhwb3J0czp7fX07dmFyIG49ZnVuY3Rpb24oKXtpZihlKXJldHVybiB0LmV4cG9ydHM7ZT0xO3ZhciBuLHI9Im9iamVjdCI9PXR5cGVvZiBSZWZsZWN0P1JlZmxlY3Q6bnVsbCxpPXImJiJmdW5jdGlvbiI9PXR5cGVvZiByLmFwcGx5P3IuYXBwbHk6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBGdW5jdGlvbi5wcm90b3R5cGUuYXBwbHkuY2FsbChlLHQsbil9O249ciYmImZ1bmN0aW9uIj09dHlwZW9mIHIub3duS2V5cz9yLm93bktleXM6T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scz9mdW5jdGlvbihlKXtyZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoZSkuY29uY2F0KE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSkpfTpmdW5jdGlvbihlKXtyZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoZSl9O3ZhciBzPU51bWJlci5pc05hTnx8ZnVuY3Rpb24oZSl7cmV0dXJuIGUhPWV9O2Z1bmN0aW9uIG8oKXtvLmluaXQuY2FsbCh0aGlzKX10LmV4cG9ydHM9byx0LmV4cG9ydHMub25jZT1mdW5jdGlvbihlLHQpe3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihuLHIpe2Z1bmN0aW9uIGkobil7ZS5yZW1vdmVMaXN0ZW5lcih0LHMpLHIobil9ZnVuY3Rpb24gcygpeyJmdW5jdGlvbiI9PXR5cGVvZiBlLnJlbW92ZUxpc3RlbmVyJiZlLnJlbW92ZUxpc3RlbmVyKCJlcnJvciIsaSksbihbXS5zbGljZS5jYWxsKGFyZ3VtZW50cykpfW0oZSx0LHMse29uY2U6ITB9KSwiZXJyb3IiIT09dCYmZnVuY3Rpb24oZSx0LG4peyJmdW5jdGlvbiI9PXR5cGVvZiBlLm9uJiZtKGUsImVycm9yIix0LG4pfShlLGkse29uY2U6ITB9KX0pfSxvLkV2ZW50RW1pdHRlcj1vLG8ucHJvdG90eXBlLl9ldmVudHM9dm9pZCAwLG8ucHJvdG90eXBlLl9ldmVudHNDb3VudD0wLG8ucHJvdG90eXBlLl9tYXhMaXN0ZW5lcnM9dm9pZCAwO3ZhciBhPTEwO2Z1bmN0aW9uIGMoZSl7aWYoImZ1bmN0aW9uIiE9dHlwZW9mIGUpdGhyb3cgbmV3IFR5cGVFcnJvcignVGhlICJsaXN0ZW5lciIgYXJndW1lbnQgbXVzdCBiZSBvZiB0eXBlIEZ1bmN0aW9uLiBSZWNlaXZlZCB0eXBlICcrdHlwZW9mIGUpfWZ1bmN0aW9uIGwoZSl7cmV0dXJuIHZvaWQgMD09PWUuX21heExpc3RlbmVycz9vLmRlZmF1bHRNYXhMaXN0ZW5lcnM6ZS5fbWF4TGlzdGVuZXJzfWZ1bmN0aW9uIHUoZSx0LG4scil7dmFyIGkscyxvLGE7aWYoYyhuKSx2b2lkIDA9PT0ocz1lLl9ldmVudHMpPyhzPWUuX2V2ZW50cz0vKiBAX19QVVJFX18gKi9PYmplY3QuY3JlYXRlKG51bGwpLGUuX2V2ZW50c0NvdW50PTApOih2b2lkIDAhPT1zLm5ld0xpc3RlbmVyJiYoZS5lbWl0KCJuZXdMaXN0ZW5lciIsdCxuLmxpc3RlbmVyP24ubGlzdGVuZXI6bikscz1lLl9ldmVudHMpLG89c1t0XSksdm9pZCAwPT09bylvPXNbdF09biwrK2UuX2V2ZW50c0NvdW50O2Vsc2UgaWYoImZ1bmN0aW9uIj09dHlwZW9mIG8/bz1zW3RdPXI/W24sb106W28sbl06cj9vLnVuc2hpZnQobik6by5wdXNoKG4pLChpPWwoZSkpPjAmJm8ubGVuZ3RoPmkmJiFvLndhcm5lZCl7by53YXJuZWQ9ITA7dmFyIHU9bmV3IEVycm9yKCJQb3NzaWJsZSBFdmVudEVtaXR0ZXIgbWVtb3J5IGxlYWsgZGV0ZWN0ZWQuICIrby5sZW5ndGgrIiAiK1N0cmluZyh0KSsiIGxpc3RlbmVycyBhZGRlZC4gVXNlIGVtaXR0ZXIuc2V0TWF4TGlzdGVuZXJzKCkgdG8gaW5jcmVhc2UgbGltaXQiKTt1Lm5hbWU9Ik1heExpc3RlbmVyc0V4Y2VlZGVkV2FybmluZyIsdS5lbWl0dGVyPWUsdS50eXBlPXQsdS5jb3VudD1vLmxlbmd0aCxhPXUsY29uc29sZSYmY29uc29sZS53YXJuJiZjb25zb2xlLndhcm4oYSl9cmV0dXJuIGV9ZnVuY3Rpb24gaCgpe2lmKCF0aGlzLmZpcmVkKXJldHVybiB0aGlzLnRhcmdldC5yZW1vdmVMaXN0ZW5lcih0aGlzLnR5cGUsdGhpcy53cmFwRm4pLHRoaXMuZmlyZWQ9ITAsMD09PWFyZ3VtZW50cy5sZW5ndGg/dGhpcy5saXN0ZW5lci5jYWxsKHRoaXMudGFyZ2V0KTp0aGlzLmxpc3RlbmVyLmFwcGx5KHRoaXMudGFyZ2V0LGFyZ3VtZW50cyl9ZnVuY3Rpb24gZihlLHQsbil7dmFyIHI9e2ZpcmVkOiExLHdyYXBGbjp2b2lkIDAsdGFyZ2V0OmUsdHlwZTp0LGxpc3RlbmVyOm59LGk9aC5iaW5kKHIpO3JldHVybiBpLmxpc3RlbmVyPW4sci53cmFwRm49aSxpfWZ1bmN0aW9uIGQoZSx0LG4pe3ZhciByPWUuX2V2ZW50cztpZih2b2lkIDA9PT1yKXJldHVybltdO3ZhciBpPXJbdF07cmV0dXJuIHZvaWQgMD09PWk/W106ImZ1bmN0aW9uIj09dHlwZW9mIGk/bj9baS5saXN0ZW5lcnx8aV06W2ldOm4/ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PW5ldyBBcnJheShlLmxlbmd0aCksbj0wO248dC5sZW5ndGg7KytuKXRbbl09ZVtuXS5saXN0ZW5lcnx8ZVtuXTtyZXR1cm4gdH0oaSk6ZyhpLGkubGVuZ3RoKX1mdW5jdGlvbiBwKGUpe3ZhciB0PXRoaXMuX2V2ZW50cztpZih2b2lkIDAhPT10KXt2YXIgbj10W2VdO2lmKCJmdW5jdGlvbiI9PXR5cGVvZiBuKXJldHVybiAxO2lmKHZvaWQgMCE9PW4pcmV0dXJuIG4ubGVuZ3RofXJldHVybiAwfWZ1bmN0aW9uIGcoZSx0KXtmb3IodmFyIG49bmV3IEFycmF5KHQpLHI9MDtyPHQ7KytyKW5bcl09ZVtyXTtyZXR1cm4gbn1mdW5jdGlvbiBtKGUsdCxuLHIpe2lmKCJmdW5jdGlvbiI9PXR5cGVvZiBlLm9uKXIub25jZT9lLm9uY2UodCxuKTplLm9uKHQsbik7ZWxzZXtpZigiZnVuY3Rpb24iIT10eXBlb2YgZS5hZGRFdmVudExpc3RlbmVyKXRocm93IG5ldyBUeXBlRXJyb3IoJ1RoZSAiZW1pdHRlciIgYXJndW1lbnQgbXVzdCBiZSBvZiB0eXBlIEV2ZW50RW1pdHRlci4gUmVjZWl2ZWQgdHlwZSAnK3R5cGVvZiBlKTtlLmFkZEV2ZW50TGlzdGVuZXIodCxmdW5jdGlvbiBpKHMpe3Iub25jZSYmZS5yZW1vdmVFdmVudExpc3RlbmVyKHQsaSksbihzKX0pfX1yZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sImRlZmF1bHRNYXhMaXN0ZW5lcnMiLHtlbnVtZXJhYmxlOiEwLGdldDpmdW5jdGlvbigpe3JldHVybiBhfSxzZXQ6ZnVuY3Rpb24oZSl7aWYoIm51bWJlciIhPXR5cGVvZiBlfHxlPDB8fHMoZSkpdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1RoZSB2YWx1ZSBvZiAiZGVmYXVsdE1heExpc3RlbmVycyIgaXMgb3V0IG9mIHJhbmdlLiBJdCBtdXN0IGJlIGEgbm9uLW5lZ2F0aXZlIG51bWJlci4gUmVjZWl2ZWQgJytlKyIuIik7YT1lfX0pLG8uaW5pdD1mdW5jdGlvbigpe3ZvaWQgMCE9PXRoaXMuX2V2ZW50cyYmdGhpcy5fZXZlbnRzIT09T2JqZWN0LmdldFByb3RvdHlwZU9mKHRoaXMpLl9ldmVudHN8fCh0aGlzLl9ldmVudHM9LyogQF9fUFVSRV9fICovT2JqZWN0LmNyZWF0ZShudWxsKSx0aGlzLl9ldmVudHNDb3VudD0wKSx0aGlzLl9tYXhMaXN0ZW5lcnM9dGhpcy5fbWF4TGlzdGVuZXJzfHx2b2lkIDB9LG8ucHJvdG90eXBlLnNldE1heExpc3RlbmVycz1mdW5jdGlvbihlKXtpZigibnVtYmVyIiE9dHlwZW9mIGV8fGU8MHx8cyhlKSl0aHJvdyBuZXcgUmFuZ2VFcnJvcignVGhlIHZhbHVlIG9mICJuIiBpcyBvdXQgb2YgcmFuZ2UuIEl0IG11c3QgYmUgYSBub24tbmVnYXRpdmUgbnVtYmVyLiBSZWNlaXZlZCAnK2UrIi4iKTtyZXR1cm4gdGhpcy5fbWF4TGlzdGVuZXJzPWUsdGhpc30sby5wcm90b3R5cGUuZ2V0TWF4TGlzdGVuZXJzPWZ1bmN0aW9uKCl7cmV0dXJuIGwodGhpcyl9LG8ucHJvdG90eXBlLmVtaXQ9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PVtdLG49MTtuPGFyZ3VtZW50cy5sZW5ndGg7bisrKXQucHVzaChhcmd1bWVudHNbbl0pO3ZhciByPSJlcnJvciI9PT1lLHM9dGhpcy5fZXZlbnRzO2lmKHZvaWQgMCE9PXMpcj1yJiZ2b2lkIDA9PT1zLmVycm9yO2Vsc2UgaWYoIXIpcmV0dXJuITE7aWYocil7dmFyIG87aWYodC5sZW5ndGg+MCYmKG89dFswXSksbyBpbnN0YW5jZW9mIEVycm9yKXRocm93IG87dmFyIGE9bmV3IEVycm9yKCJVbmhhbmRsZWQgZXJyb3IuIisobz8iICgiK28ubWVzc2FnZSsiKSI6IiIpKTt0aHJvdyBhLmNvbnRleHQ9byxhfXZhciBjPXNbZV07aWYodm9pZCAwPT09YylyZXR1cm4hMTtpZigiZnVuY3Rpb24iPT10eXBlb2YgYylpKGMsdGhpcyx0KTtlbHNle3ZhciBsPWMubGVuZ3RoLHU9ZyhjLGwpO2ZvcihuPTA7bjxsOysrbilpKHVbbl0sdGhpcyx0KX1yZXR1cm4hMH0sby5wcm90b3R5cGUuYWRkTGlzdGVuZXI9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdSh0aGlzLGUsdCwhMSl9LG8ucHJvdG90eXBlLm9uPW8ucHJvdG90eXBlLmFkZExpc3RlbmVyLG8ucHJvdG90eXBlLnByZXBlbmRMaXN0ZW5lcj1mdW5jdGlvbihlLHQpe3JldHVybiB1KHRoaXMsZSx0LCEwKX0sby5wcm90b3R5cGUub25jZT1mdW5jdGlvbihlLHQpe3JldHVybiBjKHQpLHRoaXMub24oZSxmKHRoaXMsZSx0KSksdGhpc30sby5wcm90b3R5cGUucHJlcGVuZE9uY2VMaXN0ZW5lcj1mdW5jdGlvbihlLHQpe3JldHVybiBjKHQpLHRoaXMucHJlcGVuZExpc3RlbmVyKGUsZih0aGlzLGUsdCkpLHRoaXN9LG8ucHJvdG90eXBlLnJlbW92ZUxpc3RlbmVyPWZ1bmN0aW9uKGUsdCl7dmFyIG4scixpLHMsbztpZihjKHQpLHZvaWQgMD09PShyPXRoaXMuX2V2ZW50cykpcmV0dXJuIHRoaXM7aWYodm9pZCAwPT09KG49cltlXSkpcmV0dXJuIHRoaXM7aWYobj09PXR8fG4ubGlzdGVuZXI9PT10KTA9PT0tLXRoaXMuX2V2ZW50c0NvdW50P3RoaXMuX2V2ZW50cz0vKiBAX19QVVJFX18gKi9PYmplY3QuY3JlYXRlKG51bGwpOihkZWxldGUgcltlXSxyLnJlbW92ZUxpc3RlbmVyJiZ0aGlzLmVtaXQoInJlbW92ZUxpc3RlbmVyIixlLG4ubGlzdGVuZXJ8fHQpKTtlbHNlIGlmKCJmdW5jdGlvbiIhPXR5cGVvZiBuKXtmb3IoaT0tMSxzPW4ubGVuZ3RoLTE7cz49MDtzLS0paWYobltzXT09PXR8fG5bc10ubGlzdGVuZXI9PT10KXtvPW5bc10ubGlzdGVuZXIsaT1zO2JyZWFrfWlmKGk8MClyZXR1cm4gdGhpczswPT09aT9uLnNoaWZ0KCk6ZnVuY3Rpb24oZSx0KXtmb3IoO3QrMTxlLmxlbmd0aDt0KyspZVt0XT1lW3QrMV07ZS5wb3AoKX0obixpKSwxPT09bi5sZW5ndGgmJihyW2VdPW5bMF0pLHZvaWQgMCE9PXIucmVtb3ZlTGlzdGVuZXImJnRoaXMuZW1pdCgicmVtb3ZlTGlzdGVuZXIiLGUsb3x8dCl9cmV0dXJuIHRoaXN9LG8ucHJvdG90eXBlLm9mZj1vLnByb3RvdHlwZS5yZW1vdmVMaXN0ZW5lcixvLnByb3RvdHlwZS5yZW1vdmVBbGxMaXN0ZW5lcnM9ZnVuY3Rpb24oZSl7dmFyIHQsbixyO2lmKHZvaWQgMD09PShuPXRoaXMuX2V2ZW50cykpcmV0dXJuIHRoaXM7aWYodm9pZCAwPT09bi5yZW1vdmVMaXN0ZW5lcilyZXR1cm4gMD09PWFyZ3VtZW50cy5sZW5ndGg/KHRoaXMuX2V2ZW50cz0vKiBAX19QVVJFX18gKi9PYmplY3QuY3JlYXRlKG51bGwpLHRoaXMuX2V2ZW50c0NvdW50PTApOnZvaWQgMCE9PW5bZV0mJigwPT09LS10aGlzLl9ldmVudHNDb3VudD90aGlzLl9ldmVudHM9LyogQF9fUFVSRV9fICovT2JqZWN0LmNyZWF0ZShudWxsKTpkZWxldGUgbltlXSksdGhpcztpZigwPT09YXJndW1lbnRzLmxlbmd0aCl7dmFyIGkscz1PYmplY3Qua2V5cyhuKTtmb3Iocj0wO3I8cy5sZW5ndGg7KytyKSJyZW1vdmVMaXN0ZW5lciIhPT0oaT1zW3JdKSYmdGhpcy5yZW1vdmVBbGxMaXN0ZW5lcnMoaSk7cmV0dXJuIHRoaXMucmVtb3ZlQWxsTGlzdGVuZXJzKCJyZW1vdmVMaXN0ZW5lciIpLHRoaXMuX2V2ZW50cz0vKiBAX19QVVJFX18gKi9PYmplY3QuY3JlYXRlKG51bGwpLHRoaXMuX2V2ZW50c0NvdW50PTAsdGhpc31pZigiZnVuY3Rpb24iPT10eXBlb2YodD1uW2VdKSl0aGlzLnJlbW92ZUxpc3RlbmVyKGUsdCk7ZWxzZSBpZih2b2lkIDAhPT10KWZvcihyPXQubGVuZ3RoLTE7cj49MDtyLS0pdGhpcy5yZW1vdmVMaXN0ZW5lcihlLHRbcl0pO3JldHVybiB0aGlzfSxvLnByb3RvdHlwZS5saXN0ZW5lcnM9ZnVuY3Rpb24oZSl7cmV0dXJuIGQodGhpcyxlLCEwKX0sby5wcm90b3R5cGUucmF3TGlzdGVuZXJzPWZ1bmN0aW9uKGUpe3JldHVybiBkKHRoaXMsZSwhMSl9LG8ubGlzdGVuZXJDb3VudD1mdW5jdGlvbihlLHQpe3JldHVybiJmdW5jdGlvbiI9PXR5cGVvZiBlLmxpc3RlbmVyQ291bnQ/ZS5saXN0ZW5lckNvdW50KHQpOnAuY2FsbChlLHQpfSxvLnByb3RvdHlwZS5saXN0ZW5lckNvdW50PXAsby5wcm90b3R5cGUuZXZlbnROYW1lcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9ldmVudHNDb3VudD4wP24odGhpcy5fZXZlbnRzKTpbXX0sdC5leHBvcnRzfSgpO2NvbnN0IHI9MCxpPTEscz0yLG89MyxhPTQsYz01LGw9Nix1PTcsaD04LGY9OSxkPTE2LHA9MTc7Y2xhc3MgZ3tjb25zdHJ1Y3RvcihlKXtpZihudWxsPT1lKXRoaXMuaWQ9Zy5nZW5lcmF0ZSgpO2Vsc2UgaWYoInN0cmluZyI9PXR5cGVvZiBlKXtpZighZy5pc1ZhbGlkKGUpKXRocm93IG5ldyBFcnJvcihgQXJndW1lbnQgcGFzc2VkIGluIG11c3QgYmUgYSBzdHJpbmcgb2YgMjQgaGV4IGNoYXJhY3RlcnMsIGdvdDogJHtlfWApO3RoaXMuaWQ9ZS50b0xvd2VyQ2FzZSgpfWVsc2UgaWYoZSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkmJjEyPT09ZS5sZW5ndGgpdGhpcy5pZD1BcnJheS5mcm9tKGUpLm1hcChlPT5lLnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLCIwIikpLmpvaW4oIiIpO2Vsc2V7aWYoIShlIGluc3RhbmNlb2YgZykpdGhyb3cgbmV3IEVycm9yKCJBcmd1bWVudCBwYXNzZWQgaW4gbXVzdCBiZSBhIHN0cmluZyBvZiAyNCBoZXggY2hhcmFjdGVycyBvciBhbiBPYmplY3RJZCIpO3RoaXMuaWQ9ZS5pZH19dG9TdHJpbmcoKXtyZXR1cm4gdGhpcy5pZH10b0hleFN0cmluZygpe3JldHVybiB0aGlzLmlkfWdldFRpbWVzdGFtcCgpe2NvbnN0IGU9cGFyc2VJbnQodGhpcy5pZC5zdWJzdHJpbmcoMCw4KSwxNik7cmV0dXJuIG5ldyBEYXRlKDFlMyplKX1lcXVhbHMoZSl7aWYoIShlIGluc3RhbmNlb2YgZykpdGhyb3cgbmV3IEVycm9yKCJDYW4gb25seSBjb21wYXJlIHdpdGggYW5vdGhlciBPYmplY3RJZCIpO3JldHVybiB0aGlzLmlkPT09ZS5pZH1jb21wYXJlKGUpe2lmKCEoZSBpbnN0YW5jZW9mIGcpKXRocm93IG5ldyBFcnJvcigiQ2FuIG9ubHkgY29tcGFyZSB3aXRoIGFub3RoZXIgT2JqZWN0SWQiKTtyZXR1cm4gdGhpcy5pZC5sb2NhbGVDb21wYXJlKGUuaWQpfXRvSlNPTigpe3JldHVybiB0aGlzLmlkfWluc3BlY3QoKXtyZXR1cm5gT2JqZWN0SWQoIiR7dGhpcy5pZH0iKWB9dG9CeXRlcygpe2NvbnN0IGU9bmV3IFVpbnQ4QXJyYXkoMTIpO2ZvcihsZXQgdD0wO3Q8MTI7dCsrKWVbdF09cGFyc2VJbnQodGhpcy5pZC5zdWJzdHJpbmcoMip0LDIqdCsyKSwxNik7cmV0dXJuIGV9c3RhdGljIGlzVmFsaWQoZSl7cmV0dXJuISFlJiYoInN0cmluZyI9PXR5cGVvZiBlJiYoMjQ9PT1lLmxlbmd0aCYmL15bMC05YS1mQS1GXXsyNH0kLy50ZXN0KGUpKSl9c3RhdGljIGNyZWF0ZUZyb21UaW1lKGUpe2NvbnN0IHQ9KCIwMDAwMDAwMCIrTWF0aC5mbG9vcihlLzFlMykudG9TdHJpbmcoMTYpKS5zbGljZSgtOCk7cmV0dXJuIG5ldyBnKHQrIjAwMDAwMDAwMDAwMDAwMDAiKX1zdGF0aWMgZ2VuZXJhdGUoKXtjb25zdCBlPU1hdGguZmxvb3IoRGF0ZS5ub3coKS8xZTMpLHQ9InVuZGVmaW5lZCIhPXR5cGVvZiBjcnlwdG8mJmNyeXB0by5nZXRSYW5kb21WYWx1ZXM/bmV3IFVpbnQ4QXJyYXkoOCk6bnVsbDtsZXQgbj0iIjtpZih0KXtjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKHQpO2ZvcihsZXQgZT0wO2U8dC5sZW5ndGg7ZSsrKW4rPSgiMCIrdFtlXS50b1N0cmluZygxNikpLnNsaWNlKC0yKX1lbHNlIG49TWF0aC5yYW5kb20oKS50b1N0cmluZygxNikuc2xpY2UoMikucGFkRW5kKDgsIjAiKS5zbGljZSgwLDgpK01hdGgucmFuZG9tKCkudG9TdHJpbmcoMTYpLnNsaWNlKDIpLnBhZEVuZCg4LCIwIikuc2xpY2UoMCw4KTtyZXR1cm4oKCIwMDAwMDAwMCIrZS50b1N0cmluZygxNikpLnNsaWNlKC04KStuKS5zbGljZSgwLDI0KX19Y2xhc3MgbXtjb25zdHJ1Y3RvcihlKXtpZihudWxsPT1lKXRocm93IG5ldyBFcnJvcigiUG9pbnRlciBvZmZzZXQgbXVzdCBiZSBhIG51bWJlciIpO2lmKCJudW1iZXIiIT10eXBlb2YgZSl0aHJvdyBuZXcgRXJyb3IoIlBvaW50ZXIgb2Zmc2V0IG11c3QgYmUgYSBudW1iZXIiKTtpZighTnVtYmVyLmlzSW50ZWdlcihlKSl0aHJvdyBuZXcgRXJyb3IoIlBvaW50ZXIgb2Zmc2V0IG11c3QgYmUgYW4gaW50ZWdlciIpO2lmKGU8MCl0aHJvdyBuZXcgRXJyb3IoIlBvaW50ZXIgb2Zmc2V0IG11c3QgYmUgbm9uLW5lZ2F0aXZlIik7aWYoZT5OdW1iZXIuTUFYX1NBRkVfSU5URUdFUil0aHJvdyBuZXcgRXJyb3IoIlBvaW50ZXIgb2Zmc2V0IGV4Y2VlZHMgbWF4aW11bSBzYWZlIGludGVnZXIiKTt0aGlzLm9mZnNldD1lfXZhbHVlT2YoKXtyZXR1cm4gdGhpcy5vZmZzZXR9dG9TdHJpbmcoKXtyZXR1cm4gdGhpcy5vZmZzZXQudG9TdHJpbmcoKX10b0pTT04oKXtyZXR1cm4gdGhpcy5vZmZzZXR9aW5zcGVjdCgpe3JldHVybmBQb2ludGVyKCR7dGhpcy5vZmZzZXR9KWB9ZXF1YWxzKGUpe3JldHVybiBlIGluc3RhbmNlb2YgbSYmdGhpcy5vZmZzZXQ9PT1lLm9mZnNldH19ZnVuY3Rpb24geShlKXtjb25zdCB0PVtdOyFmdW5jdGlvbiBlKG4pe2lmKG51bGw9PT1uKXQucHVzaChuZXcgVWludDhBcnJheShbcl0pKTtlbHNlIGlmKCExPT09bil0LnB1c2gobmV3IFVpbnQ4QXJyYXkoW2ldKSk7ZWxzZSBpZighMD09PW4pdC5wdXNoKG5ldyBVaW50OEFycmF5KFtzXSkpO2Vsc2UgaWYobiBpbnN0YW5jZW9mIGcpdC5wdXNoKG5ldyBVaW50OEFycmF5KFtsXSkpLHQucHVzaChuLnRvQnl0ZXMoKSk7ZWxzZSBpZihuIGluc3RhbmNlb2YgRGF0ZSl7dC5wdXNoKG5ldyBVaW50OEFycmF5KFt1XSkpO2NvbnN0IGU9bmV3IEFycmF5QnVmZmVyKDgpO25ldyBEYXRhVmlldyhlKS5zZXRCaWdJbnQ2NCgwLEJpZ0ludChuLmdldFRpbWUoKSksITApLHQucHVzaChuZXcgVWludDhBcnJheShlKSl9ZWxzZSBpZihuIGluc3RhbmNlb2YgbSl7dC5wdXNoKG5ldyBVaW50OEFycmF5KFtoXSkpO2NvbnN0IGU9bmV3IEFycmF5QnVmZmVyKDgpO25ldyBEYXRhVmlldyhlKS5zZXRCaWdVaW50NjQoMCxCaWdJbnQobi5vZmZzZXQpLCEwKSx0LnB1c2gobmV3IFVpbnQ4QXJyYXkoZSkpfWVsc2UgaWYobiBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpe3QucHVzaChuZXcgVWludDhBcnJheShbZl0pKTtjb25zdCBlPW5ldyBBcnJheUJ1ZmZlcig0KTtuZXcgRGF0YVZpZXcoZSkuc2V0VWludDMyKDAsbi5sZW5ndGgsITApLHQucHVzaChuZXcgVWludDhBcnJheShlKSksdC5wdXNoKG4pfWVsc2UgaWYoIm51bWJlciI9PXR5cGVvZiBuKWlmKE51bWJlci5pc0ludGVnZXIobikmJk51bWJlci5pc1NhZmVJbnRlZ2VyKG4pKXt0LnB1c2gobmV3IFVpbnQ4QXJyYXkoW29dKSk7Y29uc3QgZT1uZXcgQXJyYXlCdWZmZXIoOCk7bmV3IERhdGFWaWV3KGUpLnNldEJpZ0ludDY0KDAsQmlnSW50KG4pLCEwKSx0LnB1c2gobmV3IFVpbnQ4QXJyYXkoZSkpfWVsc2V7dC5wdXNoKG5ldyBVaW50OEFycmF5KFthXSkpO2NvbnN0IGU9bmV3IEFycmF5QnVmZmVyKDgpO25ldyBEYXRhVmlldyhlKS5zZXRGbG9hdDY0KDAsbiwhMCksdC5wdXNoKG5ldyBVaW50OEFycmF5KGUpKX1lbHNlIGlmKCJzdHJpbmciPT10eXBlb2Ygbil7dC5wdXNoKG5ldyBVaW50OEFycmF5KFtjXSkpO2NvbnN0IGU9KG5ldyBUZXh0RW5jb2RlcikuZW5jb2RlKG4pLHI9bmV3IEFycmF5QnVmZmVyKDQpO25ldyBEYXRhVmlldyhyKS5zZXRVaW50MzIoMCxlLmxlbmd0aCwhMCksdC5wdXNoKG5ldyBVaW50OEFycmF5KHIpKSx0LnB1c2goZSl9ZWxzZSBpZihBcnJheS5pc0FycmF5KG4pKXtjb25zdCByPVtdLGk9bmV3IEFycmF5QnVmZmVyKDQpO25ldyBEYXRhVmlldyhpKS5zZXRVaW50MzIoMCxuLmxlbmd0aCwhMCksci5wdXNoKG5ldyBVaW50OEFycmF5KGkpKTtjb25zdCBzPXQubGVuZ3RoO2Zvcihjb25zdCB0IG9mIG4pZSh0KTtjb25zdCBvPXQuc3BsaWNlKHMpO3IucHVzaCguLi5vKTtjb25zdCBhPXIucmVkdWNlKChlLHQpPT5lK3QubGVuZ3RoLDApO3QucHVzaChuZXcgVWludDhBcnJheShbZF0pKTtjb25zdCBjPW5ldyBBcnJheUJ1ZmZlcig0KTtuZXcgRGF0YVZpZXcoYykuc2V0VWludDMyKDAsYSwhMCksdC5wdXNoKG5ldyBVaW50OEFycmF5KGMpKSx0LnB1c2goLi4ucil9ZWxzZXtpZigib2JqZWN0IiE9dHlwZW9mIG4pdGhyb3cgbmV3IEVycm9yKCJVbnN1cHBvcnRlZCB0eXBlOiAiK3R5cGVvZiBuKTt7Y29uc3Qgcj1bXSxpPU9iamVjdC5rZXlzKG4pLHM9bmV3IEFycmF5QnVmZmVyKDQpO25ldyBEYXRhVmlldyhzKS5zZXRVaW50MzIoMCxpLmxlbmd0aCwhMCksci5wdXNoKG5ldyBVaW50OEFycmF5KHMpKTtjb25zdCBvPXQubGVuZ3RoO2Zvcihjb25zdCB1IG9mIGkpe2NvbnN0IHI9KG5ldyBUZXh0RW5jb2RlcikuZW5jb2RlKHUpLGk9bmV3IEFycmF5QnVmZmVyKDQpO25ldyBEYXRhVmlldyhpKS5zZXRVaW50MzIoMCxyLmxlbmd0aCwhMCksdC5wdXNoKG5ldyBVaW50OEFycmF5KGkpKSx0LnB1c2gociksZShuW3VdKX1jb25zdCBhPXQuc3BsaWNlKG8pO3IucHVzaCguLi5hKTtjb25zdCBjPXIucmVkdWNlKChlLHQpPT5lK3QubGVuZ3RoLDApO3QucHVzaChuZXcgVWludDhBcnJheShbcF0pKTtjb25zdCBsPW5ldyBBcnJheUJ1ZmZlcig0KTtuZXcgRGF0YVZpZXcobCkuc2V0VWludDMyKDAsYywhMCksdC5wdXNoKG5ldyBVaW50OEFycmF5KGwpKSx0LnB1c2goLi4ucil9fX0oZSk7Y29uc3Qgbj10LnJlZHVjZSgoZSx0KT0+ZSt0Lmxlbmd0aCwwKSx5PW5ldyBVaW50OEFycmF5KG4pO2xldCB3PTA7Zm9yKGNvbnN0IHIgb2YgdCl5LnNldChyLHcpLHcrPXIubGVuZ3RoO3JldHVybiB5fWZ1bmN0aW9uIHcoZSl7bGV0IHQ9MDtyZXR1cm4gZnVuY3Rpb24gbigpe2lmKHQ+PWUubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiVW5leHBlY3RlZCBlbmQgb2YgZGF0YSIpO2NvbnN0IHk9ZVt0KytdO3N3aXRjaCh5KXtjYXNlIHI6cmV0dXJuIG51bGw7Y2FzZSBpOnJldHVybiExO2Nhc2UgczpyZXR1cm4hMDtjYXNlIG86e2lmKHQrND5lLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoIlVuZXhwZWN0ZWQgZW5kIG9mIGRhdGEgZm9yIElOVCIpO2NvbnN0IG49bmV3IERhdGFWaWV3KGUuYnVmZmVyLGUuYnl0ZU9mZnNldCt0LDgpLmdldEJpZ0ludDY0KDAsITApO2lmKHQrPTgsbjxCaWdJbnQoTnVtYmVyLk1JTl9TQUZFX0lOVEVHRVIpfHxuPkJpZ0ludChOdW1iZXIuTUFYX1NBRkVfSU5URUdFUikpdGhyb3cgbmV3IEVycm9yKCJEZWNvZGVkIGludGVnZXIgZXhjZWVkcyBzYWZlIHJhbmdlIik7cmV0dXJuIE51bWJlcihuKX1jYXNlIGE6e2lmKHQrOD5lLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoIlVuZXhwZWN0ZWQgZW5kIG9mIGRhdGEgZm9yIEZMT0FUIik7Y29uc3Qgbj1uZXcgRGF0YVZpZXcoZS5idWZmZXIsZS5ieXRlT2Zmc2V0K3QsOCkuZ2V0RmxvYXQ2NCgwLCEwKTtyZXR1cm4gdCs9OCxufWNhc2UgYzp7aWYodCs0PmUubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiVW5leHBlY3RlZCBlbmQgb2YgZGF0YSBmb3IgU1RSSU5HIGxlbmd0aCIpO2NvbnN0IG49bmV3IERhdGFWaWV3KGUuYnVmZmVyLGUuYnl0ZU9mZnNldCt0LDQpLmdldFVpbnQzMigwLCEwKTtpZih0Kz00LHQrbj5lLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoIlVuZXhwZWN0ZWQgZW5kIG9mIGRhdGEgZm9yIFNUUklORyBjb250ZW50Iik7Y29uc3Qgcj1lLnNsaWNlKHQsdCtuKTtyZXR1cm4gdCs9biwobmV3IFRleHREZWNvZGVyKS5kZWNvZGUocil9Y2FzZSBsOntpZih0KzEyPmUubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiVW5leHBlY3RlZCBlbmQgb2YgZGF0YSBmb3IgT0lEIik7Y29uc3Qgbj1lLnNsaWNlKHQsdCsxMik7cmV0dXJuIHQrPTEyLG5ldyBnKG4pfWNhc2UgdTp7aWYodCs4PmUubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiVW5leHBlY3RlZCBlbmQgb2YgZGF0YSBmb3IgREFURSIpO2NvbnN0IG49bmV3IERhdGFWaWV3KGUuYnVmZmVyLGUuYnl0ZU9mZnNldCt0LDgpLmdldEJpZ0ludDY0KDAsITApO3JldHVybiB0Kz04LG5ldyBEYXRlKE51bWJlcihuKSl9Y2FzZSBoOntpZih0Kzg+ZS5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKCJVbmV4cGVjdGVkIGVuZCBvZiBkYXRhIGZvciBQT0lOVEVSIik7Y29uc3Qgbj1uZXcgRGF0YVZpZXcoZS5idWZmZXIsZS5ieXRlT2Zmc2V0K3QsOCkuZ2V0QmlnVWludDY0KDAsITApO2lmKHQrPTgsbj5CaWdJbnQoTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIpKXRocm93IG5ldyBFcnJvcigiUG9pbnRlciBvZmZzZXQgb3V0IG9mIHZhbGlkIHJhbmdlIik7cmV0dXJuIG5ldyBtKE51bWJlcihuKSl9Y2FzZSBmOntpZih0KzQ+ZS5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKCJVbmV4cGVjdGVkIGVuZCBvZiBkYXRhIGZvciBCSU5BUlkgbGVuZ3RoIik7Y29uc3Qgbj1uZXcgRGF0YVZpZXcoZS5idWZmZXIsZS5ieXRlT2Zmc2V0K3QsNCkuZ2V0VWludDMyKDAsITApO2lmKHQrPTQsdCtuPmUubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiVW5leHBlY3RlZCBlbmQgb2YgZGF0YSBmb3IgQklOQVJZIGNvbnRlbnQiKTtjb25zdCByPWUuc2xpY2UodCx0K24pO3JldHVybiB0Kz1uLHJ9Y2FzZSBkOntpZih0KzQ+ZS5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKCJVbmV4cGVjdGVkIGVuZCBvZiBkYXRhIGZvciBBUlJBWSBzaXplIik7Y29uc3Qgcj1uZXcgRGF0YVZpZXcoZS5idWZmZXIsZS5ieXRlT2Zmc2V0K3QsNCkuZ2V0VWludDMyKDAsITApO2lmKHQrPTQsdCtyPmUubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiVW5leHBlY3RlZCBlbmQgb2YgZGF0YSBmb3IgQVJSQVkgY29udGVudCIpO2NvbnN0IGk9bmV3IERhdGFWaWV3KGUuYnVmZmVyLGUuYnl0ZU9mZnNldCt0LDQpLmdldFVpbnQzMigwLCEwKTt0Kz00O2NvbnN0IHM9W107Zm9yKGxldCBlPTA7ZTxpO2UrKylzLnB1c2gobigpKTtyZXR1cm4gc31jYXNlIHA6e2lmKHQrND5lLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoIlVuZXhwZWN0ZWQgZW5kIG9mIGRhdGEgZm9yIE9CSkVDVCBzaXplIik7Y29uc3Qgcj1uZXcgRGF0YVZpZXcoZS5idWZmZXIsZS5ieXRlT2Zmc2V0K3QsNCkuZ2V0VWludDMyKDAsITApO2lmKHQrPTQsdCtyPmUubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiVW5leHBlY3RlZCBlbmQgb2YgZGF0YSBmb3IgT0JKRUNUIGNvbnRlbnQiKTtjb25zdCBpPW5ldyBEYXRhVmlldyhlLmJ1ZmZlcixlLmJ5dGVPZmZzZXQrdCw0KS5nZXRVaW50MzIoMCwhMCk7dCs9NDtjb25zdCBzPXt9O2ZvcihsZXQgbz0wO288aTtvKyspe2lmKHQrND5lLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoIlVuZXhwZWN0ZWQgZW5kIG9mIGRhdGEgZm9yIE9CSkVDVCBrZXkgbGVuZ3RoIik7Y29uc3Qgcj1uZXcgRGF0YVZpZXcoZS5idWZmZXIsZS5ieXRlT2Zmc2V0K3QsNCkuZ2V0VWludDMyKDAsITApO2lmKHQrPTQsdCtyPmUubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiVW5leHBlY3RlZCBlbmQgb2YgZGF0YSBmb3IgT0JKRUNUIGtleSIpO2NvbnN0IGk9ZS5zbGljZSh0LHQrcik7dCs9cjtzWyhuZXcgVGV4dERlY29kZXIpLmRlY29kZShpKV09bigpfXJldHVybiBzfWRlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKGBVbmtub3duIHR5cGUgYnl0ZTogMHgke3kudG9TdHJpbmcoMTYpfWApfX0oKX1jbGFzcyBie2NvbnN0cnVjdG9yKGUpe2lmKCFlKXRocm93IG5ldyBFcnJvcigiRmlsZVN5c3RlbVN5bmNBY2Nlc3NIYW5kbGUgaXMgcmVxdWlyZWQiKTt0aGlzLnN5bmNBY2Nlc3NIYW5kbGU9ZX0jZShlLHQpe2NvbnN0IG49bmV3IFVpbnQ4QXJyYXkodCkscj10aGlzLnN5bmNBY2Nlc3NIYW5kbGUucmVhZChuLHthdDplfSk7cmV0dXJuIHI8dD9uLnNsaWNlKDAscik6bn1nZXRGaWxlU2l6ZSgpe3JldHVybiB0aGlzLnN5bmNBY2Nlc3NIYW5kbGUuZ2V0U2l6ZSgpfXdyaXRlKGUpe2NvbnN0IHQ9eShlKTt0aGlzLnN5bmNBY2Nlc3NIYW5kbGUudHJ1bmNhdGUoMCksdGhpcy5zeW5jQWNjZXNzSGFuZGxlLndyaXRlKHQse2F0OjB9KX1yZWFkKGU9bmV3IG0oMCkpe2NvbnN0IHQ9dGhpcy5nZXRGaWxlU2l6ZSgpO2lmKDA9PT10KXRocm93IG5ldyBFcnJvcigiRmlsZSBpcyBlbXB0eSIpO2NvbnN0IG49ZS52YWx1ZU9mKCk7aWYobjwwfHxuPj10KXRocm93IG5ldyBFcnJvcihgUG9pbnRlciBvZmZzZXQgJHtlfSBvdXQgb2YgZmlsZSBib3VuZHMgWzAsICR7dH0pYCk7cmV0dXJuIHcodGhpcy4jZShuLHQtbikpfWFwcGVuZChlKXtjb25zdCB0PXkoZSksbj10aGlzLmdldEZpbGVTaXplKCk7dGhpcy5zeW5jQWNjZXNzSGFuZGxlLndyaXRlKHQse2F0Om59KX1mbHVzaCgpe3RoaXMuc3luY0FjY2Vzc0hhbmRsZS5mbHVzaCgpfSpzY2FuKCl7Y29uc3QgZT10aGlzLmdldEZpbGVTaXplKCk7aWYoMD09PWUpcmV0dXJuO2xldCB0PTA7Zm9yKDt0PGU7KXtjb25zdCBlPShlPT57bGV0IHQ9dGhpcy4jZShlLDEpO2NvbnN0IG49dFswXTtzd2l0Y2gobil7Y2FzZSByOmNhc2UgaTpjYXNlIHM6cmV0dXJuIDE7Y2FzZSBvOmNhc2UgYTpjYXNlIHU6Y2FzZSBoOnJldHVybiA5O2Nhc2UgbDpyZXR1cm4gMTM7Y2FzZSBjOnQ9dGhpcy4jZShlKzEsNCk7cmV0dXJuIDUrbmV3IERhdGFWaWV3KHQuYnVmZmVyLHQuYnl0ZU9mZnNldCw0KS5nZXRVaW50MzIoMCwhMCk7Y2FzZSBmOnQ9dGhpcy4jZShlKzEsNCk7cmV0dXJuIDUrbmV3IERhdGFWaWV3KHQuYnVmZmVyLHQuYnl0ZU9mZnNldCw0KS5nZXRVaW50MzIoMCwhMCk7Y2FzZSBkOnQ9dGhpcy4jZShlKzEsNCk7cmV0dXJuIDUrbmV3IERhdGFWaWV3KHQuYnVmZmVyLHQuYnl0ZU9mZnNldCw0KS5nZXRVaW50MzIoMCwhMCk7Y2FzZSBwOnQ9dGhpcy4jZShlKzEsNCk7cmV0dXJuIDUrbmV3IERhdGFWaWV3KHQuYnVmZmVyLHQuYnl0ZU9mZnNldCw0KS5nZXRVaW50MzIoMCwhMCk7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gdHlwZSBieXRlOiAweCR7bi50b1N0cmluZygxNil9YCl9fSkodCksbj10aGlzLiNlKHQsZSk7dCs9ZSx5aWVsZCB3KG4pfX19ZnVuY3Rpb24geChlLHQpe3JldHVybiBlIGluc3RhbmNlb2YgZ3x8dCBpbnN0YW5jZW9mIGc/ZSBpbnN0YW5jZW9mIGcmJnQgaW5zdGFuY2VvZiBnfHxlIGluc3RhbmNlb2YgZyYmInN0cmluZyI9PXR5cGVvZiB0P2UuZXF1YWxzKHQpOnQgaW5zdGFuY2VvZiBnJiYic3RyaW5nIj09dHlwZW9mIGUmJnQuZXF1YWxzKGUpOmU9PXR9ZnVuY3Rpb24gXyhlKXtpZihlIGluc3RhbmNlb2YgZylyZXR1cm4gbmV3IGcoZS5pZCk7dmFyIHQsbixyO2ZvcihyIGluIHQ9QXJyYXkuaXNBcnJheShlKT9bXTp7fSxlKW49ZVtyXSx0W3JdPSJvYmplY3QiPT10eXBlb2YgbiYmbnVsbCE9PW4/XyhuKTpuO3JldHVybiB0fWZ1bmN0aW9uIHYoZSx0KXtmb3IodmFyIG49dC5zcGxpdCgiLiIpLHI9ZVtuWzBdXSxpPTE7aTxuLmxlbmd0aDtpKyspe2lmKG51bGw9PXJ8fG51bGw9PXIpcmV0dXJuIHI7dmFyIHM9bltpXSxvPXBhcnNlSW50KHMsMTApO3I9TihyKSYmIWlzTmFOKG8pJiZvPj0wJiZvPHIubGVuZ3RoP3Jbb106cltzXX1yZXR1cm4gcn1mdW5jdGlvbiAkKGUsdCl7Zm9yKHZhciBuPXQuc3BsaXQoIi4iKSxyPVtlXSxpPTA7aTxuLmxlbmd0aDtpKyspe2Zvcih2YXIgcz1uW2ldLG89cGFyc2VJbnQocywxMCksYT1bXSxjPTA7YzxyLmxlbmd0aDtjKyspe3ZhciBsPXJbY107aWYobnVsbCE9bCYmbnVsbCE9bClpZihOKGwpJiYhaXNOYU4obykmJm8+PTApbzxsLmxlbmd0aCYmYS5wdXNoKGxbb10pO2Vsc2UgaWYoTihsKSlmb3IodmFyIHU9MDt1PGwubGVuZ3RoO3UrKyludWxsIT1sW3VdJiZudWxsIT1sW3VdJiYib2JqZWN0Ij09dHlwZW9mIGxbdV0mJmEucHVzaChsW3VdW3NdKTtlbHNlIm9iamVjdCI9PXR5cGVvZiBsJiZhLnB1c2gobFtzXSl9cj1hfWlmKDAhPT0ocj1yLmZpbHRlcihmdW5jdGlvbihlKXtyZXR1cm4gdm9pZCAwIT09ZX0pKS5sZW5ndGgpcmV0dXJuIDE9PT1yLmxlbmd0aD9yWzBdOnJ9ZnVuY3Rpb24gSShlLHQsbil7aWYoLTEhPT10LmluZGV4T2YoIiRbXSIpKXJldHVybiBmdW5jdGlvbihlLHQsbil7Zm9yKHZhciByPXQuc3BsaXQoIi4iKSxpPWUscz0wO3M8ci5sZW5ndGg7cysrKXt2YXIgbz1yW3NdO2lmKCIkW10iPT09byl7aWYoIUFycmF5LmlzQXJyYXkoaSkpdGhyb3cgbmV3IEVycm9yKCJUaGUgcG9zaXRpb25hbCBvcGVyYXRvciBkaWQgbm90IGZpbmQgdGhlIG1hdGNoIG5lZWRlZCBmcm9tIHRoZSBxdWVyeS4iKTtmb3IodmFyIGE9ci5zbGljZShzKzEpLmpvaW4oIi4iKSxjPTA7YzxpLmxlbmd0aDtjKyspYT9JKGlbY10sYSxuKTppW2NdPW47cmV0dXJufXZhciBsPXBhcnNlSW50KG8sMTApO2lmKE4oaSkmJiFpc05hTihsKSYmbD49MClpPWlbbF07ZWxzZXtpZihudWxsPT1pW29dfHxudWxsPT1pW29dKXt2YXIgdT1zKzE8ci5sZW5ndGg/cltzKzFdOm51bGw7aWYoIiRbXSI9PT11KWlbb109W107ZWxzZXt2YXIgaD1wYXJzZUludCh1LDEwKTshaXNOYU4oaCkmJmg+PTA/aVtvXT1bXTppW29dPXt9fX1pPWlbb119fX0oZSx0LG4pO2Zvcih2YXIgcj10LnNwbGl0KCIuIiksaT1lLHM9MDtzPHIubGVuZ3RoLTE7cysrKXt2YXIgbz1yW3NdLGE9cGFyc2VJbnQobywxMCk7aWYoTihpKSYmIWlzTmFOKGEpJiZhPj0wKXtmb3IoO2kubGVuZ3RoPD1hOylpLnB1c2godm9pZCAwKTtpZihudWxsPT1pW2FdfHxudWxsPT1pW2FdKXt2YXIgYz1yW3MrMV0sbD1wYXJzZUludChjLDEwKTshaXNOYU4obCkmJmw+PTA/aVthXT1bXTppW2FdPXt9fWk9aVthXX1lbHNle2lmKG51bGw9PWlbb118fG51bGw9PWlbb10pe2M9cltzKzFdLGw9cGFyc2VJbnQoYywxMCk7IWlzTmFOKGwpJiZsPj0wP2lbb109W106aVtvXT17fX1pPWlbb119fXZhciB1PXJbci5sZW5ndGgtMV0saD1wYXJzZUludCh1LDEwKTtpZihOKGkpJiYhaXNOYU4oaCkmJmg+PTApe2Zvcig7aS5sZW5ndGg8PWg7KWkucHVzaCh2b2lkIDApO2lbaF09bn1lbHNlIGlbdV09bn1mdW5jdGlvbiBOKGUpe3JldHVybiBBcnJheT09ZS5jb25zdHJ1Y3Rvcn1mdW5jdGlvbiBTKGUpe3ZhciB0PVtdO2Zvcih2YXIgbiBpbiBlKWlmKGUuaGFzT3duUHJvcGVydHkobikpe3ZhciByPXt9O3Jbbl09ZVtuXSx0LnB1c2gocil9cmV0dXJuIHR9ZnVuY3Rpb24gTyhlLHQpe2Zvcih2YXIgbj0wO248dC5sZW5ndGg7bisrKWlmKHgodFtuXSxlKSlyZXR1cm4hMDtyZXR1cm4hMX1mdW5jdGlvbiBBKGUsdCl7aWYoZS5sZW5ndGghPXQubGVuZ3RoKXJldHVybiExO2Zvcih2YXIgbj0wO248ZS5sZW5ndGg7bisrKWlmKCF4KGVbbl0sdFtuXSkpe2lmKHR5cGVvZiBlW25dIT10eXBlb2YgdFtuXSlyZXR1cm4hMTtpZigib2JqZWN0Ij09dHlwZW9mIGVbbl0mJm51bGwhPT1lW25dKXtpZihOKGVbbl0pKXtpZighQShlW25dLHRbbl0pKXJldHVybiExfWVsc2UgaWYoIUMoZVtuXSx0W25dKSlyZXR1cm4hMX1lbHNlIGlmKCF4KGVbbl0sdFtuXSkpcmV0dXJuITF9cmV0dXJuITB9ZnVuY3Rpb24gQyhlLHQpe2Zvcih2YXIgbiBpbiBlKWlmKGUuaGFzT3duUHJvcGVydHkobikpe2lmKCF0Lmhhc093blByb3BlcnR5KG4pKXJldHVybiExO2lmKCF4KGVbbl0sdFtuXSkpe2lmKHR5cGVvZiBlW25dIT10eXBlb2YgdFtuXSlyZXR1cm4hMTtpZigib2JqZWN0Ij09dHlwZW9mIGVbbl0mJm51bGwhPT1lW25dKXtpZihOKGVbbl0pKXtpZighQShlW25dLHRbbl0pKXJldHVybiExfWVsc2UgaWYoIUMoZVtuXSx0W25dKSlyZXR1cm4hMX1lbHNlIGlmKCF4KGVbbl0sdFtuXSkpcmV0dXJuITF9fWZvcih2YXIgbiBpbiB0KWlmKHQuaGFzT3duUHJvcGVydHkobikmJiFlLmhhc093blByb3BlcnR5KG4pKXJldHVybiExO3JldHVybiEwfWZ1bmN0aW9uIEUoZSx0KXt2YXIgbj17fSxyPU9iamVjdC5rZXlzKGUpO2lmKDA9PXIubGVuZ3RoKXJldHVybiB0O2Zvcih2YXIgaT0hMSxzPSExLG89MDtvPHIubGVuZ3RoO28rKykiX2lkIiE9PXJbb10mJihlW3Jbb11dP2k9ITA6cz0hMCk7aWYoaSYmcyl0aHJvd3skZXJyOiJDYW4ndCBjYW5vbmljYWxpemUgcXVlcnk6IEJhZFZhbHVlIFByb2plY3Rpb24gY2Fubm90IGhhdmUgYSBtaXggb2YgaW5jbHVzaW9uIGFuZCBleGNsdXNpb24uIixjb2RlOjE3Mjg3fTtpZihlW3JbMF1dfHxpKXswIT09ZS5faWQmJihuLl9pZD10Ll9pZCk7Zm9yKG89MDtvPHIubGVuZ3RoO28rKylpZigiX2lkIiE9PXJbb10mJmVbcltvXV0pe3ZhciBhPXYodCx1PXJbb10pO3ZvaWQgMCE9PWEmJkkobix1LGEpfX1lbHNle2Zvcih2YXIgYyBpbiB0KWlmKHQuaGFzT3duUHJvcGVydHkoYykpe3ZhciBsPXRbY107Im9iamVjdCIhPXR5cGVvZiBsfHxudWxsPT09bHx8TihsKT9OKGwpP25bY109bC5zbGljZSgpOm5bY109bDpuW2NdPV8obCl9Zm9yKG89MDtvPHIubGVuZ3RoO28rKylpZighZVtyW29dXSl7dmFyIHUsaD0odT1yW29dKS5zcGxpdCgiLiIpO2lmKDE9PT1oLmxlbmd0aClkZWxldGUgblt1XTtlbHNle2Zvcih2YXIgZj1uLGQ9MDtkPGgubGVuZ3RoLTEmJihudWxsIT1mJiZudWxsIT1mKTtkKyspZj1mW2hbZF1dO251bGwhPWYmJm51bGwhPWYmJmRlbGV0ZSBmW2hbaC5sZW5ndGgtMV1dfX19cmV0dXJuIG59Y29uc3Qgaj0yLEQ9OCxrPTE3Mjg3LFA9MjYsTT0yNyxMPTg1LEY9MTFlMyxUPTIsQj0zMTI1NCx6PTk5OTtjbGFzcyBVIGV4dGVuZHMgRXJyb3J7Y29uc3RydWN0b3IoZSx0PXt9KXtzdXBlcihlKSx0aGlzLm5hbWU9Ik1vbmdvRXJyb3IiLHRoaXMuY29kZT10LmNvZGV8fEQsdGhpcy5jb2RlTmFtZT10aGlzLl9nZXRDb2RlTmFtZSh0aGlzLmNvZGUpLHRoaXMuJGVycj1lLHQuY29sbGVjdGlvbiYmKHRoaXMuY29sbGVjdGlvbj10LmNvbGxlY3Rpb24pLHQuZGF0YWJhc2UmJih0aGlzLmRhdGFiYXNlPXQuZGF0YWJhc2UpLHQub3BlcmF0aW9uJiYodGhpcy5vcGVyYXRpb249dC5vcGVyYXRpb24pLHQucXVlcnkmJih0aGlzLnF1ZXJ5PXQucXVlcnkpLHQuZG9jdW1lbnQmJih0aGlzLmRvY3VtZW50PXQuZG9jdW1lbnQpLHQuZmllbGQmJih0aGlzLmZpZWxkPXQuZmllbGQpLHQuaW5kZXgmJih0aGlzLmluZGV4PXQuaW5kZXgpLEVycm9yLmNhcHR1cmVTdGFja1RyYWNlJiZFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLHRoaXMuY29uc3RydWN0b3IpfV9nZXRDb2RlTmFtZShlKXtyZXR1cm57MDoiT0siLDE6IkludGVybmFsRXJyb3IiLDI6IkJhZFZhbHVlIiw0OiJOb1N1Y2hLZXkiLDU6IkdyYXBoQ29udGFpbnNDeWNsZSIsNjoiSG9zdFVucmVhY2hhYmxlIiw3OiJIb3N0Tm90Rm91bmQiLDg6IlVua25vd25FcnJvciIsMTA6IkNhbm5vdE11dGF0ZU9iamVjdCIsMTE6IlVzZXJOb3RGb3VuZCIsMTI6IlVuc3VwcG9ydGVkRm9ybWF0IiwxMzoiVW5hdXRob3JpemVkIiwxNDoiVHlwZU1pc21hdGNoIiwxNToiT3ZlcmZsb3ciLDE2OiJJbnZhbGlkTGVuZ3RoIiwxNzoiUHJvdG9jb2xFcnJvciIsMTg6IkF1dGhlbnRpY2F0aW9uRmFpbGVkIiwyMDoiSWxsZWdhbE9wZXJhdGlvbiIsMjY6Ik5hbWVzcGFjZU5vdEZvdW5kIiwyNzoiSW5kZXhOb3RGb3VuZCIsMjg6IlBhdGhOb3RWaWFibGUiLDQzOiJDdXJzb3JOb3RGb3VuZCIsNDg6Ik5hbWVzcGFjZUV4aXN0cyIsNTk6IkNvbW1hbmROb3RGb3VuZCIsNjc6IkNhbm5vdENyZWF0ZUluZGV4Iiw2ODoiSW5kZXhFeGlzdHMiLDczOiJJbnZhbGlkTmFtZXNwYWNlIiw4NToiSW5kZXhPcHRpb25zQ29uZmxpY3QiLDExMjoiV3JpdGVDb25mbGljdCIsMTIxOiJEb2N1bWVudFZhbGlkYXRpb25GYWlsdXJlIiwxNzE6IkNhbm5vdEluZGV4UGFyYWxsZWxBcnJheXMiLDE5NzoiSW52YWxpZEluZGV4U3BlY2lmaWNhdGlvbk9wdGlvbiIsOTk4OiJPcGVyYXRpb25Ob3RTdXBwb3J0ZWQiLDk5OToiTm90SW1wbGVtZW50ZWQiLDExZTM6IkR1cGxpY2F0ZUtleSIsMTEwMDE6IkR1cGxpY2F0ZUtleVVwZGF0ZSIsMTcyODc6IkZhaWxlZFRvUGFyc2UifVtlXXx8IlVua25vd25FcnJvciJ9dG9KU09OKCl7Y29uc3QgZT17bmFtZTp0aGlzLm5hbWUsbWVzc2FnZTp0aGlzLm1lc3NhZ2UsY29kZTp0aGlzLmNvZGUsY29kZU5hbWU6dGhpcy5jb2RlTmFtZX07cmV0dXJuIHRoaXMuY29sbGVjdGlvbiYmKGUuY29sbGVjdGlvbj10aGlzLmNvbGxlY3Rpb24pLHRoaXMuZGF0YWJhc2UmJihlLmRhdGFiYXNlPXRoaXMuZGF0YWJhc2UpLHRoaXMub3BlcmF0aW9uJiYoZS5vcGVyYXRpb249dGhpcy5vcGVyYXRpb24pLHRoaXMuaW5kZXgmJihlLmluZGV4PXRoaXMuaW5kZXgpLHRoaXMuaW5kZXhOYW1lJiYoZS5pbmRleE5hbWU9dGhpcy5pbmRleE5hbWUpLHRoaXMuZmllbGQmJihlLmZpZWxkPXRoaXMuZmllbGQpLHRoaXMucXVlcnkmJihlLnF1ZXJ5PXRoaXMucXVlcnkpLHRoaXMuZG9jdW1lbnQmJihlLmRvY3VtZW50PXRoaXMuZG9jdW1lbnQpLHRoaXMubmFtZXNwYWNlJiYoZS5uYW1lc3BhY2U9dGhpcy5uYW1lc3BhY2UpLHRoaXMuY3Vyc29ySWQmJihlLmN1cnNvcklkPXRoaXMuY3Vyc29ySWQpLHRoaXMuZmVhdHVyZSYmKGUuZmVhdHVyZT10aGlzLmZlYXR1cmUpLHRoaXMua2V5UGF0dGVybiYmKGUua2V5UGF0dGVybj10aGlzLmtleVBhdHRlcm4pLHRoaXMua2V5VmFsdWUmJihlLmtleVZhbHVlPXRoaXMua2V5VmFsdWUpLHRoaXMud3JpdGVFcnJvcnMmJihlLndyaXRlRXJyb3JzPXRoaXMud3JpdGVFcnJvcnMpLGV9fWNsYXNzIFIgZXh0ZW5kcyBVe2NvbnN0cnVjdG9yKGUsdD17fSl7c3VwZXIoZSx0KSx0aGlzLm5hbWU9IkluZGV4RXJyb3IifX1jbGFzcyBxIGV4dGVuZHMgUntjb25zdHJ1Y3RvcihlLHQ9e30pe3N1cGVyKGBJbmRleCAnJHtlfScgbm90IGZvdW5kYCx7Li4udCxjb2RlOk0saW5kZXg6ZX0pLHRoaXMubmFtZT0iSW5kZXhOb3RGb3VuZEVycm9yIix0aGlzLmluZGV4TmFtZT1lfX1jbGFzcyBWIGV4dGVuZHMgVXtjb25zdHJ1Y3RvcihlLHQ9e30pe3N1cGVyKGUsdCksdGhpcy5uYW1lPSJRdWVyeUVycm9yIix0aGlzLmNvZGU9dC5jb2RlfHxUfX1jbGFzcyBIIGV4dGVuZHMgVXtjb25zdHJ1Y3RvcihlLHQ9e30pe3N1cGVyKGAke2V9IGlzIG5vdCBpbXBsZW1lbnRlZCBpbiBiYWJ5bW9uZ29gLHsuLi50LGNvZGU6en0pLHRoaXMubmFtZT0iTm90SW1wbGVtZW50ZWRFcnJvciIsdGhpcy5mZWF0dXJlPWV9fWNsYXNzIFcgZXh0ZW5kcyBVe2NvbnN0cnVjdG9yKGUsdCxuLHI9e30pe3N1cGVyKGBCYWQgdmFsdWUgZm9yIGZpZWxkICcke2V9JzogJHtufWAsey4uLnIsY29kZTpqLGZpZWxkOmV9KSx0aGlzLm5hbWU9IkJhZFZhbHVlRXJyb3IiLHRoaXMudmFsdWU9dH19Y2xhc3MgUXtjb25zdHJ1Y3RvcihlLHQsbixyLGkpe2lmKHRoaXMuY29sbGVjdGlvbj1lLHRoaXMucXVlcnk9dCx0aGlzLnByb2plY3Rpb249bix0aGlzLl9kb2N1bWVudHNQcm9taXNlPXIgaW5zdGFuY2VvZiBQcm9taXNlP3I6UHJvbWlzZS5yZXNvbHZlKHIpLHRoaXMuZG9jdW1lbnRzPW51bGwsdGhpcy5faW5pdGlhbGl6ZWQ9ITEsdGhpcy5Tb3J0ZWRDdXJzb3I9aSxuJiZPYmplY3Qua2V5cyhuKS5sZW5ndGg+MCl7Y29uc3QgdD1PYmplY3Qua2V5cyhuKTtsZXQgcj0hMSxpPSExO2ZvcihsZXQgZT0wO2U8dC5sZW5ndGg7ZSsrKSJfaWQiIT09dFtlXSYmKG5bdFtlXV0/cj0hMDppPSEwKTtpZihyJiZpKXRocm93IG5ldyBWKCJDYW4ndCBjYW5vbmljYWxpemUgcXVlcnk6IEJhZFZhbHVlIFByb2plY3Rpb24gY2Fubm90IGhhdmUgYSBtaXggb2YgaW5jbHVzaW9uIGFuZCBleGNsdXNpb24uIix7Y29kZTprLGNvbGxlY3Rpb246ZS5uYW1lfSl9dGhpcy5wb3M9MCx0aGlzLl9saW1pdD0wLHRoaXMuX3NraXA9MCx0aGlzLl9jbG9zZWQ9ITF9YXN5bmMgX2Vuc3VyZUluaXRpYWxpemVkKCl7dGhpcy5faW5pdGlhbGl6ZWR8fCh0aGlzLmRvY3VtZW50cz1hd2FpdCB0aGlzLl9kb2N1bWVudHNQcm9taXNlLHRoaXMuX2luaXRpYWxpemVkPSEwKX1iYXRjaFNpemUoZSl7cmV0dXJuIHRoaXMuX2JhdGNoU2l6ZT1lLHRoaXN9Y2xvc2UoKXt0aGlzLl9jbG9zZWQ9ITAsdGhpcy5kb2N1bWVudHMmJih0aGlzLnBvcz10aGlzLmRvY3VtZW50cy5sZW5ndGgpfWNvbW1lbnQoZSl7cmV0dXJuIHRoaXMuX2NvbW1lbnQ9ZSx0aGlzfWFzeW5jIGNvdW50KCl7cmV0dXJuIGF3YWl0IHRoaXMuX2Vuc3VyZUluaXRpYWxpemVkKCksdGhpcy5kb2N1bWVudHMubGVuZ3RofWV4cGxhaW4oZT0icXVlcnlQbGFubmVyIil7cmV0dXJue3F1ZXJ5UGxhbm5lcjp7cGxhbm5lclZlcnNpb246MSxuYW1lc3BhY2U6YCR7dGhpcy5jb2xsZWN0aW9uLmRiPy5uYW1lfHwiZGIifS4ke3RoaXMuY29sbGVjdGlvbi5uYW1lfWAsaW5kZXhGaWx0ZXJTZXQ6ITEscGFyc2VkUXVlcnk6dGhpcy5xdWVyeSx3aW5uaW5nUGxhbjp7c3RhZ2U6IkNPTExTQ0FOIixmaWx0ZXI6dGhpcy5xdWVyeSxkaXJlY3Rpb246ImZvcndhcmQifX0sZXhlY3V0aW9uU3RhdHM6ImV4ZWN1dGlvblN0YXRzIj09PWV8fCJhbGxQbGFuc0V4ZWN1dGlvbiI9PT1lP3tleGVjdXRpb25TdWNjZXNzOiEwLG5SZXR1cm5lZDp0aGlzLmRvY3VtZW50cz90aGlzLmRvY3VtZW50cy5sZW5ndGg6MCxleGVjdXRpb25UaW1lTWlsbGlzOjAsdG90YWxLZXlzRXhhbWluZWQ6MCx0b3RhbERvY3NFeGFtaW5lZDp0aGlzLmRvY3VtZW50cz90aGlzLmRvY3VtZW50cy5sZW5ndGg6MH06dm9pZCAwLG9rOjF9fWFzeW5jIGZvckVhY2goZSl7Zm9yKGF3YWl0IHRoaXMuX2Vuc3VyZUluaXRpYWxpemVkKCk7YXdhaXQgdGhpcy5oYXNOZXh0KCk7KWF3YWl0IGUoYXdhaXQgdGhpcy5uZXh0KCkpfWFzeW5jIGhhc05leHQoKXtpZih0aGlzLl9jbG9zZWQpcmV0dXJuITE7bGV0IGU7cmV0dXJuIGF3YWl0IHRoaXMuX2Vuc3VyZUluaXRpYWxpemVkKCksMD09PXRoaXMucG9zJiZ0aGlzLl9za2lwPjAmJih0aGlzLnBvcz1NYXRoLm1pbih0aGlzLl9za2lwLHRoaXMuZG9jdW1lbnRzLmxlbmd0aCkpLGU9dGhpcy5fbGltaXQ+MD9NYXRoLm1pbih0aGlzLl9za2lwK3RoaXMuX2xpbWl0LHRoaXMuZG9jdW1lbnRzLmxlbmd0aCk6dGhpcy5kb2N1bWVudHMubGVuZ3RoLHRoaXMucG9zPGV9aGludChlKXtyZXR1cm4gdGhpcy5faGludD1lLHRoaXN9YXN5bmMgaXRjb3VudCgpe2F3YWl0IHRoaXMuX2Vuc3VyZUluaXRpYWxpemVkKCk7bGV0IGU9MDtmb3IoO2F3YWl0IHRoaXMuaGFzTmV4dCgpOylhd2FpdCB0aGlzLm5leHQoKSxlKys7cmV0dXJuIGV9bGltaXQoZSl7cmV0dXJuIHRoaXMuX2xpbWl0PWUsdGhpc31hc3luYyBtYXAoZSl7YXdhaXQgdGhpcy5fZW5zdXJlSW5pdGlhbGl6ZWQoKTtjb25zdCB0PVtdO2Zvcig7YXdhaXQgdGhpcy5oYXNOZXh0KCk7KXQucHVzaChhd2FpdCBlKGF3YWl0IHRoaXMubmV4dCgpKSk7cmV0dXJuIHR9bWF4U2NhbihlKXtyZXR1cm4gdGhpcy5fbWF4U2Nhbj1lLHRoaXN9bWF4VGltZU1TKGUpe3JldHVybiB0aGlzLl9tYXhUaW1lTVM9ZSx0aGlzfW1heChlKXtyZXR1cm4gdGhpcy5fbWF4SW5kZXhCb3VuZHM9ZSx0aGlzfW1pbihlKXtyZXR1cm4gdGhpcy5fbWluSW5kZXhCb3VuZHM9ZSx0aGlzfWFzeW5jIG5leHQoKXtpZighKGF3YWl0IHRoaXMuaGFzTmV4dCgpKSl0aHJvdyBuZXcgVigiRXJyb3I6IGVycm9yIGhhc05leHQ6IGZhbHNlIix7Y29sbGVjdGlvbjp0aGlzLmNvbGxlY3Rpb24ubmFtZX0pO2NvbnN0IGU9dGhpcy5kb2N1bWVudHNbdGhpcy5wb3MrK107cmV0dXJuIHRoaXMucHJvamVjdGlvbj9FKHRoaXMucHJvamVjdGlvbixlKTplfW5vQ3Vyc29yVGltZW91dCgpe3JldHVybiB0aGlzLl9ub0N1cnNvclRpbWVvdXQ9ITAsdGhpc31vYmpzTGVmdEluQmF0Y2goKXtyZXR1cm4gdGhpcy5kb2N1bWVudHM/dGhpcy5zaXplKCk6MH1wcmV0dHkoKXtyZXR1cm4gdGhpcy5fcHJldHR5PSEwLHRoaXN9cmVhZENvbmNlcm4oZSl7cmV0dXJuIHRoaXMuX3JlYWRDb25jZXJuPWUsdGhpc31yZWFkUHJlZihlLHQpe3JldHVybiB0aGlzLl9yZWFkUHJlZj17bW9kZTplLHRhZ1NldDp0fSx0aGlzfXJldHVybktleShlPSEwKXtyZXR1cm4gdGhpcy5fcmV0dXJuS2V5PWUsdGhpc31zaG93UmVjb3JkSWQoZT0hMCl7cmV0dXJuIHRoaXMuX3Nob3dSZWNvcmRJZD1lLHRoaXN9c2l6ZSgpe2lmKCF0aGlzLmRvY3VtZW50cylyZXR1cm4gMDtjb25zdCBlPXRoaXMuZG9jdW1lbnRzLmxlbmd0aC10aGlzLnBvcztpZih0aGlzLl9saW1pdD4wKXtjb25zdCB0PXRoaXMuX3NraXArdGhpcy5fbGltaXQ7cmV0dXJuIE1hdGgubWluKHQtdGhpcy5wb3MsZSl9cmV0dXJuIGV9c2tpcChlKXtyZXR1cm4gdGhpcy5fc2tpcD1lLDA9PT10aGlzLnBvcyYmdGhpcy5kb2N1bWVudHMmJih0aGlzLnBvcz1NYXRoLm1pbihlLHRoaXMuZG9jdW1lbnRzLmxlbmd0aCkpLHRoaXN9aXNDbG9zZWQoKXtyZXR1cm4hMD09PXRoaXMuX2Nsb3NlZH1zbmFwc2hvdCgpe3Rocm93IG5ldyBIKCJzbmFwc2hvdCIpfXNvcnQoZSl7cmV0dXJuIG5ldyB0aGlzLlNvcnRlZEN1cnNvcih0aGlzLmNvbGxlY3Rpb24sdGhpcy5xdWVyeSx0aGlzLGUpfWFsbG93RGlza1VzZShlPSEwKXtyZXR1cm4gdGhpcy5fYWxsb3dEaXNrVXNlPWUsdGhpc31jb2xsYXRpb24oZSl7cmV0dXJuIHRoaXMuX2NvbGxhdGlvbj1lLHRoaXN9dGFpbGFibGUoKXt0aHJvdyBuZXcgSCgidGFpbGFibGUiKX1hc3luYyB0b0FycmF5KCl7YXdhaXQgdGhpcy5fZW5zdXJlSW5pdGlhbGl6ZWQoKTtjb25zdCBlPVtdO2Zvcig7YXdhaXQgdGhpcy5oYXNOZXh0KCk7KWUucHVzaChhd2FpdCB0aGlzLm5leHQoKSk7cmV0dXJuIGV9YXN5bmMqW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSgpe2Zvcihhd2FpdCB0aGlzLl9lbnN1cmVJbml0aWFsaXplZCgpO2F3YWl0IHRoaXMuaGFzTmV4dCgpOyl5aWVsZCBhd2FpdCB0aGlzLm5leHQoKX19Y2xhc3MgSntjb25zdHJ1Y3RvcihlLHQsbixyKXt0aGlzLmNvbGxlY3Rpb249ZSx0aGlzLnF1ZXJ5PXQsdGhpcy5zb3J0U3BlYz1yLHRoaXMucG9zPTAsdGhpcy5fY3Vyc29yPW4sdGhpcy5fc29ydD1yLHRoaXMuX2luaXRpYWxpemVkPSExLHRoaXMuaXRlbXM9bnVsbH1hc3luYyBfZW5zdXJlSW5pdGlhbGl6ZWQoKXtpZih0aGlzLl9pbml0aWFsaXplZClyZXR1cm47Zm9yKGF3YWl0IHRoaXMuX2N1cnNvci5fZW5zdXJlSW5pdGlhbGl6ZWQoKSx0aGlzLml0ZW1zPVtdO2F3YWl0IHRoaXMuX2N1cnNvci5oYXNOZXh0KCk7KXRoaXMuaXRlbXMucHVzaChhd2FpdCB0aGlzLl9jdXJzb3IubmV4dCgpKTtjb25zdCBlPU9iamVjdC5rZXlzKHRoaXMuX3NvcnQpO3RoaXMuaXRlbXMuc29ydChmdW5jdGlvbih0LG4pe2ZvcihsZXQgcj0wO3I8ZS5sZW5ndGg7cisrKXtpZihudWxsPT10W2Vbcl1dJiZudWxsIT1uW2Vbcl1dKXJldHVybi0xKnRoaXMuX3NvcnRbZVtyXV07aWYobnVsbCE9dFtlW3JdXSYmbnVsbD09bltlW3JdXSlyZXR1cm4gMSp0aGlzLl9zb3J0W2Vbcl1dO2lmKHRbZVtyXV08bltlW3JdXSlyZXR1cm4tMSp0aGlzLl9zb3J0W2Vbcl1dO2lmKHRbZVtyXV0+bltlW3JdXSlyZXR1cm4gMSp0aGlzLl9zb3J0W2Vbcl1dfXJldHVybiAwfS5iaW5kKHRoaXMpKSx0aGlzLl9pbml0aWFsaXplZD0hMH1iYXRjaFNpemUoKXt0aHJvdyJOb3QgSW1wbGVtZW50ZWQifWNsb3NlKCl7dGhyb3ciTm90IEltcGxlbWVudGVkIn1jb21tZW50KCl7dGhyb3ciTm90IEltcGxlbWVudGVkIn1hc3luYyBjb3VudCgpe3JldHVybiBhd2FpdCB0aGlzLl9lbnN1cmVJbml0aWFsaXplZCgpLHRoaXMuaXRlbXMubGVuZ3RofWV4cGxhaW4oKXt0aHJvdyJOb3QgSW1wbGVtZW50ZWQifWFzeW5jIGZvckVhY2goZSl7Zm9yKGF3YWl0IHRoaXMuX2Vuc3VyZUluaXRpYWxpemVkKCk7YXdhaXQgdGhpcy5oYXNOZXh0KCk7KWF3YWl0IGUoYXdhaXQgdGhpcy5uZXh0KCkpfWFzeW5jIGhhc05leHQoKXtyZXR1cm4gYXdhaXQgdGhpcy5fZW5zdXJlSW5pdGlhbGl6ZWQoKSx0aGlzLnBvczx0aGlzLml0ZW1zLmxlbmd0aH1oaW50KCl7dGhyb3ciTm90IEltcGxlbWVudGVkIn1pdGNvdW50KCl7dGhyb3ciTm90IEltcGxlbWVudGVkIn1hc3luYyBsaW1pdChlKXtyZXR1cm4gYXdhaXQgdGhpcy5fZW5zdXJlSW5pdGlhbGl6ZWQoKSx0aGlzLml0ZW1zPXRoaXMuaXRlbXMuc2xpY2UoMCxlKSx0aGlzfWFzeW5jIG1hcChlKXthd2FpdCB0aGlzLl9lbnN1cmVJbml0aWFsaXplZCgpO2NvbnN0IHQ9W107Zm9yKDthd2FpdCB0aGlzLmhhc05leHQoKTspdC5wdXNoKGF3YWl0IGUoYXdhaXQgdGhpcy5uZXh0KCkpKTtyZXR1cm4gdH1tYXhTY2FuKCl7dGhyb3ciTm90IEltcGxlbWVudGVkIn1tYXhUaW1lTVMoKXt0aHJvdyJOb3QgSW1wbGVtZW50ZWQifW1heCgpe3Rocm93Ik5vdCBJbXBsZW1lbnRlZCJ9bWluKCl7dGhyb3ciTm90IEltcGxlbWVudGVkIn1hc3luYyBuZXh0KCl7cmV0dXJuIGF3YWl0IHRoaXMuX2Vuc3VyZUluaXRpYWxpemVkKCksdGhpcy5pdGVtc1t0aGlzLnBvcysrXX1ub0N1cnNvclRpbWVvdXQoKXt0aHJvdyJOb3QgSW1wbGVtZW50ZWQifW9ianNMZWZ0SW5CYXRjaCgpe3Rocm93Ik5vdCBJbXBsZW1lbnRlZCJ9cHJldHR5KCl7dGhyb3ciTm90IEltcGxlbWVudGVkIn1yZWFkQ29uY2Vybigpe3Rocm93Ik5vdCBJbXBsZW1lbnRlZCJ9cmVhZFByZWYoKXt0aHJvdyJOb3QgSW1wbGVtZW50ZWQifXJldHVybktleSgpe3Rocm93Ik5vdCBJbXBsZW1lbnRlZCJ9c2hvd1JlY29yZElkKCl7dGhyb3ciTm90IEltcGxlbWVudGVkIn1zaXplKCl7dGhyb3ciTm90IEltcGxlbWVudGVkIn1hc3luYyBza2lwKGUpe2Zvcihhd2FpdCB0aGlzLl9lbnN1cmVJbml0aWFsaXplZCgpO2U+MDspYXdhaXQgdGhpcy5uZXh0KCksZS0tO3JldHVybiB0aGlzfXNuYXBzaG90KCl7dGhyb3ciTm90IEltcGxlbWVudGVkIn1zb3J0KGUpe3JldHVybiBuZXcgSih0aGlzLmNvbGxlY3Rpb24sdGhpcy5xdWVyeSx0aGlzLGUpfXRhaWxhYmxlKCl7dGhyb3ciTm90IEltcGxlbWVudGVkIn1hc3luYyB0b0FycmF5KCl7YXdhaXQgdGhpcy5fZW5zdXJlSW5pdGlhbGl6ZWQoKTtjb25zdCBlPVtdO2Zvcig7YXdhaXQgdGhpcy5oYXNOZXh0KCk7KWUucHVzaCh0aGlzLm5leHQoKSk7cmV0dXJuIGV9YXN5bmMqW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSgpe2Zvcihhd2FpdCB0aGlzLl9lbnN1cmVJbml0aWFsaXplZCgpO2F3YWl0IHRoaXMuaGFzTmV4dCgpOyl5aWVsZCBhd2FpdCB0aGlzLm5leHQoKX19Y29uc3QgSz17YXRpb25hbDoiYXRlIix0aW9uYWw6InRpb24iLGVuY2k6ImVuY2UiLGFuY2k6ImFuY2UiLGl6ZXI6Iml6ZSIsYmxpOiJibGUiLGFsbGk6ImFsIixlbnRsaToiZW50IixlbGk6ImUiLG91c2xpOiJvdXMiLGl6YXRpb246Iml6ZSIsYXRpb246ImF0ZSIsYXRvcjoiYXRlIixhbGlzbToiYWwiLGl2ZW5lc3M6Iml2ZSIsZnVsbmVzczoiZnVsIixvdXNuZXNzOiJvdXMiLGFsaXRpOiJhbCIsaXZpdGk6Iml2ZSIsYmlsaXRpOiJibGUiLGxvZ2k6ImxvZyJ9LEc9e2ljYXRlOiJpYyIsYXRpdmU6IiIsYWxpemU6ImFsIixpY2l0aToiaWMiLGljYWw6ImljIixmdWw6IiIsbmVzczoiIn0sWT0iW2FlaW91eV0iLFg9IihbXmFlaW91XVteYWVpb3V5XSopIixaPSIoIitZKyJbYWVpb3VdKikiLGVlPW5ldyBSZWdFeHAoIl4iK1grIj8iK1orWCksdGU9bmV3IFJlZ0V4cCgiXiIrWCsiPyIrWitYK1orIj8kIiksbmU9bmV3IFJlZ0V4cCgiXiIrWCsiPygiK1orWCsiKXsyLH0iKSxyZT1uZXcgUmVnRXhwKCJeIitYKyI/IitZKSxpZT1uZXcgUmVnRXhwKCJeIitYK1krIlteYWVpb3V3eHldJCIpLHNlPS9sbCQvLG9lPS9eKC4rPyllJC8sYWU9L14oLis/KXkkLyxjZT0vXiguKz8oc3x0KSkoaW9uKSQvLGxlPS9eKC4rPykoZWR8aW5nKSQvLHVlPS8oYXR8Ymx8aXopJC8saGU9L14oLis/KWVlZCQvLGZlPS9eLis/W15zXXMkLyxkZT0vXi4rPyhzc3xpKWVzJC8scGU9LyhbXmFlaW91eWxzel0pXDEkLyxnZT0vXiguKz8pKGF0aW9uYWx8dGlvbmFsfGVuY2l8YW5jaXxpemVyfGJsaXxhbGxpfGVudGxpfGVsaXxvdXNsaXxpemF0aW9ufGF0aW9ufGF0b3J8YWxpc218aXZlbmVzc3xmdWxuZXNzfG91c25lc3N8YWxpdGl8aXZpdGl8YmlsaXRpfGxvZ2kpJC8sbWU9L14oLis/KShpY2F0ZXxhdGl2ZXxhbGl6ZXxpY2l0aXxpY2FsfGZ1bHxuZXNzKSQvLHllPS9eKC4rPykoYWx8YW5jZXxlbmNlfGVyfGljfGFibGV8aWJsZXxhbnR8ZW1lbnR8bWVudHxlbnR8b3V8aXNtfGF0ZXxpdGl8b3VzfGl2ZXxpemUpJC87ZnVuY3Rpb24gd2UoZSl7bGV0IHQ9U3RyaW5nKGUpLnRvTG93ZXJDYXNlKCk7aWYodC5sZW5ndGg8MylyZXR1cm4gdDtsZXQgbixyPSExO3JldHVybiAxMjE9PT10LmNvZGVQb2ludEF0KDApJiYocj0hMCx0PSJZIit0LnNsaWNlKDEpKSxkZS50ZXN0KHQpP3Q9dC5zbGljZSgwLC0yKTpmZS50ZXN0KHQpJiYodD10LnNsaWNlKDAsLTEpKSwobj1oZS5leGVjKHQpKT9lZS50ZXN0KG5bMV0pJiYodD10LnNsaWNlKDAsLTEpKToobj1sZS5leGVjKHQpKSYmcmUudGVzdChuWzFdKSYmKHQ9blsxXSx1ZS50ZXN0KHQpP3QrPSJlIjpwZS50ZXN0KHQpP3Q9dC5zbGljZSgwLC0xKTppZS50ZXN0KHQpJiYodCs9ImUiKSksKG49YWUuZXhlYyh0KSkmJnJlLnRlc3QoblsxXSkmJih0PW5bMV0rImkiKSwobj1nZS5leGVjKHQpKSYmZWUudGVzdChuWzFdKSYmKHQ9blsxXStLW25bMl1dKSwobj1tZS5leGVjKHQpKSYmZWUudGVzdChuWzFdKSYmKHQ9blsxXStHW25bMl1dKSwobj15ZS5leGVjKHQpKT9uZS50ZXN0KG5bMV0pJiYodD1uWzFdKToobj1jZS5leGVjKHQpKSYmbmUudGVzdChuWzFdKSYmKHQ9blsxXSksKG49b2UuZXhlYyh0KSkmJihuZS50ZXN0KG5bMV0pfHx0ZS50ZXN0KG5bMV0pJiYhaWUudGVzdChuWzFdKSkmJih0PW5bMV0pLHNlLnRlc3QodCkmJm5lLnRlc3QodCkmJih0PXQuc2xpY2UoMCwtMSkpLHImJih0PSJ5Iit0LnNsaWNlKDEpKSx0fWNsYXNzIGJle2NvbnN0cnVjdG9yKGUsdCxuLHIsaSxzKXt0aGlzLmlkPWUsdGhpcy5pc0xlYWY9dCx0aGlzLmtleXM9bix0aGlzLnZhbHVlcz1yLHRoaXMuY2hpbGRyZW49aTtmb3IobGV0IG8gb2YgaSlpZighKG8gaW5zdGFuY2VvZiBtKSl0aHJvdyBuZXcgRXJyb3IoIkNoaWxkcmVuIG11c3QgYmUgUG9pbnRlciBvYmplY3RzIik7dGhpcy5uZXh0PXN9fWNsYXNzIHhle2NvbnN0cnVjdG9yKGUsdD0zKXtpZih0PDMpdGhyb3cgbmV3IEVycm9yKCJCKyB0cmVlIG9yZGVyIG11c3QgYmUgYXQgbGVhc3QgMyIpO3RoaXMuZmlsZT1uZXcgYihlKSx0aGlzLm9yZGVyPXQsdGhpcy5taW5LZXlzPU1hdGguY2VpbCh0LzIpLTEsdGhpcy5pc09wZW49ITEsdGhpcy5yb290UG9pbnRlcj1udWxsLHRoaXMubmV4dE5vZGVJZD0wLHRoaXMuX3NpemU9MH1hc3luYyBvcGVuKCl7aWYodGhpcy5pc09wZW4pdGhyb3cgbmV3IEVycm9yKCJUcmVlIGlzIGFscmVhZHkgb3BlbiIpO3RoaXMuZmlsZS5nZXRGaWxlU2l6ZSgpPjA/dGhpcy5fbG9hZE1ldGFkYXRhKCk6dGhpcy5faW5pdGlhbGl6ZU5ld1RyZWUoKSx0aGlzLmlzT3Blbj0hMH1hc3luYyBjbG9zZSgpe3RoaXMuaXNPcGVuJiYodGhpcy5maWxlJiZ0aGlzLmZpbGUuc3luY0FjY2Vzc0hhbmRsZSYmKHRoaXMuZmlsZS5mbHVzaCgpLGF3YWl0IHRoaXMuZmlsZS5zeW5jQWNjZXNzSGFuZGxlLmNsb3NlKCkpLHRoaXMuaXNPcGVuPSExKX1faW5pdGlhbGl6ZU5ld1RyZWUoKXtjb25zdCBlPW5ldyBiZSgwLCEwLFtdLFtdLFtdLG51bGwpO3RoaXMubmV4dE5vZGVJZD0xLHRoaXMuX3NpemU9MDtjb25zdCB0PXRoaXMuX3NhdmVOb2RlKGUpO3RoaXMucm9vdFBvaW50ZXI9dCx0aGlzLl9zYXZlTWV0YWRhdGEoKX1fc2F2ZU1ldGFkYXRhKCl7Y29uc3QgZT17dmVyc2lvbjoxLG1heEVudHJpZXM6dGhpcy5vcmRlcixtaW5FbnRyaWVzOnRoaXMubWluS2V5cyxzaXplOnRoaXMuX3NpemUscm9vdFBvaW50ZXI6dGhpcy5yb290UG9pbnRlcixuZXh0SWQ6dGhpcy5uZXh0Tm9kZUlkfTt0aGlzLmZpbGUuYXBwZW5kKGUpfV9sb2FkTWV0YWRhdGEoKXtjb25zdCBlPXRoaXMuZmlsZS5nZXRGaWxlU2l6ZSgpO2lmKGU8MTM1KXRocm93IG5ldyBFcnJvcigiSW52YWxpZCB0cmVlIGZpbGUiKTtjb25zdCB0PWUtMTM1LG49dGhpcy5maWxlLnJlYWQodCk7aWYoIW58fHZvaWQgMD09PW4ubWF4RW50cmllcyl0aHJvdyBuZXcgRXJyb3IoIkZhaWxlZCB0byByZWFkIG1ldGFkYXRhOiBtaXNzaW5nIHJlcXVpcmVkIGZpZWxkcyIpO3RoaXMub3JkZXI9bi5tYXhFbnRyaWVzLHRoaXMubWluS2V5cz1uLm1pbkVudHJpZXMsdGhpcy5fc2l6ZT1uLnNpemUsdGhpcy5uZXh0Tm9kZUlkPW4ubmV4dElkLHRoaXMucm9vdFBvaW50ZXI9bi5yb290UG9pbnRlcn1fc2F2ZU5vZGUoZSl7Y29uc3QgdD10aGlzLmZpbGUuZ2V0RmlsZVNpemUoKTtyZXR1cm4gdGhpcy5maWxlLmFwcGVuZChlKSxuZXcgbSh0KX1fbG9hZE5vZGUoZSl7aWYoIShlIGluc3RhbmNlb2YgbSkpdGhyb3cgbmV3IEVycm9yKCJFeHBlY3RlZCBQb2ludGVyIG9iamVjdCIpO2NvbnN0IHQ9dGhpcy5maWxlLnJlYWQoZSk7cmV0dXJuIG5ldyBiZSh0LmlkLHQuaXNMZWFmLHQua2V5cyx0LnZhbHVlcyx0LmNoaWxkcmVuLHQubmV4dCl9X2xvYWRSb290KCl7cmV0dXJuIHRoaXMuX2xvYWROb2RlKHRoaXMucm9vdFBvaW50ZXIpfXNlYXJjaChlKXtjb25zdCB0PXRoaXMuX2xvYWRSb290KCk7cmV0dXJuIHRoaXMuX3NlYXJjaE5vZGUodCxlKX1fc2VhcmNoTm9kZShlLHQpe2lmKCFlLmlzTGVhZil7bGV0IG49MDtmb3IoO248ZS5rZXlzLmxlbmd0aCYmdD49ZS5rZXlzW25dOyluKys7Y29uc3Qgcj10aGlzLl9sb2FkTm9kZShlLmNoaWxkcmVuW25dKTtyZXR1cm4gdGhpcy5fc2VhcmNoTm9kZShyLHQpfWZvcihsZXQgbj0wO248ZS5rZXlzLmxlbmd0aDtuKyspaWYodD09PWUua2V5c1tuXSlyZXR1cm4gZS52YWx1ZXNbbl19YWRkKGUsdCl7Y29uc3Qgbj10aGlzLl9sb2FkUm9vdCgpLHI9dGhpcy5fYWRkVG9Ob2RlKG4sZSx0KTtsZXQgaTtpZihyLm5ld05vZGUpaT1yLm5ld05vZGU7ZWxzZXtjb25zdCBlPXRoaXMuX3NhdmVOb2RlKHIubGVmdCksdD10aGlzLl9zYXZlTm9kZShyLnJpZ2h0KTtpPW5ldyBiZSh0aGlzLm5leHROb2RlSWQrKywhMSxbci5zcGxpdEtleV0sW10sW2UsdF0sbnVsbCl9Y29uc3Qgcz10aGlzLl9zYXZlTm9kZShpKTt0aGlzLnJvb3RQb2ludGVyPXMsdGhpcy5fc2l6ZSsrLHRoaXMuX3NhdmVNZXRhZGF0YSgpfV9hZGRUb05vZGUoZSx0LG4pe2lmKGUuaXNMZWFmKXtjb25zdCByPVsuLi5lLmtleXNdLGk9Wy4uLmUudmFsdWVzXSxzPXIuaW5kZXhPZih0KTtpZigtMSE9PXMpcmV0dXJuIGlbc109bix7bmV3Tm9kZTpuZXcgYmUoZS5pZCwhMCxyLGksW10sbnVsbCl9O2xldCBvPTA7Zm9yKDtvPHIubGVuZ3RoJiZ0PnJbb107KW8rKztpZihyLnNwbGljZShvLDAsdCksaS5zcGxpY2UobywwLG4pLHIubGVuZ3RoPHRoaXMub3JkZXIpcmV0dXJue25ld05vZGU6bmV3IGJlKGUuaWQsITAscixpLFtdLG51bGwpfTt7Y29uc3QgdD1NYXRoLmNlaWwoci5sZW5ndGgvMiksbj1yLnNsaWNlKDAsdCkscz1pLnNsaWNlKDAsdCksbz1yLnNsaWNlKHQpLGE9aS5zbGljZSh0KSxjPW5ldyBiZSh0aGlzLm5leHROb2RlSWQrKywhMCxvLGEsW10sbnVsbCk7cmV0dXJue2xlZnQ6bmV3IGJlKGUuaWQsITAsbixzLFtdLG51bGwpLHJpZ2h0OmMsc3BsaXRLZXk6b1swXX19fXtjb25zdCByPVsuLi5lLmtleXNdLGk9Wy4uLmUuY2hpbGRyZW5dO2xldCBzPTA7Zm9yKDtzPHIubGVuZ3RoJiZ0Pj1yW3NdOylzKys7Y29uc3Qgbz10aGlzLl9sb2FkTm9kZShpW3NdKSxhPXRoaXMuX2FkZFRvTm9kZShvLHQsbik7aWYoYS5uZXdOb2RlKXtjb25zdCB0PXRoaXMuX3NhdmVOb2RlKGEubmV3Tm9kZSk7cmV0dXJuIGlbc109dCx7bmV3Tm9kZTpuZXcgYmUoZS5pZCwhMSxyLFtdLGksbnVsbCl9fXtjb25zdCB0PXRoaXMuX3NhdmVOb2RlKGEubGVmdCksbj10aGlzLl9zYXZlTm9kZShhLnJpZ2h0KTtpZihyLnNwbGljZShzLDAsYS5zcGxpdEtleSksaS5zcGxpY2UocywxLHQsbiksci5sZW5ndGg8dGhpcy5vcmRlcilyZXR1cm57bmV3Tm9kZTpuZXcgYmUoZS5pZCwhMSxyLFtdLGksbnVsbCl9O3tjb25zdCB0PU1hdGguY2VpbChyLmxlbmd0aC8yKS0xLG49clt0XSxzPXIuc2xpY2UoMCx0KSxvPXIuc2xpY2UodCsxKSxhPWkuc2xpY2UoMCx0KzEpLGM9aS5zbGljZSh0KzEpO3JldHVybntsZWZ0Om5ldyBiZShlLmlkLCExLHMsW10sYSxudWxsKSxyaWdodDpuZXcgYmUodGhpcy5uZXh0Tm9kZUlkKyssITEsbyxbXSxjLG51bGwpLHNwbGl0S2V5Om59fX19fWRlbGV0ZShlKXtjb25zdCB0PXRoaXMuX2xvYWRSb290KCksbj10aGlzLl9kZWxldGVGcm9tTm9kZSh0LGUpO2lmKCFuKXJldHVybjtsZXQgcj1uOzA9PT1yLmtleXMubGVuZ3RoJiYhci5pc0xlYWYmJnIuY2hpbGRyZW4ubGVuZ3RoPjAmJihyPXRoaXMuX2xvYWROb2RlKHIuY2hpbGRyZW5bMF0pKTtjb25zdCBpPXRoaXMuX3NhdmVOb2RlKHIpO3RoaXMucm9vdFBvaW50ZXI9aSx0aGlzLl9zaXplLS0sdGhpcy5fc2F2ZU1ldGFkYXRhKCl9X2RlbGV0ZUZyb21Ob2RlKGUsdCl7aWYoZS5pc0xlYWYpe2NvbnN0IG49ZS5rZXlzLmluZGV4T2YodCk7aWYoLTE9PT1uKXJldHVybiBudWxsO2NvbnN0IHI9Wy4uLmUua2V5c10saT1bLi4uZS52YWx1ZXNdO3JldHVybiByLnNwbGljZShuLDEpLGkuc3BsaWNlKG4sMSksbmV3IGJlKGUuaWQsITAscixpLFtdLGUubmV4dCl9e2xldCBuPTA7Zm9yKDtuPGUua2V5cy5sZW5ndGgmJnQ+PWUua2V5c1tuXTspbisrO2NvbnN0IHI9dGhpcy5fbG9hZE5vZGUoZS5jaGlsZHJlbltuXSksaT10aGlzLl9kZWxldGVGcm9tTm9kZShyLHQpO2lmKCFpKXJldHVybiBudWxsO2NvbnN0IHM9Wy4uLmUuY2hpbGRyZW5dLG89dGhpcy5fc2F2ZU5vZGUoaSk7cmV0dXJuIHNbbl09byxuZXcgYmUoZS5pZCwhMSxbLi4uZS5rZXlzXSxbXSxzLG51bGwpfX10b0FycmF5KCl7Y29uc3QgZT1bXTtyZXR1cm4gdGhpcy5fY29sbGVjdEFsbEVudHJpZXModGhpcy5fbG9hZFJvb3QoKSxlKSxlfWFzeW5jKltTeW1ib2wuYXN5bmNJdGVyYXRvcl0oKXtpZighdGhpcy5pc09wZW4pdGhyb3cgbmV3IEVycm9yKCJUcmVlIG11c3QgYmUgb3BlbiBiZWZvcmUgaXRlcmF0aW9uIik7MCE9PXRoaXMuX3NpemUmJih5aWVsZCp0aGlzLl9pdGVyYXRlTm9kZSh0aGlzLl9sb2FkUm9vdCgpKSl9Kl9pdGVyYXRlTm9kZShlKXtpZihlLmlzTGVhZilmb3IobGV0IHQ9MDt0PGUua2V5cy5sZW5ndGg7dCsrKXlpZWxke2tleTplLmtleXNbdF0sdmFsdWU6ZS52YWx1ZXNbdF19O2Vsc2UgZm9yKGNvbnN0IHQgb2YgZS5jaGlsZHJlbil7Y29uc3QgZT10aGlzLl9sb2FkTm9kZSh0KTt5aWVsZCp0aGlzLl9pdGVyYXRlTm9kZShlKX19X2NvbGxlY3RBbGxFbnRyaWVzKGUsdCl7aWYoZS5pc0xlYWYpZm9yKGxldCBuPTA7bjxlLmtleXMubGVuZ3RoO24rKyl0LnB1c2goe2tleTplLmtleXNbbl0sdmFsdWU6ZS52YWx1ZXNbbl19KTtlbHNlIGZvcihjb25zdCBuIG9mIGUuY2hpbGRyZW4pe2NvbnN0IGU9dGhpcy5fbG9hZE5vZGUobik7dGhpcy5fY29sbGVjdEFsbEVudHJpZXMoZSx0KX19c2l6ZSgpe3JldHVybiB0aGlzLl9zaXplfWlzRW1wdHkoKXtyZXR1cm4gMD09PXRoaXMuX3NpemV9cmFuZ2VTZWFyY2goZSx0KXtjb25zdCBuPVtdO3JldHVybiB0aGlzLl9yYW5nZVNlYXJjaE5vZGUodGhpcy5fbG9hZFJvb3QoKSxlLHQsbiksbn1fcmFuZ2VTZWFyY2hOb2RlKGUsdCxuLHIpe2lmKGUuaXNMZWFmKWZvcihsZXQgaT0wO2k8ZS5rZXlzLmxlbmd0aDtpKyspZS5rZXlzW2ldPj10JiZlLmtleXNbaV08PW4mJnIucHVzaCh7a2V5OmUua2V5c1tpXSx2YWx1ZTplLnZhbHVlc1tpXX0pO2Vsc2UgZm9yKGNvbnN0IGkgb2YgZS5jaGlsZHJlbil7Y29uc3QgZT10aGlzLl9sb2FkTm9kZShpKTt0aGlzLl9yYW5nZVNlYXJjaE5vZGUoZSx0LG4scil9fWdldEhlaWdodCgpe2xldCBlPTAsdD10aGlzLl9sb2FkUm9vdCgpO2Zvcig7IXQuaXNMZWFmOyllKyssdD10aGlzLl9sb2FkTm9kZSh0LmNoaWxkcmVuWzBdKTtyZXR1cm4gZX1hc3luYyBjb21wYWN0KGUpe2lmKCF0aGlzLmlzT3Blbil0aHJvdyBuZXcgRXJyb3IoIlRyZWUgZmlsZSBpcyBub3Qgb3BlbiIpO2lmKCFlKXRocm93IG5ldyBFcnJvcigiRGVzdGluYXRpb24gc3luYyBoYW5kbGUgaXMgcmVxdWlyZWQgZm9yIGNvbXBhY3Rpb24iKTtjb25zdCB0PXRoaXMuZmlsZS5nZXRGaWxlU2l6ZSgpLG49dGhpcy50b0FycmF5KCkscj1uZXcgeGUoZSx0aGlzLm9yZGVyKTthd2FpdCByLm9wZW4oKTtmb3IoY29uc3QgcyBvZiBuKWF3YWl0IHIuYWRkKHMua2V5LHMudmFsdWUpO2NvbnN0IGk9ci5maWxlLmdldEZpbGVTaXplKCk7cmV0dXJuIGF3YWl0IHIuY2xvc2UoKSx7b2xkU2l6ZTp0LG5ld1NpemU6aSxieXRlc1NhdmVkOk1hdGgubWF4KDAsdC1pKX19fWNvbnN0IF9lPS8qIEBfX1BVUkVfXyAqL25ldyBTZXQoWyJhIiwiYWJvdXQiLCJhZnRlciIsImFsbCIsImFsc28iLCJhbSIsImFuIiwiYW5kIiwiYW5vdGhlciIsImFueSIsImFyZSIsImFyb3VuZCIsImFzIiwiYXQiLCJiZSIsImJlY2F1c2UiLCJiZWVuIiwiYmVmb3JlIiwiYmVpbmciLCJiZXR3ZWVuIiwiYm90aCIsImJ1dCIsImJ5IiwiY2FtZSIsImNhbiIsImNvbWUiLCJjb3VsZCIsImRpZCIsImRvIiwiZWFjaCIsImZvciIsImZyb20iLCJnZXQiLCJnb3QiLCJoYXMiLCJoYWQiLCJoZSIsImhhdmUiLCJoZXIiLCJoZXJlIiwiaGltIiwiaGltc2VsZiIsImhpcyIsImhvdyIsImkiLCJpZiIsImluIiwiaW50byIsImlzIiwiaXQiLCJsaWtlIiwibWFrZSIsIm1hbnkiLCJtZSIsIm1pZ2h0IiwibW9yZSIsIm1vc3QiLCJtdWNoIiwibXVzdCIsIm15IiwibmV2ZXIiLCJub3ciLCJvZiIsIm9uIiwib25seSIsIm9yIiwib3RoZXIiLCJvdXIiLCJvdXQiLCJvdmVyIiwic2FpZCIsInNhbWUiLCJzZWUiLCJzaG91bGQiLCJzaW5jZSIsInNvbWUiLCJzdGlsbCIsInN1Y2giLCJ0YWtlIiwidGhhbiIsInRoYXQiLCJ0aGUiLCJ0aGVpciIsInRoZW0iLCJ0aGVuIiwidGhlcmUiLCJ0aGVzZSIsInRoZXkiLCJ0aGlzIiwidGhvc2UiLCJ0aHJvdWdoIiwidG8iLCJ0b28iLCJ1bmRlciIsInVwIiwidmVyeSIsIndhcyIsIndheSIsIndlIiwid2VsbCIsIndlcmUiLCJ3aGF0Iiwid2hlcmUiLCJ3aGljaCIsIndoaWxlIiwid2hvIiwid2l0aCIsIndvdWxkIiwieW91IiwieW91ciJdKTtmdW5jdGlvbiB2ZShlKXtpZigic3RyaW5nIiE9dHlwZW9mIGUpcmV0dXJuW107cmV0dXJuIGUudG9Mb3dlckNhc2UoKS5zcGxpdCgvXFcrLykuZmlsdGVyKGU9PmUubGVuZ3RoPjApLmZpbHRlcihlPT4hX2UuaGFzKGUpKX1jbGFzcyAkZXtjb25zdHJ1Y3RvcihlPXt9KXtjb25zdHtvcmRlcjp0PTE2LHRyZWVzOm59PWU7dGhpcy5vcmRlcj10LHRoaXMuaW5kZXg9bj8uaW5kZXh8fG51bGwsdGhpcy5kb2N1bWVudFRlcm1zPW4/LmRvY3VtZW50VGVybXN8fG51bGwsdGhpcy5kb2N1bWVudExlbmd0aHM9bj8uZG9jdW1lbnRMZW5ndGhzfHxudWxsLHRoaXMuaXNPcGVuPSExfWFzeW5jIG9wZW4oKXtpZih0aGlzLmlzT3Blbil0aHJvdyBuZXcgRXJyb3IoIlRleHRJbmRleCBpcyBhbHJlYWR5IG9wZW4iKTtpZighdGhpcy5pbmRleHx8IXRoaXMuZG9jdW1lbnRUZXJtc3x8IXRoaXMuZG9jdW1lbnRMZW5ndGhzKXRocm93IG5ldyBFcnJvcigiVHJlZXMgbXVzdCBiZSBpbml0aWFsaXplZCBiZWZvcmUgb3BlbmluZyIpO2F3YWl0IFByb21pc2UuYWxsKFt0aGlzLmluZGV4Lm9wZW4oKSx0aGlzLmRvY3VtZW50VGVybXMub3BlbigpLHRoaXMuZG9jdW1lbnRMZW5ndGhzLm9wZW4oKV0pLHRoaXMuaXNPcGVuPSEwfWFzeW5jIGNsb3NlKCl7dGhpcy5pc09wZW4mJihhd2FpdCBQcm9taXNlLmFsbChbdGhpcy5pbmRleC5jbG9zZSgpLHRoaXMuZG9jdW1lbnRUZXJtcy5jbG9zZSgpLHRoaXMuZG9jdW1lbnRMZW5ndGhzLmNsb3NlKCldKSx0aGlzLmlzT3Blbj0hMSl9X2Vuc3VyZU9wZW4oKXtpZighdGhpcy5pc09wZW4pdGhyb3cgbmV3IEVycm9yKCJUZXh0SW5kZXggaXMgbm90IG9wZW4iKX1hc3luYyBhZGQoZSx0KXtpZih0aGlzLl9lbnN1cmVPcGVuKCksIWUpdGhyb3cgbmV3IEVycm9yKCJEb2N1bWVudCBJRCBpcyByZXF1aXJlZCIpO2NvbnN0IG49dmUodCkscj0vKiBAX19QVVJFX18gKi9uZXcgTWFwO24uZm9yRWFjaChlPT57Y29uc3QgdD13ZShlKTtyLnNldCh0LChyLmdldCh0KXx8MCkrMSl9KTtmb3IoY29uc3RbbyxhXW9mIHIuZW50cmllcygpKXtjb25zdCB0PWF3YWl0IHRoaXMuaW5kZXguc2VhcmNoKG8pfHx7fTt0W2VdPWEsYXdhaXQgdGhpcy5pbmRleC5hZGQobyx0KX1jb25zdCBpPXsuLi5hd2FpdCB0aGlzLmRvY3VtZW50VGVybXMuc2VhcmNoKGUpfHx7fX07ci5mb3JFYWNoKChlLHQpPT57aVt0XT1lfSk7Y29uc3Qgcz1PYmplY3QudmFsdWVzKGkpLnJlZHVjZSgoZSx0KT0+ZSt0LDApO2F3YWl0IHRoaXMuZG9jdW1lbnRUZXJtcy5hZGQoZSxpKSxhd2FpdCB0aGlzLmRvY3VtZW50TGVuZ3Rocy5hZGQoZSxzKX1hc3luYyByZW1vdmUoZSl7dGhpcy5fZW5zdXJlT3BlbigpO2NvbnN0IHQ9YXdhaXQgdGhpcy5kb2N1bWVudFRlcm1zLnNlYXJjaChlKTtpZighdClyZXR1cm4hMTtmb3IoY29uc3Rbbl1vZiBPYmplY3QuZW50cmllcyh0KSl7Y29uc3QgdD1hd2FpdCB0aGlzLmluZGV4LnNlYXJjaChuKXx8e307ZGVsZXRlIHRbZV0sMD09PU9iamVjdC5rZXlzKHQpLmxlbmd0aD9hd2FpdCB0aGlzLmluZGV4LmRlbGV0ZShuKTphd2FpdCB0aGlzLmluZGV4LmFkZChuLHQpfXJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50VGVybXMuZGVsZXRlKGUpLGF3YWl0IHRoaXMuZG9jdW1lbnRMZW5ndGhzLmRlbGV0ZShlKSwhMH1hc3luYyBxdWVyeShlLHQ9e3Njb3JlZDohMCxyZXF1aXJlQWxsOiExfSl7dGhpcy5fZW5zdXJlT3BlbigpO2NvbnN0IG49dmUoZSk7aWYoMD09PW4ubGVuZ3RoKXJldHVybltdO2NvbnN0IHI9bi5tYXAoZT0+d2UoZSkpLGk9Wy4uLm5ldyBTZXQocildO2lmKHQucmVxdWlyZUFsbCl7Y29uc3QgZT1bXTtmb3IoY29uc3QgbiBvZiBpKXtjb25zdCB0PWF3YWl0IHRoaXMuaW5kZXguc2VhcmNoKG4pO2UucHVzaChuZXcgU2V0KE9iamVjdC5rZXlzKHR8fHt9KSkpfWlmKDA9PT1lLmxlbmd0aClyZXR1cm5bXTtjb25zdCB0PW5ldyBTZXQoZVswXSk7Zm9yKGxldCBuPTE7bjxlLmxlbmd0aDtuKyspZm9yKGNvbnN0IHIgb2ZbLi4udF0pZVtuXS5oYXMocil8fHQuZGVsZXRlKHIpO3JldHVybiBBcnJheS5mcm9tKHQpfWNvbnN0IHM9YXdhaXQgdGhpcy5kb2N1bWVudExlbmd0aHMudG9BcnJheSgpLG89bmV3IE1hcChzLm1hcCgoe2tleTplLHZhbHVlOnR9KT0+W1N0cmluZyhlKSx0fHwxXSkpLGE9cy5sZW5ndGgsYz0vKiBAX19QVVJFX18gKi9uZXcgTWFwO2Zvcihjb25zdCBoIG9mIGkpe2NvbnN0IGU9YXdhaXQgdGhpcy5pbmRleC5zZWFyY2goaCksdD1lP09iamVjdC5rZXlzKGUpLmxlbmd0aDowO3Q+MCYmYy5zZXQoaCxNYXRoLmxvZyhhL3QpKX1jb25zdCBsPS8qIEBfX1BVUkVfXyAqL25ldyBNYXA7Zm9yKGNvbnN0IGggb2YgaSl7Y29uc3QgZT1hd2FpdCB0aGlzLmluZGV4LnNlYXJjaChoKTtpZihlKWZvcihjb25zdFt0LG5db2YgT2JqZWN0LmVudHJpZXMoZSkpe2NvbnN0IGU9bi8oby5nZXQodCl8fDEpLHI9Yy5nZXQoaCl8fDAsaT1sLmdldCh0KXx8MDtsLnNldCh0LGkrZSpyKX19Zm9yKGNvbnN0W2gsZl1vZiBsLmVudHJpZXMoKSl7Y29uc3QgZT1hd2FpdCB0aGlzLmRvY3VtZW50VGVybXMuc2VhcmNoKGgpfHx7fSx0PWkuZmlsdGVyKHQ9PiEhZVt0XSkubGVuZ3RoL2kubGVuZ3RoO2wuc2V0KGgsZiooMSt0KSl9Y29uc3QgdT1BcnJheS5mcm9tKGwuZW50cmllcygpKS5tYXAoKFtlLHRdKT0+KHtpZDplLHNjb3JlOnR9KSkuc29ydCgoZSx0KT0+dC5zY29yZS1lLnNjb3JlKTtyZXR1cm4hMT09PXQuc2NvcmVkP3UubWFwKGU9PmUuaWQpOnV9YXN5bmMgZ2V0VGVybUNvdW50KCl7dGhpcy5fZW5zdXJlT3BlbigpO3JldHVybihhd2FpdCB0aGlzLmluZGV4LnRvQXJyYXkoKSkubGVuZ3RofWFzeW5jIGdldERvY3VtZW50Q291bnQoKXt0aGlzLl9lbnN1cmVPcGVuKCk7cmV0dXJuKGF3YWl0IHRoaXMuZG9jdW1lbnRUZXJtcy50b0FycmF5KCkpLmxlbmd0aH1hc3luYyBjbGVhcigpe3RoaXMuX2Vuc3VyZU9wZW4oKTtjb25zdFtlLHQsbl09YXdhaXQgUHJvbWlzZS5hbGwoW3RoaXMuaW5kZXgudG9BcnJheSgpLHRoaXMuZG9jdW1lbnRUZXJtcy50b0FycmF5KCksdGhpcy5kb2N1bWVudExlbmd0aHMudG9BcnJheSgpXSk7Zm9yKGNvbnN0IHIgb2YgZSlhd2FpdCB0aGlzLmluZGV4LmRlbGV0ZShyLmtleSk7Zm9yKGNvbnN0IHIgb2YgdClhd2FpdCB0aGlzLmRvY3VtZW50VGVybXMuZGVsZXRlKHIua2V5KTtmb3IoY29uc3QgciBvZiBuKWF3YWl0IHRoaXMuZG9jdW1lbnRMZW5ndGhzLmRlbGV0ZShyLmtleSl9YXN5bmMgY29tcGFjdCh7aW5kZXg6ZSxkb2N1bWVudFRlcm1zOnQsZG9jdW1lbnRMZW5ndGhzOm59KXtpZih0aGlzLl9lbnN1cmVPcGVuKCksIWV8fCF0fHwhbil0aHJvdyBuZXcgRXJyb3IoIkRlc3RpbmF0aW9uIHRyZWVzIG11c3QgYmUgcHJvdmlkZWQgZm9yIGNvbXBhY3Rpb24iKTtjb25zdCByPWF3YWl0IHRoaXMuaW5kZXguY29tcGFjdChlLmZpbGUuc3luY0FjY2Vzc0hhbmRsZSksaT1hd2FpdCB0aGlzLmRvY3VtZW50VGVybXMuY29tcGFjdCh0LmZpbGUuc3luY0FjY2Vzc0hhbmRsZSkscz1hd2FpdCB0aGlzLmRvY3VtZW50TGVuZ3Rocy5jb21wYWN0KG4uZmlsZS5zeW5jQWNjZXNzSGFuZGxlKTtyZXR1cm4gYXdhaXQgdGhpcy5jbG9zZSgpLHRoaXMuaXNPcGVuPSExLHt0ZXJtczpyLGRvY3VtZW50czppLGxlbmd0aHM6c319fWZ1bmN0aW9uIEllKGUsdCl7aWYobnVsbD09ZSlyZXR1cm4gZTtpZigiYm9vbGVhbiI9PXR5cGVvZiBlfHwibnVtYmVyIj09dHlwZW9mIGUpcmV0dXJuIGU7aWYoInN0cmluZyI9PXR5cGVvZiBlKXJldHVybiBlLnN0YXJ0c1dpdGgoIiQkIik/IiQkS0VFUCI9PT1lfHwiJCRQUlVORSI9PT1lfHwiJCRERVNDRU5EIj09PWU/ZTp2KHQsZS5zdWJzdHJpbmcoMikpOiIkIj09PWUuY2hhckF0KDApP3YodCxlLnN1YnN0cmluZygxKSk6ZTtpZigib2JqZWN0Ij09dHlwZW9mIGUpe2lmKEFycmF5LmlzQXJyYXkoZSkpcmV0dXJuIGUubWFwKGU9PkllKGUsdCkpO2NvbnN0IG49T2JqZWN0LmtleXMoZSk7aWYoMD09PW4ubGVuZ3RoKXJldHVybiBlO2NvbnN0IHI9blswXTtpZigiJCI9PT1yLmNoYXJBdCgwKSl7cmV0dXJuIGZ1bmN0aW9uKGUsdCxuKXtzd2l0Y2goZSl7Y2FzZSIkYWRkIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtpZighQXJyYXkuaXNBcnJheShlKSlyZXR1cm4gbnVsbDtsZXQgbj0wO2Zvcihjb25zdCByIG9mIGUpe2NvbnN0IGU9SWUocix0KTtlIGluc3RhbmNlb2YgRGF0ZT9uKz1lLmdldFRpbWUoKToibnVtYmVyIj09dHlwZW9mIGUmJihuKz1lKX1yZXR1cm4gbn0odCxuKTtjYXNlIiRzdWJ0cmFjdCI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7aWYoIUFycmF5LmlzQXJyYXkoZSl8fDIhPT1lLmxlbmd0aClyZXR1cm4gbnVsbDtjb25zdCBuPUllKGVbMF0sdCkscj1JZShlWzFdLHQpO2lmKG4gaW5zdGFuY2VvZiBEYXRlJiZyIGluc3RhbmNlb2YgRGF0ZSlyZXR1cm4gbi5nZXRUaW1lKCktci5nZXRUaW1lKCk7aWYobiBpbnN0YW5jZW9mIERhdGUmJiJudW1iZXIiPT10eXBlb2YgcilyZXR1cm4gbmV3IERhdGUobi5nZXRUaW1lKCktcik7aWYoIm51bWJlciI9PXR5cGVvZiBuJiYibnVtYmVyIj09dHlwZW9mIHIpcmV0dXJuIG4tcjtyZXR1cm4gbnVsbH0odCxuKTtjYXNlIiRtdWx0aXBseSI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7aWYoIUFycmF5LmlzQXJyYXkoZSkpcmV0dXJuIG51bGw7bGV0IG49MTtmb3IoY29uc3QgciBvZiBlKXtjb25zdCBlPUllKHIsdCk7Im51bWJlciI9PXR5cGVvZiBlJiYobio9ZSl9cmV0dXJuIG59KHQsbik7Y2FzZSIkZGl2aWRlIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtpZighQXJyYXkuaXNBcnJheShlKXx8MiE9PWUubGVuZ3RoKXJldHVybiBudWxsO2NvbnN0IG49SWUoZVswXSx0KSxyPUllKGVbMV0sdCk7aWYoIm51bWJlciI9PXR5cGVvZiBuJiYibnVtYmVyIj09dHlwZW9mIHImJjAhPT1yKXJldHVybiBuL3I7cmV0dXJuIG51bGx9KHQsbik7Y2FzZSIkbW9kIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtpZighQXJyYXkuaXNBcnJheShlKXx8MiE9PWUubGVuZ3RoKXJldHVybiBudWxsO2NvbnN0IG49SWUoZVswXSx0KSxyPUllKGVbMV0sdCk7aWYoIm51bWJlciI9PXR5cGVvZiBuJiYibnVtYmVyIj09dHlwZW9mIHImJjAhPT1yKXJldHVybiBuJXI7cmV0dXJuIG51bGx9KHQsbik7Y2FzZSIkcG93IjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtpZighQXJyYXkuaXNBcnJheShlKXx8MiE9PWUubGVuZ3RoKXJldHVybiBudWxsO2NvbnN0IG49SWUoZVswXSx0KSxyPUllKGVbMV0sdCk7aWYoIm51bWJlciI9PXR5cGVvZiBuJiYibnVtYmVyIj09dHlwZW9mIHIpcmV0dXJuIE1hdGgucG93KG4scik7cmV0dXJuIG51bGx9KHQsbik7Y2FzZSIkc3FydCI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7Y29uc3Qgbj1JZShlLHQpO2lmKCJudW1iZXIiPT10eXBlb2YgbiYmbj49MClyZXR1cm4gTWF0aC5zcXJ0KG4pO3JldHVybiBudWxsfSh0LG4pO2Nhc2UiJGFicyI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7Y29uc3Qgbj1JZShlLHQpO2lmKCJudW1iZXIiPT10eXBlb2YgbilyZXR1cm4gTWF0aC5hYnMobik7cmV0dXJuIG51bGx9KHQsbik7Y2FzZSIkY2VpbCI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7Y29uc3Qgbj1JZShlLHQpO2lmKCJudW1iZXIiPT10eXBlb2YgbilyZXR1cm4gTWF0aC5jZWlsKG4pO3JldHVybiBudWxsfSh0LG4pO2Nhc2UiJGZsb29yIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPUllKGUsdCk7aWYoIm51bWJlciI9PXR5cGVvZiBuKXJldHVybiBNYXRoLmZsb29yKG4pO3JldHVybiBudWxsfSh0LG4pO2Nhc2UiJHRydW5jIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPUllKGUsdCk7aWYoIm51bWJlciI9PXR5cGVvZiBuKXJldHVybiBNYXRoLnRydW5jKG4pO3JldHVybiBudWxsfSh0LG4pO2Nhc2UiJHJvdW5kIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPUllKEFycmF5LmlzQXJyYXkoZSk/ZVswXTplLHQpLHI9QXJyYXkuaXNBcnJheShlKSYmdm9pZCAwIT09ZVsxXT9JZShlWzFdLHQpOjA7aWYoIm51bWJlciI9PXR5cGVvZiBuJiYibnVtYmVyIj09dHlwZW9mIHIpe2NvbnN0IGU9TWF0aC5wb3coMTAscik7cmV0dXJuIE1hdGgucm91bmQobiplKS9lfXJldHVybiBudWxsfSh0LG4pO2Nhc2UiJGNvbmNhdCI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7aWYoIUFycmF5LmlzQXJyYXkoZSkpcmV0dXJuIG51bGw7bGV0IG49IiI7Zm9yKGNvbnN0IHIgb2YgZSl7Y29uc3QgZT1JZShyLHQpO251bGwhPWUmJihuKz1TdHJpbmcoZSkpfXJldHVybiBufSh0LG4pO2Nhc2UiJHN1YnN0ciI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7aWYoIUFycmF5LmlzQXJyYXkoZSl8fGUubGVuZ3RoPDMpcmV0dXJuIG51bGw7Y29uc3Qgbj1TdHJpbmcoSWUoZVswXSx0KXx8IiIpLHI9SWUoZVsxXSx0KSxpPUllKGVbMl0sdCk7aWYoIm51bWJlciI9PXR5cGVvZiByJiYibnVtYmVyIj09dHlwZW9mIGkpcmV0dXJuIG4uc3Vic3RyKHIsaSk7cmV0dXJuIG51bGx9KHQsbik7Y2FzZSIkdG9Mb3dlciI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7Y29uc3Qgbj1JZShlLHQpO3JldHVybiBudWxsIT1uP1N0cmluZyhuKS50b0xvd2VyQ2FzZSgpOiIifSh0LG4pO2Nhc2UiJHRvVXBwZXIiOnJldHVybiBmdW5jdGlvbihlLHQpe2NvbnN0IG49SWUoZSx0KTtyZXR1cm4gbnVsbCE9bj9TdHJpbmcobikudG9VcHBlckNhc2UoKToiIn0odCxuKTtjYXNlIiR0cmltIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPUllKCJvYmplY3QiPT10eXBlb2YgZSYmZS5pbnB1dD9lLmlucHV0OmUsdCkscj1lLmNoYXJzP0llKGUuY2hhcnMsdCk6bnVsbDtsZXQgaT1udWxsIT1uP1N0cmluZyhuKToiIjtpZihyKXtjb25zdCBlPW5ldyBSZWdFeHAoYF5bJHtOZShyKX1dK3xbJHtOZShyKX1dKyRgLCJnIik7cmV0dXJuIGkucmVwbGFjZShlLCIiKX1yZXR1cm4gaS50cmltKCl9KHQsbik7Y2FzZSIkbHRyaW0iOnJldHVybiBmdW5jdGlvbihlLHQpe2NvbnN0IG49SWUoIm9iamVjdCI9PXR5cGVvZiBlJiZlLmlucHV0P2UuaW5wdXQ6ZSx0KSxyPWUuY2hhcnM/SWUoZS5jaGFycyx0KTpudWxsO2xldCBpPW51bGwhPW4/U3RyaW5nKG4pOiIiO2lmKHIpe2NvbnN0IGU9bmV3IFJlZ0V4cChgXlske05lKHIpfV0rYCwiZyIpO3JldHVybiBpLnJlcGxhY2UoZSwiIil9cmV0dXJuIGkucmVwbGFjZSgvXlxzKy8sIiIpfSh0LG4pO2Nhc2UiJHJ0cmltIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPUllKCJvYmplY3QiPT10eXBlb2YgZSYmZS5pbnB1dD9lLmlucHV0OmUsdCkscj1lLmNoYXJzP0llKGUuY2hhcnMsdCk6bnVsbDtsZXQgaT1udWxsIT1uP1N0cmluZyhuKToiIjtpZihyKXtjb25zdCBlPW5ldyBSZWdFeHAoYFske05lKHIpfV0rJGAsImciKTtyZXR1cm4gaS5yZXBsYWNlKGUsIiIpfXJldHVybiBpLnJlcGxhY2UoL1xzKyQvLCIiKX0odCxuKTtjYXNlIiRzcGxpdCI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7aWYoIUFycmF5LmlzQXJyYXkoZSl8fDIhPT1lLmxlbmd0aClyZXR1cm4gbnVsbDtjb25zdCBuPVN0cmluZyhJZShlWzBdLHQpfHwiIikscj1TdHJpbmcoSWUoZVsxXSx0KXx8IiIpO3JldHVybiBuLnNwbGl0KHIpfSh0LG4pO2Nhc2UiJHN0ckxlbkNQIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPUllKGUsdCk7cmV0dXJuIG51bGwhPW4/U3RyaW5nKG4pLmxlbmd0aDowfSh0LG4pO2Nhc2UiJHN0cmNhc2VjbXAiOnJldHVybiBmdW5jdGlvbihlLHQpe2lmKCFBcnJheS5pc0FycmF5KGUpfHwyIT09ZS5sZW5ndGgpcmV0dXJuIG51bGw7Y29uc3Qgbj1TdHJpbmcoSWUoZVswXSx0KXx8IiIpLnRvTG93ZXJDYXNlKCkscj1TdHJpbmcoSWUoZVsxXSx0KXx8IiIpLnRvTG93ZXJDYXNlKCk7cmV0dXJuIG48cj8tMTpuPnI/MTowfSh0LG4pO2Nhc2UiJGluZGV4T2ZDUCI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7aWYoIUFycmF5LmlzQXJyYXkoZSl8fGUubGVuZ3RoPDIpcmV0dXJuIG51bGw7Y29uc3Qgbj1TdHJpbmcoSWUoZVswXSx0KXx8IiIpLHI9U3RyaW5nKEllKGVbMV0sdCl8fCIiKSxpPXZvaWQgMCE9PWVbMl0/SWUoZVsyXSx0KTowLHM9dm9pZCAwIT09ZVszXT9JZShlWzNdLHQpOm4ubGVuZ3RoLG89bi5zdWJzdHJpbmcoaSxzKS5pbmRleE9mKHIpO3JldHVybi0xPT09bz8tMTpvK2l9KHQsbik7Y2FzZSIkcmVwbGFjZU9uZSI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7Y29uc3Qgbj1TdHJpbmcoSWUoZS5pbnB1dCx0KXx8IiIpLHI9U3RyaW5nKEllKGUuZmluZCx0KXx8IiIpLGk9U3RyaW5nKEllKGUucmVwbGFjZW1lbnQsdCl8fCIiKTtyZXR1cm4gbi5yZXBsYWNlKHIsaSl9KHQsbik7Y2FzZSIkcmVwbGFjZUFsbCI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7Y29uc3Qgbj1TdHJpbmcoSWUoZS5pbnB1dCx0KXx8IiIpLHI9U3RyaW5nKEllKGUuZmluZCx0KXx8IiIpLGk9U3RyaW5nKEllKGUucmVwbGFjZW1lbnQsdCl8fCIiKTtyZXR1cm4gbi5zcGxpdChyKS5qb2luKGkpfSh0LG4pO2Nhc2UiJGNtcCI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7aWYoIUFycmF5LmlzQXJyYXkoZSl8fDIhPT1lLmxlbmd0aClyZXR1cm4gbnVsbDtjb25zdCBuPUllKGVbMF0sdCkscj1JZShlWzFdLHQpO3JldHVybiBuPHI/LTE6bj5yPzE6MH0odCxuKTtjYXNlIiRlcSI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7aWYoIUFycmF5LmlzQXJyYXkoZSl8fDIhPT1lLmxlbmd0aClyZXR1cm4gbnVsbDtjb25zdCBuPUllKGVbMF0sdCkscj1JZShlWzFdLHQpO3JldHVybiBuPT09cn0odCxuKTtjYXNlIiRuZSI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7aWYoIUFycmF5LmlzQXJyYXkoZSl8fDIhPT1lLmxlbmd0aClyZXR1cm4gbnVsbDtjb25zdCBuPUllKGVbMF0sdCkscj1JZShlWzFdLHQpO3JldHVybiBuIT09cn0odCxuKTtjYXNlIiRndCI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7aWYoIUFycmF5LmlzQXJyYXkoZSl8fDIhPT1lLmxlbmd0aClyZXR1cm4gbnVsbDtjb25zdCBuPUllKGVbMF0sdCkscj1JZShlWzFdLHQpO3JldHVybiBuPnJ9KHQsbik7Y2FzZSIkZ3RlIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtpZighQXJyYXkuaXNBcnJheShlKXx8MiE9PWUubGVuZ3RoKXJldHVybiBudWxsO2NvbnN0IG49SWUoZVswXSx0KSxyPUllKGVbMV0sdCk7cmV0dXJuIG4+PXJ9KHQsbik7Y2FzZSIkbHQiOnJldHVybiBmdW5jdGlvbihlLHQpe2lmKCFBcnJheS5pc0FycmF5KGUpfHwyIT09ZS5sZW5ndGgpcmV0dXJuIG51bGw7Y29uc3Qgbj1JZShlWzBdLHQpLHI9SWUoZVsxXSx0KTtyZXR1cm4gbjxyfSh0LG4pO2Nhc2UiJGx0ZSI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7aWYoIUFycmF5LmlzQXJyYXkoZSl8fDIhPT1lLmxlbmd0aClyZXR1cm4gbnVsbDtjb25zdCBuPUllKGVbMF0sdCkscj1JZShlWzFdLHQpO3JldHVybiBuPD1yfSh0LG4pO2Nhc2UiJGFuZCI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7aWYoIUFycmF5LmlzQXJyYXkoZSkpcmV0dXJuIG51bGw7Zm9yKGNvbnN0IG4gb2YgZSl7aWYoIUllKG4sdCkpcmV0dXJuITF9cmV0dXJuITB9KHQsbik7Y2FzZSIkb3IiOnJldHVybiBmdW5jdGlvbihlLHQpe2lmKCFBcnJheS5pc0FycmF5KGUpKXJldHVybiBudWxsO2Zvcihjb25zdCBuIG9mIGUpe2lmKEllKG4sdCkpcmV0dXJuITB9cmV0dXJuITF9KHQsbik7Y2FzZSIkbm90IjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPUllKEFycmF5LmlzQXJyYXkoZSk/ZVswXTplLHQpO3JldHVybiFufSh0LG4pO2Nhc2UiJGNvbmQiOnJldHVybiBmdW5jdGlvbihlLHQpe2xldCBuLHIsaTtpZihBcnJheS5pc0FycmF5KGUpKXtpZigzIT09ZS5sZW5ndGgpcmV0dXJuIG51bGw7W24scixpXT1lfWVsc2V7aWYoIm9iamVjdCIhPXR5cGVvZiBlKXJldHVybiBudWxsO249ZS5pZixyPWUudGhlbixpPWUuZWxzZX1jb25zdCBzPUllKG4sdCk7cmV0dXJuIEllKHM/cjppLHQpfSh0LG4pO2Nhc2UiJGlmTnVsbCI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7aWYoIUFycmF5LmlzQXJyYXkoZSl8fGUubGVuZ3RoPDIpcmV0dXJuIG51bGw7Zm9yKGxldCBuPTA7bjxlLmxlbmd0aDtuKyspe2NvbnN0IHI9SWUoZVtuXSx0KTtpZihudWxsIT1yKXJldHVybiByfXJldHVybiBudWxsfSh0LG4pO2Nhc2UiJHN3aXRjaCI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7aWYoIm9iamVjdCIhPXR5cGVvZiBlfHwhQXJyYXkuaXNBcnJheShlLmJyYW5jaGVzKSlyZXR1cm4gbnVsbDtmb3IoY29uc3QgbiBvZiBlLmJyYW5jaGVzKXtpZihJZShuLmNhc2UsdCkpcmV0dXJuIEllKG4udGhlbix0KX1yZXR1cm4gdm9pZCAwIT09ZS5kZWZhdWx0P0llKGUuZGVmYXVsdCx0KTpudWxsfSh0LG4pO2Nhc2UiJHllYXIiOnJldHVybiBmdW5jdGlvbihlLHQpe2NvbnN0IG49SWUoZSx0KTtpZihuIGluc3RhbmNlb2YgRGF0ZSlyZXR1cm4gbi5nZXRVVENGdWxsWWVhcigpO3JldHVybiBudWxsfSh0LG4pO2Nhc2UiJG1vbnRoIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPUllKGUsdCk7aWYobiBpbnN0YW5jZW9mIERhdGUpcmV0dXJuIG4uZ2V0VVRDTW9udGgoKSsxO3JldHVybiBudWxsfSh0LG4pO2Nhc2UiJGRheU9mTW9udGgiOnJldHVybiBmdW5jdGlvbihlLHQpe2NvbnN0IG49SWUoZSx0KTtpZihuIGluc3RhbmNlb2YgRGF0ZSlyZXR1cm4gbi5nZXRVVENEYXRlKCk7cmV0dXJuIG51bGx9KHQsbik7Y2FzZSIkZGF5T2ZXZWVrIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPUllKGUsdCk7aWYobiBpbnN0YW5jZW9mIERhdGUpcmV0dXJuIG4uZ2V0VVRDRGF5KCkrMTtyZXR1cm4gbnVsbH0odCxuKTtjYXNlIiRkYXlPZlllYXIiOnJldHVybiBmdW5jdGlvbihlLHQpe2NvbnN0IG49SWUoZSx0KTtpZihuIGluc3RhbmNlb2YgRGF0ZSl7Y29uc3QgZT1uZXcgRGF0ZShEYXRlLlVUQyhuLmdldFVUQ0Z1bGxZZWFyKCksMCwwKSksdD1uLWUscj04NjRlNTtyZXR1cm4gTWF0aC5mbG9vcih0L3IpfXJldHVybiBudWxsfSh0LG4pO2Nhc2UiJGhvdXIiOnJldHVybiBmdW5jdGlvbihlLHQpe2NvbnN0IG49SWUoZSx0KTtpZihuIGluc3RhbmNlb2YgRGF0ZSlyZXR1cm4gbi5nZXRVVENIb3VycygpO3JldHVybiBudWxsfSh0LG4pO2Nhc2UiJG1pbnV0ZSI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7Y29uc3Qgbj1JZShlLHQpO2lmKG4gaW5zdGFuY2VvZiBEYXRlKXJldHVybiBuLmdldFVUQ01pbnV0ZXMoKTtyZXR1cm4gbnVsbH0odCxuKTtjYXNlIiRzZWNvbmQiOnJldHVybiBmdW5jdGlvbihlLHQpe2NvbnN0IG49SWUoZSx0KTtpZihuIGluc3RhbmNlb2YgRGF0ZSlyZXR1cm4gbi5nZXRVVENTZWNvbmRzKCk7cmV0dXJuIG51bGx9KHQsbik7Y2FzZSIkbWlsbGlzZWNvbmQiOnJldHVybiBmdW5jdGlvbihlLHQpe2NvbnN0IG49SWUoZSx0KTtpZihuIGluc3RhbmNlb2YgRGF0ZSlyZXR1cm4gbi5nZXRVVENNaWxsaXNlY29uZHMoKTtyZXR1cm4gbnVsbH0odCxuKTtjYXNlIiR3ZWVrIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPUllKGUsdCk7aWYobiBpbnN0YW5jZW9mIERhdGUpe2NvbnN0IGU9bmV3IERhdGUoRGF0ZS5VVEMobi5nZXRVVENGdWxsWWVhcigpLDAsMSkpO3JldHVybiBNYXRoLmNlaWwoKChuLWUpLzg2NGU1K2UuZ2V0VVRDRGF5KCkrMSkvNyktMX1yZXR1cm4gbnVsbH0odCxuKTtjYXNlIiRpc29XZWVrIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPUllKGUsdCk7aWYobiBpbnN0YW5jZW9mIERhdGUpe2NvbnN0IGU9bmV3IERhdGUobi52YWx1ZU9mKCkpLHQ9KG4uZ2V0VVRDRGF5KCkrNiklNztlLnNldFVUQ0RhdGUoZS5nZXRVVENEYXRlKCktdCszKTtjb25zdCByPWUudmFsdWVPZigpO3JldHVybiBlLnNldFVUQ01vbnRoKDAsMSksNCE9PWUuZ2V0VVRDRGF5KCkmJmUuc2V0VVRDTW9udGgoMCwxKyg0LWUuZ2V0VVRDRGF5KCkrNyklNyksMStNYXRoLmNlaWwoKHItZSkvNjA0OGU1KX1yZXR1cm4gbnVsbH0odCxuKTtjYXNlIiRpc29XZWVrWWVhciI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7Y29uc3Qgbj1JZShlLHQpO2lmKG4gaW5zdGFuY2VvZiBEYXRlKXtjb25zdCBlPW5ldyBEYXRlKG4udmFsdWVPZigpKTtyZXR1cm4gZS5zZXRVVENEYXRlKGUuZ2V0VVRDRGF0ZSgpLShuLmdldFVUQ0RheSgpKzYpJTcrMyksZS5nZXRVVENGdWxsWWVhcigpfXJldHVybiBudWxsfSh0LG4pO2Nhc2UiJGRhdGVUb1N0cmluZyI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7Y29uc3Qgbj1lLmZvcm1hdD9JZShlLmZvcm1hdCx0KToiJVktJW0tJWRUJUg6JU06JVMuJUxaIixyPUllKGUuZGF0ZSx0KTtyZXR1cm4gciBpbnN0YW5jZW9mIERhdGU/bi5yZXBsYWNlKCIlWSIsci5nZXRVVENGdWxsWWVhcigpKS5yZXBsYWNlKCIlbSIsU3RyaW5nKHIuZ2V0VVRDTW9udGgoKSsxKS5wYWRTdGFydCgyLCIwIikpLnJlcGxhY2UoIiVkIixTdHJpbmcoci5nZXRVVENEYXRlKCkpLnBhZFN0YXJ0KDIsIjAiKSkucmVwbGFjZSgiJUgiLFN0cmluZyhyLmdldFVUQ0hvdXJzKCkpLnBhZFN0YXJ0KDIsIjAiKSkucmVwbGFjZSgiJU0iLFN0cmluZyhyLmdldFVUQ01pbnV0ZXMoKSkucGFkU3RhcnQoMiwiMCIpKS5yZXBsYWNlKCIlUyIsU3RyaW5nKHIuZ2V0VVRDU2Vjb25kcygpKS5wYWRTdGFydCgyLCIwIikpLnJlcGxhY2UoIiVMIixTdHJpbmcoci5nZXRVVENNaWxsaXNlY29uZHMoKSkucGFkU3RhcnQoMywiMCIpKTpudWxsfSh0LG4pO2Nhc2UiJHRvRGF0ZSI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7Y29uc3Qgbj1JZShlLHQpO2lmKG4gaW5zdGFuY2VvZiBEYXRlKXJldHVybiBuO2lmKCJzdHJpbmciPT10eXBlb2Ygbnx8Im51bWJlciI9PXR5cGVvZiBuKXtjb25zdCBlPW5ldyBEYXRlKG4pO3JldHVybiBpc05hTihlLmdldFRpbWUoKSk/bnVsbDplfXJldHVybiBudWxsfSh0LG4pO2Nhc2UiJGFycmF5RWxlbUF0IjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtpZighQXJyYXkuaXNBcnJheShlKXx8MiE9PWUubGVuZ3RoKXJldHVybiBudWxsO2NvbnN0IG49SWUoZVswXSx0KSxyPUllKGVbMV0sdCk7aWYoIUFycmF5LmlzQXJyYXkobil8fCJudW1iZXIiIT10eXBlb2YgcilyZXR1cm4gbnVsbDtjb25zdCBpPXI8MD9uLmxlbmd0aCtyOnI7cmV0dXJuIG5baV19KHQsbik7Y2FzZSIkY29uY2F0QXJyYXlzIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtpZighQXJyYXkuaXNBcnJheShlKSlyZXR1cm4gbnVsbDtjb25zdCBuPVtdO2Zvcihjb25zdCByIG9mIGUpe2NvbnN0IGU9SWUocix0KTtBcnJheS5pc0FycmF5KGUpJiZuLnB1c2goLi4uZSl9cmV0dXJuIG59KHQsbik7Y2FzZSIkZmlsdGVyIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPUllKGUuaW5wdXQsdCkscj1lLmFzfHwidGhpcyIsaT1lLmNvbmQ7cmV0dXJuIEFycmF5LmlzQXJyYXkobik/bi5maWx0ZXIoZT0+e2NvbnN0IG49ey4uLnQsW3JdOmV9O3JldHVybiBJZShpLG4pfSk6bnVsbH0odCxuKTtjYXNlIiRpbiI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7aWYoIUFycmF5LmlzQXJyYXkoZSl8fDIhPT1lLmxlbmd0aClyZXR1cm4gbnVsbDtjb25zdCBuPUllKGVbMF0sdCkscj1JZShlWzFdLHQpO3JldHVybiEhQXJyYXkuaXNBcnJheShyKSYmci5pbmNsdWRlcyhuKX0odCxuKTtjYXNlIiRpbmRleE9mQXJyYXkiOnJldHVybiBmdW5jdGlvbihlLHQpe2lmKCFBcnJheS5pc0FycmF5KGUpfHxlLmxlbmd0aDwyKXJldHVybiBudWxsO2NvbnN0IG49SWUoZVswXSx0KSxyPUllKGVbMV0sdCksaT12b2lkIDAhPT1lWzJdP0llKGVbMl0sdCk6MCxzPXZvaWQgMCE9PWVbM10/SWUoZVszXSx0KTpuLmxlbmd0aDtpZighQXJyYXkuaXNBcnJheShuKSlyZXR1cm4gbnVsbDtmb3IobGV0IG89aTtvPHMmJm88bi5sZW5ndGg7bysrKWlmKG5bb109PT1yKXJldHVybiBvO3JldHVybi0xfSh0LG4pO2Nhc2UiJGlzQXJyYXkiOnJldHVybiBmdW5jdGlvbihlLHQpe2NvbnN0IG49SWUoZSx0KTtyZXR1cm4gQXJyYXkuaXNBcnJheShuKX0odCxuKTtjYXNlIiRtYXAiOnJldHVybiBmdW5jdGlvbihlLHQpe2NvbnN0IG49SWUoZS5pbnB1dCx0KSxyPWUuYXN8fCJ0aGlzIixpPWUuaW47cmV0dXJuIEFycmF5LmlzQXJyYXkobik/bi5tYXAoZT0+e2NvbnN0IG49ey4uLnQsW3JdOmV9O3JldHVybiBJZShpLG4pfSk6bnVsbH0odCxuKTtjYXNlIiRyZWR1Y2UiOnJldHVybiBmdW5jdGlvbihlLHQpe2NvbnN0IG49SWUoZS5pbnB1dCx0KSxyPUllKGUuaW5pdGlhbFZhbHVlLHQpLGk9ZS5pbjtpZighQXJyYXkuaXNBcnJheShuKSlyZXR1cm4gbnVsbDtsZXQgcz1yO2Zvcihjb25zdCBvIG9mIG4pe3M9SWUoaSx7Li4udCx2YWx1ZTpzLHRoaXM6b30pfXJldHVybiBzfSh0LG4pO2Nhc2UiJHNpemUiOnJldHVybiBmdW5jdGlvbihlLHQpe2NvbnN0IG49SWUoZSx0KTtyZXR1cm4gQXJyYXkuaXNBcnJheShuKT9uLmxlbmd0aDpudWxsfSh0LG4pO2Nhc2UiJHNsaWNlIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtpZighQXJyYXkuaXNBcnJheShlKXx8ZS5sZW5ndGg8MilyZXR1cm4gbnVsbDtjb25zdCBuPUllKGVbMF0sdCk7aWYoIUFycmF5LmlzQXJyYXkobikpcmV0dXJuIG51bGw7aWYoMj09PWUubGVuZ3RoKXtjb25zdCByPUllKGVbMV0sdCk7cmV0dXJuIHI+PTA/bi5zbGljZSgwLHIpOm4uc2xpY2Uocil9e2NvbnN0IHI9SWUoZVsxXSx0KSxpPUllKGVbMl0sdCk7cmV0dXJuIG4uc2xpY2UocixyK2kpfX0odCxuKTtjYXNlIiRyZXZlcnNlQXJyYXkiOnJldHVybiBmdW5jdGlvbihlLHQpe2NvbnN0IG49SWUoZSx0KTtyZXR1cm4gQXJyYXkuaXNBcnJheShuKT9uLnNsaWNlKCkucmV2ZXJzZSgpOm51bGx9KHQsbik7Y2FzZSIkemlwIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPWUuaW5wdXRzP0llKGUuaW5wdXRzLHQpOm51bGwscj1lLnVzZUxvbmdlc3RMZW5ndGh8fCExLGk9ZS5kZWZhdWx0cztpZighQXJyYXkuaXNBcnJheShuKSlyZXR1cm4gbnVsbDtjb25zdCBzPW4ubWFwKGU9PkllKGUsdCkpO2lmKCFzLmV2ZXJ5KGU9PkFycmF5LmlzQXJyYXkoZSkpKXJldHVybiBudWxsO2NvbnN0IG89TWF0aC5tYXgoLi4ucy5tYXAoZT0+ZS5sZW5ndGgpKSxhPXI/bzpNYXRoLm1pbiguLi5zLm1hcChlPT5lLmxlbmd0aCkpLGM9W107Zm9yKGxldCBsPTA7bDxhO2wrKyl7Y29uc3QgZT1bXTtmb3IobGV0IHQ9MDt0PHMubGVuZ3RoO3QrKylsPHNbdF0ubGVuZ3RoP2UucHVzaChzW3RdW2xdKTppJiZ0PGkubGVuZ3RoP2UucHVzaChpW3RdKTplLnB1c2gobnVsbCk7Yy5wdXNoKGUpfXJldHVybiBjfSh0LG4pO2Nhc2UiJHR5cGUiOnJldHVybiBmdW5jdGlvbihlLHQpe2NvbnN0IG49SWUoZSx0KTtyZXR1cm4gbnVsbD09PW4/Im51bGwiOnZvaWQgMD09PW4/Im1pc3NpbmciOiJib29sZWFuIj09dHlwZW9mIG4/ImJvb2wiOiJudW1iZXIiPT10eXBlb2Ygbj9OdW1iZXIuaXNJbnRlZ2VyKG4pPyJpbnQiOiJkb3VibGUiOiJzdHJpbmciPT10eXBlb2Ygbj8ic3RyaW5nIjpuIGluc3RhbmNlb2YgRGF0ZT8iZGF0ZSI6QXJyYXkuaXNBcnJheShuKT8iYXJyYXkiOiJvYmplY3QiPT10eXBlb2Ygbj8ib2JqZWN0IjoidW5rbm93biJ9KHQsbik7Y2FzZSIkY29udmVydCI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7Y29uc3Qgbj1JZShlLmlucHV0LHQpLHI9ZS50byxpPWUub25FcnJvcixzPWUub25OdWxsO2lmKG51bGw9PT1uKXJldHVybiB2b2lkIDAhPT1zP0llKHMsdCk6bnVsbDt0cnl7c3dpdGNoKHIpe2Nhc2UiZG91YmxlIjpjYXNlImRlY2ltYWwiOnJldHVybiBwYXJzZUZsb2F0KG4pO2Nhc2UiaW50IjpjYXNlImxvbmciOnJldHVybiBwYXJzZUludChuKTtjYXNlImJvb2wiOnJldHVybiBCb29sZWFuKG4pO2Nhc2Uic3RyaW5nIjpyZXR1cm4gU3RyaW5nKG4pO2Nhc2UiZGF0ZSI6cmV0dXJuIG5ldyBEYXRlKG4pO2RlZmF1bHQ6cmV0dXJuIG59fWNhdGNoKG8pe3JldHVybiB2b2lkIDAhPT1pP0llKGksdCk6bnVsbH19KHQsbik7Y2FzZSIkdG9Cb29sIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPUllKGUsdCk7cmV0dXJuIEJvb2xlYW4obil9KHQsbik7Y2FzZSIkdG9EZWNpbWFsIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPUllKGUsdCk7cmV0dXJuIHBhcnNlRmxvYXQobil9KHQsbik7Y2FzZSIkdG9Eb3VibGUiOnJldHVybiBmdW5jdGlvbihlLHQpe2NvbnN0IG49SWUoZSx0KTtyZXR1cm4gcGFyc2VGbG9hdChuKX0odCxuKTtjYXNlIiR0b0ludCI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7Y29uc3Qgbj1JZShlLHQpO3JldHVybiBwYXJzZUludChuKX0odCxuKTtjYXNlIiR0b0xvbmciOnJldHVybiBmdW5jdGlvbihlLHQpe2NvbnN0IG49SWUoZSx0KTtyZXR1cm4gcGFyc2VJbnQobil9KHQsbik7Y2FzZSIkdG9TdHJpbmciOnJldHVybiBmdW5jdGlvbihlLHQpe2NvbnN0IG49SWUoZSx0KTtyZXR1cm4gbnVsbD09bj9udWxsOlN0cmluZyhuKX0odCxuKTtjYXNlIiRvYmplY3RUb0FycmF5IjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPUllKGUsdCk7aWYoIm9iamVjdCIhPXR5cGVvZiBufHxudWxsPT09bnx8QXJyYXkuaXNBcnJheShuKSlyZXR1cm4gbnVsbDtyZXR1cm4gT2JqZWN0LmtleXMobikubWFwKGU9Pih7azplLHY6bltlXX0pKX0odCxuKTtjYXNlIiRhcnJheVRvT2JqZWN0IjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPUllKGUsdCk7aWYoIUFycmF5LmlzQXJyYXkobikpcmV0dXJuIG51bGw7Y29uc3Qgcj17fTtmb3IoY29uc3QgaSBvZiBuKUFycmF5LmlzQXJyYXkoaSkmJjI9PT1pLmxlbmd0aD9yW2lbMF1dPWlbMV06Im9iamVjdCI9PXR5cGVvZiBpJiZ2b2lkIDAhPT1pLmsmJnZvaWQgMCE9PWkudiYmKHJbaS5rXT1pLnYpO3JldHVybiByfSh0LG4pO2Nhc2UiJG1lcmdlT2JqZWN0cyI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7aWYoIUFycmF5LmlzQXJyYXkoZSkpcmV0dXJuIEllKGUsdCk7Y29uc3Qgbj17fTtmb3IoY29uc3QgciBvZiBlKXtjb25zdCBlPUllKHIsdCk7Im9iamVjdCIhPXR5cGVvZiBlfHxudWxsPT09ZXx8QXJyYXkuaXNBcnJheShlKXx8T2JqZWN0LmFzc2lnbihuLGUpfXJldHVybiBufSh0LG4pO2Nhc2UiJGxpdGVyYWwiOnJldHVybiB0O2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKGBVbnN1cHBvcnRlZCBhZ2dyZWdhdGlvbiBvcGVyYXRvcjogJHtlfWApfX0ocixlW3JdLHQpfXtjb25zdCByPXt9O2Zvcihjb25zdCBpIG9mIG4pcltpXT1JZShlW2ldLHQpO3JldHVybiByfX1yZXR1cm4gZX1mdW5jdGlvbiBOZShlKXtyZXR1cm4gZS5yZXBsYWNlKC9bLiorP14ke30oKXxbXF1cXF0vZywiXFwkJiIpfWNvbnN0IFNlPXsxOiJkb3VibGUiLDI6InN0cmluZyIsMzoib2JqZWN0Iiw0OiJhcnJheSIsNToiYmluRGF0YSIsNjoidW5kZWZpbmVkIiw3OiJvYmplY3RJZCIsODoiYm9vbCIsOToiZGF0ZSIsMTA6Im51bGwiLDExOiJyZWdleCIsMTM6ImphdmFzY3JpcHQiLDE1OiJqYXZhc2NyaXB0V2l0aFNjb3BlIiwxNjoiaW50IiwxNzoidGltZXN0YW1wIiwxODoibG9uZyIsMTk6ImRlY2ltYWwiLDEyNzoibWF4S2V5IiwiLTEiOiJtaW5LZXkifSxPZT1PYmplY3QuZW50cmllcyhTZSkucmVkdWNlKChlLFt0LG5dKT0+KGVbbl09cGFyc2VJbnQodCksZSkse30pO2Z1bmN0aW9uIEFlKGUsdCl7aWYoTih0KSl7Zm9yKGxldCBuPTA7bjx0Lmxlbmd0aDtuKyspaWYoQWUoZSx0W25dKSlyZXR1cm4hMDtyZXR1cm4hMX1jb25zdCBuPSJudW1iZXIiPT10eXBlb2YgdD90Ok9lW3RdLHI9U2Vbbl18fHQ7cmV0dXJuIG51bGw9PT1lPyJudWxsIj09PXJ8fDEwPT09bjp2b2lkIDA9PT1lPyJ1bmRlZmluZWQiPT09cnx8Nj09PW46Im51bWJlciI9PXR5cGVvZiBlP051bWJlci5pc0ludGVnZXIoZSk/ImludCI9PT1yfHwxNj09PW46ImRvdWJsZSI9PT1yfHwxPT09bjoic3RyaW5nIj09dHlwZW9mIGU/InN0cmluZyI9PT1yfHwyPT09bjoiYm9vbGVhbiI9PXR5cGVvZiBlPyJib29sIj09PXJ8fDg9PT1uOmUgaW5zdGFuY2VvZiBEYXRlPyJkYXRlIj09PXJ8fDk9PT1uOmUgaW5zdGFuY2VvZiBnPyJvYmplY3RJZCI9PT1yfHw3PT09bjplIGluc3RhbmNlb2YgUmVnRXhwPyJyZWdleCI9PT1yfHwxMT09PW46TihlKT8iYXJyYXkiPT09cnx8ND09PW46Im9iamVjdCI9PXR5cGVvZiBlPyJvYmplY3QiPT09cnx8Mz09PW46dHlwZW9mIGU9PT10fWZ1bmN0aW9uIENlKGUpe2lmKE4oZSkpe2xldCB0PTA7Zm9yKGxldCBuPTA7bjxlLmxlbmd0aDtuKyspdHw9MTw8ZVtuXTtyZXR1cm4gdH1yZXR1cm4ibnVtYmVyIj09dHlwZW9mIGU/ZTowfWZ1bmN0aW9uIEVlKGUsdCl7aWYoIm51bWJlciIhPXR5cGVvZiBlKXJldHVybiExO2NvbnN0IG49Q2UodCk7cmV0dXJuKGUmbik9PT1ufWZ1bmN0aW9uIGplKGUsdCl7aWYoIm51bWJlciIhPXR5cGVvZiBlKXJldHVybiExO3JldHVybiAwPT09KGUmQ2UodCkpfWZ1bmN0aW9uIERlKGUsdCl7aWYoIm51bWJlciIhPXR5cGVvZiBlKXJldHVybiExO3JldHVybiAwIT09KGUmQ2UodCkpfWZ1bmN0aW9uIGtlKGUsdCl7aWYoIm51bWJlciIhPXR5cGVvZiBlKXJldHVybiExO2NvbnN0IG49Q2UodCk7cmV0dXJuKGUmbikhPT1ufWZ1bmN0aW9uIFBlKGUsdCl7aWYodC50eXBlKXtjb25zdCBuPU4oZSk/ImFycmF5IjpudWxsPT09ZT8ibnVsbCI6dHlwZW9mIGU7aWYodC50eXBlIT09bilyZXR1cm4hMX1pZih0LnJlcXVpcmVkJiZOKHQucmVxdWlyZWQpKWZvcihsZXQgbj0wO248dC5yZXF1aXJlZC5sZW5ndGg7bisrKWlmKCEodC5yZXF1aXJlZFtuXWluIGUpKXJldHVybiExO2lmKHQucHJvcGVydGllcylmb3IoY29uc3QgbiBpbiB0LnByb3BlcnRpZXMpe2lmKCEobiBpbiBlKSlyZXR1cm4hMTtjb25zdCByPXQucHJvcGVydGllc1tuXTtpZighUGUoZVtuXSxyKSlyZXR1cm4hMX1pZih2b2lkIDAhPT10Lm1pbmltdW0mJiJudW1iZXIiPT10eXBlb2YgZSYmZTx0Lm1pbmltdW0pcmV0dXJuITE7aWYodm9pZCAwIT09dC5tYXhpbXVtJiYibnVtYmVyIj09dHlwZW9mIGUmJmU+dC5tYXhpbXVtKXJldHVybiExO2lmKHZvaWQgMCE9PXQubWluTGVuZ3RoJiYic3RyaW5nIj09dHlwZW9mIGUmJmUubGVuZ3RoPHQubWluTGVuZ3RoKXJldHVybiExO2lmKHZvaWQgMCE9PXQubWF4TGVuZ3RoJiYic3RyaW5nIj09dHlwZW9mIGUmJmUubGVuZ3RoPnQubWF4TGVuZ3RoKXJldHVybiExO2lmKHQucGF0dGVybiYmInN0cmluZyI9PXR5cGVvZiBlKXtpZighbmV3IFJlZ0V4cCh0LnBhdHRlcm4pLnRlc3QoZSkpcmV0dXJuITF9cmV0dXJuISh0LmVudW0mJk4odC5lbnVtKSYmIXQuZW51bS5pbmNsdWRlcyhlKSl9ZnVuY3Rpb24gTWUoZSx0KXtyZXR1cm4gZSBpbnN0YW5jZW9mIGcmJnQgaW5zdGFuY2VvZiBnP2UuZXF1YWxzKHQpOmU9PXR9ZnVuY3Rpb24gTGUoZSx0LG4pe2xldCByPWUsaT10O3N3aXRjaChlIGluc3RhbmNlb2YgZyYmKHI9ZS50b1N0cmluZygpKSx0IGluc3RhbmNlb2YgZyYmKGk9dC50b1N0cmluZygpKSxuKXtjYXNlIj4iOnJldHVybiByPmk7Y2FzZSI+PSI6cmV0dXJuIHI+PWk7Y2FzZSI8IjpyZXR1cm4gcjxpO2Nhc2UiPD0iOnJldHVybiByPD1pO2RlZmF1bHQ6cmV0dXJuITF9fWZ1bmN0aW9uIEZlKGUsdCl7aWYodm9pZCAwPT09ZSlyZXR1cm4hMTtpZihudWxsPT09ZSlyZXR1cm4gdChlKTtpZihOKGUpKXtmb3IodmFyIG49MDtuPGUubGVuZ3RoO24rKylpZih0KGVbbl0pKXJldHVybiEwO3JldHVybiExfXJldHVybiB0KGUpfWZ1bmN0aW9uIFRlKGUpe2lmKCJzdHJpbmciIT10eXBlb2YgZSlyZXR1cm5bXTtyZXR1cm4gdmUoZSkubWFwKGU9PndlKGUpKX1mdW5jdGlvbiBCZShlLHQpe2lmKCJzdHJpbmciIT10eXBlb2YgZSlyZXR1cm4hMTtjb25zdCBuPW5ldyBTZXQoVGUoZSkpO3JldHVybiBUZSh0KS5zb21lKGU9Pm4uaGFzKGUpKX1mdW5jdGlvbiB6ZShlLHQpe3RyeXtpZighQXJyYXkuaXNBcnJheSh0KXx8MiE9PXQubGVuZ3RoKXJldHVybiExO2NvbnN0IG49dFswXVswXSxyPXRbMF1bMV0saT10WzFdWzBdO3JldHVybiBVZShlLG4saSx0WzFdWzFdLHIpfWNhdGNoKG4pe3JldHVybiExfX1mdW5jdGlvbiBVZShlLHQsbixyLGkpe2lmKCFlKXJldHVybiExO2lmKCJGZWF0dXJlQ29sbGVjdGlvbiI9PT1lLnR5cGUmJmUuZmVhdHVyZXMmJmUuZmVhdHVyZXMubGVuZ3RoPjApe2Zvcihjb25zdCBzIG9mIGUuZmVhdHVyZXMpaWYocy5nZW9tZXRyeSYmIVVlKHMuZ2VvbWV0cnksdCxuLHIsaSkpcmV0dXJuITE7cmV0dXJuITB9aWYoIkZlYXR1cmUiPT09ZS50eXBlJiZlLmdlb21ldHJ5KXJldHVybiBVZShlLmdlb21ldHJ5LHQsbixyLGkpO2lmKCJQb2ludCI9PT1lLnR5cGUmJmUuY29vcmRpbmF0ZXMpe2NvbnN0W3Msb109ZS5jb29yZGluYXRlcztpZigibnVtYmVyIj09dHlwZW9mIHMmJiJudW1iZXIiPT10eXBlb2YgbylyZXR1cm4gcz49dCYmczw9biYmbz49ciYmbzw9aX1pZigiUG9seWdvbiI9PT1lLnR5cGUmJmUuY29vcmRpbmF0ZXMmJmUuY29vcmRpbmF0ZXMubGVuZ3RoPjApe2Zvcihjb25zdCBzIG9mIGUuY29vcmRpbmF0ZXMpZm9yKGNvbnN0IGUgb2Ygcyl7Y29uc3Qgcz1lWzBdLG89ZVsxXTtpZihzPHR8fHM+bnx8bzxyfHxvPmkpcmV0dXJuITF9cmV0dXJuITB9cmV0dXJuITF9ZnVuY3Rpb24gUmUoZSl7aWYoIWUpcmV0dXJuIG51bGw7aWYoIkZlYXR1cmVDb2xsZWN0aW9uIj09PWUudHlwZSYmZS5mZWF0dXJlcyYmZS5mZWF0dXJlcy5sZW5ndGg+MCl7Y29uc3QgdD1lLmZlYXR1cmVzWzBdO2lmKHQuZ2VvbWV0cnkpcmV0dXJuIFJlKHQuZ2VvbWV0cnkpfWlmKCJGZWF0dXJlIj09PWUudHlwZSYmZS5nZW9tZXRyeSlyZXR1cm4gUmUoZS5nZW9tZXRyeSk7aWYoIlBvaW50Ij09PWUudHlwZSYmZS5jb29yZGluYXRlcyl7Y29uc3RbdCxuXT1lLmNvb3JkaW5hdGVzO2lmKCJudW1iZXIiPT10eXBlb2YgdCYmIm51bWJlciI9PXR5cGVvZiBuKXJldHVybntsYXQ6bixsbmc6dH19aWYoIlBvbHlnb24iPT09ZS50eXBlJiZlLmNvb3JkaW5hdGVzJiZlLmNvb3JkaW5hdGVzLmxlbmd0aD4wKXtjb25zdCB0PWUuY29vcmRpbmF0ZXNbMF07aWYodC5sZW5ndGg+MCl7bGV0IGU9MCxuPTA7Zm9yKGNvbnN0IHIgb2YgdCluKz1yWzBdLGUrPXJbMV07cmV0dXJue2xhdDplL3QubGVuZ3RoLGxuZzpuL3QubGVuZ3RofX19cmV0dXJuIG51bGx9ZnVuY3Rpb24gcWUoZSx0LG4scil7Y29uc3QgaT0obi1lKSpNYXRoLlBJLzE4MCxzPShyLXQpKk1hdGguUEkvMTgwLG89TWF0aC5zaW4oaS8yKSpNYXRoLnNpbihpLzIpK01hdGguY29zKGUqTWF0aC5QSS8xODApKk1hdGguY29zKG4qTWF0aC5QSS8xODApKk1hdGguc2luKHMvMikqTWF0aC5zaW4ocy8yKTtyZXR1cm4gNjM3MSooMipNYXRoLmF0YW4yKE1hdGguc3FydChvKSxNYXRoLnNxcnQoMS1vKSkpfWZ1bmN0aW9uIFZlKGUsdCxuLHIpe2NvbnN0IGk9UmUoZSk7aWYoIWkpcmV0dXJuITE7cmV0dXJuIDFlMypxZShpLmxhdCxpLmxuZyxuLHQpPD1yfWZ1bmN0aW9uIEhlKGUsdCl7aWYoIWV8fCF0KXJldHVybiExO2NvbnN0IG49UmUodCk7aWYoIW4pcmV0dXJuITE7Y29uc3Qgcj1SZShlKTtpZighcilyZXR1cm4hMTtpZigiUG9seWdvbiI9PT10LnR5cGUmJiJQb2ludCI9PT1lLnR5cGUpcmV0dXJuIFdlKHIubG5nLHIubGF0LHQuY29vcmRpbmF0ZXNbMF0pO2lmKCJQb2x5Z29uIj09PWUudHlwZSYmIlBvaW50Ij09PXQudHlwZSl7Y29uc3Qgbj10LmNvb3JkaW5hdGVzO3JldHVybiBXZShuWzBdLG5bMV0sZS5jb29yZGluYXRlc1swXSl9aWYoIlBvaW50Ij09PWUudHlwZSYmIlBvaW50Ij09PXQudHlwZSl7cmV0dXJuIHFlKHIubGF0LHIubG5nLG4ubGF0LG4ubG5nKTwuMDAxfXJldHVybiExfWZ1bmN0aW9uIFdlKGUsdCxuKXtsZXQgcj0hMTtmb3IobGV0IGk9MCxzPW4ubGVuZ3RoLTE7aTxuLmxlbmd0aDtzPWkrKyl7Y29uc3Qgbz1uW2ldWzBdLGE9bltpXVsxXSxjPW5bc11bMF0sbD1uW3NdWzFdO2E+dCE9bD50JiZlPChjLW8pKih0LWEpLyhsLWEpK28mJihyPSFyKX1yZXR1cm4gcn1mdW5jdGlvbiBRZShlLHQpe2lmKCJmdW5jdGlvbiI9PXR5cGVvZiB0KXRyeXtyZXR1cm4gdC5jYWxsKGUpfWNhdGNoKG4pe3JldHVybiExfWVsc2UgaWYoInN0cmluZyI9PXR5cGVvZiB0KXRyeXtyZXR1cm4gbmV3IEZ1bmN0aW9uKCJyZXR1cm4gIit0KS5jYWxsKGUpfWNhdGNoKG4pe3JldHVybiExfXJldHVybiExfWZ1bmN0aW9uIEplKGUsdCl7dmFyIG49T2JqZWN0LmtleXModClbMF0scj10W25dO2lmKCIkIiE9bi5jaGFyQXQoMCkpcmV0dXJuIEtlKGUsbixyKTtpZigiJGFuZCI9PW4pcmV0dXJuIEdlKGUscik7aWYoIiRvciI9PW4pcmV0dXJuIGZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuPTA7bjx0Lmxlbmd0aDtuKyspaWYoSmUoZSx0W25dKSlyZXR1cm4hMDtyZXR1cm4hMX0oZSxyKTtpZigiJG5vdCI9PW4pcmV0dXJuIGZ1bmN0aW9uKGUsdCl7cmV0dXJuIUplKGUsdCl9KGUscik7aWYoIiRub3IiPT1uKXJldHVybiBmdW5jdGlvbihlLHQpe2Zvcih2YXIgbj0wO248dC5sZW5ndGg7bisrKWlmKEplKGUsdFtuXSkpcmV0dXJuITE7cmV0dXJuITB9KGUscik7aWYoIiR3aGVyZSI9PW4pcmV0dXJuIFFlKGUscik7aWYoIiRjb21tZW50Ij09bilyZXR1cm4hMDtpZigiJGpzb25TY2hlbWEiPT1uKXJldHVybiBQZShlLHIpO2lmKCIkdGV4dCI9PW4pe3JldHVybiBmdW5jdGlvbihlLHQpe3JldHVybiEoIWV8fCJvYmplY3QiIT10eXBlb2YgZSkmJmZ1bmN0aW9uIGUobil7aWYoInN0cmluZyI9PXR5cGVvZiBuKXJldHVybiBCZShuLHQpO2lmKCJvYmplY3QiIT10eXBlb2Ygbnx8bnVsbD09PW4pcmV0dXJuITE7aWYoTihuKSl7Zm9yKGxldCB0PTA7dDxuLmxlbmd0aDt0KyspaWYoZShuW3RdKSlyZXR1cm4hMDtyZXR1cm4hMX1mb3IoY29uc3QgdCBpbiBuKWlmKG4uaGFzT3duUHJvcGVydHkodCkmJmUoblt0XSkpcmV0dXJuITA7cmV0dXJuITF9KGUpfShlLHIuJHNlYXJjaHx8cil9aWYoIiRleHByIiE9bil0aHJvd3skZXJyOiJDYW4ndCBjYW5vbmljYWxpemUgcXVlcnk6IEJhZFZhbHVlIHVua25vd24gdG9wIGxldmVsIG9wZXJhdG9yOiAiK24sY29kZToxNzI4N307dHJ5e3JldHVybiBJZShyLGUpfWNhdGNoKGkpe3JldHVybiExfX1mdW5jdGlvbiBLZShlLHQsbil7dmFyIHI9JChlLHQpO2lmKCJzdHJpbmciPT10eXBlb2YgbilyZXR1cm4gRmUocixmdW5jdGlvbihlKXtyZXR1cm4gTWUoZSxuKX0pO2lmKCJudW1iZXIiPT10eXBlb2YgbilyZXR1cm4gRmUocixmdW5jdGlvbihlKXtyZXR1cm4gTWUoZSxuKX0pO2lmKCJib29sZWFuIj09dHlwZW9mIG4pcmV0dXJuIEZlKHIsZnVuY3Rpb24oZSl7cmV0dXJuIE1lKGUsbil9KTtpZihuIGluc3RhbmNlb2YgZylyZXR1cm4gRmUocixmdW5jdGlvbihlKXtyZXR1cm4gTWUoZSxuKX0pO2lmKCJvYmplY3QiPT10eXBlb2Ygbil7aWYobiBpbnN0YW5jZW9mIFJlZ0V4cClyZXR1cm4gbnVsbCE9ciYmRmUocixmdW5jdGlvbihlKXtyZXR1cm4gZSYmZS5tYXRjaChuKX0pO2lmKE4obikpcmV0dXJuIG51bGwhPXImJkZlKHIsZnVuY3Rpb24oZSl7cmV0dXJuIGUmJkEoZSxuKX0pO3ZhciBpPU9iamVjdC5rZXlzKG4pO2lmKCIkIj09aVswXS5jaGFyQXQoMCkpe2Zvcih2YXIgcz0wO3M8aS5sZW5ndGg7cysrKXt2YXIgbz1PYmplY3Qua2V5cyhuKVtzXSxhPW5bb107aWYoIiRlcSI9PW8pe2lmKCFGZShyLGZ1bmN0aW9uKGUpe3JldHVybiBNZShlLGEpfSkpcmV0dXJuITF9ZWxzZSBpZigiJGd0Ij09byl7aWYoIUZlKHIsZnVuY3Rpb24oZSl7cmV0dXJuIExlKGUsYSwiPiIpfSkpcmV0dXJuITF9ZWxzZSBpZigiJGd0ZSI9PW8pe2lmKCFGZShyLGZ1bmN0aW9uKGUpe3JldHVybiBMZShlLGEsIj49Iil9KSlyZXR1cm4hMX1lbHNlIGlmKCIkbHQiPT1vKXtpZighRmUocixmdW5jdGlvbihlKXtyZXR1cm4gTGUoZSxhLCI8Iil9KSlyZXR1cm4hMX1lbHNlIGlmKCIkbHRlIj09byl7aWYoIUZlKHIsZnVuY3Rpb24oZSl7cmV0dXJuIExlKGUsYSwiPD0iKX0pKXJldHVybiExfWVsc2UgaWYoIiRuZSI9PW8pe2lmKCFGZShyLGZ1bmN0aW9uKGUpe3JldHVybiFNZShlLGEpfSkpcmV0dXJuITF9ZWxzZSBpZigiJGluIj09byl7aWYoIUZlKHIsZnVuY3Rpb24oZSl7cmV0dXJuIE8oZSxhKX0pKXJldHVybiExfWVsc2UgaWYoIiRuaW4iPT1vKXtpZihGZShyLGZ1bmN0aW9uKGUpe3JldHVybiBPKGUsYSl9KSlyZXR1cm4hMX1lbHNlIGlmKCIkZXhpc3RzIj09byl7dmFyIGM9dihlLHQpO2lmKGE/bnVsbD09YzpudWxsIT1jKXJldHVybiExfWVsc2UgaWYoIiR0eXBlIj09byl7aWYodm9pZCAwPT09cil7aWYoNiE9PSgibnVtYmVyIj09dHlwZW9mIGE/YTpPZVthXSkpcmV0dXJuITF9ZWxzZSBpZighQWUocixhKSlyZXR1cm4hMX1lbHNlIGlmKCIkbW9kIj09byl7aWYoMiE9YS5sZW5ndGgpdGhyb3d7JGVycjoiQ2FuJ3QgY2Fub25pY2FsaXplIHF1ZXJ5OiBCYWRWYWx1ZSBtYWxmb3JtZWQgbW9kLCBub3QgZW5vdWdoIGVsZW1lbnRzIixjb2RlOjE3Mjg3fTtpZighRmUocixmdW5jdGlvbihlKXtyZXR1cm4gbnVsbCE9ZSYmZSVhWzBdPT1hWzFdfSkpcmV0dXJuITF9ZWxzZSBpZigiJHJlZ2V4Ij09byl7dmFyIGw9YSx1PW4uJG9wdGlvbnN8fCIiLGg9InN0cmluZyI9PXR5cGVvZiBsP25ldyBSZWdFeHAobCx1KTpsO2lmKCFGZShyLGZ1bmN0aW9uKGUpe3JldHVybiBudWxsIT1lJiZoLnRlc3QoZSl9KSlyZXR1cm4hMX1lbHNle2lmKCIkb3B0aW9ucyI9PW8pY29udGludWU7aWYoIiR0ZXh0Ij09byl7aWYoIUZlKHIsZnVuY3Rpb24oZSl7cmV0dXJuIG51bGwhPWUmJkJlKGUsYSl9KSlyZXR1cm4hMX1lbHNlIGlmKCIkZXhwciI9PW8pdHJ5e2lmKCFJZShhLGUpKXJldHVybiExfWNhdGNoKFMpe3JldHVybiExfWVsc2UgaWYoIiRnZW9XaXRoaW4iPT1vKXtpZighRmUocixmdW5jdGlvbihlKXtyZXR1cm4gbnVsbCE9ZSYmemUoZSxhKX0pKXJldHVybiExfWVsc2UgaWYoIiRuZWFyIj09b3x8IiRuZWFyU3BoZXJlIj09byl7bGV0IGU7aWYoYS4kZ2VvbWV0cnk/ZT1hLiRnZW9tZXRyeS5jb29yZGluYXRlczphLmNvb3JkaW5hdGVzP2U9YS5jb29yZGluYXRlczpBcnJheS5pc0FycmF5KGEpJiYoZT1hKSwhKGUmJmUubGVuZ3RoPj0yKSlyZXR1cm4hMTt7Y29uc3RbdCxuXT1lLGk9YS4kbWF4RGlzdGFuY2V8fDFlNjtpZighRmUocixmdW5jdGlvbihlKXtyZXR1cm4gbnVsbCE9ZSYmVmUoZSx0LG4saSl9KSlyZXR1cm4hMX19ZWxzZSBpZigiJGdlb0ludGVyc2VjdHMiPT1vKXtjb25zdCBlPWEuJGdlb21ldHJ5fHxhO2lmKCFGZShyLGZ1bmN0aW9uKHQpe3JldHVybiBudWxsIT10JiZIZSh0LGUpfSkpcmV0dXJuITF9ZWxzZSBpZigiJG5vdCI9PW8pe2lmKEtlKGUsdCxhKSlyZXR1cm4hMX1lbHNlIGlmKCIkYWxsIj09byl7aWYobnVsbD09KGQ9dihlLHQpKXx8IU4oZCkpcmV0dXJuITE7Zm9yKHZhciBmPTA7ZjxhLmxlbmd0aDtmKyspaWYoIU8oYVtmXSxkKSlyZXR1cm4hMX1lbHNlIGlmKCIkZWxlbU1hdGNoIj09byl7dmFyIGQ7aWYobnVsbD09KGQ9dihlLHQpKXx8IU4oZCkpcmV0dXJuITE7dmFyIHA9ITE7Zm9yKGY9MDtmPGQubGVuZ3RoO2YrKyl7dmFyIG09ZFtmXTtpZigib2JqZWN0IiE9dHlwZW9mIG18fE4obSkpe2Zvcih2YXIgeT0hMCx3PU9iamVjdC5rZXlzKGEpLGI9MDtiPHcubGVuZ3RoO2IrKyl7dmFyIHg9d1tiXSxfPWFbeF07KCIkZ3RlIiE9eHx8bT49XykmJigiJGd0IiE9eHx8bT5fKSYmKCIkbHRlIiE9eHx8bTw9XykmJigiJGx0IiE9eHx8bTxfKT8iJGVxIj09eCYmbSE9X3x8IiRuZSI9PXgmJm09PV8/eT0hMToiJGluIiE9eHx8TyhtLF8pPyIkbmluIj09eCYmTyhtLF8pJiYoeT0hMSk6eT0hMTp5PSExfWlmKHkpe3A9ITA7YnJlYWt9fWVsc2UgaWYoWWUobSxhKSl7cD0hMDticmVha319aWYoIXApcmV0dXJuITF9ZWxzZSBpZigiJHNpemUiPT1vKXt2YXIgST12KGUsdCk7aWYobnVsbD09SXx8IU4oSSkpcmV0dXJuITE7aWYoSS5sZW5ndGghPWEpcmV0dXJuITF9ZWxzZSBpZigiJGJpdHNBbGxTZXQiPT1vKXtpZighRmUocixmdW5jdGlvbihlKXtyZXR1cm4gRWUoZSxhKX0pKXJldHVybiExfWVsc2UgaWYoIiRiaXRzQWxsQ2xlYXIiPT1vKXtpZighRmUocixmdW5jdGlvbihlKXtyZXR1cm4gamUoZSxhKX0pKXJldHVybiExfWVsc2UgaWYoIiRiaXRzQW55U2V0Ij09byl7aWYoIUZlKHIsZnVuY3Rpb24oZSl7cmV0dXJuIERlKGUsYSl9KSlyZXR1cm4hMX1lbHNle2lmKCIkYml0c0FueUNsZWFyIiE9byl0aHJvd3skZXJyOiJDYW4ndCBjYW5vbmljYWxpemUgcXVlcnk6IEJhZFZhbHVlIHVua25vd24gb3BlcmF0b3I6ICIrbyxjb2RlOjE3Mjg3fTtpZighRmUocixmdW5jdGlvbihlKXtyZXR1cm4ga2UoZSxhKX0pKXJldHVybiExfX19cmV0dXJuITB9cmV0dXJuIHYoZSx0KSYmQyh2KGUsdCksbil9fWZ1bmN0aW9uIEdlKGUsdCl7Zm9yKHZhciBuPTA7bjx0Lmxlbmd0aDtuKyspaWYoIUplKGUsdFtuXSkpcmV0dXJuITE7cmV0dXJuITB9ZnVuY3Rpb24gWWUoZSx0KXtyZXR1cm4gR2UoZSxTKHQpKX1mdW5jdGlvbiBYZShlLHQpe2NvbnN0IG49e307cmV0dXJue21hdGNoZWQ6WmUoZSxTKHQpLG4pLGFycmF5RmlsdGVyczpufX1mdW5jdGlvbiBaZShlLHQsbil7Zm9yKHZhciByPTA7cjx0Lmxlbmd0aDtyKyspaWYoIWV0KGUsdFtyXSxuKSlyZXR1cm4hMTtyZXR1cm4hMH1mdW5jdGlvbiBldChlLHQsbil7dmFyIHI9T2JqZWN0LmtleXModClbMF0saT10W3JdO2lmKCIkIiE9ci5jaGFyQXQoMCkpcmV0dXJuIGZ1bmN0aW9uKGUsdCxuLHIpe2NvbnN0IGk9dC5zcGxpdCgiLiIpWzBdLHM9JChlLHQpLG89KG4scyk9PntpZih2b2lkIDA9PT1uKXJldHVybiExO2lmKG51bGw9PT1uKXJldHVybiBzKG4pO2lmKE4obikpe2lmKE4odihlLGkpKSl7Zm9yKHZhciBvPTA7bzxuLmxlbmd0aDtvKyspaWYocyhuW29dKSlyZXR1cm4gclt0XT1vLCEwO3JldHVybiExfX1yZXR1cm4gRmUobixzKX07aWYoInN0cmluZyI9PXR5cGVvZiBuKXJldHVybiBvKHMsZnVuY3Rpb24oZSl7cmV0dXJuIE1lKGUsbil9KTtpZigibnVtYmVyIj09dHlwZW9mIG4pcmV0dXJuIG8ocyxmdW5jdGlvbihlKXtyZXR1cm4gTWUoZSxuKX0pO2lmKCJib29sZWFuIj09dHlwZW9mIG4pcmV0dXJuIG8ocyxmdW5jdGlvbihlKXtyZXR1cm4gTWUoZSxuKX0pO2lmKG4gaW5zdGFuY2VvZiBnKXJldHVybiBvKHMsZnVuY3Rpb24oZSl7cmV0dXJuIE1lKGUsbil9KTtpZigib2JqZWN0Ij09dHlwZW9mIG4pe2lmKG4gaW5zdGFuY2VvZiBSZWdFeHApcmV0dXJuIG51bGwhPXMmJm8ocyxmdW5jdGlvbihlKXtyZXR1cm4gZSYmZS5tYXRjaChuKX0pO2lmKE4obikpcmV0dXJuIG51bGwhPXMmJm8ocyxmdW5jdGlvbihlKXtyZXR1cm4gZSYmQShlLG4pfSk7dmFyIGE9T2JqZWN0LmtleXMobik7aWYoIiQiPT1hWzBdLmNoYXJBdCgwKSl7Zm9yKHZhciBjPTA7YzxhLmxlbmd0aDtjKyspe3ZhciBsPWFbY10sdT1uW2xdO2lmKCIkZXEiPT1sKXtpZighbyhzLGZ1bmN0aW9uKGUpe3JldHVybiBNZShlLHUpfSkpcmV0dXJuITF9ZWxzZSBpZigiJGd0Ij09bCl7aWYoIW8ocyxmdW5jdGlvbihlKXtyZXR1cm4gTGUoZSx1LCI+Iil9KSlyZXR1cm4hMX1lbHNlIGlmKCIkZ3RlIj09bCl7aWYoIW8ocyxmdW5jdGlvbihlKXtyZXR1cm4gTGUoZSx1LCI+PSIpfSkpcmV0dXJuITF9ZWxzZSBpZigiJGx0Ij09bCl7aWYoIW8ocyxmdW5jdGlvbihlKXtyZXR1cm4gTGUoZSx1LCI8Iil9KSlyZXR1cm4hMX1lbHNlIGlmKCIkbHRlIj09bCl7aWYoIW8ocyxmdW5jdGlvbihlKXtyZXR1cm4gTGUoZSx1LCI8PSIpfSkpcmV0dXJuITF9ZWxzZSBpZigiJG5lIj09bCl7aWYoIW8ocyxmdW5jdGlvbihlKXtyZXR1cm4hTWUoZSx1KX0pKXJldHVybiExfWVsc2UgaWYoIiRpbiI9PWwpe2lmKCFvKHMsZnVuY3Rpb24oZSl7cmV0dXJuIE8oZSx1KX0pKXJldHVybiExfWVsc2UgaWYoIiRuaW4iPT1sKXtpZihvKHMsZnVuY3Rpb24oZSl7cmV0dXJuIE8oZSx1KX0pKXJldHVybiExfWVsc2V7aWYoIiRlbGVtTWF0Y2giPT1sKXt2YXIgaD12KGUsdCk7aWYobnVsbD09aHx8IU4oaCkpcmV0dXJuITE7Zm9yKHZhciBmPTA7ZjxoLmxlbmd0aDtmKyspe3ZhciBkPWhbZl07aWYoIm9iamVjdCIhPXR5cGVvZiBkfHxOKGQpKXtmb3IodmFyIHA9ITAsbT1PYmplY3Qua2V5cyh1KSx5PTA7eTxtLmxlbmd0aDt5Kyspe3ZhciB3PW1beV0sYj11W3ddOygiJGd0ZSIhPXd8fGQ+PWIpJiYoIiRndCIhPXd8fGQ+YikmJigiJGx0ZSIhPXd8fGQ8PWIpJiYoIiRsdCIhPXd8fGQ8Yik/KCIkZXEiPT13JiZkIT1ifHwiJG5lIj09dyYmZD09YikmJihwPSExKTpwPSExfWlmKHApcmV0dXJuIHJbdF09ZiwhMH1lbHNlIGlmKFllKGQsdSkpcmV0dXJuIHJbdF09ZiwhMH1yZXR1cm4hMX1pZighS2UoZSx0LG4pKXJldHVybiExfX1yZXR1cm4hMH1yZXR1cm4gbnVsbCE9cyYmbyhzLGZ1bmN0aW9uKGUpe3JldHVybiBDKGUsbil9KX1yZXR1cm4hMX0oZSxyLGksbik7aWYoIiRhbmQiPT1yKXJldHVybiBaZShlLGksbik7aWYoIiRvciI9PXIpcmV0dXJuIGZ1bmN0aW9uKGUsdCxuKXtmb3IodmFyIHI9MDtyPHQubGVuZ3RoO3IrKylpZihldChlLHRbcl0sbikpcmV0dXJuITA7cmV0dXJuITF9KGUsaSxuKTtpZigiJG5vdCI9PXIpcmV0dXJuIUplKGUsaSk7aWYoIiRub3IiPT1yKXJldHVybiBmdW5jdGlvbihlLHQsbil7Zm9yKHZhciByPTA7cjx0Lmxlbmd0aDtyKyspaWYoZXQoZSx0W3JdLG4pKXJldHVybiExO3JldHVybiEwfShlLGksbik7aWYoIiR3aGVyZSI9PXIpcmV0dXJuIFFlKGUsaSk7aWYoIiRjb21tZW50Ij09cilyZXR1cm4hMDtpZigiJGpzb25TY2hlbWEiPT1yKXJldHVybiBQZShlLGkpO2lmKCIkZXhwciIhPXIpdGhyb3d7JGVycjoiQ2FuJ3QgY2Fub25pY2FsaXplIHF1ZXJ5OiBCYWRWYWx1ZSB1bmtub3duIHRvcCBsZXZlbCBvcGVyYXRvcjogIityLGNvZGU6MTcyODd9O3RyeXtyZXR1cm4gSWUoaSxlKX1jYXRjaChzKXtyZXR1cm4hMX19ZnVuY3Rpb24gdHQoZSl7cmV0dXJuIGUuc3BsaXQoIi4iKS5tYXAoZT0+e2NvbnN0IHQ9ZnVuY3Rpb24oZSl7Y29uc3QgdD1lLm1hdGNoKC9eXCRcWyhbXlxdXSspXF0kLyk7cmV0dXJuIHQ/dFsxXTpudWxsfShlKTtyZXR1cm57c2VnbWVudDplLGlzRmlsdGVyZWRQb3NpdGlvbmFsOm51bGwhPT10LGlkZW50aWZpZXI6dH19KX1mdW5jdGlvbiBudChlLHQsbixyLGkpeyFmdW5jdGlvbiBlKHMsbyxhKXtpZihvPj10Lmxlbmd0aClyZXR1cm47Y29uc3QgYz10W29dLGw9bz09PXQubGVuZ3RoLTE7aWYoYy5pc0ZpbHRlcmVkUG9zaXRpb25hbCl7Y29uc3QgYT1jLmlkZW50aWZpZXIsdT1pP2kuZmluZChlPT5PYmplY3Qua2V5cyhlKS5zb21lKGU9PmUuc3RhcnRzV2l0aChhKyIuIil8fGU9PT1hKSk6bnVsbDtpZighaSl7aWYoIXNbYy5zZWdtZW50XSl7Y29uc3QgZT10W28rMV07ZSYmZS5pc0ZpbHRlcmVkUG9zaXRpb25hbD9zW2Muc2VnbWVudF09W106c1tjLnNlZ21lbnRdPXt9fXJldHVybiB2b2lkKGw/cnQocyxjLnNlZ21lbnQsbixyKTplKHNbYy5zZWdtZW50XSxvKzEpKX1pZighTihzKSlyZXR1cm4gc1tjLnNlZ21lbnRdfHwoc1tjLnNlZ21lbnRdPXt9KSx2b2lkKGw/cnQocyxjLnNlZ21lbnQsbixyKTplKHNbYy5zZWdtZW50XSxvKzEpKTtmb3IobGV0IHQ9MDt0PHMubGVuZ3RoO3QrKyl7Y29uc3QgaT1zW3RdO2xldCBjPSEwO2lmKHUpe2xldCBlPXt9LHQ9ITE7aWYoT2JqZWN0LmtleXModSkuZm9yRWFjaChuPT57aWYobi5zdGFydHNXaXRoKGErIi4iKSl7Y29uc3QgdD1uLnN1YnN0cmluZyhhLmxlbmd0aCsxKTtlW3RdPXVbbl19ZWxzZSBuPT09YSYmKGU9dVtuXSx0PSEwKX0pLHQpe2M9WWUoe3ZhbHVlOml9LHt2YWx1ZTplfSl9ZWxzZSBjPVllKGksZSl9YyYmKGw/cnQocyx0LG4scik6bnVsbCE9aSYmZShzW3RdLG8rMSkpfX1lbHNle2lmKCh2b2lkIDA9PT1zW2Muc2VnbWVudF18fG51bGw9PT1zW2Muc2VnbWVudF0pJiYhbCl7Y29uc3QgZT10W28rMV07ZSYmZS5pc0ZpbHRlcmVkUG9zaXRpb25hbD9zW2Muc2VnbWVudF09W106c1tjLnNlZ21lbnRdPXt9fWw/cnQocyxjLnNlZ21lbnQsbixyKTp2b2lkIDAhPT1zW2Muc2VnbWVudF0mJm51bGwhPT1zW2Muc2VnbWVudF0mJmUoc1tjLnNlZ21lbnRdLG8rMSl9fShlLDApfWZ1bmN0aW9uIHJ0KGUsdCxuLHIpe3N3aXRjaChyKXtjYXNlIiRzZXQiOmRlZmF1bHQ6ZVt0XT1uO2JyZWFrO2Nhc2UiJGluYyI6dm9pZCAwPT09ZVt0XSYmKGVbdF09MCksZVt0XSs9bjticmVhaztjYXNlIiRtdWwiOmVbdF09ZVt0XSpuO2JyZWFrO2Nhc2UiJG1pbiI6ZVt0XT1NYXRoLm1pbihlW3RdLG4pO2JyZWFrO2Nhc2UiJG1heCI6ZVt0XT1NYXRoLm1heChlW3RdLG4pO2JyZWFrO2Nhc2UiJHVuc2V0IjpkZWxldGUgZVt0XX19ZnVuY3Rpb24gaXQoZSl7cmV0dXJuL1wkXFtbXlxdXStcXS8udGVzdChlKX1mdW5jdGlvbiBzdChlKXtyZXR1cm4tMSE9PWUuaW5kZXhPZigiJFtdIil9ZnVuY3Rpb24gb3QoZSx0LG4pe2Zvcih2YXIgcj10LnNwbGl0KCIuIiksaT1lLHM9MDtzPHIubGVuZ3RoO3MrKyl7dmFyIG89cltzXTtpZigiJFtdIj09PW8pe2lmKCFBcnJheS5pc0FycmF5KGkpKXJldHVybjtmb3IodmFyIGE9ci5zbGljZShzKzEpLmpvaW4oIi4iKSxjPTA7YzxpLmxlbmd0aDtjKyspaWYoYSlpZigtMSE9PWEuaW5kZXhPZigiJFtdIikpb3QoaVtjXSxhLG4pO2Vsc2V7dmFyIGw9bih2KGlbY10sYSkpO0koaVtjXSxhLGwpfWVsc2UgaVtjXT1uKGlbY10pO3JldHVybn1pZihudWxsPT1pfHxudWxsPT1pKXJldHVybjtpPWlbb119fWZ1bmN0aW9uIGF0KGUsdCl7aWYoIXR8fCFlLmluY2x1ZGVzKCIkIikpcmV0dXJuIGU7Y29uc3Qgbj1lLnNwbGl0KCIuIikscj1uLmluZGV4T2YoIiQiKTtpZigtMT09PXIpcmV0dXJuIGU7Y29uc3QgaT1uLnNsaWNlKDAscikuam9pbigiLiIpO2xldCBzPW51bGw7Zm9yKGNvbnN0IG8gaW4gdClpZihvPT09aXx8by5zdGFydHNXaXRoKGkrIi4iKSl7cz10W29dO2JyZWFrfXJldHVybiBudWxsIT1zPyhuW3JdPXMudG9TdHJpbmcoKSxuLmpvaW4oIi4iKSk6ZX1mdW5jdGlvbiBjdChlLHQsbixyLGkpe2Zvcih2YXIgcz1PYmplY3Qua2V5cyhlKSxvPTA7bzxzLmxlbmd0aDtvKyspe3ZhciBhPXNbb10sYz1lW2FdO2lmKCIkaW5jIj09YSlmb3IodmFyIGw9T2JqZWN0LmtleXMoYyksdT0wO3U8bC5sZW5ndGg7dSsrKXt2YXIgaD1hdChsW3VdLHIpLGY9Y1tsW3VdXTtpZihpdChoKSl7aWYoIWkpdGhyb3cgbmV3IEVycm9yKCJhcnJheUZpbHRlcnMgb3B0aW9uIGlzIHJlcXVpcmVkIHdoZW4gdXNpbmcgZmlsdGVyZWQgcG9zaXRpb25hbCBvcGVyYXRvciAkWzxpZGVudGlmaWVyPl0iKTtudCh0LHR0KGgpLGYsIiRpbmMiLGkpfWVsc2UgaWYoc3QoaCkpb3QodCxoLGZ1bmN0aW9uKGUpe3JldHVybih2b2lkIDA9PT1lPzA6ZSkrZn0pO2Vsc2V7bnVsbD09KGQ9dih0LGgpKSYmKGQ9MCksSSh0LGgsZCtmKX19ZWxzZSBpZigiJG11bCI9PWEpZm9yKGw9T2JqZWN0LmtleXMoYyksdT0wO3U8bC5sZW5ndGg7dSsrKXtoPWF0KGxbdV0sciksZj1jW2xbdV1dO2lmKGl0KGgpKXtpZighaSl0aHJvdyBuZXcgRXJyb3IoImFycmF5RmlsdGVycyBvcHRpb24gaXMgcmVxdWlyZWQgd2hlbiB1c2luZyBmaWx0ZXJlZCBwb3NpdGlvbmFsIG9wZXJhdG9yICRbPGlkZW50aWZpZXI+XSIpO250KHQsdHQoaCksZiwiJG11bCIsaSl9ZWxzZSBpZihzdChoKSlvdCh0LGgsZnVuY3Rpb24oZSl7cmV0dXJuIGUqZn0pO2Vsc2V7bnVsbD09KGQ9dih0LGgpKSYmKGQ9MCksSSh0LGgsZCpmKX19ZWxzZSBpZigiJHJlbmFtZSI9PWEpZm9yKGw9T2JqZWN0LmtleXMoYyksdT0wO3U8bC5sZW5ndGg7dSsrKXtoPWF0KGxbdV0scik7dFthdChjW2xbdV1dLHIpXT10W2hdLGRlbGV0ZSB0W2hdfWVsc2UgaWYoIiRzZXRPbkluc2VydCI9PWEmJm4pZm9yKGw9T2JqZWN0LmtleXMoYyksdT0wO3U8bC5sZW5ndGg7dSsrKXt0W2g9YXQobFt1XSxyKV09Y1tsW3VdXX1lbHNlIGlmKCIkc2V0Ij09YSlmb3IobD1PYmplY3Qua2V5cyhjKSx1PTA7dTxsLmxlbmd0aDt1Kyspe2lmKGl0KGg9YXQobFt1XSxyKSkpe2lmKCFpKXRocm93IG5ldyBFcnJvcigiYXJyYXlGaWx0ZXJzIG9wdGlvbiBpcyByZXF1aXJlZCB3aGVuIHVzaW5nIGZpbHRlcmVkIHBvc2l0aW9uYWwgb3BlcmF0b3IgJFs8aWRlbnRpZmllcj5dIik7bnQodCx0dChoKSxjW2xbdV1dLCIkc2V0IixpKX1lbHNlIEkodCxoLGNbbFt1XV0pfWVsc2UgaWYoIiR1bnNldCI9PWEpZm9yKGw9T2JqZWN0LmtleXMoYyksdT0wO3U8bC5sZW5ndGg7dSsrKXtkZWxldGUgdFtoPWF0KGxbdV0scildfWVsc2UgaWYoIiRtaW4iPT1hKWZvcihsPU9iamVjdC5rZXlzKGMpLHU9MDt1PGwubGVuZ3RoO3UrKyl7aD1hdChsW3VdLHIpLGY9Y1tsW3VdXTtpZihpdChoKSl7aWYoIWkpdGhyb3cgbmV3IEVycm9yKCJhcnJheUZpbHRlcnMgb3B0aW9uIGlzIHJlcXVpcmVkIHdoZW4gdXNpbmcgZmlsdGVyZWQgcG9zaXRpb25hbCBvcGVyYXRvciAkWzxpZGVudGlmaWVyPl0iKTtudCh0LHR0KGgpLGYsIiRtaW4iLGkpfWVsc2UgaWYoc3QoaCkpb3QodCxoLGZ1bmN0aW9uKGUpe3JldHVybiBNYXRoLm1pbihlLGYpfSk7ZWxzZXt2YXIgZD12KHQsaCk7SSh0LGgsTWF0aC5taW4oZCxmKSl9fWVsc2UgaWYoIiRtYXgiPT1hKWZvcihsPU9iamVjdC5rZXlzKGMpLHU9MDt1PGwubGVuZ3RoO3UrKyl7aD1hdChsW3VdLHIpLGY9Y1tsW3VdXTtpZihpdChoKSl7aWYoIWkpdGhyb3cgbmV3IEVycm9yKCJhcnJheUZpbHRlcnMgb3B0aW9uIGlzIHJlcXVpcmVkIHdoZW4gdXNpbmcgZmlsdGVyZWQgcG9zaXRpb25hbCBvcGVyYXRvciAkWzxpZGVudGlmaWVyPl0iKTtudCh0LHR0KGgpLGYsIiRtYXgiLGkpfWVsc2UgaWYoc3QoaCkpb3QodCxoLGZ1bmN0aW9uKGUpe3JldHVybiBNYXRoLm1heChlLGYpfSk7ZWxzZXtkPXYodCxoKTtJKHQsaCxNYXRoLm1heChkLGYpKX19ZWxzZSBpZigiJGN1cnJlbnREYXRlIj09YSlmb3IobD1PYmplY3Qua2V5cyhjKSx1PTA7dTxsLmxlbmd0aDt1Kyspe2g9YXQobFt1XSxyKTt2YXIgcD1jW2xbdV1dOyEwPT09cHx8Im9iamVjdCI9PXR5cGVvZiBwJiZwLiR0eXBlLEkodCxoLC8qIEBfX1BVUkVfXyAqL25ldyBEYXRlKX1lbHNlIGlmKCIkYWRkVG9TZXQiPT1hKWZvcihsPU9iamVjdC5rZXlzKGMpLHU9MDt1PGwubGVuZ3RoO3UrKyl7aD1hdChsW3VdLHIpO3ZhciBnPWNbbFt1XV07KFA9dih0LGgpKSYmQXJyYXkuaXNBcnJheShQKSYmUC5wdXNoKGcpfWVsc2UgaWYoIiRwb3AiPT1hKWZvcihsPU9iamVjdC5rZXlzKGMpLHU9MDt1PGwubGVuZ3RoO3UrKyl7aD1hdChsW3VdLHIpO3ZhciBtPWNbbFt1XV07KFA9dih0LGgpKSYmQXJyYXkuaXNBcnJheShQKSYmKDE9PW0/UC5wb3AoKTotMT09bSYmUC5zaGlmdCgpKX1lbHNlIGlmKCIkcHVsbCI9PWEpZm9yKGw9T2JqZWN0LmtleXMoYyksdT0wO3U8bC5sZW5ndGg7dSsrKXtoPWF0KGxbdV0scik7dmFyIHk9Y1tsW3VdXTtpZihudWxsIT0oJD12KHQsaCkpJiZBcnJheS5pc0FycmF5KCQpKXtmb3IodmFyIHc9W10sYj0wO2I8JC5sZW5ndGg7YisrKXt2YXIgeD0kW2JdLF89ITE7aWYoIm9iamVjdCIhPXR5cGVvZiB5fHxudWxsPT09eXx8QXJyYXkuaXNBcnJheSh5KSlfPXg9PXk7ZWxzZSBpZigib2JqZWN0IiE9dHlwZW9mIHh8fG51bGw9PT14fHxBcnJheS5pc0FycmF5KHgpKV89S2Uoe19fdGVtcDp4fSwiX190ZW1wIix5KTtlbHNlIF89WWUoeCx5KTtffHx3LnB1c2goeCl9SSh0LGgsdyl9fWVsc2UgaWYoIiRwdWxsQWxsIj09YSlmb3IobD1PYmplY3Qua2V5cyhjKSx1PTA7dTxsLmxlbmd0aDt1Kyspe3ZhciAkPXYodCxoPWF0KGxbdV0scikpLE49Y1tsW3VdXTtmb3Iodz1bXSxiPTA7YjwkLmxlbmd0aDtiKyspe2Zvcih2YXIgUz0hMSxPPTA7TzxOLmxlbmd0aDtPKyspaWYoJFtiXT09TltPXSl7Uz0hMDticmVha31TfHx3LnB1c2goJFtiXSl9SSh0LGgsdyl9ZWxzZSBpZigiJHB1c2hBbGwiPT1hKWZvcihsPU9iamVjdC5rZXlzKGMpLHU9MDt1PGwubGVuZ3RoO3UrKyl7aD1hdChsW3VdLHIpO3ZhciBBPWNbbFt1XV07aWYoKFA9dih0LGgpKSYmQXJyYXkuaXNBcnJheShQKSlmb3IoYj0wO2I8QS5sZW5ndGg7YisrKVAucHVzaChBW2JdKX1lbHNlIGlmKCIkcHVzaCI9PWEpZm9yKGw9T2JqZWN0LmtleXMoYyksdT0wO3U8bC5sZW5ndGg7dSsrKXtoPWF0KGxbdV0scik7dmFyIEM9Y1tsW3VdXTtpZihudWxsIT09QyYmIm9iamVjdCI9PXR5cGVvZiBDJiYodm9pZCAwIT09Qy4kZWFjaHx8dm9pZCAwIT09Qy4kcG9zaXRpb258fHZvaWQgMCE9PUMuJHNsaWNlfHx2b2lkIDAhPT1DLiRzb3J0KSl7KFA9dih0LGgpKXx8SSh0LGgsUD1bXSk7dmFyIEU9dm9pZCAwIT09Qy4kZWFjaD9DLiRlYWNoOltDXSxqPXZvaWQgMCE9PUMuJHBvc2l0aW9uP0MuJHBvc2l0aW9uOlAubGVuZ3RoO2lmKGo8MCYmKGo9TWF0aC5tYXgoMCxQLmxlbmd0aCtqKSksUC5zcGxpY2UoaiwwLC4uLkUpLHZvaWQgMCE9PUMuJHNvcnQpe3ZhciBEPUMuJHNvcnQ7Im51bWJlciI9PXR5cGVvZiBEP1Auc29ydChmdW5jdGlvbihlLHQpe3JldHVybiBlPHQ/RD4wPy0xOjE6ZT50P0Q+MD8xOi0xOjB9KToib2JqZWN0Ij09dHlwZW9mIEQmJlAuc29ydChmdW5jdGlvbihlLHQpe2Zvcih2YXIgbj1PYmplY3Qua2V5cyhEKSxyPTA7cjxuLmxlbmd0aDtyKyspe3ZhciBpPW5bcl0scz1EW2ldLG89dihlLGkpLGE9dih0LGkpO2lmKG88YSlyZXR1cm4gcz4wPy0xOjE7aWYobz5hKXJldHVybiBzPjA/MTotMX1yZXR1cm4gMH0pfWlmKHZvaWQgMCE9PUMuJHNsaWNlKXt2YXIgaz1DLiRzbGljZTtpZihrPDApSSh0LGgsUC5zbGljZShrKSk7ZWxzZSBpZigwPT09aylJKHQsaCxbXSk7ZWxzZXtJKHQsaCxQLnNsaWNlKDAsaykpfX19ZWxzZXt2YXIgUDsoUD12KHQsaCkpJiZBcnJheS5pc0FycmF5KFApJiZQLnB1c2goQyl9fWVsc2V7aWYoIiRiaXQiIT1hKXRocm93InVua25vd24gdXBkYXRlIG9wZXJhdG9yOiAiK2E7aD1hdCgobD1PYmplY3Qua2V5cyhjKSlbMF0scik7dmFyIE09Y1tsWzBdXSxMPU9iamVjdC5rZXlzKE0pWzBdLEY9TVtMXTtkPXYodCxoKTtpZigiYW5kIj09TClJKHQsaCxkJkYpO2Vsc2UgaWYoIm9yIj09TClJKHQsaCxkfEYpO2Vsc2V7aWYoInhvciIhPUwpdGhyb3cidW5rbm93biAkYml0IG9wZXJhdG9yOiAiK0w7SSh0LGgsZF5GKX19fX1mdW5jdGlvbiBsdChlLHQsbil7Zm9yKHZhciByPXtfaWQ6bn0saT0hMCxzPU9iamVjdC5rZXlzKHQpLG89MDtvPHMubGVuZ3RoO28rKylpZigiJCI9PXNbb10uY2hhckF0KDApKXtpPSExO2JyZWFrfWlmKGkpZm9yKG89MDtvPHMubGVuZ3RoO28rKylyW3Nbb11dPXRbc1tvXV07ZWxzZXt2YXIgYT1PYmplY3Qua2V5cyhlKTtmb3Iobz0wO288YS5sZW5ndGg7bysrKXJbYVtvXV09ZVthW29dXTtjdCh0LHIsITApfXJldHVybiByfWNsYXNzIHV0e2NvbnN0cnVjdG9yKGUsdCxuLHI9e30pe3RoaXMubmFtZT1lLHRoaXMua2V5cz10LHRoaXMuc3RvcmFnZT1uLHRoaXMub3B0aW9ucz1yfWFkZChlKXt0aHJvdyBuZXcgRXJyb3IoImFkZCgpIG11c3QgYmUgaW1wbGVtZW50ZWQgYnkgc3ViY2xhc3MiKX1yZW1vdmUoZSl7dGhyb3cgbmV3IEVycm9yKCJyZW1vdmUoKSBtdXN0IGJlIGltcGxlbWVudGVkIGJ5IHN1YmNsYXNzIil9dXBkYXRlKGUsdCl7dGhpcy5yZW1vdmUoZSksdGhpcy5hZGQodCl9cXVlcnkoZSl7dGhyb3cgbmV3IEVycm9yKCJxdWVyeSgpIG11c3QgYmUgaW1wbGVtZW50ZWQgYnkgc3ViY2xhc3MiKX1jbGVhcigpe3Rocm93IG5ldyBFcnJvcigiY2xlYXIoKSBtdXN0IGJlIGltcGxlbWVudGVkIGJ5IHN1YmNsYXNzIil9Z2V0U3BlYygpe3JldHVybntuYW1lOnRoaXMubmFtZSxrZXk6dGhpcy5rZXlzfX19Y29uc3QgaHQ9Ii52ZXJzaW9uLmpzb24iLGZ0PTE2Mzg0O2Z1bmN0aW9uIGR0KGUsdCl7Y29uc3Qgbj1OdW1iZXIodCk7aWYoIU51bWJlci5pc0Zpbml0ZShuKSl0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgdmVyc2lvbiB2YWx1ZTogJHt0fWApO2lmKG48MCl0aHJvdyBuZXcgRXJyb3IoYFZlcnNpb24gbXVzdCBiZSBub24tbmVnYXRpdmU6ICR7bn1gKTtyZXR1cm4gMD09PW4/ZTpgJHtlfS52JHtufWB9ZnVuY3Rpb24gcHQoZSl7Y29uc3QgdD17Y3VycmVudFZlcnNpb246MCxyZWZDb3VudHM6e319O2lmKCFlfHwib2JqZWN0IiE9dHlwZW9mIGUpcmV0dXJuIHQ7Y29uc3Qgbj1OdW1iZXIoZS5jdXJyZW50VmVyc2lvbik7aWYodC5jdXJyZW50VmVyc2lvbj1OdW1iZXIuaXNGaW5pdGUobik/bjowLGUucmVmQ291bnRzJiYib2JqZWN0Ij09dHlwZW9mIGUucmVmQ291bnRzKWZvcihjb25zdFtyLGldb2YgT2JqZWN0LmVudHJpZXMoZS5yZWZDb3VudHMpKXtjb25zdCBlPU51bWJlcihpKTtOdW1iZXIuaXNGaW5pdGUoZSkmJmU+MD90LnJlZkNvdW50c1tTdHJpbmcocildPWU6KCFOdW1iZXIuaXNGaW5pdGUoZSl8fGU8MCkmJmNvbnNvbGUud2FybihgSWdub3JpbmcgaW52YWxpZCByZWYgY291bnQgZm9yIHZlcnNpb24gJHtyfTogJHtpfWApfXJldHVybiB0fWZ1bmN0aW9uIGd0KGUpe2NvbnN0IHQ9ZS5zcGxpdCgiLyIpLmZpbHRlcihCb29sZWFuKSxuPXQucG9wKCk7aWYoIW4pdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIHN0b3JhZ2UgcGF0aDogJHtlfWApO3JldHVybntwYXJ0czp0LGZpbGVuYW1lOm59fWFzeW5jIGZ1bmN0aW9uIG10KGUsdCl7bGV0IG49YXdhaXQgZ2xvYmFsVGhpcy5uYXZpZ2F0b3Iuc3RvcmFnZS5nZXREaXJlY3RvcnkoKTtmb3IoY29uc3QgciBvZiBlKW49YXdhaXQgbi5nZXREaXJlY3RvcnlIYW5kbGUocix7Y3JlYXRlOnR9KTtyZXR1cm4gbn1hc3luYyBmdW5jdGlvbiB5dChlKXtjb25zdHtwYXJ0czp0fT1ndChlKTswIT09dC5sZW5ndGgmJmF3YWl0IG10KHQsITApfWFzeW5jIGZ1bmN0aW9uIHd0KGUse2NyZWF0ZTp0fT17fSl7Y29uc3R7cGFydHM6bixmaWxlbmFtZTpyfT1ndChlKTtyZXR1cm4oYXdhaXQgbXQobiwhIXQpKS5nZXRGaWxlSGFuZGxlKHIse2NyZWF0ZTp0fSl9YXN5bmMgZnVuY3Rpb24gYnQoZSl7Y29uc3QgdD1gJHtlfSR7aHR9YDt0cnl7Y29uc3QgZT1hd2FpdCB3dCh0LHtjcmVhdGU6ITF9KSxuPWF3YWl0IGUuZ2V0RmlsZSgpLHI9YXdhaXQgbi50ZXh0KCk7cmV0dXJuIHImJiIiIT09ci50cmltKCk/cHQoSlNPTi5wYXJzZShyKSk6cHQoKX1jYXRjaChuKXtpZigiTm90Rm91bmRFcnJvciI9PT1uPy5uYW1lfHwiRU5PRU5UIj09PW4/LmNvZGUpcmV0dXJuIHB0KCk7dGhyb3cgbn19YXN5bmMgZnVuY3Rpb24geHQoZSx0KXtjb25zdCBuPWAke2V9JHtodH1gO2F3YWl0IHl0KG4pO2NvbnN0IHI9YXdhaXQgd3Qobix7Y3JlYXRlOiEwfSksaT1hd2FpdCByLmNyZWF0ZVdyaXRhYmxlKCk7YXdhaXQgaS53cml0ZShKU09OLnN0cmluZ2lmeSh0KSksYXdhaXQgaS5jbG9zZSgpfWFzeW5jIGZ1bmN0aW9uIF90KGUsdCxuLHIpe2lmKHQ9PT1uLmN1cnJlbnRWZXJzaW9uKXJldHVybjtjb25zdCBpPVN0cmluZyh0KTtuLnJlZkNvdW50c1tpXXx8YXdhaXQgYXN5bmMgZnVuY3Rpb24oZSx0LG4pe2NvbnN0IHI9ZHQoZSx0KTtmb3IoY29uc3QgaSBvZiBuKXtjb25zdCBlPWk/YCR7cn0ke2l9YDpyO2F3YWl0IFN0KGUpfX0oZSx0LHIpfWFzeW5jIGZ1bmN0aW9uIHZ0KGUpe2NvbnN0IHQ9YXdhaXQgYnQoZSksbj10LmN1cnJlbnRWZXJzaW9uLHI9U3RyaW5nKG4pO3JldHVybiB0LnJlZkNvdW50c1tyXT0odC5yZWZDb3VudHNbcl18fDApKzEsYXdhaXQgeHQoZSx0KSx7dmVyc2lvbjpuLHBhdGg6ZHQoZSxuKX19YXN5bmMgZnVuY3Rpb24gJHQoZSx0LHtzdWZmaXhlczpuPVsiIl19PXt9KXtjb25zdCByPWF3YWl0IGJ0KGUpLGk9U3RyaW5nKHQpO3IucmVmQ291bnRzW2ldJiYoci5yZWZDb3VudHNbaV0tPTEsci5yZWZDb3VudHNbaV08PTAmJmRlbGV0ZSByLnJlZkNvdW50c1tpXSksYXdhaXQgX3QoZSx0LHIsbiksYXdhaXQgeHQoZSxyKX1hc3luYyBmdW5jdGlvbiBJdChlLHQsbix7c3VmZml4ZXM6cj1bIiJdfT17fSl7Y29uc3QgaT1hd2FpdCBidChlKSxzPU51bWJlcih0KTtpLmN1cnJlbnRWZXJzaW9uPU51bWJlci5pc0Zpbml0ZShzKT9zOmkuY3VycmVudFZlcnNpb247Y29uc3Qgbz1TdHJpbmcoaS5jdXJyZW50VmVyc2lvbik7aS5yZWZDb3VudHNbb118fChpLnJlZkNvdW50c1tvXT0wKSxhd2FpdCBfdChlLG4saSxyKSxhd2FpdCB4dChlLGkpfWFzeW5jIGZ1bmN0aW9uIE50KGUpe3JldHVybihhd2FpdCBidChlKSkuY3VycmVudFZlcnNpb259YXN5bmMgZnVuY3Rpb24gU3QoZSl7dHJ5e2NvbnN0e3BhcnRzOnQsZmlsZW5hbWU6bn09Z3QoZSkscj1hd2FpdCBtdCh0LCExKTthd2FpdCByLnJlbW92ZUVudHJ5KG4pfWNhdGNoKHQpe2lmKCJOb3RGb3VuZEVycm9yIj09PXQ/Lm5hbWV8fCJFTk9FTlQiPT09dD8uY29kZSlyZXR1cm47dGhyb3cgdH19YXN5bmMgZnVuY3Rpb24gT3QoZSx7cmVzZXQ6dD0hMX09e30pe3QmJmF3YWl0IFN0KGUpLGF3YWl0IHl0KGUpO3JldHVybihhd2FpdCB3dChlLHtjcmVhdGU6ITB9KSkuY3JlYXRlU3luY0FjY2Vzc0hhbmRsZSgpfWNsYXNzIEF0IGV4dGVuZHMgdXR7Y29uc3RydWN0b3IoZSx0LG4scj17fSl7c3VwZXIoZSx0LG4sciksdGhpcy5zdG9yYWdlRmlsZVBhdGg9bix0aGlzLnN0b3JhZ2VWZXJzaW9uZWRQYXRoPW51bGwsdGhpcy5zdG9yYWdlVmVyc2lvbj0wLHRoaXMuX3JlbGVhc2VTdG9yYWdlPW51bGwsdGhpcy5kYXRhPW51bGwsdGhpcy5zeW5jSGFuZGxlPW51bGwsdGhpcy5pc09wZW49ITF9YXN5bmMgb3Blbigpe2lmKCF0aGlzLmlzT3Blbil0cnl7Y29uc3R7dmVyc2lvbjplLHBhdGg6dH09YXdhaXQgdnQodGhpcy5zdG9yYWdlRmlsZVBhdGgpO3RoaXMuc3RvcmFnZVZlcnNpb249ZSx0aGlzLnN0b3JhZ2VWZXJzaW9uZWRQYXRoPXQsdGhpcy5fcmVsZWFzZVN0b3JhZ2U9KCk9PiR0KHRoaXMuc3RvcmFnZUZpbGVQYXRoLGUpO2NvbnN0IG49dGhpcy5zdG9yYWdlVmVyc2lvbmVkUGF0aC5zcGxpdCgiLyIpLmZpbHRlcihCb29sZWFuKSxyPW4ucG9wKCk7aWYoIXIpdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIHN0b3JhZ2UgcGF0aDogJHt0aGlzLnN0b3JhZ2VWZXJzaW9uZWRQYXRofWApO2xldCBpPWF3YWl0IGdsb2JhbFRoaXMubmF2aWdhdG9yLnN0b3JhZ2UuZ2V0RGlyZWN0b3J5KCk7Zm9yKGNvbnN0IG8gb2YgbilpPWF3YWl0IGkuZ2V0RGlyZWN0b3J5SGFuZGxlKG8se2NyZWF0ZTohMH0pO2NvbnN0IHM9YXdhaXQgaS5nZXRGaWxlSGFuZGxlKHIse2NyZWF0ZTohMH0pO3RoaXMuc3luY0hhbmRsZT1hd2FpdCBzLmNyZWF0ZVN5bmNBY2Nlc3NIYW5kbGUoKSx0aGlzLmRhdGE9bmV3IHhlKHRoaXMuc3luY0hhbmRsZSw1MCksYXdhaXQgdGhpcy5kYXRhLm9wZW4oKSx0aGlzLmlzT3Blbj0hMH1jYXRjaChlKXtpZighZS5tZXNzYWdlfHwhKGUubWVzc2FnZS5pbmNsdWRlcygiVW5rbm93biB0eXBlIGJ5dGUiKXx8ZS5tZXNzYWdlLmluY2x1ZGVzKCJGYWlsZWQgdG8gcmVhZCBtZXRhZGF0YSIpfHxlLm1lc3NhZ2UuaW5jbHVkZXMoIkludmFsaWQgdHJlZSBmaWxlIikpKXRocm93IGU7e2lmKHRoaXMuc3luY0hhbmRsZSl7dHJ5e2F3YWl0IHRoaXMuc3luY0hhbmRsZS5jbG9zZSgpfWNhdGNoKHQpe310aGlzLnN5bmNIYW5kbGU9bnVsbH1jb25zdCBlPXRoaXMuc3RvcmFnZVZlcnNpb25lZFBhdGguc3BsaXQoIi8iKS5maWx0ZXIoQm9vbGVhbiksbj1lLnBvcCgpO2lmKCFuKXRocm93IG5ldyBFcnJvcihgSW52YWxpZCBzdG9yYWdlIHBhdGg6ICR7dGhpcy5zdG9yYWdlVmVyc2lvbmVkUGF0aH1gKTtsZXQgcj1hd2FpdCBnbG9iYWxUaGlzLm5hdmlnYXRvci5zdG9yYWdlLmdldERpcmVjdG9yeSgpO2Zvcihjb25zdCB0IG9mIGUpcj1hd2FpdCByLmdldERpcmVjdG9yeUhhbmRsZSh0LHtjcmVhdGU6ITB9KTt0cnl7YXdhaXQgci5yZW1vdmVFbnRyeShuKX1jYXRjaCh0KXt9Y29uc3QgaT1hd2FpdCByLmdldEZpbGVIYW5kbGUobix7Y3JlYXRlOiEwfSk7dGhpcy5zeW5jSGFuZGxlPWF3YWl0IGkuY3JlYXRlU3luY0FjY2Vzc0hhbmRsZSgpLHRoaXMuZGF0YT1uZXcgeGUodGhpcy5zeW5jSGFuZGxlLDUwKSxhd2FpdCB0aGlzLmRhdGEub3BlbigpLHRoaXMuaXNPcGVuPSEwfX19YXN5bmMgY2xvc2UoKXtpZih0aGlzLmlzT3Blbil7dHJ5e2F3YWl0IHRoaXMuX21heWJlQ29tcGFjdCgpLGF3YWl0IHRoaXMuZGF0YS5jbG9zZSgpfWNhdGNoKGUpe2lmKCFlLm1lc3NhZ2V8fCFlLm1lc3NhZ2UuaW5jbHVkZXMoIkZpbGUgaXMgbm90IG9wZW4iKSl0aHJvdyBlfXRoaXMuaXNPcGVuPSExLHRoaXMuX3JlbGVhc2VTdG9yYWdlJiYoYXdhaXQgdGhpcy5fcmVsZWFzZVN0b3JhZ2UoKSx0aGlzLl9yZWxlYXNlU3RvcmFnZT1udWxsKX1lbHNlIHRoaXMuX3JlbGVhc2VTdG9yYWdlJiYoYXdhaXQgdGhpcy5fcmVsZWFzZVN0b3JhZ2UoKSx0aGlzLl9yZWxlYXNlU3RvcmFnZT1udWxsKX1hc3luYyBfbWF5YmVDb21wYWN0KCl7aWYoIXRoaXMuZGF0YXx8IXRoaXMuZGF0YS5maWxlKXJldHVybjtjb25zdCBlPWF3YWl0IE50KHRoaXMuc3RvcmFnZUZpbGVQYXRoKTtpZihlIT09dGhpcy5zdG9yYWdlVmVyc2lvbilyZXR1cm47Y29uc3QgdD10aGlzLmRhdGEuZmlsZS5nZXRGaWxlU2l6ZSgpO2lmKCF0fHx0PGZ0KXJldHVybjtjb25zdCBuPWUrMSxyPWR0KHRoaXMuc3RvcmFnZUZpbGVQYXRoLG4pLGk9YXdhaXQgT3Qocix7cmVzZXQ6ITB9KTthd2FpdCB0aGlzLmRhdGEuY29tcGFjdChpKSxhd2FpdCBJdCh0aGlzLnN0b3JhZ2VGaWxlUGF0aCxuLGUpfWV4dHJhY3RJbmRleEtleShlKXtjb25zdCB0PU9iamVjdC5rZXlzKHRoaXMua2V5cyk7aWYoMD09PXQubGVuZ3RoKXJldHVybiBudWxsO2lmKDE9PT10Lmxlbmd0aCl7Y29uc3Qgbj12KGUsdFswXSk7cmV0dXJuIHZvaWQgMD09PW4/bnVsbDpufWNvbnN0IG49W107Zm9yKGxldCByPTA7cjx0Lmxlbmd0aDtyKyspe2NvbnN0IGk9dihlLHRbcl0pO2lmKHZvaWQgMD09PWkpcmV0dXJuIG51bGw7bi5wdXNoKGkpfXJldHVybiBuLmpvaW4oIlwwIil9YXN5bmMgYWRkKGUpe3RoaXMuaXNPcGVufHxhd2FpdCB0aGlzLm9wZW4oKTtjb25zdCB0PXRoaXMuZXh0cmFjdEluZGV4S2V5KGUpO2lmKG51bGwhPT10KXtjb25zdCBuPWUuX2lkLnRvU3RyaW5nKCkscj1hd2FpdCB0aGlzLmRhdGEuc2VhcmNoKHQpO2xldCBpO2lmKEFycmF5LmlzQXJyYXkocikpe2lmKHIuaW5jbHVkZXMobikpcmV0dXJuO2k9Wy4uLnIsbl19ZWxzZSBpPXI/cj09PW4/W3JdOltyLG5dOltuXTthd2FpdCB0aGlzLmRhdGEuYWRkKHQsaSl9fWFzeW5jIHJlbW92ZShlKXt0aGlzLmlzT3Blbnx8YXdhaXQgdGhpcy5vcGVuKCk7Y29uc3QgdD10aGlzLmV4dHJhY3RJbmRleEtleShlKTtpZihudWxsIT09dCl7Y29uc3Qgbj1lLl9pZC50b1N0cmluZygpLHI9YXdhaXQgdGhpcy5kYXRhLnNlYXJjaCh0KTtpZihBcnJheS5pc0FycmF5KHIpKXtjb25zdCBlPXIuZmlsdGVyKGU9PmUhPT1uKTtlLmxlbmd0aD4wP2F3YWl0IHRoaXMuZGF0YS5hZGQodCxlKTphd2FpdCB0aGlzLmRhdGEuZGVsZXRlKHQpfWVsc2Ugcj09PW4mJmF3YWl0IHRoaXMuZGF0YS5kZWxldGUodCl9fWFzeW5jIHF1ZXJ5KGUpe2NvbnN0IHQ9T2JqZWN0LmtleXMoZSksbj1PYmplY3Qua2V5cyh0aGlzLmtleXMpO2lmKDEhPT1uLmxlbmd0aClyZXR1cm4gbnVsbDtjb25zdCByPW5bMF07aWYoLTE9PT10LmluZGV4T2YocikpcmV0dXJuIG51bGw7Y29uc3QgaT1lW3JdO2lmKCJvYmplY3QiIT10eXBlb2YgaXx8bnVsbD09PWkpe2NvbnN0IGU9aTtyZXR1cm4gYXdhaXQgdGhpcy5kYXRhLnNlYXJjaChlKXx8W119cmV0dXJuIm9iamVjdCIhPXR5cGVvZiBpfHxBcnJheS5pc0FycmF5KGkpP251bGw6YXdhaXQgdGhpcy5fcXVlcnlXaXRoT3BlcmF0b3JzKHIsaSl9YXN5bmMgX3F1ZXJ5V2l0aE9wZXJhdG9ycyhlLHQpe2NvbnN0IG49T2JqZWN0LmtleXModCkscj0vKiBAX19QVVJFX18gKi9uZXcgU2V0O2lmKG4uc29tZShlPT5bIiRndCIsIiRndGUiLCIkbHQiLCIkbHRlIl0uaW5jbHVkZXMoZSkpKXtjb25zdCBlPW4uaW5jbHVkZXMoIiRndCIpfHxuLmluY2x1ZGVzKCIkZ3RlIiksaT1uLmluY2x1ZGVzKCIkbHQiKXx8bi5pbmNsdWRlcygiJGx0ZSIpO2lmKGUmJmkpe2NvbnN0IGU9bi5pbmNsdWRlcygiJGd0ZSIpP3QuJGd0ZTpuLmluY2x1ZGVzKCIkZ3QiKT90LiRndDotMS8wLGk9bi5pbmNsdWRlcygiJGx0ZSIpP3QuJGx0ZTpuLmluY2x1ZGVzKCIkbHQiKT90LiRsdDoxLzAscz1hd2FpdCB0aGlzLmRhdGEucmFuZ2VTZWFyY2goZSxpKTtmb3IoY29uc3QgbyBvZiBzKXtjb25zdCBlPW8ua2V5LGk9by52YWx1ZTtsZXQgcz0hMDshbi5pbmNsdWRlcygiJGd0Iil8fGU+dC4kZ3R8fChzPSExKSwhbi5pbmNsdWRlcygiJGd0ZSIpfHxlPj10LiRndGV8fChzPSExKSwhbi5pbmNsdWRlcygiJGx0Iil8fGU8dC4kbHR8fChzPSExKSwhbi5pbmNsdWRlcygiJGx0ZSIpfHxlPD10LiRsdGV8fChzPSExKSxzJiZpJiYoQXJyYXkuaXNBcnJheShpKT9pLmZvckVhY2goZT0+ci5hZGQoZSkpOnIuYWRkKGkpKX1yZXR1cm4gQXJyYXkuZnJvbShyKX17Y29uc3QgZT1hd2FpdCB0aGlzLmRhdGEudG9BcnJheSgpO2Zvcihjb25zdCBpIG9mIGUpe2NvbnN0IGU9aS5rZXkscz1pLnZhbHVlO2xldCBvPSEwO2Zvcihjb25zdCByIG9mIG4pe2NvbnN0IG49dFtyXTsoIiRndCIhPT1yfHxlPm4pJiYoIiRndGUiIT09cnx8ZT49bikmJigiJGx0IiE9PXJ8fGU8bikmJigiJGx0ZSIhPT1yfHxlPD1uKT8oIiRlcSI9PT1yJiZlIT09bnx8IiRuZSI9PT1yJiZlPT09bikmJihvPSExKTpvPSExfW8mJnMmJihBcnJheS5pc0FycmF5KHMpP3MuZm9yRWFjaChlPT5yLmFkZChlKSk6ci5hZGQocykpfXJldHVybiBBcnJheS5mcm9tKHIpfX1pZihuLmluY2x1ZGVzKCIkaW4iKSl7Y29uc3QgZT10LiRpbjtpZihBcnJheS5pc0FycmF5KGUpKXtmb3IoY29uc3QgdCBvZiBlKXtjb25zdCBlPWF3YWl0IHRoaXMuZGF0YS5zZWFyY2godCk7ZSYmKEFycmF5LmlzQXJyYXkoZSk/ZS5mb3JFYWNoKGU9PnIuYWRkKGUpKTpyLmFkZChlKSl9cmV0dXJuIEFycmF5LmZyb20ocil9fWlmKG4uaW5jbHVkZXMoIiRlcSIpKXtjb25zdCBlPXQuJGVxLG49YXdhaXQgdGhpcy5kYXRhLnNlYXJjaChlKTtyZXR1cm4gbj9BcnJheS5pc0FycmF5KG4pP246W25dOltdfWlmKG4uaW5jbHVkZXMoIiRuZSIpKXtjb25zdCBlPXQuJG5lLG49YXdhaXQgdGhpcy5kYXRhLnRvQXJyYXkoKTtmb3IoY29uc3QgdCBvZiBuKXQua2V5IT09ZSYmdC52YWx1ZSYmKEFycmF5LmlzQXJyYXkodC52YWx1ZSk/dC52YWx1ZS5mb3JFYWNoKGU9PnIuYWRkKGUpKTpyLmFkZCh0LnZhbHVlKSk7cmV0dXJuIEFycmF5LmZyb20ocil9cmV0dXJuIG51bGx9YXN5bmMgY2xlYXIoKXt0aGlzLmlzT3BlbiYmYXdhaXQgdGhpcy5jbG9zZSgpO2NvbnN0IGU9YXdhaXQgTnQodGhpcy5zdG9yYWdlRmlsZVBhdGgpLHQ9ZHQodGhpcy5zdG9yYWdlRmlsZVBhdGgsZSkuc3BsaXQoIi8iKS5maWx0ZXIoQm9vbGVhbiksbj10LnBvcCgpO2xldCByPWF3YWl0IGdsb2JhbFRoaXMubmF2aWdhdG9yLnN0b3JhZ2UuZ2V0RGlyZWN0b3J5KCk7Zm9yKGNvbnN0IHMgb2YgdClyPWF3YWl0IHIuZ2V0RGlyZWN0b3J5SGFuZGxlKHMse2NyZWF0ZTohMH0pO3RyeXthd2FpdCByLnJlbW92ZUVudHJ5KG4pfWNhdGNoKGkpe31hd2FpdCB0aGlzLm9wZW4oKX19Y29uc3QgQ3Q9WyItdGVybXMuYmpzb24iLCItZG9jdW1lbnRzLmJqc29uIiwiLWxlbmd0aHMuYmpzb24iXTtjbGFzcyBFdCBleHRlbmRzIHV0e2NvbnN0cnVjdG9yKGUsdCxuLHI9e30pe3N1cGVyKGUsdCxuKSx0aGlzLnN0b3JhZ2VCYXNlUGF0aD1uLHRoaXMuc3RvcmFnZVZlcnNpb249MCx0aGlzLnZlcnNpb25lZEJhc2VQYXRoPW51bGwsdGhpcy5fcmVsZWFzZVN0b3JhZ2U9bnVsbCx0aGlzLnRleHRJbmRleD1udWxsLHRoaXMuc3luY0hhbmRsZXM9W10sdGhpcy5pc09wZW49ITEsdGhpcy5pbmRleGVkRmllbGRzPVtdO2Zvcihjb25zdCBpIGluIHQpInRleHQiPT09dFtpXSYmdGhpcy5pbmRleGVkRmllbGRzLnB1c2goaSk7aWYoMD09PXRoaXMuaW5kZXhlZEZpZWxkcy5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKCdUZXh0IGluZGV4IG11c3QgaGF2ZSBhdCBsZWFzdCBvbmUgZmllbGQgd2l0aCB0eXBlICJ0ZXh0IicpfWFzeW5jIG9wZW4oKXtpZighdGhpcy5pc09wZW4pdHJ5e2NvbnN0e3ZlcnNpb246ZSxwYXRoOnR9PWF3YWl0IHZ0KHRoaXMuc3RvcmFnZUJhc2VQYXRoKTt0aGlzLnN0b3JhZ2VWZXJzaW9uPWUsdGhpcy52ZXJzaW9uZWRCYXNlUGF0aD10LHRoaXMuX3JlbGVhc2VTdG9yYWdlPSgpPT4kdCh0aGlzLnN0b3JhZ2VCYXNlUGF0aCxlLHtzdWZmaXhlczpDdH0pO2NvbnN0IG49YXdhaXQgdGhpcy5fY3JlYXRlQlBsdXNUcmVlKHRoaXMuX2dldEFjdGl2ZUJhc2VQYXRoKCkrIi10ZXJtcy5ianNvbiIpLHI9YXdhaXQgdGhpcy5fY3JlYXRlQlBsdXNUcmVlKHRoaXMuX2dldEFjdGl2ZUJhc2VQYXRoKCkrIi1kb2N1bWVudHMuYmpzb24iKSxpPWF3YWl0IHRoaXMuX2NyZWF0ZUJQbHVzVHJlZSh0aGlzLl9nZXRBY3RpdmVCYXNlUGF0aCgpKyItbGVuZ3Rocy5ianNvbiIpO3RoaXMudGV4dEluZGV4PW5ldyAkZSh7b3JkZXI6MTYsdHJlZXM6e2luZGV4Om4sZG9jdW1lbnRUZXJtczpyLGRvY3VtZW50TGVuZ3RoczppfX0pLGF3YWl0IHRoaXMudGV4dEluZGV4Lm9wZW4oKSx0aGlzLmlzT3Blbj0hMH1jYXRjaChlKXtpZighKCJFTk9FTlQiPT09ZS5jb2RlfHxlLm1lc3NhZ2UmJihlLm1lc3NhZ2UuaW5jbHVkZXMoIkZhaWxlZCB0byByZWFkIG1ldGFkYXRhIil8fGUubWVzc2FnZS5pbmNsdWRlcygibWlzc2luZyByZXF1aXJlZCBmaWVsZHMiKXx8ZS5tZXNzYWdlLmluY2x1ZGVzKCJVbmtub3duIHR5cGUgYnl0ZSIpfHxlLm1lc3NhZ2UuaW5jbHVkZXMoIkludmFsaWQiKXx8ZS5tZXNzYWdlLmluY2x1ZGVzKCJmaWxlIHRvbyBzbWFsbCIpKSkpdGhyb3cgZTt7YXdhaXQgdGhpcy5fY2xvc2VTeW5jSGFuZGxlcygpLGF3YWl0IHRoaXMuX2RlbGV0ZUluZGV4RmlsZXMoKSxhd2FpdCB0aGlzLl9lbnN1cmVEaXJlY3RvcnlGb3JGaWxlKHRoaXMuX2dldEFjdGl2ZUJhc2VQYXRoKCkrIi10ZXJtcy5ianNvbiIpO2NvbnN0IGU9YXdhaXQgdGhpcy5fY3JlYXRlQlBsdXNUcmVlKHRoaXMuX2dldEFjdGl2ZUJhc2VQYXRoKCkrIi10ZXJtcy5ianNvbiIpLHQ9YXdhaXQgdGhpcy5fY3JlYXRlQlBsdXNUcmVlKHRoaXMuX2dldEFjdGl2ZUJhc2VQYXRoKCkrIi1kb2N1bWVudHMuYmpzb24iKSxuPWF3YWl0IHRoaXMuX2NyZWF0ZUJQbHVzVHJlZSh0aGlzLl9nZXRBY3RpdmVCYXNlUGF0aCgpKyItbGVuZ3Rocy5ianNvbiIpO3RoaXMudGV4dEluZGV4PW5ldyAkZSh7b3JkZXI6MTYsdHJlZXM6e2luZGV4OmUsZG9jdW1lbnRUZXJtczp0LGRvY3VtZW50TGVuZ3RoczpufX0pLGF3YWl0IHRoaXMudGV4dEluZGV4Lm9wZW4oKSx0aGlzLmlzT3Blbj0hMH19fWFzeW5jIF9jcmVhdGVCUGx1c1RyZWUoZSl7Y29uc3QgdD1lLnNwbGl0KCIvIikuZmlsdGVyKEJvb2xlYW4pLG49dC5wb3AoKTtpZighbil0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgc3RvcmFnZSBwYXRoOiAke2V9YCk7bGV0IHI9YXdhaXQgZ2xvYmFsVGhpcy5uYXZpZ2F0b3Iuc3RvcmFnZS5nZXREaXJlY3RvcnkoKTtmb3IoY29uc3QgbyBvZiB0KXI9YXdhaXQgci5nZXREaXJlY3RvcnlIYW5kbGUobyx7Y3JlYXRlOiEwfSk7Y29uc3QgaT1hd2FpdCByLmdldEZpbGVIYW5kbGUobix7Y3JlYXRlOiEwfSkscz1hd2FpdCBpLmNyZWF0ZVN5bmNBY2Nlc3NIYW5kbGUoKTtyZXR1cm4gdGhpcy5zeW5jSGFuZGxlcy5wdXNoKHMpLG5ldyB4ZShzLDE2KX1hc3luYyBfY2xvc2VTeW5jSGFuZGxlcygpe2Zvcihjb25zdCB0IG9mIHRoaXMuc3luY0hhbmRsZXMpdHJ5e2F3YWl0IHQuY2xvc2UoKX1jYXRjaChlKXt9dGhpcy5zeW5jSGFuZGxlcz1bXX1fZ2V0QWN0aXZlQmFzZVBhdGgoKXtyZXR1cm4gdGhpcy52ZXJzaW9uZWRCYXNlUGF0aHx8dGhpcy5zdG9yYWdlQmFzZVBhdGh9YXN5bmMgX2RlbGV0ZUluZGV4RmlsZXMoZT10aGlzLl9nZXRBY3RpdmVCYXNlUGF0aCgpKXtmb3IoY29uc3QgdCBvZiBDdClhd2FpdCB0aGlzLl9kZWxldGVGaWxlKGUrdCl9YXN5bmMgX2RlbGV0ZUZpbGUoZSl7aWYoZSl0cnl7Y29uc3QgdD1lLnNwbGl0KCIvIikuZmlsdGVyKEJvb2xlYW4pLG49dC5wb3AoKTtpZighbil0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgc3RvcmFnZSBwYXRoOiAke2V9YCk7bGV0IHI9YXdhaXQgZ2xvYmFsVGhpcy5uYXZpZ2F0b3Iuc3RvcmFnZS5nZXREaXJlY3RvcnkoKTtmb3IoY29uc3QgZSBvZiB0KXI9YXdhaXQgci5nZXREaXJlY3RvcnlIYW5kbGUoZSx7Y3JlYXRlOiExfSk7YXdhaXQgci5yZW1vdmVFbnRyeShuKX1jYXRjaCh0KXt9fWFzeW5jIF9lbnN1cmVEaXJlY3RvcnlGb3JGaWxlKGUpe2lmKCFlKXJldHVybjtjb25zdCB0PWUuc3BsaXQoIi8iKS5maWx0ZXIoQm9vbGVhbik7aWYodC5wb3AoKSwwIT09dC5sZW5ndGgpdHJ5e2xldCBlPWF3YWl0IGdsb2JhbFRoaXMubmF2aWdhdG9yLnN0b3JhZ2UuZ2V0RGlyZWN0b3J5KCk7Zm9yKGNvbnN0IG4gb2YgdCllPWF3YWl0IGUuZ2V0RGlyZWN0b3J5SGFuZGxlKG4se2NyZWF0ZTohMH0pfWNhdGNoKG4pe2lmKCJFRVhJU1QiIT09bi5jb2RlKXRocm93IG59fWFzeW5jIGNsb3NlKCl7aWYodGhpcy5pc09wZW4pe2lmKGF3YWl0IHRoaXMuX21heWJlQ29tcGFjdCgpLHRoaXMudGV4dEluZGV4Py5pc09wZW4pdHJ5e2F3YWl0IHRoaXMudGV4dEluZGV4LmNsb3NlKCl9Y2F0Y2goZSl7aWYoIWUubWVzc2FnZXx8IWUubWVzc2FnZS5pbmNsdWRlcygiRmlsZSBpcyBub3Qgb3BlbiIpKXRocm93IGV9dGhpcy5pc09wZW49ITF9dGhpcy5fcmVsZWFzZVN0b3JhZ2UmJihhd2FpdCB0aGlzLl9yZWxlYXNlU3RvcmFnZSgpLHRoaXMuX3JlbGVhc2VTdG9yYWdlPW51bGwpfWFzeW5jIF9tYXliZUNvbXBhY3QoKXtpZighdGhpcy50ZXh0SW5kZXg/LmluZGV4Py5maWxlfHwhdGhpcy50ZXh0SW5kZXg/LmRvY3VtZW50VGVybXM/LmZpbGV8fCF0aGlzLnRleHRJbmRleD8uZG9jdW1lbnRMZW5ndGhzPy5maWxlKXJldHVybiExO2NvbnN0IGU9YXdhaXQgTnQodGhpcy5zdG9yYWdlQmFzZVBhdGgpO2lmKGUhPT10aGlzLnN0b3JhZ2VWZXJzaW9uKXJldHVybiExO2NvbnN0IHQ9dGhpcy50ZXh0SW5kZXguaW5kZXguZmlsZS5nZXRGaWxlU2l6ZSgpK3RoaXMudGV4dEluZGV4LmRvY3VtZW50VGVybXMuZmlsZS5nZXRGaWxlU2l6ZSgpK3RoaXMudGV4dEluZGV4LmRvY3VtZW50TGVuZ3Rocy5maWxlLmdldEZpbGVTaXplKCk7aWYoIXR8fHQ8ZnQpcmV0dXJuITE7Y29uc3Qgbj1lKzEscj1kdCh0aGlzLnN0b3JhZ2VCYXNlUGF0aCxuKSxpPWF3YWl0IE90KGAke3J9LXRlcm1zLmJqc29uYCx7cmVzZXQ6ITB9KSxzPWF3YWl0IE90KGAke3J9LWRvY3VtZW50cy5ianNvbmAse3Jlc2V0OiEwfSksbz1hd2FpdCBPdChgJHtyfS1sZW5ndGhzLmJqc29uYCx7cmVzZXQ6ITB9KSxhPW5ldyB4ZShpLDE2KSxjPW5ldyB4ZShzLDE2KSxsPW5ldyB4ZShvLDE2KTtyZXR1cm4gYXdhaXQgdGhpcy50ZXh0SW5kZXguY29tcGFjdCh7aW5kZXg6YSxkb2N1bWVudFRlcm1zOmMsZG9jdW1lbnRMZW5ndGhzOmx9KSxhd2FpdCBJdCh0aGlzLnN0b3JhZ2VCYXNlUGF0aCxuLGUse3N1ZmZpeGVzOkN0fSksYXdhaXQgdGhpcy5fY2xvc2VTeW5jSGFuZGxlcygpLCEwfV9leHRyYWN0VGV4dChlKXtjb25zdCB0PVtdO2Zvcihjb25zdCBuIG9mIHRoaXMuaW5kZXhlZEZpZWxkcyl7Y29uc3Qgcj12KGUsbik7bnVsbCE9ciYmdC5wdXNoKFN0cmluZyhyKSl9cmV0dXJuIHQuam9pbigiICIpfWFzeW5jIGFkZChlKXtpZighZS5faWQpdGhyb3cgbmV3IEVycm9yKCJEb2N1bWVudCBtdXN0IGhhdmUgYW4gX2lkIGZpZWxkIik7Y29uc3QgdD10aGlzLl9leHRyYWN0VGV4dChlKTt0JiZhd2FpdCB0aGlzLnRleHRJbmRleC5hZGQoU3RyaW5nKGUuX2lkKSx0KX1hc3luYyByZW1vdmUoZSl7ZS5faWQmJmF3YWl0IHRoaXMudGV4dEluZGV4LnJlbW92ZShTdHJpbmcoZS5faWQpKX1xdWVyeShlKXtyZXR1cm4gbnVsbH1hc3luYyBzZWFyY2goZSx0PXt9KXtyZXR1cm4gYXdhaXQgdGhpcy50ZXh0SW5kZXgucXVlcnkoZSx7c2NvcmVkOiExLC4uLnR9KX1hc3luYyBjbGVhcigpe3RoaXMuaXNPcGVuJiZhd2FpdCB0aGlzLmNsb3NlKCk7Y29uc3QgZT1hd2FpdCBOdCh0aGlzLnN0b3JhZ2VCYXNlUGF0aCksdD1kdCh0aGlzLnN0b3JhZ2VCYXNlUGF0aCxlKTthd2FpdCB0aGlzLl9kZWxldGVJbmRleEZpbGVzKHQpLGF3YWl0IHRoaXMub3BlbigpfWdldFNwZWMoKXtyZXR1cm57bmFtZTp0aGlzLm5hbWUsa2V5OnRoaXMua2V5cyx0ZXh0SW5kZXhWZXJzaW9uOjMsd2VpZ2h0czp0aGlzLl9nZXRXZWlnaHRzKCl9fV9nZXRXZWlnaHRzKCl7Y29uc3QgZT17fTtmb3IoY29uc3QgdCBvZiB0aGlzLmluZGV4ZWRGaWVsZHMpZVt0XT0xO3JldHVybiBlfX1mdW5jdGlvbiBqdChlLHQsbixyKXtjb25zdCBpPShuLWUpKk1hdGguUEkvMTgwLHM9KHItdCkqTWF0aC5QSS8xODAsbz1NYXRoLnNpbihpLzIpKk1hdGguc2luKGkvMikrTWF0aC5jb3MoZSpNYXRoLlBJLzE4MCkqTWF0aC5jb3MobipNYXRoLlBJLzE4MCkqTWF0aC5zaW4ocy8yKSpNYXRoLnNpbihzLzIpO3JldHVybiA2MzcxKigyKk1hdGguYXRhbjIoTWF0aC5zcXJ0KG8pLE1hdGguc3FydCgxLW8pKSl9ZnVuY3Rpb24gRHQoZSx0KXtyZXR1cm4hKGUubWF4TGF0PHQubWluTGF0fHxlLm1pbkxhdD50Lm1heExhdHx8ZS5tYXhMbmc8dC5taW5Mbmd8fGUubWluTG5nPnQubWF4TG5nKX1mdW5jdGlvbiBrdChlKXtyZXR1cm4oZS5tYXhMYXQtZS5taW5MYXQpKihlLm1heExuZy1lLm1pbkxuZyl9ZnVuY3Rpb24gUHQoZSx0KXtyZXR1cm57bWluTGF0Ok1hdGgubWluKGUubWluTGF0LHQubWluTGF0KSxtYXhMYXQ6TWF0aC5tYXgoZS5tYXhMYXQsdC5tYXhMYXQpLG1pbkxuZzpNYXRoLm1pbihlLm1pbkxuZyx0Lm1pbkxuZyksbWF4TG5nOk1hdGgubWF4KGUubWF4TG5nLHQubWF4TG5nKX19ZnVuY3Rpb24gTXQoZSx0KXtyZXR1cm4ga3QoUHQoZSx0KSkta3QoZSl9Y2xhc3MgTHR7Y29uc3RydWN0b3IoZSx0KXt0aGlzLnJ0cmVlPWUsdGhpcy5pZD10LmlkLHRoaXMuaXNMZWFmPXQuaXNMZWFmLHRoaXMuY2hpbGRyZW49dC5jaGlsZHJlbnx8W10sdGhpcy5iYm94PXQuYmJveH11cGRhdGVCQm94KCl7aWYoMD09PXRoaXMuY2hpbGRyZW4ubGVuZ3RoKXJldHVybiB2b2lkKHRoaXMuYmJveD1udWxsKTtsZXQgZT0xLzAsdD0tMS8wLG49MS8wLHI9LTEvMDtmb3IoY29uc3QgaSBvZiB0aGlzLmNoaWxkcmVuKXtsZXQgcztpZih0aGlzLmlzTGVhZilzPWkuYmJveDtlbHNle3M9dGhpcy5ydHJlZS5fbG9hZE5vZGUoaSkuYmJveH1zJiYoZT1NYXRoLm1pbihlLHMubWluTGF0KSx0PU1hdGgubWF4KHQscy5tYXhMYXQpLG49TWF0aC5taW4obixzLm1pbkxuZykscj1NYXRoLm1heChyLHMubWF4TG5nKSl9dGhpcy5iYm94PXttaW5MYXQ6ZSxtYXhMYXQ6dCxtaW5Mbmc6bixtYXhMbmc6cn0sdGhpcy5ydHJlZS5fc2F2ZU5vZGUodGhpcyl9dG9KU09OKCl7cmV0dXJue2lkOnRoaXMuaWQsaXNMZWFmOnRoaXMuaXNMZWFmLGNoaWxkcmVuOnRoaXMuY2hpbGRyZW4sYmJveDp0aGlzLmJib3h9fX1jbGFzcyBGdHtjb25zdHJ1Y3RvcihlLHQ9OSl7dGhpcy5maWxlPW5ldyBiKGUpLHRoaXMubWF4RW50cmllcz10LHRoaXMubWluRW50cmllcz1NYXRoLm1heCgyLE1hdGguY2VpbCh0LzIpKSx0aGlzLnJvb3RQb2ludGVyPW51bGwsdGhpcy5uZXh0SWQ9MSx0aGlzLl9zaXplPTAsdGhpcy5pc09wZW49ITF9YXN5bmMgb3Blbigpe2lmKHRoaXMuaXNPcGVuKXRocm93IG5ldyBFcnJvcigiUi10cmVlIGlzIGFscmVhZHkgb3BlbiIpO3RoaXMuZmlsZS5nZXRGaWxlU2l6ZSgpPjA/dGhpcy5fbG9hZEZyb21GaWxlKCk6dGhpcy5faW5pdGlhbGl6ZU5ld1RyZWUoKSx0aGlzLmlzT3Blbj0hMH1hc3luYyBjbG9zZSgpe3RoaXMuaXNPcGVuJiYodGhpcy5fd3JpdGVNZXRhZGF0YSgpLHRoaXMuZmlsZSYmdGhpcy5maWxlLnN5bmNBY2Nlc3NIYW5kbGUmJih0aGlzLmZpbGUuZmx1c2goKSxhd2FpdCB0aGlzLmZpbGUuc3luY0FjY2Vzc0hhbmRsZS5jbG9zZSgpKSx0aGlzLmlzT3Blbj0hMSl9X2luaXRpYWxpemVOZXdUcmVlKCl7Y29uc3QgZT1uZXcgTHQodGhpcyx7aWQ6MCxpc0xlYWY6ITAsY2hpbGRyZW46W10sYmJveDpudWxsfSk7dGhpcy5uZXh0SWQ9MSx0aGlzLl9zaXplPTAsdGhpcy5yb290UG9pbnRlcj10aGlzLl9zYXZlTm9kZShlKSx0aGlzLl93cml0ZU1ldGFkYXRhKCl9X3dyaXRlTWV0YWRhdGEoKXtjb25zdCBlPXt2ZXJzaW9uOjEsbWF4RW50cmllczp0aGlzLm1heEVudHJpZXMsbWluRW50cmllczp0aGlzLm1pbkVudHJpZXMsc2l6ZTp0aGlzLl9zaXplLHJvb3RQb2ludGVyOnRoaXMucm9vdFBvaW50ZXIsbmV4dElkOnRoaXMubmV4dElkfTt0aGlzLmZpbGUuYXBwZW5kKGUpfV9sb2FkRnJvbUZpbGUoKXtjb25zdCBlPXRoaXMuZmlsZS5nZXRGaWxlU2l6ZSgpO2lmKGU8MTM1KXRocm93IG5ldyBFcnJvcigiSW52YWxpZCBSLXRyZWUgZmlsZSBmb3JtYXQ6IGZpbGUgdG9vIHNtYWxsIGZvciBtZXRhZGF0YSIpO2NvbnN0IHQ9ZS0xMzUsbj10aGlzLmZpbGUucmVhZCh0KTt0aGlzLm1heEVudHJpZXM9bi5tYXhFbnRyaWVzLHRoaXMubWluRW50cmllcz1uLm1pbkVudHJpZXMsdGhpcy5fc2l6ZT1uLnNpemUsdGhpcy5yb290UG9pbnRlcj1uLnJvb3RQb2ludGVyLHRoaXMubmV4dElkPW4ubmV4dElkfV9zYXZlTm9kZShlKXtjb25zdCB0PWUudG9KU09OKCksbj10aGlzLmZpbGUuZ2V0RmlsZVNpemUoKTtyZXR1cm4gdGhpcy5maWxlLmFwcGVuZCh0KSxuZXcgbShuKX1fbG9hZE5vZGUoZSl7aWYoIShlIGluc3RhbmNlb2YgbSkpdGhyb3cgbmV3IEVycm9yKCJFeHBlY3RlZCBQb2ludGVyIG9iamVjdCIpO2NvbnN0IHQ9ZS52YWx1ZU9mKCksbj10aGlzLmZpbGUucmVhZCh0KTtyZXR1cm4gbmV3IEx0KHRoaXMsbil9X2xvYWRSb290KCl7cmV0dXJuIHRoaXMuX2xvYWROb2RlKHRoaXMucm9vdFBvaW50ZXIpfWluc2VydChlLHQsbil7aWYoIXRoaXMuaXNPcGVuKXRocm93IG5ldyBFcnJvcigiUi10cmVlIGZpbGUgbXVzdCBiZSBvcGVuZWQgYmVmb3JlIHVzZSIpO2lmKCEobiBpbnN0YW5jZW9mIGcpKXRocm93IG5ldyBFcnJvcigib2JqZWN0SWQgbXVzdCBiZSBhbiBpbnN0YW5jZSBvZiBPYmplY3RJZCB0byBpbnNlcnQgaW50byBydHJlZSIpO2NvbnN0IHI9e2Jib3g6e21pbkxhdDplLG1heExhdDplLG1pbkxuZzp0LG1heExuZzp0fSxsYXQ6ZSxsbmc6dCxvYmplY3RJZDpufSxpPXRoaXMuX2xvYWRSb290KCkscz10aGlzLl9pbnNlcnQocixpLDEpO2lmKHMuc3BsaXQpe2NvbnN0IGU9bmV3IEx0KHRoaXMse2lkOnRoaXMubmV4dElkKyssaXNMZWFmOiExLGNoaWxkcmVuOnMucG9pbnRlcnMsYmJveDpudWxsfSk7ZS51cGRhdGVCQm94KCksdGhpcy5yb290UG9pbnRlcj10aGlzLl9zYXZlTm9kZShlKX1lbHNlIHRoaXMucm9vdFBvaW50ZXI9cy5wb2ludGVyO3RoaXMuX3NpemUrKyx0aGlzLl93cml0ZU1ldGFkYXRhKCl9X2luc2VydChlLHQsbil7aWYodC5pc0xlYWYpe2lmKHQuY2hpbGRyZW4ucHVzaChlKSx0LnVwZGF0ZUJCb3goKSx0LmNoaWxkcmVuLmxlbmd0aD50aGlzLm1heEVudHJpZXMpe2NvbnN0W2Usbl09dGhpcy5fc3BsaXQodCk7cmV0dXJue3NwbGl0OiEwLHBvaW50ZXJzOltlLG5dfX1yZXR1cm57c3BsaXQ6ITEscG9pbnRlcjp0aGlzLl9zYXZlTm9kZSh0KX19e2NvbnN0IHI9dGhpcy5fY2hvb3NlU3VidHJlZShlLmJib3gsdCksaT10aGlzLl9sb2FkTm9kZShyKSxzPXRoaXMuX2luc2VydChlLGksbisxKTtpZihzLnNwbGl0KXtsZXQgZT0tMTtmb3IobGV0IG49MDtuPHQuY2hpbGRyZW4ubGVuZ3RoO24rKylpZih0LmNoaWxkcmVuW25dLnZhbHVlT2YoKT09PXIudmFsdWVPZigpKXtlPW47YnJlYWt9aWYoLTEhPT1lPyh0LmNoaWxkcmVuW2VdPXMucG9pbnRlcnNbMF0sdC5jaGlsZHJlbi5wdXNoKHMucG9pbnRlcnNbMV0pKToodC5jaGlsZHJlbi5wdXNoKHMucG9pbnRlcnNbMF0pLHQuY2hpbGRyZW4ucHVzaChzLnBvaW50ZXJzWzFdKSksdC51cGRhdGVCQm94KCksdC5jaGlsZHJlbi5sZW5ndGg+dGhpcy5tYXhFbnRyaWVzKXtjb25zdFtlLG5dPXRoaXMuX3NwbGl0KHQpO3JldHVybntzcGxpdDohMCxwb2ludGVyczpbZSxuXX19fWVsc2V7bGV0IGU9LTE7Zm9yKGxldCBuPTA7bjx0LmNoaWxkcmVuLmxlbmd0aDtuKyspaWYodC5jaGlsZHJlbltuXS52YWx1ZU9mKCk9PT1yLnZhbHVlT2YoKSl7ZT1uO2JyZWFrfS0xIT09ZSYmKHQuY2hpbGRyZW5bZV09cy5wb2ludGVyKSx0LnVwZGF0ZUJCb3goKX1yZXR1cm57c3BsaXQ6ITEscG9pbnRlcjp0aGlzLl9zYXZlTm9kZSh0KX19fV9jaG9vc2VTdWJ0cmVlKGUsdCl7bGV0IG49MS8wLHI9MS8wLGk9bnVsbDtmb3IoY29uc3QgcyBvZiB0LmNoaWxkcmVuKXtpZighKHMgaW5zdGFuY2VvZiBtKSl0aHJvdyBuZXcgRXJyb3IoIkV4cGVjdGVkIFBvaW50ZXIgaW4gX2Nob29zZVN1YnRyZWUsIGdvdDogIit0eXBlb2Ygcyk7Y29uc3QgdD10aGlzLl9sb2FkTm9kZShzKSxvPU10KHQuYmJveCxlKSxhPWt0KHQuYmJveCk7KG88bnx8bz09PW4mJmE8cikmJihuPW8scj1hLGk9cyl9cmV0dXJuIGl9X3NwbGl0KGUpe2NvbnN0IHQ9ZS5jaGlsZHJlbixuPWUuaXNMZWFmO2xldCByPS0xLzAsaT0wLHM9MTtmb3IobGV0IGM9MDtjPHQubGVuZ3RoO2MrKylmb3IobGV0IGU9YysxO2U8dC5sZW5ndGg7ZSsrKXtsZXQgbyxhO2lmKG4pbz10W2NdLmJib3gsYT10W2VdLmJib3g7ZWxzZXtjb25zdCBuPXRoaXMuX2xvYWROb2RlKHRbY10pLHI9dGhpcy5fbG9hZE5vZGUodFtlXSk7bz1uLmJib3gsYT1yLmJib3h9Y29uc3QgbD1rdChQdChvLGEpKTtsPnImJihyPWwsaT1jLHM9ZSl9Y29uc3Qgbz1uZXcgTHQodGhpcyx7aWQ6dGhpcy5uZXh0SWQrKyxpc0xlYWY6bixjaGlsZHJlbjpbdFtpXV0sYmJveDpudWxsfSksYT1uZXcgTHQodGhpcyx7aWQ6dGhpcy5uZXh0SWQrKyxpc0xlYWY6bixjaGlsZHJlbjpbdFtzXV0sYmJveDpudWxsfSk7Zm9yKGxldCBjPTA7Yzx0Lmxlbmd0aDtjKyspe2lmKGM9PT1pfHxjPT09cyljb250aW51ZTtjb25zdCBlPXRbY107bGV0IHI7aWYobilyPWUuYmJveDtlbHNle3I9dGhpcy5fbG9hZE5vZGUoZSkuYmJveH1vLnVwZGF0ZUJCb3goKSxhLnVwZGF0ZUJCb3goKTtjb25zdCBsPW8uYmJveD9NdChvLmJib3gscik6MCx1PWEuYmJveD9NdChhLmJib3gscik6MDtsPHU/by5jaGlsZHJlbi5wdXNoKGUpOnU8bD9hLmNoaWxkcmVuLnB1c2goZSk6by5jaGlsZHJlbi5sZW5ndGg8PWEuY2hpbGRyZW4ubGVuZ3RoP28uY2hpbGRyZW4ucHVzaChlKTphLmNoaWxkcmVuLnB1c2goZSl9by51cGRhdGVCQm94KCksYS51cGRhdGVCQm94KCk7cmV0dXJuW3RoaXMuX3NhdmVOb2RlKG8pLHRoaXMuX3NhdmVOb2RlKGEpXX1zZWFyY2hCQm94KGUpe2lmKCF0aGlzLmlzT3Blbil0aHJvdyBuZXcgRXJyb3IoIlItdHJlZSBmaWxlIG11c3QgYmUgb3BlbmVkIGJlZm9yZSB1c2UiKTtjb25zdCB0PVtdLG49dGhpcy5fbG9hZFJvb3QoKTtyZXR1cm4gdGhpcy5fc2VhcmNoQkJveChlLG4sdCksdH1fc2VhcmNoQkJveChlLHQsbil7aWYodC5iYm94JiZEdChlLHQuYmJveCkpaWYodC5pc0xlYWYpZm9yKGNvbnN0IHIgb2YgdC5jaGlsZHJlbilEdChlLHIuYmJveCkmJm4ucHVzaCh7b2JqZWN0SWQ6ci5vYmplY3RJZCxsYXQ6ci5sYXQsbG5nOnIubG5nfSk7ZWxzZSBmb3IoY29uc3QgciBvZiB0LmNoaWxkcmVuKXtjb25zdCB0PXRoaXMuX2xvYWROb2RlKHIpO3RoaXMuX3NlYXJjaEJCb3goZSx0LG4pfX1zZWFyY2hSYWRpdXMoZSx0LG4pe2NvbnN0IHI9ZnVuY3Rpb24oZSx0LG4pe2NvbnN0IHI9bi8xMTEsaT1uLygxMTEqTWF0aC5jb3MoZSpNYXRoLlBJLzE4MCkpO3JldHVybnttaW5MYXQ6ZS1yLG1heExhdDplK3IsbWluTG5nOnQtaSxtYXhMbmc6dCtpfX0oZSx0LG4pLGk9dGhpcy5fbG9hZFJvb3QoKSxzPVtdO3RoaXMuX3NlYXJjaEJCb3hFbnRyaWVzKHIsaSxzKTtjb25zdCBvPVtdO2Zvcihjb25zdCBhIG9mIHMpe2NvbnN0IHI9anQoZSx0LGEubGF0LGEubG5nKTtyPD1uJiZvLnB1c2goe29iamVjdElkOmEub2JqZWN0SWQsbGF0OmEubGF0LGxuZzphLmxuZyxkaXN0YW5jZTpyfSl9cmV0dXJuIG99X3NlYXJjaEJCb3hFbnRyaWVzKGUsdCxuKXtpZih0LmJib3gmJkR0KGUsdC5iYm94KSlpZih0LmlzTGVhZilmb3IoY29uc3QgciBvZiB0LmNoaWxkcmVuKUR0KGUsci5iYm94KSYmbi5wdXNoKHIpO2Vsc2UgZm9yKGNvbnN0IHIgb2YgdC5jaGlsZHJlbil7Y29uc3QgdD10aGlzLl9sb2FkTm9kZShyKTt0aGlzLl9zZWFyY2hCQm94RW50cmllcyhlLHQsbil9fXJlbW92ZShlKXtpZighdGhpcy5pc09wZW4pdGhyb3cgbmV3IEVycm9yKCJSLXRyZWUgZmlsZSBtdXN0IGJlIG9wZW5lZCBiZWZvcmUgdXNlIik7aWYoIShlIGluc3RhbmNlb2YgZykpdGhyb3cgbmV3IEVycm9yKCJvYmplY3RJZCBtdXN0IGJlIGFuIGluc3RhbmNlIG9mIE9iamVjdElkIHRvIHJlbW92ZSBmcm9tIHJ0cmVlIik7Y29uc3QgdD10aGlzLl9sb2FkUm9vdCgpLG49dGhpcy5fcmVtb3ZlKGUsdCk7aWYoIW4uZm91bmQpcmV0dXJuITE7aWYobi51bmRlcmZsb3cmJm4uY2hpbGRyZW4paWYoMD09PW4uY2hpbGRyZW4ubGVuZ3RoKXtjb25zdCBlPW5ldyBMdCh0aGlzLHtpZDp0aGlzLm5leHRJZCsrLGlzTGVhZjohMCxjaGlsZHJlbjpbXSxiYm94Om51bGx9KTt0aGlzLnJvb3RQb2ludGVyPXRoaXMuX3NhdmVOb2RlKGUpfWVsc2UgaWYoMSE9PW4uY2hpbGRyZW4ubGVuZ3RofHxuLmlzTGVhZil7Y29uc3QgZT1uZXcgTHQodGhpcyx7aWQ6dC5pZCxpc0xlYWY6bi5pc0xlYWYsY2hpbGRyZW46bi5jaGlsZHJlbixiYm94Om51bGx9KTtlLnVwZGF0ZUJCb3goKSx0aGlzLnJvb3RQb2ludGVyPXRoaXMuX3NhdmVOb2RlKGUpfWVsc2UgdGhpcy5yb290UG9pbnRlcj1uLmNoaWxkcmVuWzBdO2Vsc2Ugbi5wb2ludGVyJiYodGhpcy5yb290UG9pbnRlcj1uLnBvaW50ZXIpO3JldHVybiB0aGlzLl9zaXplLS0sdGhpcy5fd3JpdGVNZXRhZGF0YSgpLCEwfV9yZW1vdmUoZSx0KXtpZih0LmlzTGVhZil7Y29uc3Qgbj10LmNoaWxkcmVuLmxlbmd0aDtpZih0LmNoaWxkcmVuPXQuY2hpbGRyZW4uZmlsdGVyKHQ9PiF0Lm9iamVjdElkLmVxdWFscyhlKSksdC5jaGlsZHJlbi5sZW5ndGg9PT1uKXJldHVybntmb3VuZDohMX07dC51cGRhdGVCQm94KCk7Y29uc3Qgcj10aGlzLl9zYXZlTm9kZSh0KTtyZXR1cm57Zm91bmQ6ITAsdW5kZXJmbG93OnQuY2hpbGRyZW4ubGVuZ3RoPHRoaXMubWluRW50cmllcyYmdC5jaGlsZHJlbi5sZW5ndGg+MCxwb2ludGVyOnIsY2hpbGRyZW46dC5jaGlsZHJlbixpc0xlYWY6ITB9fXtsZXQgbj1bLi4udC5jaGlsZHJlbl07Zm9yKGxldCByPTA7cjxuLmxlbmd0aDtyKyspe2NvbnN0IGk9bltyXSxzPXRoaXMuX2xvYWROb2RlKGkpLG89dGhpcy5fcmVtb3ZlKGUscyk7aWYoby5mb3VuZCl7aWYoby51bmRlcmZsb3cpe2NvbnN0IGU9dGhpcy5faGFuZGxlVW5kZXJmbG93KHQscixzLG8pO2UubWVyZ2VkP249ZS5jaGlsZHJlbjpuW3JdPW8ucG9pbnRlcn1lbHNlIG5bcl09by5wb2ludGVyO2NvbnN0IGU9bmV3IEx0KHRoaXMse2lkOnQuaWQsaXNMZWFmOiExLGNoaWxkcmVuOm4sYmJveDpudWxsfSk7ZS51cGRhdGVCQm94KCk7Y29uc3QgaT10aGlzLl9zYXZlTm9kZShlKTtyZXR1cm57Zm91bmQ6ITAsdW5kZXJmbG93Om4ubGVuZ3RoPHRoaXMubWluRW50cmllcyYmbi5sZW5ndGg+MCxwb2ludGVyOmksY2hpbGRyZW46bixpc0xlYWY6ITF9fX1yZXR1cm57Zm91bmQ6ITF9fX1faGFuZGxlVW5kZXJmbG93KGUsdCxuLHIpe2NvbnN0IGk9W107aWYodD4wKXtjb25zdCBuPWUuY2hpbGRyZW5bdC0xXSxyPXRoaXMuX2xvYWROb2RlKG4pO2kucHVzaCh7aW5kZXg6dC0xLG5vZGU6cixwb2ludGVyOm59KX1pZih0PGUuY2hpbGRyZW4ubGVuZ3RoLTEpe2NvbnN0IG49ZS5jaGlsZHJlblt0KzFdLHI9dGhpcy5fbG9hZE5vZGUobik7aS5wdXNoKHtpbmRleDp0KzEsbm9kZTpyLHBvaW50ZXI6bn0pfWZvcihjb25zdCBzIG9mIGkpaWYocy5ub2RlLmNoaWxkcmVuLmxlbmd0aD50aGlzLm1pbkVudHJpZXMpe2NvbnN0IGk9Wy4uLnIuY2hpbGRyZW4sLi4ucy5ub2RlLmNoaWxkcmVuXSxvPU1hdGguY2VpbChpLmxlbmd0aC8yKSxhPWkuc2xpY2UoMCxvKSxjPWkuc2xpY2UobyksbD1uZXcgTHQodGhpcyx7aWQ6bi5pZCxpc0xlYWY6ci5pc0xlYWYsY2hpbGRyZW46YSxiYm94Om51bGx9KTtsLnVwZGF0ZUJCb3goKTtjb25zdCB1PW5ldyBMdCh0aGlzLHtpZDpzLm5vZGUuaWQsaXNMZWFmOnMubm9kZS5pc0xlYWYsY2hpbGRyZW46YyxiYm94Om51bGx9KTt1LnVwZGF0ZUJCb3goKTtjb25zdCBoPXRoaXMuX3NhdmVOb2RlKGwpLGY9dGhpcy5fc2F2ZU5vZGUodSksZD1bLi4uZS5jaGlsZHJlbl0scD1NYXRoLm1pbih0LHMuaW5kZXgpLGc9TWF0aC5tYXgodCxzLmluZGV4KTtyZXR1cm4gZFtwXT1oLGRbZ109Zix7bWVyZ2VkOiEwLGNoaWxkcmVuOmR9fWlmKGkubGVuZ3RoPjApe2NvbnN0IG49aVswXSxzPVsuLi5yLmNoaWxkcmVuLC4uLm4ubm9kZS5jaGlsZHJlbl0sbz1uZXcgTHQodGhpcyx7aWQ6dGhpcy5uZXh0SWQrKyxpc0xlYWY6ci5pc0xlYWYsY2hpbGRyZW46cyxiYm94Om51bGx9KTtvLnVwZGF0ZUJCb3goKTtjb25zdCBhPXRoaXMuX3NhdmVOb2RlKG8pLGM9ZS5jaGlsZHJlbi5maWx0ZXIoKGUscik9PnIhPT10JiZyIT09bi5pbmRleCk7cmV0dXJuIGMucHVzaChhKSx7bWVyZ2VkOiEwLGNoaWxkcmVuOmN9fXJldHVybnttZXJnZWQ6ITF9fXNpemUoKXtyZXR1cm4gdGhpcy5fc2l6ZX1hc3luYyBjbGVhcigpe2NvbnN0IGU9bmV3IEx0KHRoaXMse2lkOnRoaXMubmV4dElkKyssaXNMZWFmOiEwLGNoaWxkcmVuOltdLGJib3g6bnVsbH0pO3RoaXMucm9vdFBvaW50ZXI9dGhpcy5fc2F2ZU5vZGUoZSksdGhpcy5fc2l6ZT0wLHRoaXMuX3dyaXRlTWV0YWRhdGEoKX1hc3luYyBjb21wYWN0KGUpe2lmKCF0aGlzLmlzT3Blbil0aHJvdyBuZXcgRXJyb3IoIlItdHJlZSBmaWxlIG11c3QgYmUgb3BlbmVkIGJlZm9yZSB1c2UiKTtpZighZSl0aHJvdyBuZXcgRXJyb3IoIkRlc3RpbmF0aW9uIHN5bmMgaGFuZGxlIGlzIHJlcXVpcmVkIGZvciBjb21wYWN0aW9uIik7dGhpcy5fd3JpdGVNZXRhZGF0YSgpO2NvbnN0IHQ9dGhpcy5maWxlLmdldEZpbGVTaXplKCksbj1uZXcgRnQoZSx0aGlzLm1heEVudHJpZXMpO2F3YWl0IG4ub3BlbigpLG4ubWluRW50cmllcz10aGlzLm1pbkVudHJpZXMsbi5uZXh0SWQ9dGhpcy5uZXh0SWQsbi5fc2l6ZT10aGlzLl9zaXplO2NvbnN0IHI9LyogQF9fUFVSRV9fICovbmV3IE1hcCxpPWU9Pntjb25zdCB0PWUudmFsdWVPZigpO2lmKHIuaGFzKHQpKXJldHVybiByLmdldCh0KTtjb25zdCBzPXRoaXMuX2xvYWROb2RlKGUpLG89W107aWYocy5pc0xlYWYpZm9yKGNvbnN0IG4gb2Ygcy5jaGlsZHJlbilvLnB1c2gobik7ZWxzZSBmb3IoY29uc3QgbiBvZiBzLmNoaWxkcmVuKXtjb25zdCBlPWkobik7by5wdXNoKGUpfWNvbnN0IGE9bmV3IEx0KG4se2lkOnMuaWQsaXNMZWFmOnMuaXNMZWFmLGNoaWxkcmVuOm8sYmJveDpzLmJib3h9KSxjPW4uX3NhdmVOb2RlKGEpO3JldHVybiByLnNldCh0LGMpLGN9LHM9aSh0aGlzLnJvb3RQb2ludGVyKTtuLnJvb3RQb2ludGVyPXMsbi5fd3JpdGVNZXRhZGF0YSgpO2NvbnN0IG89bi5maWxlLmdldEZpbGVTaXplKCk7cmV0dXJuIGF3YWl0IG4uY2xvc2UoKSx7b2xkU2l6ZTp0LG5ld1NpemU6byxieXRlc1NhdmVkOk1hdGgubWF4KDAsdC1vKX19fWNsYXNzIFR0IGV4dGVuZHMgdXR7Y29uc3RydWN0b3IoZSx0LG4scj17fSl7c3VwZXIoZSx0LG4sciksdGhpcy5nZW9GaWVsZD1PYmplY3Qua2V5cyh0KVswXSx0aGlzLnN0b3JhZ2VGaWxlUGF0aD1uLHRoaXMucnRyZWU9bnVsbCx0aGlzLnN5bmNIYW5kbGU9bnVsbCx0aGlzLmlzT3Blbj0hMX1hc3luYyBvcGVuKCl7aWYoIXRoaXMuaXNPcGVuKXRyeXtjb25zdCBlPXRoaXMuc3RvcmFnZUZpbGVQYXRoLnNwbGl0KCIvIikuZmlsdGVyKEJvb2xlYW4pLHQ9ZS5wb3AoKTtpZighdCl0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgc3RvcmFnZSBwYXRoOiAke3RoaXMuc3RvcmFnZUZpbGVQYXRofWApO2xldCBuPWF3YWl0IGdsb2JhbFRoaXMubmF2aWdhdG9yLnN0b3JhZ2UuZ2V0RGlyZWN0b3J5KCk7Zm9yKGNvbnN0IGkgb2YgZSluPWF3YWl0IG4uZ2V0RGlyZWN0b3J5SGFuZGxlKGkse2NyZWF0ZTohMH0pO2NvbnN0IHI9YXdhaXQgbi5nZXRGaWxlSGFuZGxlKHQse2NyZWF0ZTohMH0pO3RoaXMuc3luY0hhbmRsZT1hd2FpdCByLmNyZWF0ZVN5bmNBY2Nlc3NIYW5kbGUoKSx0aGlzLnJ0cmVlPW5ldyBGdCh0aGlzLnN5bmNIYW5kbGUsOSksYXdhaXQgdGhpcy5ydHJlZS5vcGVuKCksdGhpcy5pc09wZW49ITB9Y2F0Y2goZSl7aWYoISgiRU5PRU5UIj09PWUuY29kZXx8ZS5tZXNzYWdlJiYoZS5tZXNzYWdlLmluY2x1ZGVzKCJJbnZhbGlkIFItdHJlZSIpfHxlLm1lc3NhZ2UuaW5jbHVkZXMoImZpbGUgdG9vIHNtYWxsIil8fGUubWVzc2FnZS5pbmNsdWRlcygiRmFpbGVkIHRvIHJlYWQgbWV0YWRhdGEiKXx8ZS5tZXNzYWdlLmluY2x1ZGVzKCJVbmtub3duIHR5cGUgYnl0ZSIpKSkpdGhyb3cgZTt7aWYodGhpcy5zeW5jSGFuZGxlKXt0cnl7YXdhaXQgdGhpcy5zeW5jSGFuZGxlLmNsb3NlKCl9Y2F0Y2godCl7fXRoaXMuc3luY0hhbmRsZT1udWxsfWNvbnN0IGU9dGhpcy5zdG9yYWdlRmlsZVBhdGguc3BsaXQoIi8iKS5maWx0ZXIoQm9vbGVhbiksbj1lLnBvcCgpO2lmKCFuKXRocm93IG5ldyBFcnJvcihgSW52YWxpZCBzdG9yYWdlIHBhdGg6ICR7dGhpcy5zdG9yYWdlRmlsZVBhdGh9YCk7bGV0IHI9YXdhaXQgZ2xvYmFsVGhpcy5uYXZpZ2F0b3Iuc3RvcmFnZS5nZXREaXJlY3RvcnkoKTtmb3IoY29uc3QgdCBvZiBlKXI9YXdhaXQgci5nZXREaXJlY3RvcnlIYW5kbGUodCx7Y3JlYXRlOiEwfSk7dHJ5e2F3YWl0IHIucmVtb3ZlRW50cnkobil9Y2F0Y2godCl7fWNvbnN0IGk9YXdhaXQgci5nZXRGaWxlSGFuZGxlKG4se2NyZWF0ZTohMH0pO3RoaXMuc3luY0hhbmRsZT1hd2FpdCBpLmNyZWF0ZVN5bmNBY2Nlc3NIYW5kbGUoKSx0aGlzLnJ0cmVlPW5ldyBGdCh0aGlzLnN5bmNIYW5kbGUsOSksYXdhaXQgdGhpcy5ydHJlZS5vcGVuKCksdGhpcy5pc09wZW49ITB9fX1hc3luYyBjbG9zZSgpe2lmKHRoaXMuaXNPcGVuKXt0cnl7YXdhaXQgdGhpcy5ydHJlZS5jbG9zZSgpfWNhdGNoKGUpe2lmKCFlLm1lc3NhZ2V8fCFlLm1lc3NhZ2UuaW5jbHVkZXMoIkZpbGUgaXMgbm90IG9wZW4iKSl0aHJvdyBlfXRoaXMuaXNPcGVuPSExfX1fZXh0cmFjdENvb3JkaW5hdGVzKGUpe2lmKCFlKXJldHVybiBudWxsO2lmKCJGZWF0dXJlQ29sbGVjdGlvbiI9PT1lLnR5cGUmJmUuZmVhdHVyZXMmJmUuZmVhdHVyZXMubGVuZ3RoPjApe2NvbnN0IHQ9ZS5mZWF0dXJlc1swXTtpZih0Lmdlb21ldHJ5KXJldHVybiB0aGlzLl9leHRyYWN0Q29vcmRpbmF0ZXModC5nZW9tZXRyeSl9aWYoIkZlYXR1cmUiPT09ZS50eXBlJiZlLmdlb21ldHJ5KXJldHVybiB0aGlzLl9leHRyYWN0Q29vcmRpbmF0ZXMoZS5nZW9tZXRyeSk7aWYoIlBvaW50Ij09PWUudHlwZSYmZS5jb29yZGluYXRlcyl7Y29uc3RbdCxuXT1lLmNvb3JkaW5hdGVzO2lmKCJudW1iZXIiPT10eXBlb2YgdCYmIm51bWJlciI9PXR5cGVvZiBuKXJldHVybntsYXQ6bixsbmc6dH19aWYoIlBvbHlnb24iPT09ZS50eXBlJiZlLmNvb3JkaW5hdGVzJiZlLmNvb3JkaW5hdGVzLmxlbmd0aD4wKXtjb25zdCB0PWUuY29vcmRpbmF0ZXNbMF07aWYodC5sZW5ndGg+MCl7bGV0IGU9MCxuPTA7Zm9yKGNvbnN0IHIgb2YgdCluKz1yWzBdLGUrPXJbMV07cmV0dXJue2xhdDplL3QubGVuZ3RoLGxuZzpuL3QubGVuZ3RofX19cmV0dXJuIG51bGx9YXN5bmMgYWRkKGUpe2lmKCFlLl9pZCl0aHJvdyBuZXcgRXJyb3IoIkRvY3VtZW50IG11c3QgaGF2ZSBhbiBfaWQgZmllbGQiKTtjb25zdCB0PXYoZSx0aGlzLmdlb0ZpZWxkKSxuPXRoaXMuX2V4dHJhY3RDb29yZGluYXRlcyh0KTtuJiZhd2FpdCB0aGlzLnJ0cmVlLmluc2VydChuLmxhdCxuLmxuZyxlLl9pZCl9YXN5bmMgcmVtb3ZlKGUpe2lmKGUuX2lkKXtpZighKGUuX2lkIGluc3RhbmNlb2YgZykpdGhyb3cgY29uc29sZS5lcnJvcihlKSxuZXcgRXJyb3IoIkRvY3VtZW50IF9pZCBtdXN0IGJlIGFuIE9iamVjdElkIHRvIHJlbW92ZSBmcm9tIGdlb3NwYXRpYWwgaW5kZXgiKTthd2FpdCB0aGlzLnJ0cmVlLnJlbW92ZShlLl9pZCl9fWFzeW5jIHF1ZXJ5KGUpe2lmKHRoaXMuaXNPcGVufHxhd2FpdCB0aGlzLm9wZW4oKSwhZVt0aGlzLmdlb0ZpZWxkXSlyZXR1cm4gbnVsbDtjb25zdCB0PWVbdGhpcy5nZW9GaWVsZF07aWYodC4kZ2VvV2l0aGluKXtjb25zdCBlPXQuJGdlb1dpdGhpbjtpZihBcnJheS5pc0FycmF5KGUpJiYyPT09ZS5sZW5ndGgpe2NvbnN0IHQ9ZVswXVswXSxuPWVbMF1bMV0scj1lWzFdWzBdLGk9ZVsxXVsxXTtyZXR1cm4oYXdhaXQgdGhpcy5ydHJlZS5zZWFyY2hCQm94KHttaW5MYXQ6aSxtYXhMYXQ6bixtaW5Mbmc6dCxtYXhMbmc6cn0pKS5tYXAoZT0+ZS5vYmplY3RJZC50b1N0cmluZygpKX19aWYodC4kbmVhcil7Y29uc3QgZT10LiRuZWFyO2xldCBuO2lmKGUuJGdlb21ldHJ5KW49ZS4kZ2VvbWV0cnkuY29vcmRpbmF0ZXM7ZWxzZSBpZihlLmNvb3JkaW5hdGVzKW49ZS5jb29yZGluYXRlcztlbHNle2lmKCFBcnJheS5pc0FycmF5KGUpKXJldHVybiBudWxsO249ZX1pZighbnx8bi5sZW5ndGg8MilyZXR1cm4gbnVsbDtjb25zdFtyLGldPW4scz0oZS4kbWF4RGlzdGFuY2V8fDFlNikvMWUzLG89YXdhaXQgdGhpcy5ydHJlZS5zZWFyY2hSYWRpdXMoaSxyLHMpO3JldHVybiBvLnNvcnQoKGUsdCk9PmUuZGlzdGFuY2UtdC5kaXN0YW5jZSksby5tYXAoZT0+ZS5vYmplY3RJZC50b1N0cmluZygpKX1pZih0LiRuZWFyU3BoZXJlKXtjb25zdCBlPXQuJG5lYXJTcGhlcmU7bGV0IG47aWYoZS4kZ2VvbWV0cnkpbj1lLiRnZW9tZXRyeS5jb29yZGluYXRlcztlbHNlIGlmKGUuY29vcmRpbmF0ZXMpbj1lLmNvb3JkaW5hdGVzO2Vsc2V7aWYoIUFycmF5LmlzQXJyYXkoZSkpcmV0dXJuIG51bGw7bj1lfWlmKCFufHxuLmxlbmd0aDwyKXJldHVybiBudWxsO2NvbnN0W3IsaV09bixzPShlLiRtYXhEaXN0YW5jZXx8MWU2KS8xZTMsbz1hd2FpdCB0aGlzLnJ0cmVlLnNlYXJjaFJhZGl1cyhpLHIscyk7cmV0dXJuIG8uc29ydCgoZSx0KT0+ZS5kaXN0YW5jZS10LmRpc3RhbmNlKSxvLm1hcChlPT5lLm9iamVjdElkLnRvU3RyaW5nKCkpfWlmKHQuJGdlb0ludGVyc2VjdHMpe2NvbnN0IGU9dC4kZ2VvSW50ZXJzZWN0cztsZXQgbjtpZighZS4kZ2VvbWV0cnkpcmV0dXJuIG51bGw7aWYobj1lLiRnZW9tZXRyeSwhbnx8IW4udHlwZSlyZXR1cm4gbnVsbDtpZigiUG9pbnQiPT09bi50eXBlKXtjb25zdFtlLHRdPW4uY29vcmRpbmF0ZXMscj0xZS00O3JldHVybihhd2FpdCB0aGlzLnJ0cmVlLnNlYXJjaEJCb3goe21pbkxhdDp0LXIsbWF4TGF0OnQrcixtaW5Mbmc6ZS1yLG1heExuZzplK3J9KSkubWFwKGU9PmUub2JqZWN0SWQudG9TdHJpbmcoKSl9aWYoIlBvbHlnb24iPT09bi50eXBlKXtjb25zdCBlPW4uY29vcmRpbmF0ZXM7aWYoIWV8fDA9PT1lLmxlbmd0aClyZXR1cm4gbnVsbDtjb25zdCB0PWVbMF07aWYoIXR8fHQubGVuZ3RoPDMpcmV0dXJuIG51bGw7bGV0IHI9MS8wLGk9LTEvMCxzPTEvMCxvPS0xLzA7Zm9yKGNvbnN0IG4gb2YgdCl7Y29uc3RbZSx0XT1uO3I9TWF0aC5taW4ocix0KSxpPU1hdGgubWF4KGksdCkscz1NYXRoLm1pbihzLGUpLG89TWF0aC5tYXgobyxlKX1yZXR1cm4oYXdhaXQgdGhpcy5ydHJlZS5zZWFyY2hCQm94KHttaW5MYXQ6cixtYXhMYXQ6aSxtaW5Mbmc6cyxtYXhMbmc6b30pKS5maWx0ZXIoZT0+dGhpcy5fcG9pbnRJblBvbHlnb24oZS5sYXQsZS5sbmcsdCkpLm1hcChlPT5lLm9iamVjdElkLnRvU3RyaW5nKCkpfXJldHVybiBudWxsfXJldHVybiBudWxsfV9wb2ludEluUG9seWdvbihlLHQsbil7bGV0IHI9ITE7Zm9yKGxldCBpPTAscz1uLmxlbmd0aC0xO2k8bi5sZW5ndGg7cz1pKyspe2NvbnN0W28sYV09bltpXSxbYyxsXT1uW3NdO2E+ZSE9bD5lJiZ0PChjLW8pKihlLWEpLyhsLWEpK28mJihyPSFyKX1yZXR1cm4gcn1hc3luYyBjbGVhcigpe2F3YWl0IHRoaXMuY2xvc2UoKTt0cnl7Y29uc3QgZT10aGlzLnN0b3JhZ2VGaWxlUGF0aC5zcGxpdCgiLyIpLmZpbHRlcihCb29sZWFuKSx0PWUucG9wKCk7bGV0IG49YXdhaXQgZ2xvYmFsVGhpcy5uYXZpZ2F0b3Iuc3RvcmFnZS5nZXREaXJlY3RvcnkoKTtmb3IoY29uc3QgciBvZiBlKW49YXdhaXQgbi5nZXREaXJlY3RvcnlIYW5kbGUocix7Y3JlYXRlOiExfSk7YXdhaXQgbi5yZW1vdmVFbnRyeSh0KX1jYXRjaChlKXtpZighZXx8Ik5vdEZvdW5kRXJyb3IiIT09ZS5uYW1lKXRocm93IGV9YXdhaXQgdGhpcy5vcGVuKCl9Z2V0U3BlYygpe3JldHVybntuYW1lOnRoaXMubmFtZSxrZXk6dGhpcy5rZXlzLCIyZHNwaGVyZUluZGV4VmVyc2lvbiI6M319fWNsYXNzIEJ0e2NvbnN0cnVjdG9yKCl7dGhpcy50eXBlPSJmdWxsX3NjYW4iLHRoaXMuaW5kZXhlcz1bXSx0aGlzLmluZGV4U2NhbnM9W10sdGhpcy5lc3RpbWF0ZWRDb3N0PTEvMCx0aGlzLmluZGV4T25seT0hMX19Y2xhc3MgenR7Y29uc3RydWN0b3IoZSl7dGhpcy5pbmRleGVzPWV9cGxhbihlKXtjb25zdCB0PW5ldyBCdDtpZighZXx8MD09PU9iamVjdC5rZXlzKGUpLmxlbmd0aClyZXR1cm4gdDtjb25zdCBuPXRoaXMuX2FuYWx5emVRdWVyeShlKTtpZihuLmhhc1RleHRTZWFyY2gpe2NvbnN0IHQ9dGhpcy5fcGxhblRleHRTZWFyY2goZSxuKTtpZih0KXJldHVybiB0fWlmKG4uaGFzR2VvUXVlcnkpe2NvbnN0IHQ9dGhpcy5fcGxhbkdlb1F1ZXJ5KGUsbik7aWYodClyZXR1cm4gdH1pZigiYW5kIj09PW4udHlwZSl7Y29uc3QgdD10aGlzLl9wbGFuQW5kUXVlcnkoZSxuKTtpZigiZnVsbF9zY2FuIiE9PXQudHlwZSlyZXR1cm4gdH1pZigib3IiPT09bi50eXBlKXtjb25zdCB0PXRoaXMuX3BsYW5PclF1ZXJ5KGUsbik7aWYoImZ1bGxfc2NhbiIhPT10LnR5cGUpcmV0dXJuIHR9Y29uc3Qgcj10aGlzLl9wbGFuU2ltcGxlUXVlcnkoZSk7cmV0dXJuImZ1bGxfc2NhbiIhPT1yLnR5cGU/cjp0fV9hbmFseXplUXVlcnkoZSl7Y29uc3QgdD17dHlwZToic2ltcGxlIixmaWVsZHM6W10sb3BlcmF0b3JzOnt9LGhhc1RleHRTZWFyY2g6ITEsaGFzR2VvUXVlcnk6ITEsY29uZGl0aW9uczpbXX0sbj1PYmplY3Qua2V5cyhlKTtpZigxPT09bi5sZW5ndGgpe2NvbnN0IHI9blswXTtpZigiJGFuZCI9PT1yKXt0LnR5cGU9ImFuZCIsdC5jb25kaXRpb25zPWUuJGFuZDtmb3IoY29uc3QgZSBvZiB0LmNvbmRpdGlvbnMpe2NvbnN0IG49dGhpcy5fYW5hbHl6ZVF1ZXJ5KGUpO3QuZmllbGRzLnB1c2goLi4ubi5maWVsZHMpLG4uaGFzVGV4dFNlYXJjaCYmKHQuaGFzVGV4dFNlYXJjaD0hMCksbi5oYXNHZW9RdWVyeSYmKHQuaGFzR2VvUXVlcnk9ITApfXJldHVybiB0fWlmKCIkb3IiPT09cil7dC50eXBlPSJvciIsdC5jb25kaXRpb25zPWUuJG9yO2Zvcihjb25zdCBlIG9mIHQuY29uZGl0aW9ucyl7Y29uc3Qgbj10aGlzLl9hbmFseXplUXVlcnkoZSk7dC5maWVsZHMucHVzaCguLi5uLmZpZWxkcyksbi5oYXNUZXh0U2VhcmNoJiYodC5oYXNUZXh0U2VhcmNoPSEwKSxuLmhhc0dlb1F1ZXJ5JiYodC5oYXNHZW9RdWVyeT0hMCl9cmV0dXJuIHR9fWZvcihjb25zdCByIG9mIG4pe2lmKHIuc3RhcnRzV2l0aCgiJCIpKWNvbnRpbnVlO3QuZmllbGRzLnB1c2gocik7Y29uc3Qgbj1lW3JdO2lmKCJvYmplY3QiPT10eXBlb2YgbiYmbnVsbCE9PW4mJiFBcnJheS5pc0FycmF5KG4pKXtjb25zdCBlPU9iamVjdC5rZXlzKG4pO3Qub3BlcmF0b3JzW3JdPWUsZS5pbmNsdWRlcygiJHRleHQiKSYmKHQuaGFzVGV4dFNlYXJjaD0hMCksZS5zb21lKGU9PlsiJGdlb1dpdGhpbiIsIiRnZW9JbnRlcnNlY3RzIiwiJG5lYXIiLCIkbmVhclNwaGVyZSJdLmluY2x1ZGVzKGUpKSYmKHQuaGFzR2VvUXVlcnk9ITApfX1yZXR1cm4gbi5sZW5ndGg+MSYmKHQudHlwZT0iYW5kIiksdH1fcGxhblRleHRTZWFyY2goZSx0KXtmb3IoY29uc3RbbixyXW9mIHRoaXMuaW5kZXhlcylpZihyIGluc3RhbmNlb2YgRXQpe2NvbnN0IHQ9dGhpcy5fZXh0cmFjdFRleHRRdWVyeShlKTtpZih0KXtjb25zdCBlPW5ldyBCdDtyZXR1cm4gZS50eXBlPSJpbmRleF9zY2FuIixlLmluZGV4ZXM9W25dLGUuaW5kZXhTY2Fucz1be2luZGV4TmFtZTpuLGluZGV4OnIsdGV4dFF1ZXJ5OnR9XSxlLmVzdGltYXRlZENvc3Q9MTAwLGUuaW5kZXhPbmx5PSEwLGV9fXJldHVybiBudWxsfV9leHRyYWN0VGV4dFF1ZXJ5KGUpe2Zvcihjb25zdCB0IGluIGUpe2NvbnN0IG49ZVt0XTtpZigib2JqZWN0Ij09dHlwZW9mIG4mJm51bGwhPT1uJiZuLiR0ZXh0KXJldHVybiJzdHJpbmciPT10eXBlb2Ygbi4kdGV4dD9uLiR0ZXh0Om4uJHRleHQuJHNlYXJjaH1yZXR1cm4gbnVsbH1fcGxhbkdlb1F1ZXJ5KGUsdCl7Zm9yKGNvbnN0W24scl1vZiB0aGlzLmluZGV4ZXMpaWYociBpbnN0YW5jZW9mIFR0KXtjb25zdCB0PW5ldyBCdDtyZXR1cm4gdC50eXBlPSJpbmRleF9zY2FuIix0LmluZGV4ZXM9W25dLHQuaW5kZXhTY2Fucz1be2luZGV4TmFtZTpuLGluZGV4OnIscXVlcnk6ZX1dLHQuZXN0aW1hdGVkQ29zdD0xMDAsdC5pbmRleE9ubHk9ITAsdH1yZXR1cm4gbnVsbH1fcGxhbkFuZFF1ZXJ5KGUsdCl7Y29uc3Qgbj1uZXcgQnQ7bGV0IHI7cj1lLiRhbmQ/ZS4kYW5kOk9iamVjdC5rZXlzKGUpLm1hcCh0PT4oe1t0XTplW3RdfSkpO2NvbnN0IGk9W107Zm9yKGNvbnN0IHMgb2Ygcil7Y29uc3QgZT10aGlzLl9wbGFuU2ltcGxlUXVlcnkocyk7ImluZGV4X3NjYW4iPT09ZS50eXBlJiZpLnB1c2goZS5pbmRleFNjYW5zWzBdKX1yZXR1cm4gaS5sZW5ndGg+MT8obi50eXBlPSJpbmRleF9pbnRlcnNlY3Rpb24iLG4uaW5kZXhTY2Fucz1pLG4uaW5kZXhlcz1pLm1hcChlPT5lLmluZGV4TmFtZSksbi5lc3RpbWF0ZWRDb3N0PTUwLG4pOjE9PT1pLmxlbmd0aD8obi50eXBlPSJpbmRleF9zY2FuIixuLmluZGV4U2NhbnM9W2lbMF1dLG4uaW5kZXhlcz1baVswXS5pbmRleE5hbWVdLG4uZXN0aW1hdGVkQ29zdD01MCxuKTpufV9wbGFuT3JRdWVyeShlLHQpe2NvbnN0IG49bmV3IEJ0O2lmKCFlLiRvcilyZXR1cm4gbjtjb25zdCByPWUuJG9yLGk9W107Zm9yKGNvbnN0IHMgb2Ygcil7Y29uc3QgZT10aGlzLl9wbGFuU2ltcGxlUXVlcnkocyk7ImluZGV4X3NjYW4iPT09ZS50eXBlJiZpLnB1c2goZS5pbmRleFNjYW5zWzBdKX1yZXR1cm4gaS5sZW5ndGg+MD8obi50eXBlPSJpbmRleF91bmlvbiIsbi5pbmRleFNjYW5zPWksbi5pbmRleGVzPWkubWFwKGU9PmUuaW5kZXhOYW1lKSxuLmVzdGltYXRlZENvc3Q9MTAwKmkubGVuZ3RoLG4pOm59X3BsYW5TaW1wbGVRdWVyeShlKXtjb25zdCB0PW5ldyBCdDtpZigwPT09T2JqZWN0LmtleXMoZSkubGVuZ3RoKXJldHVybiB0O2Zvcihjb25zdFtuLHJdb2YgdGhpcy5pbmRleGVzKWlmKCEociBpbnN0YW5jZW9mIEV0fHxyIGluc3RhbmNlb2YgVHQpJiZ0aGlzLl9jYW5JbmRleEhhbmRsZVF1ZXJ5KHIsZSkpcmV0dXJuIHQudHlwZT0iaW5kZXhfc2NhbiIsdC5pbmRleGVzPVtuXSx0LmluZGV4U2NhbnM9W3tpbmRleE5hbWU6bixpbmRleDpyLHF1ZXJ5OmV9XSx0LmVzdGltYXRlZENvc3Q9NTAsdDtyZXR1cm4gdH1hc3luYyBfZXhlY3V0ZUluZGV4U2NhbihlKXtjb25zdHtpbmRleDp0LHF1ZXJ5Om4sdGV4dFF1ZXJ5OnJ9PWU7aWYoImZ1bmN0aW9uIiE9dHlwZW9mIHQub3Blbnx8dm9pZCAwPT09dC5pc09wZW58fHQuaXNPcGVufHxhd2FpdCB0Lm9wZW4oKSx2b2lkIDAhPT1yKXJldHVybiBhd2FpdCB0LnNlYXJjaChyKTtpZih2b2lkIDAhPT1uKXtjb25zdCBlPWF3YWl0IHQucXVlcnkobik7cmV0dXJuIG51bGwhPT1lP2U6W119cmV0dXJuIHZvaWQgMCE9PWUuZG9jSWRzP2UuZG9jSWRzOltdfV9jYW5JbmRleEhhbmRsZVF1ZXJ5KGUsdCl7Y29uc3Qgbj1PYmplY3Qua2V5cyh0KSxyPU9iamVjdC5rZXlzKGUua2V5cyk7aWYoMSE9PXIubGVuZ3RoKXJldHVybiExO2NvbnN0IGk9clswXTtyZXR1cm4tMSE9PW4uaW5kZXhPZihpKX1hc3luYyBleGVjdXRlKGUpe2lmKCJmdWxsX3NjYW4iPT09ZS50eXBlKXJldHVybiBudWxsO2lmKCJpbmRleF9zY2FuIj09PWUudHlwZSl7Y29uc3QgdD1lLmluZGV4U2NhbnNbMF07cmV0dXJuIGF3YWl0IHRoaXMuX2V4ZWN1dGVJbmRleFNjYW4odCl9aWYoImluZGV4X2ludGVyc2VjdGlvbiI9PT1lLnR5cGUpe2lmKDA9PT1lLmluZGV4U2NhbnMubGVuZ3RoKXJldHVybiBudWxsO2NvbnN0IHQ9W107Zm9yKGNvbnN0IGkgb2YgZS5pbmRleFNjYW5zKXQucHVzaCh7ZG9jSWRzOmF3YWl0IHRoaXMuX2V4ZWN1dGVJbmRleFNjYW4oaSksaW5kZXhOYW1lOmkuaW5kZXhOYW1lfSk7Y29uc3Qgbj10LnNsaWNlKCkuc29ydCgoZSx0KT0+ZS5kb2NJZHMubGVuZ3RoLXQuZG9jSWRzLmxlbmd0aCk7bGV0IHI9bmV3IFNldChuWzBdLmRvY0lkcyk7Zm9yKGxldCBlPTE7ZTxuLmxlbmd0aDtlKyspe2NvbnN0IHQ9bmV3IFNldChuW2VdLmRvY0lkcyk7aWYocj1uZXcgU2V0KFsuLi5yXS5maWx0ZXIoZT0+dC5oYXMoZSkpKSwwPT09ci5zaXplKWJyZWFrfXJldHVybiBBcnJheS5mcm9tKHIpfWlmKCJpbmRleF91bmlvbiI9PT1lLnR5cGUpe2NvbnN0IHQ9LyogQF9fUFVSRV9fICovbmV3IFNldDtmb3IoY29uc3QgbiBvZiBlLmluZGV4U2NhbnMpeyhhd2FpdCB0aGlzLl9leGVjdXRlSW5kZXhTY2FuKG4pKS5mb3JFYWNoKGU9PnQuYWRkKGUpKX1yZXR1cm4gQXJyYXkuZnJvbSh0KX1yZXR1cm4gbnVsbH19Y2xhc3MgVXQgZXh0ZW5kcyBuLkV2ZW50RW1pdHRlcntjb25zdHJ1Y3RvcihlLHQ9W10sbj17fSl7c3VwZXIoKSx0aGlzLnRhcmdldD1lLHRoaXMucGlwZWxpbmU9dCx0aGlzLm9wdGlvbnM9bix0aGlzLmNsb3NlZD0hMSx0aGlzLl9saXN0ZW5lcnM9LyogQF9fUFVSRV9fICovbmV3IE1hcCx0aGlzLl9jaGFuZ2VDb3VudGVyPTAsdGhpcy5fc3RhcnRXYXRjaGluZygpfV9pc0RCKGUpe3JldHVybiBlJiYic3RyaW5nIj09dHlwZW9mIGUuZGJOYW1lJiYiZnVuY3Rpb24iPT10eXBlb2YgZS5nZXRDb2xsZWN0aW9uTmFtZXMmJmUuY29sbGVjdGlvbnMgaW5zdGFuY2VvZiBNYXB9X2lzU2VydmVyKGUpe3JldHVybiBlJiZlLmRhdGFiYXNlcyBpbnN0YW5jZW9mIE1hcCYmImZ1bmN0aW9uIj09dHlwZW9mIGUuX2dldERCfV9pc01vbmdvQ2xpZW50KGUpe3JldHVybiBlJiYiZnVuY3Rpb24iPT10eXBlb2YgZS5jb25uZWN0JiYiZnVuY3Rpb24iPT10eXBlb2YgZS5kYiYmIk1vbmdvQ2xpZW50Ij09PWUuY29uc3RydWN0b3IubmFtZX1fc3RhcnRXYXRjaGluZygpe2lmKHRoaXMuY2xvc2VkKXJldHVybjtjb25zdCBlPXRoaXMuX2dldENvbGxlY3Rpb25zVG9XYXRjaCgpO2Zvcihjb25zdCB0IG9mIGUpdGhpcy5fd2F0Y2hDb2xsZWN0aW9uKHQpO3RoaXMuX2lzU2VydmVyKHRoaXMudGFyZ2V0KSYmdGhpcy5faW50ZXJjZXB0U2VydmVyREJDcmVhdGlvbigpLHRoaXMuX2lzREIodGhpcy50YXJnZXQpJiZ0aGlzLl9pbnRlcmNlcHREQkNvbGxlY3Rpb25DcmVhdGlvbigpLHRoaXMuX2lzTW9uZ29DbGllbnQodGhpcy50YXJnZXQpJiZ0aGlzLl9pbnRlcmNlcHRDbGllbnREQkNyZWF0aW9uKCl9X2dldENvbGxlY3Rpb25zVG9XYXRjaCgpe2NvbnN0IGU9W107aWYodGhpcy5faXNTZXJ2ZXIodGhpcy50YXJnZXQpKXtmb3IoY29uc3RbdCxuXW9mIHRoaXMudGFyZ2V0LmRhdGFiYXNlcyl7Y29uc3QgdD1uLmdldENvbGxlY3Rpb25OYW1lcygpO2Zvcihjb25zdCByIG9mIHQpe2NvbnN0IHQ9bltyXTt0JiZ0LmlzQ29sbGVjdGlvbiYmZS5wdXNoKHQpfX1yZXR1cm4gZX1pZih0aGlzLl9pc01vbmdvQ2xpZW50KHRoaXMudGFyZ2V0KSlyZXR1cm4gdGhpcy5fbW9uaXRvckNsaWVudCgpLGU7aWYodGhpcy5faXNEQih0aGlzLnRhcmdldCkpe2NvbnN0IHQ9dGhpcy50YXJnZXQuZ2V0Q29sbGVjdGlvbk5hbWVzKCk7Zm9yKGNvbnN0IG4gb2YgdCl7Y29uc3QgdD10aGlzLnRhcmdldFtuXTt0JiZ0LmlzQ29sbGVjdGlvbiYmZS5wdXNoKHQpfXRoaXMuX21vbml0b3JEQigpfXJldHVybiB0aGlzLnRhcmdldC5pc0NvbGxlY3Rpb24mJmUucHVzaCh0aGlzLnRhcmdldCksZX1fd2F0Y2hDb2xsZWN0aW9uKGUpe2lmKHRoaXMuY2xvc2VkKXJldHVybjtpZighZSlyZXR1cm47aWYoImZ1bmN0aW9uIiE9dHlwZW9mIGUub24pcmV0dXJuO2lmKCFlLmlzQ29sbGVjdGlvbilyZXR1cm47aWYodGhpcy5fbGlzdGVuZXJzLmhhcyhlKSlyZXR1cm47Y29uc3QgdD17aW5zZXJ0OnQ9PnRoaXMuX2VtaXRDaGFuZ2UoImluc2VydCIsZSx0KSx1cGRhdGU6KHQsbik9PnRoaXMuX2VtaXRDaGFuZ2UoInVwZGF0ZSIsZSx0LG4pLHJlcGxhY2U6dD0+dGhpcy5fZW1pdENoYW5nZSgicmVwbGFjZSIsZSx0KSxkZWxldGU6dD0+dGhpcy5fZW1pdENoYW5nZSgiZGVsZXRlIixlLHQpfTt0aGlzLl9saXN0ZW5lcnMuc2V0KGUsdCksZS5vbigiaW5zZXJ0Iix0Lmluc2VydCksZS5vbigidXBkYXRlIix0LnVwZGF0ZSksZS5vbigicmVwbGFjZSIsdC5yZXBsYWNlKSxlLm9uKCJkZWxldGUiLHQuZGVsZXRlKX1fZW1pdENoYW5nZShlLHQsbixyPW51bGwpe2lmKHRoaXMuY2xvc2VkKXJldHVybjtjb25zdCBpPXRoaXMuX2NyZWF0ZUNoYW5nZUV2ZW50KGUsdCxuLHIpO3RoaXMuX21hdGNoZXNQaXBlbGluZShpKSYmdGhpcy5lbWl0KCJjaGFuZ2UiLGkpfV9jcmVhdGVDaGFuZ2VFdmVudChlLHQsbixyKXtjb25zdCBpPXtfaWQ6e19kYXRhOmJ0b2EoU3RyaW5nKCsrdGhpcy5fY2hhbmdlQ291bnRlcikpfSxvcGVyYXRpb25UeXBlOmUsY2x1c3RlclRpbWU6LyogQF9fUFVSRV9fICovbmV3IERhdGUsbnM6e2RiOnQuZGIuZGJOYW1lLGNvbGw6dC5uYW1lfSxkb2N1bWVudEtleTp7X2lkOm4uX2lkfX07c3dpdGNoKGUpe2Nhc2UiaW5zZXJ0IjpjYXNlInJlcGxhY2UiOmkuZnVsbERvY3VtZW50PW47YnJlYWs7Y2FzZSJ1cGRhdGUiOmkudXBkYXRlRGVzY3JpcHRpb249cnx8e3VwZGF0ZWRGaWVsZHM6e30scmVtb3ZlZEZpZWxkczpbXSx0cnVuY2F0ZWRBcnJheXM6W119LCJ1cGRhdGVMb29rdXAiPT09dGhpcy5vcHRpb25zLmZ1bGxEb2N1bWVudCYmKGkuZnVsbERvY3VtZW50PW4pfXJldHVybiBpfV9tYXRjaGVzUGlwZWxpbmUoZSl7aWYoIXRoaXMucGlwZWxpbmV8fDA9PT10aGlzLnBpcGVsaW5lLmxlbmd0aClyZXR1cm4hMDtmb3IoY29uc3QgdCBvZiB0aGlzLnBpcGVsaW5lKWlmKHQuJG1hdGNoJiYhWWUoZSx0LiRtYXRjaCkpcmV0dXJuITE7cmV0dXJuITB9X2dldE5lc3RlZFZhbHVlKGUsdCl7cmV0dXJuIHQuc3BsaXQoIi4iKS5yZWR1Y2UoKGUsdCk9PmU/Llt0XSxlKX1fbW9uaXRvckNsaWVudCgpe31faW50ZXJjZXB0Q2xpZW50REJDcmVhdGlvbigpe2NvbnN0IGU9dGhpcy50YXJnZXQsdD1lLmRiLmJpbmQoZSksbj10aGlzO3RoaXMuX3dhdGNoZWREQnM9LyogQF9fUFVSRV9fICovbmV3IE1hcCxlLmRiPWZ1bmN0aW9uKGUscil7Y29uc3QgaT10KGUscikscz1pLmRiTmFtZTtpZighbi5fd2F0Y2hlZERCcy5oYXMocykpe24uX3dhdGNoZWREQnMuc2V0KHMsaSk7Y29uc3QgZT1pLmdldENvbGxlY3Rpb25OYW1lcygpO2Zvcihjb25zdCB0IG9mIGUpe2NvbnN0IGU9aVt0XTtlJiZlLmlzQ29sbGVjdGlvbiYmIW4uX2xpc3RlbmVycy5oYXMoZSkmJm4uX3dhdGNoQ29sbGVjdGlvbihlKX1uLl9pbnRlcmNlcHREQkNvbGxlY3Rpb25DcmVhdGlvbkZvckNsaWVudChpKX1yZXR1cm4gaX0sdGhpcy5fb3JpZ2luYWxDbGllbnRNZXRob2RzPXtkYjp0fX1faW50ZXJjZXB0U2VydmVyREJDcmVhdGlvbigpe2NvbnN0IGU9dGhpcy50YXJnZXQsdD1lLl9nZXREQi5iaW5kKGUpLG49dGhpczt0aGlzLl93YXRjaGVkREJzPS8qIEBfX1BVUkVfXyAqL25ldyBNYXAsZS5fZ2V0REI9ZnVuY3Rpb24oZSl7Y29uc3Qgcj10KGUpO2lmKCFuLl93YXRjaGVkREJzLmhhcyhlKSl7bi5fd2F0Y2hlZERCcy5zZXQoZSxyKTtjb25zdCB0PXIuZ2V0Q29sbGVjdGlvbk5hbWVzKCk7Zm9yKGNvbnN0IGUgb2YgdCl7Y29uc3QgdD1yW2VdO3QmJnQuaXNDb2xsZWN0aW9uJiYhbi5fbGlzdGVuZXJzLmhhcyh0KSYmbi5fd2F0Y2hDb2xsZWN0aW9uKHQpfW4uX2ludGVyY2VwdERCQ29sbGVjdGlvbkNyZWF0aW9uRm9yU2VydmVyKHIpfXJldHVybiByfSx0aGlzLl9vcmlnaW5hbFNlcnZlck1ldGhvZHM9e19nZXREQjp0fX1faW50ZXJjZXB0REJDb2xsZWN0aW9uQ3JlYXRpb25Gb3JTZXJ2ZXIoZSl7Y29uc3QgdD1lLmNvbGxlY3Rpb24uYmluZChlKSxuPWUuY3JlYXRlQ29sbGVjdGlvbi5iaW5kKGUpLHI9dGhpcztlLmNvbGxlY3Rpb249ZnVuY3Rpb24oZSl7Y29uc3Qgbj10KGUpO3JldHVybiBuJiZuLmlzQ29sbGVjdGlvbiYmIXIuX2xpc3RlbmVycy5oYXMobikmJnIuX3dhdGNoQ29sbGVjdGlvbihuKSxufSxlLmNyZWF0ZUNvbGxlY3Rpb249ZnVuY3Rpb24odCl7bih0KTtjb25zdCBpPWVbdF07aSYmaS5pc0NvbGxlY3Rpb24mJiFyLl9saXN0ZW5lcnMuaGFzKGkpJiZyLl93YXRjaENvbGxlY3Rpb24oaSl9fV9pbnRlcmNlcHREQkNvbGxlY3Rpb25DcmVhdGlvbkZvckNsaWVudChlKXtjb25zdCB0PWUuY29sbGVjdGlvbi5iaW5kKGUpLG49ZS5jcmVhdGVDb2xsZWN0aW9uLmJpbmQoZSkscj10aGlzO2UuY29sbGVjdGlvbj1mdW5jdGlvbihlKXtjb25zdCBuPXQoZSk7cmV0dXJuIG4mJm4uaXNDb2xsZWN0aW9uJiYhci5fbGlzdGVuZXJzLmhhcyhuKSYmci5fd2F0Y2hDb2xsZWN0aW9uKG4pLG59LGUuY3JlYXRlQ29sbGVjdGlvbj1mdW5jdGlvbih0KXtuKHQpO2NvbnN0IGk9ZVt0XTtpJiZpLmlzQ29sbGVjdGlvbiYmIXIuX2xpc3RlbmVycy5oYXMoaSkmJnIuX3dhdGNoQ29sbGVjdGlvbihpKX19X21vbml0b3JEQigpe31faW50ZXJjZXB0REJDb2xsZWN0aW9uQ3JlYXRpb24oKXtjb25zdCBlPXRoaXMudGFyZ2V0LHQ9ZS5nZXRDb2xsZWN0aW9uLmJpbmQoZSksbj1lLmNyZWF0ZUNvbGxlY3Rpb24/ZS5jcmVhdGVDb2xsZWN0aW9uLmJpbmQoZSk6bnVsbCxyPXRoaXM7ZS5nZXRDb2xsZWN0aW9uPWZ1bmN0aW9uKGUpe2NvbnN0IG49dChlKTtyZXR1cm4gbiYmbi5pc0NvbGxlY3Rpb24mJiFyLl9saXN0ZW5lcnMuaGFzKG4pJiZyLl93YXRjaENvbGxlY3Rpb24obiksbn0sbiYmKGUuY3JlYXRlQ29sbGVjdGlvbj1mdW5jdGlvbih0KXtuKHQpO2NvbnN0IGk9ZVt0XTtpJiZpLmlzQ29sbGVjdGlvbiYmIXIuX2xpc3RlbmVycy5oYXMoaSkmJnIuX3dhdGNoQ29sbGVjdGlvbihpKX0pLHRoaXMuX29yaWdpbmFsREJNZXRob2RzPXtnZXRDb2xsZWN0aW9uOnQsY3JlYXRlQ29sbGVjdGlvbjpufX1jbG9zZSgpe2lmKCF0aGlzLmNsb3NlZCl7dGhpcy5jbG9zZWQ9ITA7Zm9yKGNvbnN0W2UsdF1vZiB0aGlzLl9saXN0ZW5lcnMpZS5vZmYoImluc2VydCIsdC5pbnNlcnQpLGUub2ZmKCJ1cGRhdGUiLHQudXBkYXRlKSxlLm9mZigicmVwbGFjZSIsdC5yZXBsYWNlKSxlLm9mZigiZGVsZXRlIix0LmRlbGV0ZSk7dGhpcy5fbGlzdGVuZXJzLmNsZWFyKCksdGhpcy5fb3JpZ2luYWxTZXJ2ZXJNZXRob2RzJiYiU2VydmVyIj09PXRoaXMudGFyZ2V0LmNvbnN0cnVjdG9yLm5hbWUmJih0aGlzLnRhcmdldC5fZ2V0REI9dGhpcy5fb3JpZ2luYWxTZXJ2ZXJNZXRob2RzLl9nZXREQiksdGhpcy5fb3JpZ2luYWxEQk1ldGhvZHMmJiJEQiI9PT10aGlzLnRhcmdldC5jb25zdHJ1Y3Rvci5uYW1lJiYodGhpcy50YXJnZXQuY29sbGVjdGlvbj10aGlzLl9vcmlnaW5hbERCTWV0aG9kcy5jb2xsZWN0aW9uLHRoaXMudGFyZ2V0LmNyZWF0ZUNvbGxlY3Rpb249dGhpcy5fb3JpZ2luYWxEQk1ldGhvZHMuY3JlYXRlQ29sbGVjdGlvbiksdGhpcy5fb3JpZ2luYWxDbGllbnRNZXRob2RzJiYiTW9uZ29DbGllbnQiPT09dGhpcy50YXJnZXQuY29uc3RydWN0b3IubmFtZSYmKHRoaXMudGFyZ2V0LmRiPXRoaXMuX29yaWdpbmFsQ2xpZW50TWV0aG9kcy5kYiksdGhpcy5lbWl0KCJjbG9zZSIpLHRoaXMucmVtb3ZlQWxsTGlzdGVuZXJzKCl9fWdldCBpc0Nsb3NlZCgpe3JldHVybiB0aGlzLmNsb3NlZH1hc3luYypbU3ltYm9sLmFzeW5jSXRlcmF0b3JdKCl7Y29uc3QgZT1bXTtsZXQgdD1udWxsLG49ITE7Y29uc3Qgcj1uPT57dD8odCh7dmFsdWU6bixkb25lOiExfSksdD1udWxsKTplLnB1c2gobil9LGk9KCk9PntuPSEwLHQmJih0KHtkb25lOiEwfSksdD1udWxsKX0scz1lPT57dCYmKHQoUHJvbWlzZS5yZWplY3QoZSkpLHQ9bnVsbCl9O3RoaXMub24oImNoYW5nZSIsciksdGhpcy5vbigiY2xvc2UiLGkpLHRoaXMub24oImVycm9yIixzKTt0cnl7Zm9yKDshbjspaWYoZS5sZW5ndGg+MCl5aWVsZCBlLnNoaWZ0KCk7ZWxzZXtjb25zdCBlPWF3YWl0IG5ldyBQcm9taXNlKGU9Pnt0PWUsbiYmZSh7ZG9uZTohMH0pfSk7aWYoZS5kb25lKWJyZWFrO3lpZWxkIGUudmFsdWV9fWZpbmFsbHl7dGhpcy5vZmYoImNoYW5nZSIsciksdGhpcy5vZmYoImNsb3NlIixpKSx0aGlzLm9mZigiZXJyb3IiLHMpfX1hc3luYyBuZXh0KCl7cmV0dXJuIG5ldyBQcm9taXNlKChlLHQpPT57Y29uc3Qgbj10PT57cygpLGUodCl9LHI9KCk9PntzKCksZShudWxsKX0saT1lPT57cygpLHQoZSl9LHM9KCk9Pnt0aGlzLm9mZigiY2hhbmdlIixuKSx0aGlzLm9mZigiY2xvc2UiLHIpLHRoaXMub2ZmKCJlcnJvciIsaSl9O3RoaXMuY2xvc2VkP2UobnVsbCk6KHRoaXMub25jZSgiY2hhbmdlIixuKSx0aGlzLm9uY2UoImNsb3NlIixyKSx0aGlzLm9uY2UoImVycm9yIixpKSl9KX19Y29uc3QgUnQ9bmV3IGNsYXNze2NvbnN0cnVjdG9yKGU9ITEpe3RoaXMuZW5hYmxlZD1lLHRoaXMudGltaW5ncz1bXSx0aGlzLm5lc3RlZExldmVsPTB9c2V0RW5hYmxlZChlKXt0aGlzLmVuYWJsZWQ9ZX1zdGFydChlLHQsbj17fSl7cmV0dXJuIHRoaXMuZW5hYmxlZD97Y2F0ZWdvcnk6ZSxvcGVyYXRpb246dCxkZXRhaWxzOm4sc3RhcnRUaW1lOnBlcmZvcm1hbmNlLm5vdygpLG5lc3RlZExldmVsOnRoaXMubmVzdGVkTGV2ZWwrK306bnVsbH1lbmQoZSx0PXt9KXtpZighdGhpcy5lbmFibGVkfHwhZSlyZXR1cm47dGhpcy5uZXN0ZWRMZXZlbD4wJiZ0aGlzLm5lc3RlZExldmVsLS07Y29uc3Qgbj1wZXJmb3JtYW5jZS5ub3coKS1lLnN0YXJ0VGltZTt0aGlzLnRpbWluZ3MucHVzaCh7Y2F0ZWdvcnk6ZS5jYXRlZ29yeSxvcGVyYXRpb246ZS5vcGVyYXRpb24sZHVyYXRpb246bixkZXRhaWxzOnsuLi5lLmRldGFpbHMsLi4udH0sbmVzdGVkTGV2ZWw6ZS5uZXN0ZWRMZXZlbCx0aW1lc3RhbXA6ZS5zdGFydFRpbWV9KX1nZXRUaW1pbmdzKCl7cmV0dXJuIHRoaXMudGltaW5nc31nZXRUaW1pbmdzQnlDYXRlZ29yeSgpe2NvbnN0IGU9e307Zm9yKGNvbnN0IHQgb2YgdGhpcy50aW1pbmdzKWVbdC5jYXRlZ29yeV18fChlW3QuY2F0ZWdvcnldPVtdKSxlW3QuY2F0ZWdvcnldLnB1c2godCk7cmV0dXJuIGV9Z2V0U3VtbWFyeSgpe2NvbnN0IGU9e307Zm9yKGNvbnN0IHQgb2YgdGhpcy50aW1pbmdzKXtjb25zdCBuPWAke3QuY2F0ZWdvcnl9LiR7dC5vcGVyYXRpb259YDtlW25dfHwoZVtuXT17Y2F0ZWdvcnk6dC5jYXRlZ29yeSxvcGVyYXRpb246dC5vcGVyYXRpb24sY291bnQ6MCx0b3RhbDowLG1pbjoxLzAsbWF4Oi0xLzAsYXZnOjB9KTtjb25zdCByPWVbbl07ci5jb3VudCsrLHIudG90YWwrPXQuZHVyYXRpb24sci5taW49TWF0aC5taW4oci5taW4sdC5kdXJhdGlvbiksci5tYXg9TWF0aC5tYXgoci5tYXgsdC5kdXJhdGlvbiksci5hdmc9ci50b3RhbC9yLmNvdW50fXJldHVybiBPYmplY3QudmFsdWVzKGUpfWNsZWFyKCl7dGhpcy50aW1pbmdzPVtdLHRoaXMubmVzdGVkTGV2ZWw9MH1mb3JtYXRUaW1pbmdzKCl7Y29uc3QgZT10aGlzLmdldFN1bW1hcnkoKTtpZigwPT09ZS5sZW5ndGgpcmV0dXJuIk5vIHRpbWluZyBkYXRhIGNvbGxlY3RlZCI7bGV0IHQ9IlxuIisiPSIucmVwZWF0KDgwKSsiXG4iO3QrPSJQRVJGT1JNQU5DRSBUSU1JTkcgUkVQT1JUXG4iLHQrPSI9Ii5yZXBlYXQoODApKyJcblxuIjtjb25zdCBuPXt9O2Zvcihjb25zdCByIG9mIGUpbltyLmNhdGVnb3J5XXx8KG5bci5jYXRlZ29yeV09W10pLG5bci5jYXRlZ29yeV0ucHVzaChyKTtmb3IoY29uc3RbcixpXW9mIE9iamVjdC5lbnRyaWVzKG4pKXt0Kz1gJHtyLnRvVXBwZXJDYXNlKCl9XG5gLHQrPSItIi5yZXBlYXQoODApKyJcbiIsdCs9Ik9wZXJhdGlvbiIucGFkRW5kKDMwKSsiQ291bnQiLnBhZFN0YXJ0KDgpKyJUb3RhbChtcykiLnBhZFN0YXJ0KDEyKSsiQXZnKG1zKSIucGFkU3RhcnQoMTIpKyJNaW4obXMpIi5wYWRTdGFydCgxMikrIk1heChtcykiLnBhZFN0YXJ0KDEyKSsiXG4iLHQrPSItIi5yZXBlYXQoODApKyJcbiI7Zm9yKGNvbnN0IGUgb2YgaSl0Kz1lLm9wZXJhdGlvbi5wYWRFbmQoMzApK2UuY291bnQudG9TdHJpbmcoKS5wYWRTdGFydCg4KStlLnRvdGFsLnRvRml4ZWQoMykucGFkU3RhcnQoMTIpK2UuYXZnLnRvRml4ZWQoMykucGFkU3RhcnQoMTIpK2UubWluLnRvRml4ZWQoMykucGFkU3RhcnQoMTIpK2UubWF4LnRvRml4ZWQoMykucGFkU3RhcnQoMTIpKyJcbiI7dCs9IlxuIn1yZXR1cm4gdCs9Ij0iLnJlcGVhdCg4MCkrIlxuIix0fX0oITEpO2NsYXNzIHF0IGV4dGVuZHMgbi5FdmVudEVtaXR0ZXJ7Y29uc3RydWN0b3IoZSx0LG49e30pe3N1cGVyKCksdGhpcy5kYj1lLHRoaXMubmFtZT10LHRoaXMucGF0aD1gJHt0aGlzLmRiLmJhc2VGb2xkZXJ9LyR7dGhpcy5kYi5kYk5hbWV9LyR7dGhpcy5uYW1lfWAsdGhpcy5kb2N1bWVudHNQYXRoPWAke3RoaXMucGF0aH0vZG9jdW1lbnRzLmJqc29uYCx0aGlzLmRvY3VtZW50c1ZlcnNpb25lZFBhdGg9bnVsbCx0aGlzLmRvY3VtZW50c1ZlcnNpb249MCx0aGlzLl9yZWxlYXNlRG9jdW1lbnRzPW51bGwsdGhpcy5vcmRlcj1uLmJQbHVzVHJlZU9yZGVyfHw1MCx0aGlzLmRvY3VtZW50cz1udWxsLHRoaXMuaW5kZXhlcz0vKiBAX19QVVJFX18gKi9uZXcgTWFwLHRoaXMuX2luaXRpYWxpemVkPSExLHRoaXMuaXNDb2xsZWN0aW9uPSEwLHRoaXMucXVlcnlQbGFubmVyPW5ldyB6dCh0aGlzLmluZGV4ZXMpfWFzeW5jIF9pbml0aWFsaXplKCl7aWYodGhpcy5faW5pdGlhbGl6ZWQpcmV0dXJuO2lmKCFnbG9iYWxUaGlzLm5hdmlnYXRvcnx8IWdsb2JhbFRoaXMubmF2aWdhdG9yLnN0b3JhZ2V8fCJmdW5jdGlvbiIhPXR5cGVvZiBnbG9iYWxUaGlzLm5hdmlnYXRvci5zdG9yYWdlLmdldERpcmVjdG9yeSl0aHJvdyBuZXcgRXJyb3IoIk9QRlMgbm90IGF2YWlsYWJsZTogbmF2aWdhdG9yLnN0b3JhZ2UuZ2V0RGlyZWN0b3J5IGlzIG1pc3NpbmciKTtjb25zdHt2ZXJzaW9uOmUscGF0aDp0fT1hd2FpdCB2dCh0aGlzLmRvY3VtZW50c1BhdGgpO3RoaXMuZG9jdW1lbnRzVmVyc2lvbj1lLHRoaXMuZG9jdW1lbnRzVmVyc2lvbmVkUGF0aD10LHRoaXMuX3JlbGVhc2VEb2N1bWVudHM9KCk9PiR0KHRoaXMuZG9jdW1lbnRzUGF0aCxlKTtsZXQgbj1hd2FpdCB0aGlzLl9lbnN1cmVEaXJlY3RvcnlGb3JGaWxlKHRoaXMuZG9jdW1lbnRzVmVyc2lvbmVkUGF0aCk7bnx8KG49YXdhaXQgZ2xvYmFsVGhpcy5uYXZpZ2F0b3Iuc3RvcmFnZS5nZXREaXJlY3RvcnkoKSk7Y29uc3Qgcj10aGlzLmRvY3VtZW50c1ZlcnNpb25lZFBhdGguc3BsaXQoIi8iKS5maWx0ZXIoQm9vbGVhbiksaT1yW3IubGVuZ3RoLTFdO2lmKCFpKXRocm93IG5ldyBFcnJvcihgSW52YWxpZCBkb2N1bWVudHMgcGF0aDogJHt0aGlzLmRvY3VtZW50c1ZlcnNpb25lZFBhdGh9YCk7Y29uc3Qgcz1hd2FpdCBuLmdldEZpbGVIYW5kbGUoaSx7Y3JlYXRlOiEwfSksbz1hd2FpdCBzLmNyZWF0ZVN5bmNBY2Nlc3NIYW5kbGUoKTt0aGlzLmRvY3VtZW50cz1uZXcgeGUobyx0aGlzLm9yZGVyKSxhd2FpdCB0aGlzLmRvY3VtZW50cy5vcGVuKCksYXdhaXQgdGhpcy5fbG9hZEluZGV4ZXMoKSx0aGlzLl9pbml0aWFsaXplZD0hMH1hc3luYyBfZW5zdXJlRGlyZWN0b3J5Rm9yRmlsZShlKXtpZighZSlyZXR1cm47Y29uc3QgdD1lLnNwbGl0KCIvIikuZmlsdGVyKEJvb2xlYW4pO2lmKHQucG9wKCksMCE9PXQubGVuZ3RoKXRyeXtsZXQgZT1hd2FpdCBnbG9iYWxUaGlzLm5hdmlnYXRvci5zdG9yYWdlLmdldERpcmVjdG9yeSgpO2Zvcihjb25zdCBuIG9mIHQpZT1hd2FpdCBlLmdldERpcmVjdG9yeUhhbmRsZShuLHtjcmVhdGU6ITB9KTtyZXR1cm4gZX1jYXRjaChuKXtpZigiRUVYSVNUIiE9PW4uY29kZSl0aHJvdyBufX1hc3luYyBfbG9hZEluZGV4ZXMoKXtsZXQgZTt0cnl7Y29uc3QgdD10aGlzLnBhdGguc3BsaXQoIi8iKS5maWx0ZXIoQm9vbGVhbik7bGV0IG49YXdhaXQgZ2xvYmFsVGhpcy5uYXZpZ2F0b3Iuc3RvcmFnZS5nZXREaXJlY3RvcnkoKTtmb3IoY29uc3QgZSBvZiB0KW49YXdhaXQgbi5nZXREaXJlY3RvcnlIYW5kbGUoZSx7Y3JlYXRlOiExfSk7ZT1ufWNhdGNoKHQpe2lmKCJOb3RGb3VuZEVycm9yIj09PXQ/Lm5hbWV8fCJFTk9FTlQiPT09dD8uY29kZSlyZXR1cm47dGhyb3cgdH1mb3IgYXdhaXQoY29uc3RbbixyXW9mIGUuZW50cmllcygpKXtpZigiZmlsZSIhPT1yLmtpbmQpY29udGludWU7Y29uc3QgZT0vXC52XGQrKD89LXwkKS8saT1uLnJlcGxhY2UoZSwiIik7bGV0IHM7aWYoaS5lbmRzV2l0aCgiLnRleHRpbmRleC1kb2N1bWVudHMuYmpzb24iKSlzPSJ0ZXh0IjtlbHNlIGlmKGkuZW5kc1dpdGgoIi5ydHJlZS5ianNvbiIpKXM9Imdlb3NwYXRpYWwiO2Vsc2V7aWYoIWkuZW5kc1dpdGgoIi5icGx1c3RyZWUuYmpzb24iKSljb250aW51ZTtzPSJyZWd1bGFyIn1jb25zdCBvPWkucmVwbGFjZSgvXC50ZXh0aW5kZXgtZG9jdW1lbnRzXC5ianNvbiQvLCIiKS5yZXBsYWNlKC9cLnJ0cmVlXC5ianNvbiQvLCIiKS5yZXBsYWNlKC9cLmJwbHVzdHJlZVwuYmpzb24kLywiIik7aWYodGhpcy5pbmRleGVzLmhhcyhvKSljb250aW51ZTtjb25zdCBhPXRoaXMuX3BhcnNlSW5kZXhOYW1lKG8scyk7aWYoIWEpY29udGludWU7bGV0IGM7aWYoInRleHQiPT09cyl7Y29uc3QgZT1hd2FpdCB0aGlzLl9nZXRJbmRleFBhdGgobyxzKTtjPW5ldyBFdChvLGEsZSx7fSl9ZWxzZSBpZigiZ2Vvc3BhdGlhbCI9PT1zKXtjb25zdCBlPWF3YWl0IHRoaXMuX2dldEluZGV4UGF0aChvLHMpO2M9bmV3IFR0KG8sYSxlLHt9KX1lbHNle2NvbnN0IGU9YXdhaXQgdGhpcy5fZ2V0SW5kZXhQYXRoKG8scyk7Yz1uZXcgQXQobyxhLGUse30pfXRyeXthd2FpdCBjLm9wZW4oKSx0aGlzLmluZGV4ZXMuc2V0KG8sYyl9Y2F0Y2godCl7fX19X3BhcnNlSW5kZXhOYW1lKGUsdCl7Y29uc3Qgbj1lLnNwbGl0KCJfIik7aWYobi5sZW5ndGg8Mnx8bi5sZW5ndGglMiE9MClyZXR1cm4gbnVsbDtjb25zdCByPXt9O2ZvcihsZXQgaT0wO2k8bi5sZW5ndGg7aSs9Mil7Y29uc3QgZT1uW2ldLHM9bltpKzFdO2lmKCFlfHx2b2lkIDA9PT1zKXJldHVybiBudWxsO2lmKCJ0ZXh0Ij09PXR8fCJ0ZXh0Ij09PXMpcltlXT0idGV4dCI7ZWxzZSBpZigiZ2Vvc3BhdGlhbCI9PT10fHwiMmRzcGhlcmUiPT09c3x8IjJkIj09PXMpcltlXT0iMmQiPT09cz8iMmQiOiIyZHNwaGVyZSI7ZWxzZXtjb25zdCB0PU51bWJlcihzKTtpZihOdW1iZXIuaXNOYU4odCl8fDEhPT10JiYtMSE9PXQpcmV0dXJuIG51bGw7cltlXT10fX1yZXR1cm4gcn1hc3luYyBjbG9zZSgpe2lmKHRoaXMuX2luaXRpYWxpemVkKXtmb3IoY29uc3RbZSx0XW9mIHRoaXMuaW5kZXhlcylhd2FpdCB0LmNsb3NlKCk7YXdhaXQgdGhpcy5fbWF5YmVDb21wYWN0RG9jdW1lbnRzKCksYXdhaXQgdGhpcy5kb2N1bWVudHMuY2xvc2UoKSx0aGlzLl9yZWxlYXNlRG9jdW1lbnRzJiYoYXdhaXQgdGhpcy5fcmVsZWFzZURvY3VtZW50cygpLHRoaXMuX3JlbGVhc2VEb2N1bWVudHM9bnVsbCl9fWFzeW5jIF9tYXliZUNvbXBhY3REb2N1bWVudHMoKXtpZighdGhpcy5kb2N1bWVudHN8fCF0aGlzLmRvY3VtZW50cy5maWxlKXJldHVybjtjb25zdCBlPWF3YWl0IE50KHRoaXMuZG9jdW1lbnRzUGF0aCk7aWYoZSE9PXRoaXMuZG9jdW1lbnRzVmVyc2lvbilyZXR1cm47Y29uc3QgdD10aGlzLmRvY3VtZW50cy5maWxlLmdldEZpbGVTaXplKCk7aWYoIXR8fHQ8ZnQpcmV0dXJuO2NvbnN0IG49ZSsxLHI9ZHQodGhpcy5kb2N1bWVudHNQYXRoLG4pLGk9YXdhaXQgT3Qocix7cmVzZXQ6ITB9KTthd2FpdCB0aGlzLmRvY3VtZW50cy5jb21wYWN0KGkpLGF3YWl0IEl0KHRoaXMuZG9jdW1lbnRzUGF0aCxuLGUpfWdlbmVyYXRlSW5kZXhOYW1lKGUpe2NvbnN0IHQ9W107Zm9yKGNvbnN0IG4gaW4gZSllLmhhc093blByb3BlcnR5KG4pJiZ0LnB1c2gobisiXyIrZVtuXSk7cmV0dXJuIHQuam9pbigiXyIpfWlzVGV4dEluZGV4KGUpe2Zvcihjb25zdCB0IGluIGUpaWYoInRleHQiPT09ZVt0XSlyZXR1cm4hMDtyZXR1cm4hMX1pc0dlb3NwYXRpYWxJbmRleChlKXtmb3IoY29uc3QgdCBpbiBlKWlmKCIyZHNwaGVyZSI9PT1lW3RdfHwiMmQiPT09ZVt0XSlyZXR1cm4hMDtyZXR1cm4hMX1hc3luYyBfZ2V0SW5kZXhQYXRoKGUsdCl7Y29uc3Qgbj1TdHJpbmcoZSkucmVwbGFjZSgvW15hLXpBLVowLTlfLV0vZywiXyIpO3JldHVybiJ0ZXh0Ij09PXQ/YCR7dGhpcy5wYXRofS8ke259LnRleHRpbmRleGA6Imdlb3NwYXRpYWwiPT09dD9gJHt0aGlzLnBhdGh9LyR7bn0ucnRyZWUuYmpzb25gOmAke3RoaXMucGF0aH0vJHtufS5icGx1c3RyZWUuYmpzb25gfWFzeW5jIF9idWlsZEluZGV4KGUsdCxuPXt9KXtsZXQgcixpLHM7dGhpcy5faW5pdGlhbGl6ZWR8fGF3YWl0IHRoaXMuX2luaXRpYWxpemUoKSx0aGlzLmlzVGV4dEluZGV4KHQpPyhzPSJ0ZXh0IixpPWF3YWl0IHRoaXMuX2dldEluZGV4UGF0aChlLHMpLHI9bmV3IEV0KGUsdCxpLG4pKTp0aGlzLmlzR2Vvc3BhdGlhbEluZGV4KHQpPyhzPSJnZW9zcGF0aWFsIixpPWF3YWl0IHRoaXMuX2dldEluZGV4UGF0aChlLHMpLHI9bmV3IFR0KGUsdCxpLG4pKToocz0icmVndWxhciIsaT1hd2FpdCB0aGlzLl9nZXRJbmRleFBhdGgoZSxzKSxyPW5ldyBBdChlLHQsaSxuKSksYXdhaXQgci5vcGVuKCksImZ1bmN0aW9uIj09dHlwZW9mIHIuY2xlYXImJmF3YWl0IHIuY2xlYXIoKTtmb3IgYXdhaXQoY29uc3QgbyBvZiB0aGlzLmRvY3VtZW50cylvJiZvLnZhbHVlJiZhd2FpdCByLmFkZChvLnZhbHVlKTtyZXR1cm4gdGhpcy5pbmRleGVzLnNldChlLHIpLHJ9YXN5bmMgdXBkYXRlSW5kZXhlc09uSW5zZXJ0KGUpe2NvbnN0IHQ9W107Zm9yKGNvbnN0W24scl1vZiB0aGlzLmluZGV4ZXMpdC5wdXNoKChhc3luYygpPT57YXdhaXQgdGhpcy5fZW5zdXJlSW5kZXhPcGVuKHIpLGF3YWl0IHIuYWRkKGUpfSkoKSk7dC5sZW5ndGg+MCYmYXdhaXQgUHJvbWlzZS5hbGwodCl9YXN5bmMgdXBkYXRlSW5kZXhlc09uRGVsZXRlKGUpe2NvbnN0IHQ9W107Zm9yKGNvbnN0W24scl1vZiB0aGlzLmluZGV4ZXMpdC5wdXNoKChhc3luYygpPT57YXdhaXQgdGhpcy5fZW5zdXJlSW5kZXhPcGVuKHIpLGF3YWl0IHIucmVtb3ZlKGUpfSkoKSk7dC5sZW5ndGg+MCYmYXdhaXQgUHJvbWlzZS5hbGwodCl9YXN5bmMgX2Vuc3VyZUluZGV4T3BlbihlKXtlJiYiZnVuY3Rpb24iPT10eXBlb2YgZS5vcGVuJiYhZS5pc09wZW4mJmF3YWl0IGUub3BlbigpfXBsYW5RdWVyeShlKXtjb25zdCB0PXRoaXMucXVlcnlQbGFubmVyLnBsYW4oZSk7cmV0dXJue3VzZUluZGV4OiJmdWxsX3NjYW4iIT09dC50eXBlLHBsYW5UeXBlOnQudHlwZSxpbmRleE5hbWVzOnQuaW5kZXhlcyxkb2NJZHM6bnVsbCxlc3RpbWF0ZWRDb3N0OnQuZXN0aW1hdGVkQ29zdCxpbmRleE9ubHk6dC5pbmRleE9ubHl8fCExfX1hc3luYyBwbGFuUXVlcnlBc3luYyhlKXtjb25zdCB0PXRoaXMucXVlcnlQbGFubmVyLnBsYW4oZSksbj1hd2FpdCB0aGlzLnF1ZXJ5UGxhbm5lci5leGVjdXRlKHQpO3JldHVybnt1c2VJbmRleDoiZnVsbF9zY2FuIiE9PXQudHlwZSxwbGFuVHlwZTp0LnR5cGUsaW5kZXhOYW1lczp0LmluZGV4ZXMsZG9jSWRzOm4sZXN0aW1hdGVkQ29zdDp0LmVzdGltYXRlZENvc3QsaW5kZXhPbmx5OnQuaW5kZXhPbmx5fHwhMX19Z2V0VGV4dEluZGV4KGUpe2Zvcihjb25zdFt0LG5db2YgdGhpcy5pbmRleGVzKWlmKG4gaW5zdGFuY2VvZiBFdCYmbi5pbmRleGVkRmllbGRzLmluY2x1ZGVzKGUpKXJldHVybiBuO3JldHVybiBudWxsfWFzeW5jIGFnZ3JlZ2F0ZShlKXtjb25zdCB0PVJ0LnN0YXJ0KCJjb2xsZWN0aW9uIiwiYWdncmVnYXRlIix7Y29sbGVjdGlvbjp0aGlzLm5hbWUsc3RhZ2VDb3VudDplPy5sZW5ndGh8fDB9KTtpZighZXx8IU4oZSkpdGhyb3cgbmV3IFYoIlBpcGVsaW5lIG11c3QgYmUgYW4gYXJyYXkiLHtjb2xsZWN0aW9uOnRoaXMubmFtZSxjb2RlOmt9KTtjb25zdCBuPVJ0LnN0YXJ0KCJjb2xsZWN0aW9uIiwiYWdncmVnYXRlLmxvYWREb2N1bWVudHMiKTtsZXQgcj1bXTtjb25zdCBpPXRoaXMuZmluZCh7fSk7Zm9yKGF3YWl0IGkuX2Vuc3VyZUluaXRpYWxpemVkKCk7YXdhaXQgaS5oYXNOZXh0KCk7KXIucHVzaChhd2FpdCBpLm5leHQoKSk7UnQuZW5kKG4se2RvY0NvdW50OnIubGVuZ3RofSk7Zm9yKGxldCBzPTA7czxlLmxlbmd0aDtzKyspe2NvbnN0IHQ9ZVtzXSxuPU9iamVjdC5rZXlzKHQpO2lmKDEhPT1uLmxlbmd0aCl0aHJvdyBuZXcgVigiRWFjaCBwaXBlbGluZSBzdGFnZSBtdXN0IGhhdmUgZXhhY3RseSBvbmUga2V5Iix7Y29sbGVjdGlvbjp0aGlzLm5hbWUsY29kZTprfSk7Y29uc3QgaT1uWzBdLG89dFtpXSxhPVJ0LnN0YXJ0KCJjb2xsZWN0aW9uIixgYWdncmVnYXRlLiR7aX1gLHtpbnB1dERvY3M6ci5sZW5ndGh9KTtpZigiJG1hdGNoIj09PWkpe2NvbnN0IGU9W107Zm9yKGxldCB0PTA7dDxyLmxlbmd0aDt0KyspWWUoclt0XSxvKSYmZS5wdXNoKHJbdF0pO3I9ZSxSdC5lbmQoYSx7b3V0cHV0RG9jczpyLmxlbmd0aH0pfWVsc2UgaWYoIiRwcm9qZWN0Ij09PWkpe2NvbnN0IGU9W107Zm9yKGxldCB0PTA7dDxyLmxlbmd0aDt0KyspZS5wdXNoKFZ0KG8sclt0XSkpO3I9ZSxSdC5lbmQoYSx7b3V0cHV0RG9jczpyLmxlbmd0aH0pfWVsc2UgaWYoIiRhZGRGaWVsZHMiPT09aXx8IiRzZXQiPT09aSl7Y29uc3QgZT1bXTtmb3IobGV0IHQ9MDt0PHIubGVuZ3RoO3QrKyl7Y29uc3Qgbj1fKHJbdF0pO2Zvcihjb25zdCBlIGluIG8pe2NvbnN0IGk9b1tlXTtuW2VdPUllKGksclt0XSl9ZS5wdXNoKG4pfXI9ZSxSdC5lbmQoYSx7b3V0cHV0RG9jczpyLmxlbmd0aH0pfWVsc2UgaWYoIiR1bnNldCI9PT1pKXtjb25zdCBlPVtdO2xldCB0PVtdOyJzdHJpbmciPT10eXBlb2Ygbz90PVtvXTpBcnJheS5pc0FycmF5KG8pP3Q9bzoib2JqZWN0Ij09dHlwZW9mIG8mJih0PU9iamVjdC5rZXlzKG8pKTtmb3IobGV0IG49MDtuPHIubGVuZ3RoO24rKyl7Y29uc3QgaT1fKHJbbl0pO2ZvcihsZXQgZT0wO2U8dC5sZW5ndGg7ZSsrKXtjb25zdCBuPXRbZV0scj1uLnNwbGl0KCIuIik7aWYoMT09PXIubGVuZ3RoKWRlbGV0ZSBpW25dO2Vsc2V7bGV0IGU9aTtmb3IobGV0IHQ9MDt0PHIubGVuZ3RoLTEmJihudWxsIT1lJiZudWxsIT1lKTt0KyspZT1lW3JbdF1dO251bGwhPWUmJm51bGwhPWUmJmRlbGV0ZSBlW3Jbci5sZW5ndGgtMV1dfX1lLnB1c2goaSl9cj1lLFJ0LmVuZChhLHtvdXRwdXREb2NzOnIubGVuZ3RofSl9ZWxzZSBpZigiJHNvcnQiPT09aSl7Y29uc3QgZT1PYmplY3Qua2V5cyhvKTtyLnNvcnQoZnVuY3Rpb24odCxuKXtmb3IobGV0IHI9MDtyPGUubGVuZ3RoO3IrKyl7Y29uc3QgaT1lW3JdO2lmKHZvaWQgMD09PXRbaV0mJnZvaWQgMCE9PW5baV0pcmV0dXJuLTEqb1tpXTtpZih2b2lkIDAhPT10W2ldJiZ2b2lkIDA9PT1uW2ldKXJldHVybiAxKm9baV07aWYodFtpXTxuW2ldKXJldHVybi0xKm9baV07aWYodFtpXT5uW2ldKXJldHVybiAxKm9baV19cmV0dXJuIDB9KSxSdC5lbmQoYSx7b3V0cHV0RG9jczpyLmxlbmd0aH0pfWVsc2UgaWYoIiRsaW1pdCI9PT1pKXI9ci5zbGljZSgwLG8pLFJ0LmVuZChhLHtvdXRwdXREb2NzOnIubGVuZ3RofSk7ZWxzZSBpZigiJHNraXAiPT09aSlyPXIuc2xpY2UobyksUnQuZW5kKGEse291dHB1dERvY3M6ci5sZW5ndGh9KTtlbHNlIGlmKCIkZ3JvdXAiPT09aSl7Y29uc3QgZT17fSx0PW8uX2lkO2ZvcihsZXQgaT0wO2k8ci5sZW5ndGg7aSsrKXtjb25zdCBuPXJbaV07bGV0IHM7cz1udWxsPT10P251bGw6SWUodCxuKTtjb25zdCBvPUpTT04uc3RyaW5naWZ5KHMpO2Vbb118fChlW29dPXtfaWQ6cyxkb2NzOltdLGFjY3VtdWxhdG9yczp7fX0pLGVbb10uZG9jcy5wdXNoKG4pfWNvbnN0IG49W107Zm9yKGNvbnN0IHIgaW4gZSl7Y29uc3QgdD1lW3JdLGk9e19pZDp0Ll9pZH07Zm9yKGNvbnN0IGUgaW4gbyl7aWYoIl9pZCI9PT1lKWNvbnRpbnVlO2NvbnN0IG49b1tlXSxyPU9iamVjdC5rZXlzKG4pO2lmKDEhPT1yLmxlbmd0aCljb250aW51ZTtjb25zdCBzPXJbMF0sYT1uW3NdO2lmKCIkc3VtIj09PXMpe2xldCBuPTA7Zm9yKGxldCBlPTA7ZTx0LmRvY3MubGVuZ3RoO2UrKyl7Y29uc3Qgcj1JZShhLHQuZG9jc1tlXSk7Im51bWJlciI9PXR5cGVvZiByP24rPXI6bnVsbCE9ciYmKG4rPU51bWJlcihyKXx8MCl9aVtlXT1ufWVsc2UgaWYoIiRhdmciPT09cyl7bGV0IG49MCxyPTA7Zm9yKGxldCBlPTA7ZTx0LmRvY3MubGVuZ3RoO2UrKyl7Y29uc3QgaT1JZShhLHQuZG9jc1tlXSk7bnVsbCE9aSYmKG4rPU51bWJlcihpKXx8MCxyKyspfWlbZV09cj4wP24vcjowfWVsc2UgaWYoIiRtaW4iPT09cyl7bGV0IG47Zm9yKGxldCBlPTA7ZTx0LmRvY3MubGVuZ3RoO2UrKyl7Y29uc3Qgcj1JZShhLHQuZG9jc1tlXSk7dm9pZCAwIT09ciYmKHZvaWQgMD09PW58fHI8bikmJihuPXIpfWlbZV09bn1lbHNlIGlmKCIkbWF4Ij09PXMpe2xldCBuO2ZvcihsZXQgZT0wO2U8dC5kb2NzLmxlbmd0aDtlKyspe2NvbnN0IHI9SWUoYSx0LmRvY3NbZV0pO3ZvaWQgMCE9PXImJih2b2lkIDA9PT1ufHxyPm4pJiYobj1yKX1pW2VdPW59ZWxzZSBpZigiJHB1c2giPT09cyl7Y29uc3Qgbj1bXTtmb3IobGV0IGU9MDtlPHQuZG9jcy5sZW5ndGg7ZSsrKXtjb25zdCByPUllKGEsdC5kb2NzW2VdKTtuLnB1c2gocil9aVtlXT1ufWVsc2UgaWYoIiRhZGRUb1NldCI9PT1zKXtjb25zdCBuPXt9O2ZvcihsZXQgZT0wO2U8dC5kb2NzLmxlbmd0aDtlKyspe2NvbnN0IHI9SWUoYSx0LmRvY3NbZV0pO25bSlNPTi5zdHJpbmdpZnkocildPXJ9Y29uc3Qgcj1bXTtmb3IoY29uc3QgZSBpbiBuKXIucHVzaChuW2VdKTtpW2VdPXJ9ZWxzZSBpZigiJGZpcnN0Ij09PXMpdC5kb2NzLmxlbmd0aD4wJiYoaVtlXT1JZShhLHQuZG9jc1swXSkpO2Vsc2UgaWYoIiRsYXN0Ij09PXMpdC5kb2NzLmxlbmd0aD4wJiYoaVtlXT1JZShhLHQuZG9jc1t0LmRvY3MubGVuZ3RoLTFdKSk7ZWxzZSBpZigiJHN0ZERldlBvcCI9PT1zKXtjb25zdCBuPVtdO2ZvcihsZXQgZT0wO2U8dC5kb2NzLmxlbmd0aDtlKyspe2NvbnN0IHI9SWUoYSx0LmRvY3NbZV0pOyJudW1iZXIiPT10eXBlb2YgciYmbi5wdXNoKHIpfWlmKG4ubGVuZ3RoPjApe2NvbnN0IHQ9bi5yZWR1Y2UoKGUsdCk9PmUrdCwwKS9uLmxlbmd0aCxyPW4ucmVkdWNlKChlLG4pPT5lK01hdGgucG93KG4tdCwyKSwwKS9uLmxlbmd0aDtpW2VdPU1hdGguc3FydChyKX1lbHNlIGlbZV09MH1lbHNlIGlmKCIkc3RkRGV2U2FtcCI9PT1zKXtjb25zdCBuPVtdO2ZvcihsZXQgZT0wO2U8dC5kb2NzLmxlbmd0aDtlKyspe2NvbnN0IHI9SWUoYSx0LmRvY3NbZV0pOyJudW1iZXIiPT10eXBlb2YgciYmbi5wdXNoKHIpfWlmKG4ubGVuZ3RoPjEpe2NvbnN0IHQ9bi5yZWR1Y2UoKGUsdCk9PmUrdCwwKS9uLmxlbmd0aCxyPW4ucmVkdWNlKChlLG4pPT5lK01hdGgucG93KG4tdCwyKSwwKS8obi5sZW5ndGgtMSk7aVtlXT1NYXRoLnNxcnQocil9ZWxzZSBpW2VdPTB9ZWxzZSBpZigiJG1lcmdlT2JqZWN0cyI9PT1zKXtjb25zdCBuPXt9O2ZvcihsZXQgZT0wO2U8dC5kb2NzLmxlbmd0aDtlKyspe2NvbnN0IHI9SWUoYSx0LmRvY3NbZV0pOyJvYmplY3QiIT10eXBlb2Ygcnx8bnVsbD09PXJ8fEFycmF5LmlzQXJyYXkocil8fE9iamVjdC5hc3NpZ24obixyKX1pW2VdPW59fW4ucHVzaChpKX1yPW4sUnQuZW5kKGEse291dHB1dERvY3M6ci5sZW5ndGgsZ3JvdXBDb3VudDpPYmplY3Qua2V5cyhlKS5sZW5ndGh9KX1lbHNlIGlmKCIkY291bnQiPT09aSlyPVt7W29dOnIubGVuZ3RofV0sUnQuZW5kKGEse291dHB1dERvY3M6ci5sZW5ndGh9KTtlbHNlIGlmKCIkdW53aW5kIj09PWkpe2NvbnN0IGU9W107bGV0IHQ9bzsic3RyaW5nIj09dHlwZW9mIHQmJiIkIj09PXQuY2hhckF0KDApJiYodD10LnN1YnN0cmluZygxKSk7Zm9yKGxldCBuPTA7bjxyLmxlbmd0aDtuKyspe2NvbnN0IGk9cltuXSxzPXYoaSx0KTtpZihzJiZOKHMpJiZzLmxlbmd0aD4wKWZvcihsZXQgbj0wO248cy5sZW5ndGg7bisrKXtjb25zdCByPV8oaSksbz10LnNwbGl0KCIuIik7bGV0IGE9cjtmb3IobGV0IGU9MDtlPG8ubGVuZ3RoLTE7ZSsrKWFbb1tlXV18fChhW29bZV1dPXt9KSxhPWFbb1tlXV07YVtvW28ubGVuZ3RoLTFdXT1zW25dLGUucHVzaChyKX19cj1lLFJ0LmVuZChhLHtvdXRwdXREb2NzOnIubGVuZ3RofSl9ZWxzZSBpZigiJHNvcnRCeUNvdW50Ij09PWkpe2NvbnN0IGU9e307Zm9yKGxldCB0PTA7dDxyLmxlbmd0aDt0Kyspe2NvbnN0IG49clt0XSxpPUllKG8sbikscz1KU09OLnN0cmluZ2lmeShpKTtlW3NdfHwoZVtzXT17X2lkOmksY291bnQ6MH0pLGVbc10uY291bnQrK31yPU9iamVjdC52YWx1ZXMoZSkuc29ydCgoZSx0KT0+dC5jb3VudC1lLmNvdW50KX1lbHNlIGlmKCIkcmVwbGFjZVJvb3QiPT09aXx8IiRyZXBsYWNlV2l0aCI9PT1pKXtjb25zdCBlPVtdLHQ9IiRyZXBsYWNlUm9vdCI9PT1pP28ubmV3Um9vdDpvO2ZvcihsZXQgbj0wO248ci5sZW5ndGg7bisrKXtjb25zdCBpPUllKHQscltuXSk7aWYoIm9iamVjdCIhPXR5cGVvZiBpfHxudWxsPT09aXx8QXJyYXkuaXNBcnJheShpKSl0aHJvdyBuZXcgVigiJHJlcGxhY2VSb290IGV4cHJlc3Npb24gbXVzdCBldmFsdWF0ZSB0byBhbiBvYmplY3QiLHtjb2xsZWN0aW9uOnRoaXMubmFtZSxjb2RlOmt9KTtlLnB1c2goaSl9cj1lfWVsc2UgaWYoIiRzYW1wbGUiPT09aSl7Y29uc3QgZT1vLnNpemV8fDE7aWYoIm51bWJlciIhPXR5cGVvZiBlfHxlPDApdGhyb3cgbmV3IFYoIiRzYW1wbGUgc2l6ZSBtdXN0IGJlIGEgbm9uLW5lZ2F0aXZlIG51bWJlciIse2NvbGxlY3Rpb246dGhpcy5uYW1lLGNvZGU6a30pO2NvbnN0IHQ9Wy4uLnJdO2ZvcihsZXQgbj10Lmxlbmd0aC0xO24+MDtuLS0pe2NvbnN0IGU9TWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKihuKzEpKTtbdFtuXSx0W2VdXT1bdFtlXSx0W25dXX1yPXQuc2xpY2UoMCxNYXRoLm1pbihlLHQubGVuZ3RoKSl9ZWxzZSBpZigiJGJ1Y2tldCI9PT1pKXtpZighby5ncm91cEJ5fHwhby5ib3VuZGFyaWVzKXRocm93IG5ldyBWKCIkYnVja2V0IHJlcXVpcmVzIGdyb3VwQnkgYW5kIGJvdW5kYXJpZXMiLHtjb2xsZWN0aW9uOnRoaXMubmFtZSxjb2RlOmt9KTtjb25zdCBlPW8uYm91bmRhcmllcyx0PW8uZGVmYXVsdCxuPW8ub3V0cHV0fHx7Y291bnQ6eyRzdW06MX19LGk9e307Zm9yKGxldCByPTA7cjxlLmxlbmd0aC0xO3IrKyl7aVtKU09OLnN0cmluZ2lmeShlW3JdKV09e19pZDplW3JdLGRvY3M6W119fXZvaWQgMCE9PXQmJihpLmRlZmF1bHQ9e19pZDp0LGRvY3M6W119KTtmb3IobGV0IGE9MDthPHIubGVuZ3RoO2ErKyl7Y29uc3Qgbj1yW2FdLHM9SWUoby5ncm91cEJ5LG4pO2xldCBjPSExO2ZvcihsZXQgdD0wO3Q8ZS5sZW5ndGgtMTt0KyspaWYocz49ZVt0XSYmczxlW3QrMV0pe2lbSlNPTi5zdHJpbmdpZnkoZVt0XSldLmRvY3MucHVzaChuKSxjPSEwO2JyZWFrfWN8fHZvaWQgMD09PXR8fGkuZGVmYXVsdC5kb2NzLnB1c2gobil9Y29uc3Qgcz1bXTtmb3IoY29uc3QgciBpbiBpKXtjb25zdCBlPWlbcl07aWYoMD09PWUuZG9jcy5sZW5ndGgpY29udGludWU7Y29uc3QgdD17X2lkOmUuX2lkfTtmb3IoY29uc3QgciBpbiBuKXtjb25zdCBpPW5bcl0scz1PYmplY3Qua2V5cyhpKTtpZigxIT09cy5sZW5ndGgpY29udGludWU7Y29uc3Qgbz1zWzBdLGE9aVtvXTtpZigiJHN1bSI9PT1vKXtsZXQgbj0wO2ZvcihsZXQgdD0wO3Q8ZS5kb2NzLmxlbmd0aDt0Kyspe2NvbnN0IHI9SWUoYSxlLmRvY3NbdF0pOyJudW1iZXIiPT10eXBlb2Ygcj9uKz1yOm51bGwhPXImJihuKz1OdW1iZXIocil8fDApfXRbcl09bn1lbHNlIGlmKCIkYXZnIj09PW8pe2xldCBuPTAsaT0wO2ZvcihsZXQgdD0wO3Q8ZS5kb2NzLmxlbmd0aDt0Kyspe2NvbnN0IHI9SWUoYSxlLmRvY3NbdF0pO251bGwhPXImJihuKz1OdW1iZXIocil8fDAsaSsrKX10W3JdPWk+MD9uL2k6MH1lbHNlIGlmKCIkcHVzaCI9PT1vKXtjb25zdCBuPVtdO2ZvcihsZXQgdD0wO3Q8ZS5kb2NzLmxlbmd0aDt0Kyspe2NvbnN0IHI9SWUoYSxlLmRvY3NbdF0pO24ucHVzaChyKX10W3JdPW59ZWxzZSBpZigiJGFkZFRvU2V0Ij09PW8pe2NvbnN0IG49e307Zm9yKGxldCB0PTA7dDxlLmRvY3MubGVuZ3RoO3QrKyl7Y29uc3Qgcj1JZShhLGUuZG9jc1t0XSk7bltKU09OLnN0cmluZ2lmeShyKV09cn10W3JdPU9iamVjdC52YWx1ZXMobil9fXMucHVzaCh0KX1yPXMuc29ydCgoZSx0KT0+ZS5faWQ8dC5faWQ/LTE6ZS5faWQ+dC5faWQ/MTowKX1lbHNlIGlmKCIkYnVja2V0QXV0byI9PT1pKXtpZighby5ncm91cEJ5fHwhby5idWNrZXRzKXRocm93IG5ldyBWKCIkYnVja2V0QXV0byByZXF1aXJlcyBncm91cEJ5IGFuZCBidWNrZXRzIix7Y29sbGVjdGlvbjp0aGlzLm5hbWUsY29kZTprfSk7Y29uc3QgZT1vLmJ1Y2tldHMsdD1vLm91dHB1dHx8e2NvdW50Onskc3VtOjF9fTtpZigwPT09ci5sZW5ndGgpcj1bXTtlbHNle2NvbnN0IG49ci5tYXAoZT0+KHt2YWx1ZTpJZShvLmdyb3VwQnksZSksZG9jOmV9KSkuc29ydCgoZSx0KT0+ZS52YWx1ZTx0LnZhbHVlPy0xOmUudmFsdWU+dC52YWx1ZT8xOjApLGk9TWF0aC5jZWlsKG4ubGVuZ3RoL2UpLHM9W107Zm9yKGxldCB0PTA7dDxlJiZ0Kmk8bi5sZW5ndGg7dCsrKXtjb25zdCBlPXQqaSxyPU1hdGgubWluKCh0KzEpKmksbi5sZW5ndGgpLG89bi5zbGljZShlLHIpO2lmKDA9PT1vLmxlbmd0aCljb250aW51ZTtjb25zdCBhPXtfaWQ6e21pbjpvWzBdLnZhbHVlLG1heDoobi5sZW5ndGgsb1tvLmxlbmd0aC0xXS52YWx1ZSl9LGRvY3M6by5tYXAoZT0+ZS5kb2MpfTtzLnB1c2goYSl9Y29uc3QgYT1bXTtmb3IobGV0IGU9MDtlPHMubGVuZ3RoO2UrKyl7Y29uc3Qgbj1zW2VdLHI9e19pZDpuLl9pZH07Zm9yKGNvbnN0IGUgaW4gdCl7Y29uc3QgaT10W2VdLHM9T2JqZWN0LmtleXMoaSk7aWYoMSE9PXMubGVuZ3RoKWNvbnRpbnVlO2NvbnN0IG89c1swXSxhPWlbb107aWYoIiRzdW0iPT09byl7bGV0IHQ9MDtmb3IobGV0IGU9MDtlPG4uZG9jcy5sZW5ndGg7ZSsrKXtjb25zdCByPUllKGEsbi5kb2NzW2VdKTsibnVtYmVyIj09dHlwZW9mIHI/dCs9cjpudWxsIT1yJiYodCs9TnVtYmVyKHIpfHwwKX1yW2VdPXR9ZWxzZSBpZigiJGF2ZyI9PT1vKXtsZXQgdD0wLGk9MDtmb3IobGV0IGU9MDtlPG4uZG9jcy5sZW5ndGg7ZSsrKXtjb25zdCByPUllKGEsbi5kb2NzW2VdKTtudWxsIT1yJiYodCs9TnVtYmVyKHIpfHwwLGkrKyl9cltlXT1pPjA/dC9pOjB9ZWxzZSBpZigiJHB1c2giPT09byl7Y29uc3QgdD1bXTtmb3IobGV0IGU9MDtlPG4uZG9jcy5sZW5ndGg7ZSsrKXtjb25zdCByPUllKGEsbi5kb2NzW2VdKTt0LnB1c2gocil9cltlXT10fX1hLnB1c2gocil9cj1hfX1lbHNlIGlmKCIkb3V0Ij09PWkpe2NvbnN0IGU9bztpZigic3RyaW5nIiE9dHlwZW9mIGUpdGhyb3cgbmV3IFYoIiRvdXQgcmVxdWlyZXMgYSBzdHJpbmcgY29sbGVjdGlvbiBuYW1lIix7Y29sbGVjdGlvbjp0aGlzLm5hbWUsY29kZTprfSk7dGhpcy5kYi5jb2xsZWN0aW9ucy5oYXMoZSkmJmF3YWl0IHRoaXMuZGIuZHJvcENvbGxlY3Rpb24oZSk7Y29uc3QgdD10aGlzLmRiW2VdO2ZvcihsZXQgbj0wO248ci5sZW5ndGg7bisrKXtjb25zdCBlPXJbbl0saT1lLl9pZDsib2JqZWN0Ij09dHlwZW9mIGkmJmkudG9TdHJpbmc/aS50b1N0cmluZygpOlN0cmluZyhpKSxhd2FpdCB0Lmluc2VydE9uZShlKX1yPVtdfWVsc2UgaWYoIiRtZXJnZSI9PT1pKXtsZXQgZSx0PSJfaWQiLG49Im1lcmdlIixpPSJpbnNlcnQiO2lmKCJzdHJpbmciPT10eXBlb2Ygbz9lPW86Im9iamVjdCI9PXR5cGVvZiBvJiYoZT1vLmludG8sdD1vLm9ufHx0LG49by53aGVuTWF0Y2hlZHx8bixpPW8ud2hlbk5vdE1hdGNoZWR8fGkpLCFlKXRocm93IG5ldyBWKCIkbWVyZ2UgcmVxdWlyZXMgYSB0YXJnZXQgY29sbGVjdGlvbiIse2NvbGxlY3Rpb246dGhpcy5uYW1lLGNvZGU6a30pO2NvbnN0IHM9dGhpcy5kYltlXTtmb3IobGV0IG89MDtvPHIubGVuZ3RoO28rKyl7Y29uc3QgZT1yW29dLGE9InN0cmluZyI9PXR5cGVvZiB0P3Q6dFswXSxjPXYoZSxhKSxsPXMuZmluZCh7W2FdOmN9KTthd2FpdCBsLl9lbnN1cmVJbml0aWFsaXplZCgpO2NvbnN0IHU9YXdhaXQgbC5oYXNOZXh0KCk/YXdhaXQgbC5uZXh0KCk6bnVsbDtpZih1KXtpZigicmVwbGFjZSI9PT1uKWF3YWl0IHMucmVwbGFjZU9uZSh7X2lkOnUuX2lkfSxlKTtlbHNlIGlmKCJtZXJnZSI9PT1uKXtjb25zdCB0PU9iamVjdC5hc3NpZ24oe30sdSxlKTthd2FpdCBzLnJlcGxhY2VPbmUoe19pZDp1Ll9pZH0sdCl9ZWxzZSBpZigia2VlcEV4aXN0aW5nIj09PW4pO2Vsc2UgaWYoImZhaWwiPT09bil0aHJvdyBuZXcgVigiJG1lcmdlIGZhaWxlZDogZHVwbGljYXRlIGtleSIse2NvbGxlY3Rpb246dGhpcy5uYW1lLGNvZGU6Rn0pfWVsc2UgaWYoImluc2VydCI9PT1pKWF3YWl0IHMuaW5zZXJ0T25lKGUpO2Vsc2UgaWYoImRpc2NhcmQiPT09aSk7ZWxzZSBpZigiZmFpbCI9PT1pKXRocm93IG5ldyBWKCIkbWVyZ2UgZmFpbGVkOiBkb2N1bWVudCBub3QgZm91bmQiLHtjb2xsZWN0aW9uOnRoaXMubmFtZSxjb2RlOmt9KX1yPVtdfWVsc2UgaWYoIiRsb29rdXAiPT09aSl7aWYoIShvLmZyb20mJm8ubG9jYWxGaWVsZCYmby5mb3JlaWduRmllbGQmJm8uYXMpKXRocm93IG5ldyBWKCIkbG9va3VwIHJlcXVpcmVzIGZyb20sIGxvY2FsRmllbGQsIGZvcmVpZ25GaWVsZCwgYW5kIGFzIix7Y29sbGVjdGlvbjp0aGlzLm5hbWUsY29kZTprfSk7aWYoIXRoaXMuZGIuZ2V0Q29sbGVjdGlvbk5hbWVzKCkuaW5jbHVkZXMoby5mcm9tKSl0aHJvdyBuZXcgVigiJGxvb2t1cDogY29sbGVjdGlvbiBub3QgZm91bmQ6ICIrby5mcm9tLHtjb2xsZWN0aW9uOnRoaXMubmFtZSxjb2RlOlB9KTtjb25zdCBlPXRoaXMuZGJbby5mcm9tXSx0PVtdO2ZvcihsZXQgbj0wO248ci5sZW5ndGg7bisrKXtjb25zdCBpPV8ocltuXSkscz12KGksby5sb2NhbEZpZWxkKSxhPVtdLGM9ZS5maW5kKHtbby5mb3JlaWduRmllbGRdOnN9KTtmb3IoYXdhaXQgYy5fZW5zdXJlSW5pdGlhbGl6ZWQoKTthd2FpdCBjLmhhc05leHQoKTspYS5wdXNoKGF3YWl0IGMubmV4dCgpKTtpW28uYXNdPWEsdC5wdXNoKGkpfXI9dH1lbHNlIGlmKCIkZ3JhcGhMb29rdXAiPT09aSl7aWYoIShvLmZyb20mJm8uc3RhcnRXaXRoJiZvLmNvbm5lY3RGcm9tRmllbGQmJm8uY29ubmVjdFRvRmllbGQmJm8uYXMpKXRocm93IG5ldyBWKCIkZ3JhcGhMb29rdXAgcmVxdWlyZXMgZnJvbSwgc3RhcnRXaXRoLCBjb25uZWN0RnJvbUZpZWxkLCBjb25uZWN0VG9GaWVsZCwgYW5kIGFzIix7Y29sbGVjdGlvbjp0aGlzLm5hbWUsY29kZTprfSk7aWYoIXRoaXMuZGIuZ2V0Q29sbGVjdGlvbk5hbWVzKCkuaW5jbHVkZXMoby5mcm9tKSl0aHJvdyBuZXcgVigiJGdyYXBoTG9va3VwOiBjb2xsZWN0aW9uIG5vdCBmb3VuZDogIitvLmZyb20se2NvbGxlY3Rpb246dGhpcy5uYW1lLGNvZGU6UH0pO2NvbnN0IGU9dGhpcy5kYltvLmZyb21dLHQ9dm9pZCAwIT09by5tYXhEZXB0aD9vLm1heERlcHRoOk51bWJlci5NQVhfU0FGRV9JTlRFR0VSLG49by5kZXB0aEZpZWxkLGk9by5yZXN0cmljdFNlYXJjaFdpdGhNYXRjaCxzPVtdO2ZvcihsZXQgYT0wO2E8ci5sZW5ndGg7YSsrKXtjb25zdCBjPV8oclthXSksbD1JZShvLnN0YXJ0V2l0aCxyW2FdKSx1PS8qIEBfX1BVUkVfXyAqL25ldyBTZXQsaD1bXSxmPVt7dmFsdWU6bCxkZXB0aDowfV07Zm9yKDtmLmxlbmd0aD4wOyl7Y29uc3R7dmFsdWU6cixkZXB0aDpzfT1mLnNoaWZ0KCk7aWYocz50KWNvbnRpbnVlO2NvbnN0IGE9SlNPTi5zdHJpbmdpZnkocik7aWYodS5oYXMoYSkpY29udGludWU7dS5hZGQoYSk7bGV0IGM9e1tvLmNvbm5lY3RUb0ZpZWxkXTpyfTtpJiYoYz17JGFuZDpbYyxpXX0pO2NvbnN0IGw9ZS5maW5kKGMpO2Zvcihhd2FpdCBsLl9lbnN1cmVJbml0aWFsaXplZCgpO2F3YWl0IGwuaGFzTmV4dCgpOyl7Y29uc3QgZT1hd2FpdCBsLm5leHQoKSx0PV8oZSk7biYmKHRbbl09cyksaC5wdXNoKHQpO2NvbnN0IHI9dihlLG8uY29ubmVjdEZyb21GaWVsZCk7bnVsbCE9ciYmZi5wdXNoKHt2YWx1ZTpyLGRlcHRoOnMrMX0pfX1jW28uYXNdPWgscy5wdXNoKGMpfXI9c31lbHNlIGlmKCIkZmFjZXQiPT09aSl7aWYoIm9iamVjdCIhPXR5cGVvZiBvfHxBcnJheS5pc0FycmF5KG8pKXRocm93IG5ldyBWKCIkZmFjZXQgcmVxdWlyZXMgYW4gb2JqZWN0IHdpdGggcGlwZWxpbmUgZGVmaW5pdGlvbnMiLHtjb2xsZWN0aW9uOnRoaXMubmFtZSxjb2RlOmt9KTtjb25zdCBlPXt9O2Zvcihjb25zdCB0IGluIG8pe2NvbnN0IG49b1t0XTtpZighQXJyYXkuaXNBcnJheShuKSl0aHJvdyBuZXcgVigiJGZhY2V0IHBpcGVsaW5lIG11c3QgYmUgYW4gYXJyYXkiLHtjb2xsZWN0aW9uOnRoaXMubmFtZSxjb2RlOmt9KTtsZXQgaT1yLm1hcChlPT5fKGUpKTtmb3IobGV0IGU9MDtlPG4ubGVuZ3RoO2UrKyl7Y29uc3QgdD1uW2VdLHI9T2JqZWN0LmtleXModCk7aWYoMSE9PXIubGVuZ3RoKXRocm93IG5ldyBWKCJFYWNoIHBpcGVsaW5lIHN0YWdlIG11c3QgaGF2ZSBleGFjdGx5IG9uZSBrZXkiLHtjb2xsZWN0aW9uOnRoaXMubmFtZSxjb2RlOmt9KTtjb25zdCBzPXJbMF0sbz10W3NdO2lmKCIkbWF0Y2giPT09cyl7Y29uc3QgZT1bXTtmb3IobGV0IHQ9MDt0PGkubGVuZ3RoO3QrKylZZShpW3RdLG8pJiZlLnB1c2goaVt0XSk7aT1lfWVsc2UgaWYoIiRwcm9qZWN0Ij09PXMpe2NvbnN0IGU9W107Zm9yKGxldCB0PTA7dDxpLmxlbmd0aDt0KyspZS5wdXNoKFZ0KG8saVt0XSkpO2k9ZX1lbHNlIGlmKCIkbGltaXQiPT09cylpPWkuc2xpY2UoMCxvKTtlbHNlIGlmKCIkc2tpcCI9PT1zKWk9aS5zbGljZShvKTtlbHNlIGlmKCIkc29ydCI9PT1zKXtjb25zdCBlPU9iamVjdC5rZXlzKG8pO2kuc29ydChmdW5jdGlvbih0LG4pe2ZvcihsZXQgcj0wO3I8ZS5sZW5ndGg7cisrKXtjb25zdCBpPWVbcl07aWYodm9pZCAwPT09dFtpXSYmdm9pZCAwIT09bltpXSlyZXR1cm4tMSpvW2ldO2lmKHZvaWQgMCE9PXRbaV0mJnZvaWQgMD09PW5baV0pcmV0dXJuIDEqb1tpXTtpZih0W2ldPG5baV0pcmV0dXJuLTEqb1tpXTtpZih0W2ldPm5baV0pcmV0dXJuIDEqb1tpXX1yZXR1cm4gMH0pfWVsc2UgaWYoIiRjb3VudCI9PT1zKWk9W3tbb106aS5sZW5ndGh9XTtlbHNlIGlmKCIkZ3JvdXAiPT09cyl7Y29uc3QgZT17fSx0PW8uX2lkO2ZvcihsZXQgcj0wO3I8aS5sZW5ndGg7cisrKXtjb25zdCBuPWlbcl07bGV0IHM7cz1udWxsPT10P251bGw6SWUodCxuKTtjb25zdCBvPUpTT04uc3RyaW5naWZ5KHMpO2Vbb118fChlW29dPXtfaWQ6cyxkb2NzOltdLGFjY3VtdWxhdG9yczp7fX0pLGVbb10uZG9jcy5wdXNoKG4pfWNvbnN0IG49W107Zm9yKGNvbnN0IHIgaW4gZSl7Y29uc3QgdD1lW3JdLGk9e19pZDp0Ll9pZH07Zm9yKGNvbnN0IGUgaW4gbyl7aWYoIl9pZCI9PT1lKWNvbnRpbnVlO2NvbnN0IG49b1tlXSxyPU9iamVjdC5rZXlzKG4pO2lmKDEhPT1yLmxlbmd0aCljb250aW51ZTtjb25zdCBzPXJbMF0sYT1uW3NdO2lmKCIkc3VtIj09PXMpe2xldCBuPTA7Zm9yKGxldCBlPTA7ZTx0LmRvY3MubGVuZ3RoO2UrKyl7Y29uc3Qgcj1JZShhLHQuZG9jc1tlXSk7Im51bWJlciI9PXR5cGVvZiByP24rPXI6bnVsbCE9ciYmKG4rPU51bWJlcihyKXx8MCl9aVtlXT1ufWVsc2UgaWYoIiRhdmciPT09cyl7bGV0IG49MCxyPTA7Zm9yKGxldCBlPTA7ZTx0LmRvY3MubGVuZ3RoO2UrKyl7Y29uc3QgaT1JZShhLHQuZG9jc1tlXSk7bnVsbCE9aSYmKG4rPU51bWJlcihpKXx8MCxyKyspfWlbZV09cj4wP24vcjowfWVsc2UgaWYoIiRtYXgiPT09cyl7bGV0IG47Zm9yKGxldCBlPTA7ZTx0LmRvY3MubGVuZ3RoO2UrKyl7Y29uc3Qgcj1JZShhLHQuZG9jc1tlXSk7dm9pZCAwIT09ciYmKHZvaWQgMD09PW58fHI+bikmJihuPXIpfWlbZV09bn19bi5wdXNoKGkpfWk9bn1lbHNlIGlmKCIkc29ydEJ5Q291bnQiPT09cyl7Y29uc3QgZT17fTtmb3IobGV0IHQ9MDt0PGkubGVuZ3RoO3QrKyl7Y29uc3Qgbj1pW3RdLHI9SWUobyxuKSxzPUpTT04uc3RyaW5naWZ5KHIpO2Vbc118fChlW3NdPXtfaWQ6cixjb3VudDowfSksZVtzXS5jb3VudCsrfWk9T2JqZWN0LnZhbHVlcyhlKS5zb3J0KChlLHQpPT50LmNvdW50LWUuY291bnQpfWVsc2UgaWYoIiRzYW1wbGUiPT09cyl7Y29uc3QgZT1vLnNpemV8fDEsdD1bLi4uaV07Zm9yKGxldCBuPXQubGVuZ3RoLTE7bj4wO24tLSl7Y29uc3QgZT1NYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqKG4rMSkpO1t0W25dLHRbZV1dPVt0W2VdLHRbbl1dfWk9dC5zbGljZSgwLE1hdGgubWluKGUsdC5sZW5ndGgpKX1lbHNlIGlmKCIkYnVja2V0Ij09PXMpe2NvbnN0IGU9by5ib3VuZGFyaWVzLHQ9by5kZWZhdWx0LG49by5vdXRwdXR8fHtjb3VudDp7JHN1bToxfX0scj17fTtmb3IobGV0IGk9MDtpPGUubGVuZ3RoLTE7aSsrKXtyW0pTT04uc3RyaW5naWZ5KGVbaV0pXT17X2lkOmVbaV0sZG9jczpbXX19dm9pZCAwIT09dCYmKHIuZGVmYXVsdD17X2lkOnQsZG9jczpbXX0pO2ZvcihsZXQgYT0wO2E8aS5sZW5ndGg7YSsrKXtjb25zdCBuPWlbYV0scz1JZShvLmdyb3VwQnksbik7bGV0IGM9ITE7Zm9yKGxldCB0PTA7dDxlLmxlbmd0aC0xO3QrKylpZihzPj1lW3RdJiZzPGVbdCsxXSl7cltKU09OLnN0cmluZ2lmeShlW3RdKV0uZG9jcy5wdXNoKG4pLGM9ITA7YnJlYWt9Y3x8dm9pZCAwPT09dHx8ci5kZWZhdWx0LmRvY3MucHVzaChuKX1jb25zdCBzPVtdO2Zvcihjb25zdCBpIGluIHIpe2NvbnN0IGU9cltpXTtpZigwPT09ZS5kb2NzLmxlbmd0aCljb250aW51ZTtjb25zdCB0PXtfaWQ6ZS5faWR9O2Zvcihjb25zdCByIGluIG4pe2NvbnN0IGk9bltyXSxzPU9iamVjdC5rZXlzKGkpO2lmKDEhPT1zLmxlbmd0aCljb250aW51ZTtjb25zdCBvPXNbMF0sYT1pW29dO2lmKCIkc3VtIj09PW8pe2xldCBuPTA7Zm9yKGxldCB0PTA7dDxlLmRvY3MubGVuZ3RoO3QrKyl7Y29uc3Qgcj1JZShhLGUuZG9jc1t0XSk7Im51bWJlciI9PXR5cGVvZiByP24rPXI6bnVsbCE9ciYmKG4rPU51bWJlcihyKXx8MCl9dFtyXT1ufX1zLnB1c2godCl9aT1zLnNvcnQoKGUsdCk9PmUuX2lkPHQuX2lkPy0xOmUuX2lkPnQuX2lkPzE6MCl9fWVbdF09aX1yPVtlXX1lbHNlIGlmKCIkcmVkYWN0Ij09PWkpe2NvbnN0IGU9W107Zm9yKGxldCB0PTA7dDxyLmxlbmd0aDt0Kyspe2NvbnN0IG49clt0XSxpPUllKG8sbik7aWYoIiQkREVTQ0VORCI9PT1pKWUucHVzaChuKTtlbHNle2lmKCIkJFBSVU5FIj09PWkpY29udGludWU7KCIkJEtFRVAiPT09aXx8aSkmJmUucHVzaChuKX19cj1lfWVsc2V7aWYoIiRnZW9OZWFyIiE9PWkpdGhyb3cgUnQuZW5kKGEse2Vycm9yOiEwLHN0YWdlVHlwZTppfSksbmV3IFYoIlVuc3VwcG9ydGVkIGFnZ3JlZ2F0aW9uIHN0YWdlOiAiK2kse2NvbGxlY3Rpb246dGhpcy5uYW1lLGNvZGU6a30pO3tpZighby5uZWFyfHwhby5kaXN0YW5jZUZpZWxkKXRocm93IG5ldyBWKCIkZ2VvTmVhciByZXF1aXJlcyBuZWFyIGFuZCBkaXN0YW5jZUZpZWxkIix7Y29sbGVjdGlvbjp0aGlzLm5hbWUsY29kZTprfSk7Y29uc3QgZT1vLm5lYXIsdD1vLmRpc3RhbmNlRmllbGQsbj1vLm1heERpc3RhbmNlLGk9by5taW5EaXN0YW5jZXx8MCxzPSExIT09by5zcGhlcmljYWwsYz1vLmtleXx8ImxvY2F0aW9uIixsPVtdO2ZvcihsZXQgbz0wO288ci5sZW5ndGg7bysrKXtjb25zdCBhPV8ocltvXSksdT12KGEsYyk7aWYoIXV8fCFBcnJheS5pc0FycmF5KHUpfHx1Lmxlbmd0aDwyKWNvbnRpbnVlO2xldCBoO2lmKHMpe2NvbnN0IHQ9NjM3MWUzLG49ZVsxXSpNYXRoLlBJLzE4MCxyPXVbMV0qTWF0aC5QSS8xODAsaT0odVsxXS1lWzFdKSpNYXRoLlBJLzE4MCxzPSh1WzBdLWVbMF0pKk1hdGguUEkvMTgwLG89TWF0aC5zaW4oaS8yKSpNYXRoLnNpbihpLzIpK01hdGguY29zKG4pKk1hdGguY29zKHIpKk1hdGguc2luKHMvMikqTWF0aC5zaW4ocy8yKTtoPXQqKDIqTWF0aC5hdGFuMihNYXRoLnNxcnQobyksTWF0aC5zcXJ0KDEtbykpKX1lbHNle2NvbnN0IHQ9dVswXS1lWzBdLG49dVsxXS1lWzFdO2g9TWF0aC5zcXJ0KHQqdCtuKm4pfWg+PWkmJighbnx8aDw9bikmJihhW3RdPWgsbC5wdXNoKGEpKX1sLnNvcnQoKGUsbik9PmVbdF0tblt0XSkscj1vLmxpbWl0P2wuc2xpY2UoMCxvLmxpbWl0KTpsLFJ0LmVuZChhLHtvdXRwdXREb2NzOnIubGVuZ3RofSl9fX1yZXR1cm4gUnQuZW5kKHQse3Jlc3VsdENvdW50OnIubGVuZ3RofSkscn1hc3luYyBidWxrV3JpdGUoKXt0aHJvdyBuZXcgSCgiYnVsa1dyaXRlIix7Y29sbGVjdGlvbjp0aGlzLm5hbWV9KX1hc3luYyBjb3VudCgpe3RoaXMuX2luaXRpYWxpemVkfHxhd2FpdCB0aGlzLl9pbml0aWFsaXplKCk7bGV0IGU9MDtmb3IgYXdhaXQoY29uc3QgdCBvZiB0aGlzLmRvY3VtZW50cyllKys7cmV0dXJuIGV9YXN5bmMgY29weVRvKGUpe3RoaXMuZGIuY3JlYXRlQ29sbGVjdGlvbihlKTtjb25zdCB0PXRoaXMuZGIuZ2V0Q29sbGVjdGlvbihlKTtsZXQgbj0wO2NvbnN0IHI9dGhpcy5maW5kKHt9KTtmb3IoYXdhaXQgci5fZW5zdXJlSW5pdGlhbGl6ZWQoKTthd2FpdCByLmhhc05leHQoKTspYXdhaXQgdC5pbnNlcnRPbmUoYXdhaXQgci5uZXh0KCkpLG4rKztyZXR1cm4gbn1hc3luYyBjcmVhdGVJbmRleChlLHQpe2lmKHRoaXMuX2luaXRpYWxpemVkfHxhd2FpdCB0aGlzLl9pbml0aWFsaXplKCksIWV8fCJvYmplY3QiIT10eXBlb2YgZXx8QXJyYXkuaXNBcnJheShlKSl0aHJvdyBuZXcgVygia2V5cyIsZSwiY3JlYXRlSW5kZXggcmVxdWlyZXMgYSBrZXkgc3BlY2lmaWNhdGlvbiBvYmplY3QiLHtjb2xsZWN0aW9uOnRoaXMubmFtZX0pO2NvbnN0IG49dCYmdC5uYW1lP3QubmFtZTp0aGlzLmdlbmVyYXRlSW5kZXhOYW1lKGUpO2lmKHRoaXMuaW5kZXhlcy5oYXMobikpe2NvbnN0IHQ9dGhpcy5pbmRleGVzLmdldChuKTtpZihKU09OLnN0cmluZ2lmeSh0LmtleXMpIT09SlNPTi5zdHJpbmdpZnkoZSkpdGhyb3cgbmV3IFIoIkluZGV4IHdpdGggbmFtZSAnIituKyInIGFscmVhZHkgZXhpc3RzIHdpdGggYSBkaWZmZXJlbnQga2V5IHNwZWNpZmljYXRpb24iLHtjb2RlOkwsaW5kZXg6bixjb2xsZWN0aW9uOnRoaXMubmFtZX0pO3JldHVybiBufXJldHVybiBhd2FpdCB0aGlzLl9idWlsZEluZGV4KG4sZSx0KSxufWRhdGFTaXplKCl7dGhyb3cgbmV3IEgoImRhdGFTaXplIix7Y29sbGVjdGlvbjp0aGlzLm5hbWV9KX1hc3luYyBkZWxldGVPbmUoZSl7Y29uc3QgdD1hd2FpdCB0aGlzLmZpbmRPbmUoZSk7cmV0dXJuIHQ/KGF3YWl0IHRoaXMudXBkYXRlSW5kZXhlc09uRGVsZXRlKHQpLGF3YWl0IHRoaXMuZG9jdW1lbnRzLmRlbGV0ZSh0Ll9pZC50b1N0cmluZygpKSx0aGlzLmVtaXQoImRlbGV0ZSIse19pZDp0Ll9pZH0pLHtkZWxldGVkQ291bnQ6MX0pOntkZWxldGVkQ291bnQ6MH19YXN5bmMgZGVsZXRlTWFueShlKXtjb25zdCB0PXRoaXMuZmluZChlKTthd2FpdCB0Ll9lbnN1cmVJbml0aWFsaXplZCgpO2NvbnN0IG49W10scj1bXTtmb3IoO2F3YWl0IHQuaGFzTmV4dCgpOyl7Y29uc3QgZT1hd2FpdCB0Lm5leHQoKTtuLnB1c2goZS5faWQpLHIucHVzaChlKX1jb25zdCBpPW4ubGVuZ3RoO2ZvcihsZXQgcz0wO3M8bi5sZW5ndGg7cysrKWF3YWl0IHRoaXMudXBkYXRlSW5kZXhlc09uRGVsZXRlKHJbc10pLHRoaXMuZG9jdW1lbnRzLmRlbGV0ZShuW3NdLnRvU3RyaW5nKCkpLHRoaXMuZW1pdCgiZGVsZXRlIix7X2lkOm5bc119KTtyZXR1cm57ZGVsZXRlZENvdW50Oml9fWFzeW5jIGRpc3RpbmN0KGUsdCl7Y29uc3Qgbj17fSxyPXRoaXMuZmluZCh0KTtmb3IoYXdhaXQgci5fZW5zdXJlSW5pdGlhbGl6ZWQoKTthd2FpdCByLmhhc05leHQoKTspe2NvbnN0IHQ9YXdhaXQgci5uZXh0KCk7dFtlXSYmKG5bdFtlXV09ITApfXJldHVybiBPYmplY3Qua2V5cyhuKX1hc3luYyBkcm9wKCl7dGhpcy5faW5pdGlhbGl6ZWR8fGF3YWl0IHRoaXMuX2luaXRpYWxpemUoKTtmb3IoY29uc3RbaSxzXW9mIHRoaXMuaW5kZXhlcylzJiYiZnVuY3Rpb24iPT10eXBlb2Ygcy5jbG9zZSYmYXdhaXQgcy5jbG9zZSgpO3RoaXMuZG9jdW1lbnRzJiYiZnVuY3Rpb24iPT10eXBlb2YgdGhpcy5kb2N1bWVudHMuY2xvc2UmJmF3YWl0IHRoaXMuZG9jdW1lbnRzLmNsb3NlKCksdGhpcy5fcmVsZWFzZURvY3VtZW50cyYmKGF3YWl0IHRoaXMuX3JlbGVhc2VEb2N1bWVudHMoKSx0aGlzLl9yZWxlYXNlRG9jdW1lbnRzPW51bGwpO3RyeXtjb25zdCBlPXRoaXMucGF0aC5zcGxpdCgiLyIpLmZpbHRlcihCb29sZWFuKTtsZXQgdD1hd2FpdCBnbG9iYWxUaGlzLm5hdmlnYXRvci5zdG9yYWdlLmdldERpcmVjdG9yeSgpO2Zvcihjb25zdCBuIG9mIGUpdD1hd2FpdCB0LmdldERpcmVjdG9yeUhhbmRsZShuLHtjcmVhdGU6ITF9KTtjb25zdCByPVtdO2ZvciBhd2FpdChjb25zdFtuLGldb2YgdC5lbnRyaWVzKCkpci5wdXNoKG4pO2Zvcihjb25zdCBpIG9mIHIpdHJ5e2F3YWl0IHQucmVtb3ZlRW50cnkoaSx7cmVjdXJzaXZlOiExfSl9Y2F0Y2gobil7fX1jYXRjaChyKXt9Y29uc3QgZT10aGlzLnBhdGguc3BsaXQoIi8iKS5maWx0ZXIoQm9vbGVhbiksdD1lLnBvcCgpO3RyeXtsZXQgcj1hd2FpdCBnbG9iYWxUaGlzLm5hdmlnYXRvci5zdG9yYWdlLmdldERpcmVjdG9yeSgpO2Zvcihjb25zdCB0IG9mIGUpcj1hd2FpdCByLmdldERpcmVjdG9yeUhhbmRsZSh0LHtjcmVhdGU6ITF9KTt0cnl7YXdhaXQgci5yZW1vdmVFbnRyeSh0LHtyZWN1cnNpdmU6ITB9KX1jYXRjaChuKXtpZigiVHlwZUVycm9yIiE9PW4ubmFtZSYmIW4ubWVzc2FnZT8uaW5jbHVkZXMoInJlY3Vyc2l2ZSIpKXRocm93IG47YXdhaXQgci5yZW1vdmVFbnRyeSh0KX19Y2F0Y2gocil7aWYoIk5vdEZvdW5kRXJyb3IiIT09ci5uYW1lJiYiRU5PRU5UIiE9PXIuY29kZSl0aHJvdyByfXJldHVybiB0aGlzLmRvY3VtZW50cz1udWxsLHRoaXMuaW5kZXhlcy5jbGVhcigpLHRoaXMuX2luaXRpYWxpemVkPSExLHRoaXMuZGIuY29sbGVjdGlvbnMuZGVsZXRlKHRoaXMubmFtZSksdGhpcy5lbWl0KCJkcm9wIix7Y29sbGVjdGlvbjp0aGlzLm5hbWV9KSx7b2s6MX19YXN5bmMgZHJvcEluZGV4KGUpe2lmKCF0aGlzLmluZGV4ZXMuaGFzKGUpKXRocm93IG5ldyBxKGUse2NvbGxlY3Rpb246dGhpcy5uYW1lfSk7Y29uc3QgdD10aGlzLmluZGV4ZXMuZ2V0KGUpO3JldHVybiB0JiYiZnVuY3Rpb24iPT10eXBlb2YgdC5jbGVhciYmYXdhaXQgdC5jbGVhcigpLHQmJiJmdW5jdGlvbiI9PXR5cGVvZiB0LmNsb3NlJiZhd2FpdCB0LmNsb3NlKCksdGhpcy5pbmRleGVzLmRlbGV0ZShlKSx7bkluZGV4ZXNXYXM6dGhpcy5pbmRleGVzLnNpemUrMSxvazoxfX1hc3luYyBkcm9wSW5kZXhlcygpe2NvbnN0IGU9dGhpcy5pbmRleGVzLnNpemU7Zm9yKGNvbnN0W3Qsbl1vZiB0aGlzLmluZGV4ZXMpbiYmImZ1bmN0aW9uIj09dHlwZW9mIG4uY2xlYXImJmF3YWl0IG4uY2xlYXIoKSxuJiYiZnVuY3Rpb24iPT10eXBlb2Ygbi5jbG9zZSYmYXdhaXQgbi5jbG9zZSgpO3JldHVybiB0aGlzLmluZGV4ZXMuY2xlYXIoKSx7bkluZGV4ZXNXYXM6ZSxtc2c6Im5vbi1faWQgaW5kZXhlcyBkcm9wcGVkIixvazoxfX1lbnN1cmVJbmRleCgpe3Rocm93IG5ldyBIKCJlbnN1cmVJbmRleCIse2NvbGxlY3Rpb246dGhpcy5uYW1lfSl9ZXhwbGFpbigpe3Rocm93IG5ldyBIKCJleHBsYWluIix7Y29sbGVjdGlvbjp0aGlzLm5hbWV9KX1maW5kKGUsdCl7dGhpcy5fdmFsaWRhdGVQcm9qZWN0aW9uKHQpO2NvbnN0IG49dGhpcy5fZmluZEludGVybmFsKGUsdCk7cmV0dXJuIG5ldyBRKHRoaXMsZSx0LG4sSil9X3ZhbGlkYXRlUHJvamVjdGlvbihlKXtpZighZXx8MD09PU9iamVjdC5rZXlzKGUpLmxlbmd0aClyZXR1cm47Y29uc3QgdD1PYmplY3Qua2V5cyhlKTtsZXQgbj0hMSxyPSExO2Zvcihjb25zdCBpIG9mIHQpaWYoIl9pZCIhPT1pJiYoZVtpXT9uPSEwOnI9ITAsbiYmcikpYnJlYWs7aWYobiYmcil0aHJvdyBuZXcgVigiQ2Fubm90IGRvIGV4Y2x1c2lvbiBvbiBmaWVsZCBpbiBpbmNsdXNpb24gcHJvamVjdGlvbiIse2NvZGU6Qixjb2xsZWN0aW9uOnRoaXMubmFtZX0pfWFzeW5jIF9maW5kSW50ZXJuYWwoZSx0KXtjb25zdCBuPVJ0LnN0YXJ0KCJjb2xsZWN0aW9uIiwiZmluZCIse2NvbGxlY3Rpb246dGhpcy5uYW1lfSk7dGhpcy5faW5pdGlhbGl6ZWR8fGF3YWl0IHRoaXMuX2luaXRpYWxpemUoKTtjb25zdCByPW51bGw9PWU/e306ZSxpPXRoaXMuX2V4dHJhY3ROZWFyU3BlYyhyKSxzPVtdLG89e307aWYodGhpcy5pbmRleGVzLnNpemU+MCl7Y29uc3QgZT1SdC5zdGFydCgiY29sbGVjdGlvbiIsImZpbmQucXVlcnlQbGFubmluZyIpLHQ9YXdhaXQgdGhpcy5wbGFuUXVlcnlBc3luYyhyKTtpZihSdC5lbmQoZSx7dXNlSW5kZXg6dC51c2VJbmRleCxkb2NJZHNDb3VudDp0LmRvY0lkcz8ubGVuZ3RofHwwfSksdC51c2VJbmRleCYmdC5kb2NJZHMmJnQuZG9jSWRzLmxlbmd0aD4wKXtjb25zdCBlPVJ0LnN0YXJ0KCJjb2xsZWN0aW9uIiwiZmluZC5pbmRleExvb2t1cCIpO2Zvcihjb25zdCBuIG9mIHQuZG9jSWRzKWlmKCFvW25dKXtjb25zdCBlPWF3YWl0IHRoaXMuZG9jdW1lbnRzLnNlYXJjaChuKTtlJiZZZShlLHIpJiYob1tuXT0hMCxzLnB1c2goZSkpfVJ0LmVuZChlLHtkb2NzRm91bmQ6cy5sZW5ndGh9KX1lbHNle2NvbnN0IGU9UnQuc3RhcnQoImNvbGxlY3Rpb24iLCJmaW5kLmZ1bGxTY2FuIik7Zm9yIGF3YWl0KGNvbnN0IHQgb2YgdGhpcy5kb2N1bWVudHMpdCYmdC52YWx1ZSYmIW9bdC52YWx1ZS5faWRdJiZZZSh0LnZhbHVlLHIpJiYob1t0LnZhbHVlLl9pZF09ITAscy5wdXNoKHQudmFsdWUpKTtSdC5lbmQoZSx7ZG9jc0ZvdW5kOnMubGVuZ3RofSl9fWVsc2V7Y29uc3QgZT1SdC5zdGFydCgiY29sbGVjdGlvbiIsImZpbmQuZnVsbFNjYW4iKTtmb3IgYXdhaXQoY29uc3QgdCBvZiB0aGlzLmRvY3VtZW50cyl0JiZ0LnZhbHVlJiYhb1t0LnZhbHVlLl9pZF0mJlllKHQudmFsdWUscikmJihvW3QudmFsdWUuX2lkXT0hMCxzLnB1c2godC52YWx1ZSkpO1J0LmVuZChlLHtkb2NzRm91bmQ6cy5sZW5ndGh9KX1pZihpKXtjb25zdCBlPVJ0LnN0YXJ0KCJjb2xsZWN0aW9uIiwiZmluZC5uZWFyU29ydCIpO3RoaXMuX3NvcnRCeU5lYXJEaXN0YW5jZShzLGkpLFJ0LmVuZChlKX1jb25zdCBhPVJ0LnN0YXJ0KCJjb2xsZWN0aW9uIiwiZmluZC5wcm9qZWN0aW9uIiksYz1zLm1hcChlPT50P0UoXyhlKSx0KTpfKGUpKTtyZXR1cm4gUnQuZW5kKGEse2RvY3NQcm9jZXNzZWQ6Yy5sZW5ndGh9KSxSdC5lbmQobix7ZG9jc1JldHVybmVkOmMubGVuZ3RoLGhhc0luZGV4ZXM6dGhpcy5pbmRleGVzLnNpemU+MH0pLGN9X2V4dHJhY3ROZWFyU3BlYyhlKXtmb3IoY29uc3QgdCBvZiBPYmplY3Qua2V5cyhlfHx7fSkpe2lmKHQuc3RhcnRzV2l0aCgiJCIpKWNvbnRpbnVlO2NvbnN0IG49ZVt0XTtpZihuJiYib2JqZWN0Ij09dHlwZW9mIG4pe2lmKG4uJG5lYXIpe2NvbnN0IGU9dGhpcy5fcGFyc2VOZWFyQ29vcmRpbmF0ZXMobi4kbmVhcik7aWYoZSlyZXR1cm57ZmllbGQ6dCwuLi5lfX1pZihuLiRuZWFyU3BoZXJlKXtjb25zdCBlPXRoaXMuX3BhcnNlTmVhckNvb3JkaW5hdGVzKG4uJG5lYXJTcGhlcmUpO2lmKGUpcmV0dXJue2ZpZWxkOnQsLi4uZX19fX1yZXR1cm4gbnVsbH1fcGFyc2VOZWFyQ29vcmRpbmF0ZXMoZSl7bGV0IHQ7aWYoZSYmIm9iamVjdCI9PXR5cGVvZiBlJiYoZS4kZ2VvbWV0cnkmJmUuJGdlb21ldHJ5LmNvb3JkaW5hdGVzP3Q9ZS4kZ2VvbWV0cnkuY29vcmRpbmF0ZXM6ZS5jb29yZGluYXRlcz90PWUuY29vcmRpbmF0ZXM6QXJyYXkuaXNBcnJheShlKSYmKHQ9ZSkpLCF0fHx0Lmxlbmd0aDwyKXJldHVybiBudWxsO2NvbnN0W24scl09dDtyZXR1cm4ibnVtYmVyIiE9dHlwZW9mIHJ8fCJudW1iZXIiIT10eXBlb2Ygbj9udWxsOntsYXQ6cixsbmc6bn19X2V4dHJhY3RQb2ludENvb3JkaW5hdGVzKGUpe2lmKCFlKXJldHVybiBudWxsO2lmKCJGZWF0dXJlQ29sbGVjdGlvbiI9PT1lLnR5cGUmJkFycmF5LmlzQXJyYXkoZS5mZWF0dXJlcykmJmUuZmVhdHVyZXMubGVuZ3RoPjApcmV0dXJuIHRoaXMuX2V4dHJhY3RQb2ludENvb3JkaW5hdGVzKGUuZmVhdHVyZXNbMF0uZ2VvbWV0cnkpO2lmKCJGZWF0dXJlIj09PWUudHlwZSYmZS5nZW9tZXRyeSlyZXR1cm4gdGhpcy5fZXh0cmFjdFBvaW50Q29vcmRpbmF0ZXMoZS5nZW9tZXRyeSk7aWYoIlBvaW50Ij09PWUudHlwZSYmQXJyYXkuaXNBcnJheShlLmNvb3JkaW5hdGVzKSYmZS5jb29yZGluYXRlcy5sZW5ndGg+PTIpe2NvbnN0W3Qsbl09ZS5jb29yZGluYXRlcztpZigibnVtYmVyIj09dHlwZW9mIG4mJiJudW1iZXIiPT10eXBlb2YgdClyZXR1cm57bGF0Om4sbG5nOnR9fXJldHVybiBudWxsfV9zb3J0QnlOZWFyRGlzdGFuY2UoZSx0KXtjb25zdHtmaWVsZDpuLGxhdDpyLGxuZzppfT10O2Uuc29ydCgoZSx0KT0+e2NvbnN0IHM9dGhpcy5fZXh0cmFjdFBvaW50Q29vcmRpbmF0ZXModihlLG4pKSxvPXRoaXMuX2V4dHJhY3RQb2ludENvb3JkaW5hdGVzKHYodCxuKSk7cmV0dXJuKHM/dGhpcy5faGF2ZXJzaW5lRGlzdGFuY2Uocy5sYXQscy5sbmcscixpKToxLzApLShvP3RoaXMuX2hhdmVyc2luZURpc3RhbmNlKG8ubGF0LG8ubG5nLHIsaSk6MS8wKX0pfV9oYXZlcnNpbmVEaXN0YW5jZShlLHQsbixyKXtjb25zdCBpPShuLWUpKk1hdGguUEkvMTgwLHM9KHItdCkqTWF0aC5QSS8xODAsbz1NYXRoLnNpbihpLzIpKk1hdGguc2luKGkvMikrTWF0aC5jb3MoZSpNYXRoLlBJLzE4MCkqTWF0aC5jb3MobipNYXRoLlBJLzE4MCkqTWF0aC5zaW4ocy8yKSpNYXRoLnNpbihzLzIpO3JldHVybiA2MzcxKigyKk1hdGguYXRhbjIoTWF0aC5zcXJ0KG8pLE1hdGguc3FydCgxLW8pKSl9ZmluZEFuZE1vZGlmeSgpe3Rocm93IG5ldyBIKCJmaW5kQW5kTW9kaWZ5Iix7Y29sbGVjdGlvbjp0aGlzLm5hbWV9KX1hc3luYyBmaW5kT25lKGUsdCl7Y29uc3Qgbj10aGlzLmZpbmQoZSx0KTtyZXR1cm4gYXdhaXQgbi5fZW5zdXJlSW5pdGlhbGl6ZWQoKSxhd2FpdCBuLmhhc05leHQoKT9hd2FpdCBuLm5leHQoKTpudWxsfWFzeW5jIGZpbmRPbmVBbmREZWxldGUoZSx0KXtsZXQgbj10aGlzLmZpbmQoZSk7aWYodCYmdC5zb3J0PyhuPW4uc29ydCh0LnNvcnQpLGF3YWl0IG4uX2Vuc3VyZUluaXRpYWxpemVkKCkpOmF3YWl0IG4uX2Vuc3VyZUluaXRpYWxpemVkKCksIShhd2FpdCBuLmhhc05leHQoKSkpcmV0dXJuIG51bGw7Y29uc3Qgcj1hd2FpdCBuLm5leHQoKTtyZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudHMuZGVsZXRlKHIuX2lkLnRvU3RyaW5nKCkpLHQmJnQucHJvamVjdGlvbj9FKHQucHJvamVjdGlvbixyKTpyfWFzeW5jIGZpbmRPbmVBbmRSZXBsYWNlKGUsdCxuKXtsZXQgcj10aGlzLmZpbmQoZSk7aWYobiYmbi5zb3J0PyhyPXIuc29ydChuLnNvcnQpLGF3YWl0IHIuX2Vuc3VyZUluaXRpYWxpemVkKCkpOmF3YWl0IHIuX2Vuc3VyZUluaXRpYWxpemVkKCksIShhd2FpdCByLmhhc05leHQoKSkpcmV0dXJuIG51bGw7Y29uc3QgaT1hd2FpdCByLm5leHQoKTtyZXR1cm4gdC5faWQ9aS5faWQsYXdhaXQgdGhpcy5kb2N1bWVudHMuYWRkKGkuX2lkLnRvU3RyaW5nKCksdCksbiYmbi5yZXR1cm5OZXdEb2N1bWVudD9uJiZuLnByb2plY3Rpb24/RShuLnByb2plY3Rpb24sdCk6dDpuJiZuLnByb2plY3Rpb24/RShuLnByb2plY3Rpb24saSk6aX1hc3luYyBmaW5kT25lQW5kVXBkYXRlKGUsdCxuKXtsZXQgcj10aGlzLmZpbmQoZSk7aWYobiYmbi5zb3J0PyhyPXIuc29ydChuLnNvcnQpLGF3YWl0IHIuX2Vuc3VyZUluaXRpYWxpemVkKCkpOmF3YWl0IHIuX2Vuc3VyZUluaXRpYWxpemVkKCksIShhd2FpdCByLmhhc05leHQoKSkpcmV0dXJuIG51bGw7Y29uc3QgaT1hd2FpdCByLm5leHQoKSxzPU9iamVjdC5hc3NpZ24oe30saSk7cmV0dXJuIGN0KHQscywhMSxYZShpLGUpLmFycmF5RmlsdGVycyxuJiZuLmFycmF5RmlsdGVycyksYXdhaXQgdGhpcy5kb2N1bWVudHMuYWRkKGkuX2lkLnRvU3RyaW5nKCkscyksbiYmbi5yZXR1cm5OZXdEb2N1bWVudD9uJiZuLnByb2plY3Rpb24/RShuLnByb2plY3Rpb24scyk6czpuJiZuLnByb2plY3Rpb24/RShuLnByb2plY3Rpb24saSk6aX1nZXRJbmRleGVzKCl7Y29uc3QgZT1bXTtmb3IoY29uc3RbdCxuXW9mIHRoaXMuaW5kZXhlcyllLnB1c2gobi5nZXRTcGVjKCkpO3JldHVybiBlfWdldFNoYXJkRGlzdHJpYnV0aW9uKCl7dGhyb3cgbmV3IEgoImdldFNoYXJkRGlzdHJpYnV0aW9uIix7Y29sbGVjdGlvbjp0aGlzLm5hbWV9KX1nZXRTaGFyZFZlcnNpb24oKXt0aHJvdyBuZXcgSCgiZ2V0U2hhcmRWZXJzaW9uIix7Y29sbGVjdGlvbjp0aGlzLm5hbWV9KX1nZXRTdG9yZSgpe3JldHVybiB0aGlzLmRvY3VtZW50c31ncm91cCgpe3Rocm93IG5ldyBIKCJncm91cCIse2NvbGxlY3Rpb246dGhpcy5uYW1lfSl9YXN5bmMgaW5zZXJ0KGUpe3JldHVybiBBcnJheT09ZS5jb25zdHJ1Y3Rvcj9hd2FpdCB0aGlzLmluc2VydE1hbnkoZSk6YXdhaXQgdGhpcy5pbnNlcnRPbmUoZSl9YXN5bmMgaW5zZXJ0T25lKGUpe2NvbnN0IHQ9UnQuc3RhcnQoImNvbGxlY3Rpb24iLCJpbnNlcnRPbmUiLHtjb2xsZWN0aW9uOnRoaXMubmFtZX0pO3RoaXMuX2luaXRpYWxpemVkfHxhd2FpdCB0aGlzLl9pbml0aWFsaXplKCksbnVsbD09ZS5faWQmJihlLl9pZD1uZXcgZyk7Y29uc3Qgbj1SdC5zdGFydCgiY29sbGVjdGlvbiIsImluc2VydE9uZS5zdG9yZSIpO2F3YWl0IHRoaXMuZG9jdW1lbnRzLmFkZChlLl9pZC50b1N0cmluZygpLGUpLFJ0LmVuZChuKTtjb25zdCByPVJ0LnN0YXJ0KCJjb2xsZWN0aW9uIiwiaW5zZXJ0T25lLnVwZGF0ZUluZGV4ZXMiKTtyZXR1cm4gYXdhaXQgdGhpcy51cGRhdGVJbmRleGVzT25JbnNlcnQoZSksUnQuZW5kKHIse2luZGV4Q291bnQ6dGhpcy5pbmRleGVzLnNpemV9KSx0aGlzLmVtaXQoImluc2VydCIsZSksUnQuZW5kKHQpLHtpbnNlcnRlZElkOmUuX2lkfX1hc3luYyBpbnNlcnRNYW55KGUpe2NvbnN0IHQ9UnQuc3RhcnQoImNvbGxlY3Rpb24iLCJpbnNlcnRNYW55Iix7Y29sbGVjdGlvbjp0aGlzLm5hbWUsZG9jQ291bnQ6ZS5sZW5ndGh9KTt0aGlzLl9pbml0aWFsaXplZHx8YXdhaXQgdGhpcy5faW5pdGlhbGl6ZSgpO2NvbnN0IG49W107Zm9yKGxldCByPTA7cjxlLmxlbmd0aDtyKyspe2NvbnN0IHQ9YXdhaXQgdGhpcy5pbnNlcnRPbmUoZVtyXSk7bi5wdXNoKHQuaW5zZXJ0ZWRJZCl9cmV0dXJuIFJ0LmVuZCh0LHtpbnNlcnRlZENvdW50Om4ubGVuZ3RofSkse2luc2VydGVkSWRzOm59fWlzQ2FwcGVkKCl7dGhyb3cgbmV3IEgoImlzQ2FwcGVkIix7Y29sbGVjdGlvbjp0aGlzLm5hbWV9KX1tYXBSZWR1Y2UoKXt0aHJvdyBuZXcgSCgibWFwUmVkdWNlIix7Y29sbGVjdGlvbjp0aGlzLm5hbWV9KX1yZUluZGV4KCl7dGhyb3cgbmV3IEgoInJlSW5kZXgiLHtjb2xsZWN0aW9uOnRoaXMubmFtZX0pfWFzeW5jIHJlcGxhY2VPbmUoZSx0LG4pe2NvbnN0IHI9e30saT10aGlzLmZpbmQoZSk7aWYoYXdhaXQgaS5fZW5zdXJlSW5pdGlhbGl6ZWQoKSxyLm1hdGNoZWRDb3VudD1hd2FpdCBpLmNvdW50KCksMD09ci5tYXRjaGVkQ291bnQpe2lmKHIubW9kaWZpZWRDb3VudD0wLG4mJm4udXBzZXJ0KXtjb25zdCBlPXQ7ZS5faWQ9bmV3IGcsYXdhaXQgdGhpcy5kb2N1bWVudHMuYWRkKGUuX2lkLnRvU3RyaW5nKCksZSksYXdhaXQgdGhpcy51cGRhdGVJbmRleGVzT25JbnNlcnQoZSksdGhpcy5lbWl0KCJpbnNlcnQiLGUpLHIudXBzZXJ0ZWRJZD1lLl9pZH19ZWxzZXtyLm1vZGlmaWVkQ291bnQ9MTtjb25zdCBlPWF3YWl0IGkubmV4dCgpO2F3YWl0IHRoaXMudXBkYXRlSW5kZXhlc09uRGVsZXRlKGUpLHQuX2lkPWUuX2lkLHRoaXMuZG9jdW1lbnRzLmFkZChlLl9pZC50b1N0cmluZygpLHQpLGF3YWl0IHRoaXMudXBkYXRlSW5kZXhlc09uSW5zZXJ0KHQpLHRoaXMuZW1pdCgicmVwbGFjZSIsdCl9cmV0dXJuIHJ9YXN5bmMgcmVtb3ZlKGUsdCl7Y29uc3Qgbj10aGlzLmZpbmQoZSk7aWYoYXdhaXQgbi5fZW5zdXJlSW5pdGlhbGl6ZWQoKSxhd2FpdCBuLmhhc05leHQoKSlpZighMD09PXR8fHQmJnQuanVzdE9uZSl7Y29uc3QgZT1hd2FpdCBuLm5leHQoKTthd2FpdCB0aGlzLnVwZGF0ZUluZGV4ZXNPbkRlbGV0ZShlKSx0aGlzLmRvY3VtZW50cy5kZWxldGUoZS5faWQudG9TdHJpbmcoKSl9ZWxzZSBmb3IoO2F3YWl0IG4uaGFzTmV4dCgpOyl7Y29uc3QgZT1hd2FpdCBuLm5leHQoKTthd2FpdCB0aGlzLnVwZGF0ZUluZGV4ZXNPbkRlbGV0ZShlKSx0aGlzLmRvY3VtZW50cy5kZWxldGUoZS5faWQudG9TdHJpbmcoKSl9fXJlbmFtZUNvbGxlY3Rpb24oKXt0aHJvdyBuZXcgSCgicmVuYW1lQ29sbGVjdGlvbiIse2NvbGxlY3Rpb246dGhpcy5uYW1lfSl9c2F2ZSgpe3Rocm93IG5ldyBIKCJzYXZlIix7Y29sbGVjdGlvbjp0aGlzLm5hbWV9KX1zdGF0cygpe3Rocm93IG5ldyBIKCJzdGF0cyIse2NvbGxlY3Rpb246dGhpcy5uYW1lfSl9c3RvcmFnZVNpemUoKXt0aHJvdyBuZXcgSCgic3RvcmFnZVNpemUiLHtjb2xsZWN0aW9uOnRoaXMubmFtZX0pfXRvdGFsU2l6ZSgpe3Rocm93IG5ldyBIKCJ0b3RhbFNpemUiLHtjb2xsZWN0aW9uOnRoaXMubmFtZX0pfXRvdGFsSW5kZXhTaXplKCl7dGhyb3cgbmV3IEgoInRvdGFsSW5kZXhTaXplIix7Y29sbGVjdGlvbjp0aGlzLm5hbWV9KX1hc3luYyB1cGRhdGUoZSx0LG4pe2NvbnN0IHI9dGhpcy5maW5kKGUpO2lmKGF3YWl0IHIuX2Vuc3VyZUluaXRpYWxpemVkKCksYXdhaXQgci5oYXNOZXh0KCkpaWYobiYmbi5tdWx0aSlmb3IoO2F3YWl0IHIuaGFzTmV4dCgpOyl7Y29uc3QgaT1hd2FpdCByLm5leHQoKSxzPVhlKGksZSkuYXJyYXlGaWx0ZXJzLG89biYmbi5hcnJheUZpbHRlcnM7YXdhaXQgdGhpcy51cGRhdGVJbmRleGVzT25EZWxldGUoaSksY3QodCxpLCExLHMsbyksYXdhaXQgdGhpcy5kb2N1bWVudHMuYWRkKGkuX2lkLnRvU3RyaW5nKCksaSksYXdhaXQgdGhpcy51cGRhdGVJbmRleGVzT25JbnNlcnQoaSl9ZWxzZXtjb25zdCBpPWF3YWl0IHIubmV4dCgpLHM9WGUoaSxlKS5hcnJheUZpbHRlcnMsbz1uJiZuLmFycmF5RmlsdGVyczthd2FpdCB0aGlzLnVwZGF0ZUluZGV4ZXNPbkRlbGV0ZShpKSxjdCh0LGksITEscyxvKSxhd2FpdCB0aGlzLmRvY3VtZW50cy5hZGQoaS5faWQudG9TdHJpbmcoKSxpKSxhd2FpdCB0aGlzLnVwZGF0ZUluZGV4ZXNPbkluc2VydChpKX1lbHNlIGlmKG4mJm4udXBzZXJ0KXtjb25zdCBuPWx0KGUsdCxuZXcgZyk7YXdhaXQgdGhpcy5kb2N1bWVudHMuYWRkKG4uX2lkLnRvU3RyaW5nKCksbiksYXdhaXQgdGhpcy51cGRhdGVJbmRleGVzT25JbnNlcnQobil9fWFzeW5jIHVwZGF0ZU9uZShlLHQsbil7Y29uc3Qgcj1SdC5zdGFydCgiY29sbGVjdGlvbiIsInVwZGF0ZU9uZSIse2NvbGxlY3Rpb246dGhpcy5uYW1lfSksaT1SdC5zdGFydCgiY29sbGVjdGlvbiIsInVwZGF0ZU9uZS5maW5kIikscz10aGlzLmZpbmQoZSk7aWYoYXdhaXQgcy5fZW5zdXJlSW5pdGlhbGl6ZWQoKSxSdC5lbmQoaSksYXdhaXQgcy5oYXNOZXh0KCkpe2NvbnN0IHI9YXdhaXQgcy5uZXh0KCksaT1KU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHIpKSxvPVhlKHIsZSkuYXJyYXlGaWx0ZXJzLGE9biYmbi5hcnJheUZpbHRlcnMsYz1SdC5zdGFydCgiY29sbGVjdGlvbiIsInVwZGF0ZU9uZS51cGRhdGVJbmRleGVzT25EZWxldGUiKTthd2FpdCB0aGlzLnVwZGF0ZUluZGV4ZXNPbkRlbGV0ZShyKSxSdC5lbmQoYyk7Y29uc3QgbD1SdC5zdGFydCgiY29sbGVjdGlvbiIsInVwZGF0ZU9uZS5hcHBseVVwZGF0ZXMiKTtjdCh0LHIsITEsbyxhKSxSdC5lbmQobCk7Y29uc3QgdT1SdC5zdGFydCgiY29sbGVjdGlvbiIsInVwZGF0ZU9uZS5zdG9yZSIpO3RoaXMuZG9jdW1lbnRzLmFkZChyLl9pZC50b1N0cmluZygpLHIpLFJ0LmVuZCh1KTtjb25zdCBoPVJ0LnN0YXJ0KCJjb2xsZWN0aW9uIiwidXBkYXRlT25lLnVwZGF0ZUluZGV4ZXNPbkluc2VydCIpO2F3YWl0IHRoaXMudXBkYXRlSW5kZXhlc09uSW5zZXJ0KHIpLFJ0LmVuZChoLHtpbmRleENvdW50OnRoaXMuaW5kZXhlcy5zaXplfSk7Y29uc3QgZj10aGlzLl9nZXRVcGRhdGVEZXNjcmlwdGlvbihpLHIpO3RoaXMuZW1pdCgidXBkYXRlIixyLGYpfWVsc2UgaWYobiYmbi51cHNlcnQpe2NvbnN0IG49bHQoZSx0LG5ldyBnKTt0aGlzLmRvY3VtZW50cy5hZGQobi5faWQudG9TdHJpbmcoKSxuKSxhd2FpdCB0aGlzLnVwZGF0ZUluZGV4ZXNPbkluc2VydChuKSx0aGlzLmVtaXQoImluc2VydCIsbil9UnQuZW5kKHIpfWFzeW5jIHVwZGF0ZU1hbnkoZSx0LG4pe2NvbnN0IHI9UnQuc3RhcnQoImNvbGxlY3Rpb24iLCJ1cGRhdGVNYW55Iix7Y29sbGVjdGlvbjp0aGlzLm5hbWV9KSxpPVJ0LnN0YXJ0KCJjb2xsZWN0aW9uIiwidXBkYXRlTWFueS5maW5kIikscz10aGlzLmZpbmQoZSk7YXdhaXQgcy5fZW5zdXJlSW5pdGlhbGl6ZWQoKSxSdC5lbmQoaSk7bGV0IG89MDtpZihhd2FpdCBzLmhhc05leHQoKSlmb3IoO2F3YWl0IHMuaGFzTmV4dCgpOyl7Y29uc3Qgcj1hd2FpdCBzLm5leHQoKSxpPUpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkocikpLGE9WGUocixlKS5hcnJheUZpbHRlcnMsYz1uJiZuLmFycmF5RmlsdGVyczthd2FpdCB0aGlzLnVwZGF0ZUluZGV4ZXNPbkRlbGV0ZShyKSxjdCh0LHIsITEsYSxjKSx0aGlzLmRvY3VtZW50cy5hZGQoci5faWQudG9TdHJpbmcoKSxyKSxhd2FpdCB0aGlzLnVwZGF0ZUluZGV4ZXNPbkluc2VydChyKTtjb25zdCBsPXRoaXMuX2dldFVwZGF0ZURlc2NyaXB0aW9uKGkscik7dGhpcy5lbWl0KCJ1cGRhdGUiLHIsbCksbysrfWVsc2UgaWYobiYmbi51cHNlcnQpe2NvbnN0IG49bHQoZSx0LG5ldyBnKTt0aGlzLmRvY3VtZW50cy5hZGQobi5faWQudG9TdHJpbmcoKSxuKSxhd2FpdCB0aGlzLnVwZGF0ZUluZGV4ZXNPbkluc2VydChuKSx0aGlzLmVtaXQoImluc2VydCIsbil9UnQuZW5kKHIse3VwZGF0ZWRDb3VudDpvfSl9dmFsaWRhdGUoKXt0aHJvdyBuZXcgSCgidmFsaWRhdGUiLHtjb2xsZWN0aW9uOnRoaXMubmFtZX0pfV9nZXRVcGRhdGVEZXNjcmlwdGlvbihlLHQpe2NvbnN0IG49e30scj1bXTtmb3IoY29uc3QgaSBpbiB0KSJfaWQiIT09aSYmSlNPTi5zdHJpbmdpZnkoZVtpXSkhPT1KU09OLnN0cmluZ2lmeSh0W2ldKSYmKG5baV09dFtpXSk7Zm9yKGNvbnN0IGkgaW4gZSkiX2lkIiE9PWkmJihpIGluIHR8fHIucHVzaChpKSk7cmV0dXJue3VwZGF0ZWRGaWVsZHM6bixyZW1vdmVkRmllbGRzOnIsdHJ1bmNhdGVkQXJyYXlzOltdfX13YXRjaChlPVtdLHQ9e30pe3JldHVybiBuZXcgVXQodGhpcyxlLHQpfX1mdW5jdGlvbiBWdChlLHQpe2NvbnN0IG49e30scj1PYmplY3Qua2V5cyhlKTtsZXQgaT0hMSxzPSExO2Zvcihjb25zdCBvIG9mIHIpe2lmKCJfaWQiPT09byljb250aW51ZTtjb25zdCB0PWVbb107MT09PXR8fCEwPT09dD9pPSEwOjA9PT10fHwhMT09PXR8fChzPSEwKX1pZihzfHxpKXswIT09ZS5faWQmJiExIT09ZS5faWQmJihuLl9pZD10Ll9pZCk7Zm9yKGNvbnN0IGkgb2Ygcil7Y29uc3Qgcj1lW2ldOyJfaWQiPT09aT8wIT09ciYmITEhPT1yfHxkZWxldGUgbi5faWQ6bltpXT0xPT09cnx8ITA9PT1yP3YodCxpKTpJZShyLHQpfX1lbHNle2Zvcihjb25zdCBlIGluIHQpdC5oYXNPd25Qcm9wZXJ0eShlKSYmKG5bZV09dFtlXSk7Zm9yKGNvbnN0IHQgb2YgcikwIT09ZVt0XSYmITEhPT1lW3RdfHxkZWxldGUgblt0XX1yZXR1cm4gbn1jbGFzcyBIdHtjb25zdHJ1Y3RvcihlKXt0aGlzLm9wdGlvbnM9ZXx8e30sdGhpcy5iYXNlRm9sZGVyPXRoaXMub3B0aW9ucy5iYXNlRm9sZGVyfHwiYmFieW1vbmdvIix0aGlzLmRiTmFtZT10aGlzLm9wdGlvbnMuZGJOYW1lfHwiZGVmYXVsdCIsdGhpcy5kYkZvbGRlcj1gJHt0aGlzLmJhc2VGb2xkZXJ9LyR7dGhpcy5kYk5hbWV9YCx0aGlzLmNvbGxlY3Rpb25zPS8qIEBfX1BVUkVfXyAqL25ldyBNYXA7Y29uc3QgdD1uZXcgUHJveHkodGhpcyx7Z2V0OihlLHQsbik9PnQgaW4gZT9SZWZsZWN0LmdldChlLHQsbik6InN5bWJvbCI9PXR5cGVvZiB0fHx0LnN0YXJ0c1dpdGgoIl8iKT92b2lkIDA6InN0cmluZyI9PXR5cGVvZiB0P2UuZ2V0Q29sbGVjdGlvbih0KTp2b2lkIDB9KTtyZXR1cm4gdGhpcy5fcHJveHk9dCx0fWFzeW5jIGNsb3NlKCl7Zm9yKGNvbnN0W2UsdF1vZiB0aGlzLmNvbGxlY3Rpb25zKWF3YWl0IHQuY2xvc2UoKX1jbG9uZUNvbGxlY3Rpb24oKXt0aHJvdyBuZXcgSCgiY2xvbmVDb2xsZWN0aW9uIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX1jbG9uZURhdGFiYXNlKCl7dGhyb3cgbmV3IEgoImNsb25lRGF0YWJhc2UiLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfWNvbW1hbmRIZWxwKCl7dGhyb3cgbmV3IEgoImNvbW1hbmRIZWxwIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX1jb3B5RGF0YWJhc2UoKXt0aHJvdyBuZXcgSCgiY29weURhdGFiYXNlIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX1jcmVhdGVDb2xsZWN0aW9uKGUpe3JldHVybiB0aGlzLmNvbGxlY3Rpb25zLmhhcyhlKXx8dGhpcy5jb2xsZWN0aW9ucy5zZXQoZSxuZXcgcXQodGhpcyxlKSkse29rOjF9fWN1cnJlbnRPcCgpe3Rocm93IG5ldyBIKCJjdXJyZW50T3AiLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfWFzeW5jIGRyb3BDb2xsZWN0aW9uKGUpe2lmKHRoaXMuY29sbGVjdGlvbnMuaGFzKGUpKXtjb25zdCB0PXRoaXMuY29sbGVjdGlvbnMuZ2V0KGUpOyJmdW5jdGlvbiI9PXR5cGVvZiB0LmRyb3AmJmF3YWl0IHQuZHJvcCgpLHRoaXMuY29sbGVjdGlvbnMuZGVsZXRlKGUpfX1hc3luYyBkcm9wRGF0YWJhc2UoKXtmb3IoY29uc3RbcixpXW9mIHRoaXMuY29sbGVjdGlvbnMpYXdhaXQgaS5kcm9wKCk7dGhpcy5jb2xsZWN0aW9ucy5jbGVhcigpO2NvbnN0IGU9dGhpcy5kYkZvbGRlci5zcGxpdCgiLyIpLmZpbHRlcihCb29sZWFuKSx0PWUucG9wKCk7dHJ5e2xldCBuPWF3YWl0IGdsb2JhbFRoaXMubmF2aWdhdG9yLnN0b3JhZ2UuZ2V0RGlyZWN0b3J5KCk7Zm9yKGNvbnN0IHQgb2YgZSluPWF3YWl0IG4uZ2V0RGlyZWN0b3J5SGFuZGxlKHQse2NyZWF0ZTohMX0pO2F3YWl0IG4ucmVtb3ZlRW50cnkodCx7cmVjdXJzaXZlOiEwfSl9Y2F0Y2gobil7aWYoIk5vdEZvdW5kRXJyb3IiIT09bi5uYW1lJiYiRU5PRU5UIiE9PW4uY29kZSl0aHJvdyBufXJldHVybntvazoxfX1ldmFsKCl7dGhyb3cgbmV3IEgoImV2YWwiLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfWZzeW5jTG9jaygpe3Rocm93IG5ldyBIKCJmc3luY0xvY2siLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfWZzeW5jVW5sb2NrKCl7dGhyb3cgbmV3IEgoImZzeW5jVW5sb2NrIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX1nZXRDb2xsZWN0aW9uKGUpe2lmKCF0aGlzLmNvbGxlY3Rpb25zLmhhcyhlKSl7Y29uc3QgdD10aGlzLl9wcm94eXx8dGhpczt0aGlzLmNvbGxlY3Rpb25zLnNldChlLG5ldyBxdCh0LGUpKX1yZXR1cm4gdGhpcy5jb2xsZWN0aW9ucy5nZXQoZSl9Y29sbGVjdGlvbihlKXtyZXR1cm4gdGhpcy5nZXRDb2xsZWN0aW9uKGUpfWdldENvbGxlY3Rpb25JbmZvcygpe3Rocm93IG5ldyBIKCJnZXRDb2xsZWN0aW9uSW5mb3MiLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfWdldENvbGxlY3Rpb25OYW1lcygpe3JldHVybiBBcnJheS5mcm9tKHRoaXMuY29sbGVjdGlvbnMua2V5cygpKX1nZXRMYXN0RXJyb3IoKXt0aHJvdyBuZXcgSCgiZ2V0TGFzdEVycm9yIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX1nZXRMYXN0RXJyb3JPYmooKXt0aHJvdyBuZXcgSCgiZ2V0TGFzdEVycm9yT2JqIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX1nZXRMb2dDb21wb25lbnRzKCl7dGhyb3cgbmV3IEgoImdldExvZ0NvbXBvbmVudHMiLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfWdldE1vbmdvKCl7dGhyb3cgbmV3IEgoImdldE1vbmdvIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX1nZXROYW1lKCl7dGhyb3cgbmV3IEgoImdldE5hbWUiLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfWdldFByZXZFcnJvcigpe3Rocm93IG5ldyBIKCJnZXRQcmV2RXJyb3IiLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfWdldFByb2ZpbGluZ0xldmVsKCl7dGhyb3cgbmV3IEgoImdldFByb2ZpbGluZ0xldmVsIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX1nZXRQcm9maWxpbmdTdGF0dXMoKXt0aHJvdyBuZXcgSCgiZ2V0UHJvZmlsaW5nU3RhdHVzIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX1nZXRSZXBsaWNhdGlvbkluZm8oKXt0aHJvdyBuZXcgSCgiZ2V0UmVwbGljYXRpb25JbmZvIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX1nZXRTaWJsaW5nREIoKXt0aHJvdyBuZXcgSCgiZ2V0U2libGluZ0RCIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX1oZWxwKCl7Y29uc29sZS5sb2coIiAgICAgICAgaGVscCBtciAgICAgICAgICAgICAgICAgICAgICBtYXByZWR1Y2UiKSxjb25zb2xlLmxvZygiICAgICAgICBkYi5mb28uZmluZCgpICAgICAgICAgICAgICAgIGxpc3Qgb2JqZWN0cyBpbiBjb2xsZWN0aW9uIGZvbyIpLGNvbnNvbGUubG9nKCIgICAgICAgIGRiLmZvby5maW5kKCB7IGEgOiAxIH0gKSAgICAgbGlzdCBvYmplY3RzIGluIGZvbyB3aGVyZSBhID09IDEiKSxjb25zb2xlLmxvZygiICAgICAgICBpdCAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCBvZiB0aGUgbGFzdCBsaW5lIGV2YWx1YXRlZDsgdXNlIHRvIGZ1cnRoZXIgaXRlcmF0ZSIpfWhvc3RJbmZvKCl7dGhyb3cgbmV3IEgoImhvc3RJbmZvIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX1pc01hc3Rlcigpe3Rocm93IG5ldyBIKCJpc01hc3RlciIse2RhdGFiYXNlOnRoaXMuZGJOYW1lfSl9a2lsbE9wKCl7dGhyb3cgbmV3IEgoImtpbGxPcCIse2RhdGFiYXNlOnRoaXMuZGJOYW1lfSl9bGlzdENvbW1hbmRzKCl7dGhyb3cgbmV3IEgoImxpc3RDb21tYW5kcyIse2RhdGFiYXNlOnRoaXMuZGJOYW1lfSl9bG9hZFNlcnZlclNjcmlwdHMoKXt0aHJvdyBuZXcgSCgibG9hZFNlcnZlclNjcmlwdHMiLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfWxvZ291dCgpe3Rocm93IG5ldyBIKCJsb2dvdXQiLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfXByaW50Q29sbGVjdGlvblN0YXRzKCl7dGhyb3cgbmV3IEgoInByaW50Q29sbGVjdGlvblN0YXRzIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX1wcmludFJlcGxpY2F0aW9uSW5mbygpe3Rocm93IG5ldyBIKCJwcmludFJlcGxpY2F0aW9uSW5mbyIse2RhdGFiYXNlOnRoaXMuZGJOYW1lfSl9cHJpbnRTaGFyZGluZ1N0YXR1cygpe3Rocm93IG5ldyBIKCJwcmludFNoYXJkaW5nU3RhdHVzIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX1wcmludFNsYXZlUmVwbGljYXRpb25JbmZvKCl7dGhyb3cgbmV3IEgoInByaW50U2xhdmVSZXBsaWNhdGlvbkluZm8iLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfXJlcGFpckRhdGFiYXNlKCl7dGhyb3cgbmV3IEgoInJlcGFpckRhdGFiYXNlIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX1yZXNldEVycm9yKCl7dGhyb3cgbmV3IEgoInJlc2V0RXJyb3IiLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfXJ1bkNvbW1hbmQoKXt0aHJvdyBuZXcgSCgicnVuQ29tbWFuZCIse2RhdGFiYXNlOnRoaXMuZGJOYW1lfSl9c2VydmVyQnVpbGRJbmZvKCl7dGhyb3cgbmV3IEgoInNlcnZlckJ1aWxkSW5mbyIse2RhdGFiYXNlOnRoaXMuZGJOYW1lfSl9c2VydmVyQ21kTGluZU9wdHMoKXt0aHJvdyBuZXcgSCgic2VydmVyQ21kTGluZU9wdHMiLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfXNlcnZlclN0YXR1cygpe3Rocm93IG5ldyBIKCJzZXJ2ZXJTdGF0dXMiLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfXNldExvZ0xldmVsKCl7dGhyb3cgbmV3IEgoInNldExvZ0xldmVsIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX1zZXRQcm9maWxpbmdMZXZlbCgpe3Rocm93IG5ldyBIKCJzZXRQcm9maWxpbmdMZXZlbCIse2RhdGFiYXNlOnRoaXMuZGJOYW1lfSl9c2h1dGRvd25TZXJ2ZXIoKXt0aHJvdyBuZXcgSCgic2h1dGRvd25TZXJ2ZXIiLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfXN0YXRzKCl7dGhyb3cgbmV3IEgoInN0YXRzIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX12ZXJzaW9uKCl7dGhyb3cgbmV3IEgoInZlcnNpb24iLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfXVwZ3JhZGVDaGVjaygpe3Rocm93IG5ldyBIKCJ1cGdyYWRlQ2hlY2siLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfXVwZ3JhZGVDaGVja0FsbERCcygpe3Rocm93IG5ldyBIKCJ1cGdyYWRlQ2hlY2tBbGxEQnMiLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfXdhdGNoKGU9W10sdD17fSl7cmV0dXJuIG5ldyBVdCh0aGlzLGUsdCl9fWNsYXNzIFd0e2NvbnN0cnVjdG9yKGU9e30sdD0oKT0+e30pe3RoaXMub3B0aW9ucz1lLHRoaXMuZGF0YWJhc2VzPS8qIEBfX1BVUkVfXyAqL25ldyBNYXAsdGhpcy5wb3N0RXZlbnQ9dCx0aGlzLmN1cnNvcnM9LyogQF9fUFVSRV9fICovbmV3IE1hcCx0aGlzLmN1cnNvckNvdW50ZXI9MSx0aGlzLnN0cmVhbXM9LyogQF9fUFVSRV9fICovbmV3IE1hcCx0aGlzLnN0cmVhbUNvdW50ZXI9MX1hc3luYyBkaXNwYXRjaChlKXtjb25zdHt0YXJnZXQ6dCxkYXRhYmFzZTpuLGNvbGxlY3Rpb246cixtZXRob2Q6aSxhcmdzOnM9W10sY3Vyc29ySWQ6byxzdHJlYW1JZDphLGN1cnNvck9wdHM6Y309ZTtpZigiY3Vyc29yIj09PXQpcmV0dXJuIGF3YWl0IHRoaXMuX2N1cnNvck9wKG8saSxzKTtpZigiY2hhbmdlc3RyZWFtIj09PXQpcmV0dXJuIGF3YWl0IHRoaXMuX2NoYW5nZVN0cmVhbU9wKGEsaSxzKTtpZigiY2xpZW50Ij09PXQpcmV0dXJuIGF3YWl0IHRoaXMuX2NhbGwodGhpcyxpLHMpO2lmKCF0fHwhbnx8IWkpdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIHJlcXVlc3QgcGF5bG9hZCIpO2NvbnN0IGw9dGhpcy5fZ2V0REIobik7aWYoImRiIj09PXQpcmV0dXJuIGF3YWl0IHRoaXMuX2NhbGwobCxpLHMpO2lmKCJjb2xsZWN0aW9uIj09PXQpe2lmKCFyKXRocm93IG5ldyBFcnJvcigiQ29sbGVjdGlvbiBuYW1lIHJlcXVpcmVkIGZvciBjb2xsZWN0aW9uIHRhcmdldCIpO2NvbnN0IGU9bC5jb2xsZWN0aW9uKHIpO3JldHVybiBhd2FpdCB0aGlzLl9jYWxsKGUsaSxzLGMpfXRocm93IG5ldyBFcnJvcihgVW5rbm93biB0YXJnZXQ6ICR7dH1gKX1fZ2V0REIoZSl7aWYodGhpcy5kYXRhYmFzZXMuaGFzKGUpKXJldHVybiB0aGlzLmRhdGFiYXNlcy5nZXQoZSk7Y29uc3QgdD1uZXcgSHQoey4uLnRoaXMub3B0aW9ucyxkYk5hbWU6ZX0pO3JldHVybiB0aGlzLmRhdGFiYXNlcy5zZXQoZSx0KSx0fWFzeW5jIF9jYWxsKGUsdCxuLHIpe2lmKCJmdW5jdGlvbiIhPXR5cGVvZiBlW3RdKXRocm93IG5ldyBFcnJvcihgTWV0aG9kICR7dH0gbm90IGZvdW5kIG9uIHRhcmdldGApO2NvbnN0IGk9ZVt0XSguLi5ufHxbXSkscz1pJiYiZnVuY3Rpb24iPT10eXBlb2YgaS50aGVuP2F3YWl0IGk6aTtyZXR1cm4gcyYmImZ1bmN0aW9uIj09dHlwZW9mIHMuaGFzTmV4dCYmImZ1bmN0aW9uIj09dHlwZW9mIHMubmV4dD9hd2FpdCB0aGlzLl9yZWdpc3RlckN1cnNvcihzLHIpOiJhZ2dyZWdhdGUiPT09dCYmQXJyYXkuaXNBcnJheShzKT9hd2FpdCB0aGlzLl9yZWdpc3RlckFycmF5QXNDdXJzb3Iocyk6cyYmIkNoYW5nZVN0cmVhbSI9PT1zLmNvbnN0cnVjdG9yPy5uYW1lfHxzJiYiZnVuY3Rpb24iPT10eXBlb2Ygcy5vbiYmcy5oYXNPd25Qcm9wZXJ0eSgicGlwZWxpbmUiKSYmcy5oYXNPd25Qcm9wZXJ0eSgiX2NoYW5nZUNvdW50ZXIiKT90aGlzLl9yZWdpc3RlckNoYW5nZVN0cmVhbShzKTpzfWFzeW5jIF9yZWdpc3RlckN1cnNvcihlLHQ9e30pe3Quc29ydCYmKGU9ZS5zb3J0KHQuc29ydCkpLHQuc2tpcCYmKGU9YXdhaXQgZS5za2lwKHQuc2tpcCkpLHQubGltaXQmJihlPWF3YWl0IGUubGltaXQodC5saW1pdCkpLHQubWluJiZlLm1pbiYmKGU9ZS5taW4odC5taW4pKSx0Lm1heCYmZS5tYXgmJihlPWUubWF4KHQubWF4KSksdC5oaW50JiZlLmhpbnQmJihlPWUuaGludCh0LmhpbnQpKSx0LmNvbW1lbnQmJmUuY29tbWVudCYmKGU9ZS5jb21tZW50KHQuY29tbWVudCkpLHQubWF4VGltZU1TJiZlLm1heFRpbWVNUyYmKGU9ZS5tYXhUaW1lTVModC5tYXhUaW1lTVMpKSx0Lm1heFNjYW4mJmUubWF4U2NhbiYmKGU9ZS5tYXhTY2FuKHQubWF4U2NhbikpLHQucmV0dXJuS2V5JiZlLnJldHVybktleSYmKGU9ZS5yZXR1cm5LZXkodC5yZXR1cm5LZXkpKSx0LnNob3dSZWNvcmRJZCYmZS5zaG93UmVjb3JkSWQmJihlPWUuc2hvd1JlY29yZElkKHQuc2hvd1JlY29yZElkKSksdC5jb2xsYXRpb24mJmUuY29sbGF0aW9uJiYoZT1lLmNvbGxhdGlvbih0LmNvbGxhdGlvbikpO2NvbnN0IG49ImN1cl8iK3RoaXMuY3Vyc29yQ291bnRlcisrLHI9dGhpcy5vcHRpb25zLmJhdGNoU2l6ZXx8MTAwLGk9W107Zm9yKDtpLmxlbmd0aDxyJiZhd2FpdCBlLmhhc05leHQoKTspaS5wdXNoKGF3YWl0IGUubmV4dCgpKTtjb25zdCBzPSEoYXdhaXQgZS5oYXNOZXh0KCkpO3JldHVybiBzfHx0aGlzLmN1cnNvcnMuc2V0KG4sZSkse2N1cnNvcklkOm4sYmF0Y2g6aSxleGhhdXN0ZWQ6cyxiYXRjaFNpemU6cn19YXN5bmMgX3JlZ2lzdGVyQXJyYXlBc0N1cnNvcihlKXtjb25zdCB0PSJjdXJfIit0aGlzLmN1cnNvckNvdW50ZXIrKyxuPXRoaXMub3B0aW9ucy5iYXRjaFNpemV8fDEwMCxyPWUuc2xpY2UoMCxuKSxpPWUubGVuZ3RoPD1uO2lmKCFpKXtjb25zdCByPXtwb3NpdGlvbjpuLGFycmF5OmUsYXN5bmMgaGFzTmV4dCgpe3JldHVybiB0aGlzLnBvc2l0aW9uPHRoaXMuYXJyYXkubGVuZ3RofSxhc3luYyBuZXh0KCl7aWYodGhpcy5wb3NpdGlvbj49dGhpcy5hcnJheS5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKCJObyBtb3JlIGRvY3VtZW50cyIpO3JldHVybiB0aGlzLmFycmF5W3RoaXMucG9zaXRpb24rK119fTt0aGlzLmN1cnNvcnMuc2V0KHQscil9cmV0dXJue2N1cnNvcklkOnQsYmF0Y2g6cixleGhhdXN0ZWQ6aSxiYXRjaFNpemU6bn19YXN5bmMgX2N1cnNvck9wKGUsdCxuPVtdKXtpZighZSl0aHJvdyBuZXcgRXJyb3IoImN1cnNvcklkIHJlcXVpcmVkIik7Y29uc3Qgcj10aGlzLmN1cnNvcnMuZ2V0KGUpO2lmKCFyKXtpZigiY2xvc2UiPT09dClyZXR1cm57Y2xvc2VkOiEwfTt0aHJvdyBuZXcgRXJyb3IoYEN1cnNvciBub3QgZm91bmQ6ICR7ZX1gKX1pZigiY2xvc2UiPT09dClyZXR1cm4gdGhpcy5jdXJzb3JzLmRlbGV0ZShlKSx7Y2xvc2VkOiEwfTtpZigiZ2V0TW9yZSI9PT10KXtjb25zdCB0PShuPy5bMF18fHt9KS5iYXRjaFNpemV8fDEwMCxpPVtdO2Zvcig7aS5sZW5ndGg8dCYmYXdhaXQgci5oYXNOZXh0KCk7KWkucHVzaChhd2FpdCByLm5leHQoKSk7Y29uc3Qgcz0hKGF3YWl0IHIuaGFzTmV4dCgpKTtyZXR1cm4gcyYmdGhpcy5jdXJzb3JzLmRlbGV0ZShlKSx7YmF0Y2g6aSxleGhhdXN0ZWQ6cyxiYXRjaFNpemU6dH19dGhyb3cgbmV3IEVycm9yKGBVbmtub3duIGN1cnNvciBtZXRob2Q6ICR7dH1gKX1fcmVnaXN0ZXJDaGFuZ2VTdHJlYW0oZSl7Y29uc3QgdD0iY3NfIit0aGlzLnN0cmVhbUNvdW50ZXIrKyxuPXtjaGFuZ2U6ZT0+dGhpcy5wb3N0RXZlbnQoe3R5cGU6ImV2ZW50IixldmVudDoiY2hhbmdlU3RyZWFtIixwYXlsb2FkOntzdHJlYW1JZDp0LHR5cGU6ImNoYW5nZSIsZGF0YTplfX0pLGVycm9yOmU9PnRoaXMucG9zdEV2ZW50KHt0eXBlOiJldmVudCIsZXZlbnQ6ImNoYW5nZVN0cmVhbSIscGF5bG9hZDp7c3RyZWFtSWQ6dCx0eXBlOiJlcnJvciIsZGF0YTp7bmFtZTplPy5uYW1lLG1lc3NhZ2U6ZT8ubWVzc2FnZSxzdGFjazplPy5zdGFja319fSksY2xvc2U6KCk9PnRoaXMucG9zdEV2ZW50KHt0eXBlOiJldmVudCIsZXZlbnQ6ImNoYW5nZVN0cmVhbSIscGF5bG9hZDp7c3RyZWFtSWQ6dCx0eXBlOiJjbG9zZSJ9fSl9O3JldHVybiBlLm9uKCJjaGFuZ2UiLG4uY2hhbmdlKSxlLm9uKCJlcnJvciIsbi5lcnJvciksZS5vbigiY2xvc2UiLG4uY2xvc2UpLHRoaXMuc3RyZWFtcy5zZXQodCx7c3RyZWFtOmUsaGFuZGxlcnM6bn0pLHtzdHJlYW1JZDp0fX1hc3luYyBfY2hhbmdlU3RyZWFtT3AoZSx0KXtpZighZSl0aHJvdyBuZXcgRXJyb3IoInN0cmVhbUlkIHJlcXVpcmVkIik7Y29uc3Qgbj10aGlzLnN0cmVhbXMuZ2V0KGUpO2lmKCFuKXJldHVybntjbG9zZWQ6ITB9O2lmKCJjbG9zZSI9PT10KXtjb25zdHtzdHJlYW06dCxoYW5kbGVyczpyfT1uO3JldHVybiB0Lm9mZigiY2hhbmdlIixyLmNoYW5nZSksdC5vZmYoImVycm9yIixyLmVycm9yKSx0Lm9mZigiY2xvc2UiLHIuY2xvc2UpLCJmdW5jdGlvbiI9PXR5cGVvZiB0LmNsb3NlJiZhd2FpdCB0LmNsb3NlKCksdGhpcy5zdHJlYW1zLmRlbGV0ZShlKSx7Y2xvc2VkOiEwfX10aHJvdyBuZXcgRXJyb3IoYFVua25vd24gY2hhbmdlIHN0cmVhbSBtZXRob2Q6ICR7dH1gKX13YXRjaChlPVtdLHQ9e30pe3JldHVybiBuZXcgVXQodGhpcyxlLHQpfX1mdW5jdGlvbiBRdChlLHQ9LyogQF9fUFVSRV9fICovbmV3IFdlYWtTZXQpe2lmKG51bGw9PWUpcmV0dXJuIGU7aWYoImZ1bmN0aW9uIj09dHlwZW9mIGUpcmV0dXJue19fZnVuY3Rpb246ZS50b1N0cmluZygpfTtpZihlJiYib2JqZWN0Ij09dHlwZW9mIGUmJiJmdW5jdGlvbiI9PXR5cGVvZiBlLnRvU3RyaW5nKXRyeXtjb25zdCB0PWUudG9TdHJpbmcoKTtpZih0JiYyND09PXQubGVuZ3RoJiYvXlswLTlhLWZdezI0fSQvaS50ZXN0KHQpJiZlLmNvbnN0cnVjdG9yJiYiT2JqZWN0SWQiPT09ZS5jb25zdHJ1Y3Rvci5uYW1lKXJldHVybntfX29iamVjdElkOnR9fWNhdGNoKG4pe31pZihlIGluc3RhbmNlb2YgZylyZXR1cm57X19vYmplY3RJZDplLnRvU3RyaW5nKCl9O2lmKGUgaW5zdGFuY2VvZiBEYXRlKXJldHVybntfX2RhdGU6ZS50b0lTT1N0cmluZygpfTtpZigib2JqZWN0Ij09dHlwZW9mIGUpe2lmKHQuaGFzKGUpKXJldHVybjt0LmFkZChlKX1pZihBcnJheS5pc0FycmF5KGUpKXJldHVybiBlLm1hcChlPT5RdChlLHQpKTtpZigib2JqZWN0Ij09dHlwZW9mIGUpe2NvbnN0IG49e307Zm9yKGNvbnN0W3IsaV1vZiBPYmplY3QuZW50cmllcyhlKSluW3JdPVF0KGksdCk7cmV0dXJuIG59cmV0dXJuIGV9ZnVuY3Rpb24gSnQoZSl7aWYobnVsbD09ZSlyZXR1cm4gZTtpZigib2JqZWN0Ij09dHlwZW9mIGUmJmUuX19mdW5jdGlvbilyZXR1cm4ic3RyaW5nIj09dHlwZW9mIGUuX19mdW5jdGlvbj9gKCR7ZS5fX2Z1bmN0aW9ufSkuY2FsbCh0aGlzKWA6dm9pZCAwO2lmKCJvYmplY3QiPT10eXBlb2YgZSYmZS5fX29iamVjdElkKXJldHVybiBuZXcgZyhlLl9fb2JqZWN0SWQpO2lmKCJvYmplY3QiPT10eXBlb2YgZSYmZS5fX2RhdGUpcmV0dXJuIG5ldyBEYXRlKGUuX19kYXRlKTtpZihBcnJheS5pc0FycmF5KGUpKXJldHVybiBlLm1hcChKdCk7aWYoIm9iamVjdCI9PXR5cGVvZiBlKXtjb25zdCB0PXt9O2Zvcihjb25zdFtuLHJdb2YgT2JqZWN0LmVudHJpZXMoZSkpdFtuXT1KdChyKTtyZXR1cm4gdH1yZXR1cm4gZX1jb25zdCBLdD0idW5kZWZpbmVkIiE9dHlwZW9mIHByb2Nlc3MmJiEhcHJvY2Vzcy52ZXJzaW9ucz8ubm9kZTtsZXQgR3QsWXQ9bnVsbDthc3luYyBmdW5jdGlvbiBYdChlLHQpe2lmKCFlfHwicmVxdWVzdCIhPT1lLnR5cGUpcmV0dXJuO1l0JiZhd2FpdCBZdDtjb25zdHtpZDpuLHBheWxvYWQ6cn09ZSxpPUp0KHIpLHM9ZnVuY3Rpb24oZSl7cmV0dXJuIEd0fHwoR3Q9bmV3IFd0KHt9LGUpKSxHdH0odCk7dHJ5e2NvbnN0IGU9YXdhaXQgcy5kaXNwYXRjaChpKTt0KHt0eXBlOiJyZXNwb25zZSIsaWQ6bixzdWNjZXNzOiEwLHJlc3VsdDpRdChlKX0pfWNhdGNoKG8pe3Qoe3R5cGU6InJlc3BvbnNlIixpZDpuLHN1Y2Nlc3M6ITEsZXJyb3I6e25hbWU6bz8ubmFtZSxtZXNzYWdlOm8/Lm1lc3NhZ2Usc3RhY2s6bz8uc3RhY2ssY29kZTpvPy5jb2RlLCRlcnI6bz8uJGVycn19KX19S3QmJihZdD1Qcm9taXNlLnJlc29sdmUoKS50aGVuKCgpPT57Y29uc3QgZT1uZXcgRnVuY3Rpb24oInNwZWMiLCJyZXR1cm4gaW1wb3J0KHNwZWMpIik7cmV0dXJuIFByb21pc2UuYWxsKFtlKCJwYXRoIiksZSgidXJsIiksZSgibm9kZS1vcGZzIildKX0pLnRoZW4oKFtlLHQsbl0pPT57Y29uc3Qgcj1lLmRlZmF1bHQse2ZpbGVVUkxUb1BhdGg6aX09dCx7U3RvcmFnZU1hbmFnZXI6c309bixvPWkoaW1wb3J0Lm1ldGEudXJsKSxhPXIuZGlybmFtZShvKSxjPXIucmVzb2x2ZShhLCIuLiIpLGw9bmV3IHMoci5qb2luKGMsIi5vcGZzIikpLHU9e3N0b3JhZ2U6e2dldERpcmVjdG9yeTooKT0+bC5nZXREaXJlY3RvcnkoKX19O3ZvaWQgMD09PWdsb2JhbFRoaXMubmF2aWdhdG9yP2dsb2JhbFRoaXMubmF2aWdhdG9yPXU6Z2xvYmFsVGhpcy5uYXZpZ2F0b3Iuc3RvcmFnZT11LnN0b3JhZ2V9KS5jYXRjaCgoKT0+e30pKSxhc3luYyBmdW5jdGlvbigpe2lmKEt0KXtjb25zdHtwYXJlbnRQb3J0OmV9PWF3YWl0IGltcG9ydCgid29ya2VyX3RocmVhZHMiKSx0PXQ9PmUucG9zdE1lc3NhZ2UodCk7ZS5vbigibWVzc2FnZSIsZT0+WHQoZSx0KSl9ZWxzZXtjb25zdCBlPWU9PnNlbGYucG9zdE1lc3NhZ2UoZSk7c2VsZi5vbm1lc3NhZ2U9dD0+WHQodC5kYXRhLGUpfX0oKS5jYXRjaChlPT57Y29uc29sZS5lcnJvcigiV29ya2VyIGluaXRpYWxpemF0aW9uIGZhaWxlZDoiLGUpLCJ1bmRlZmluZWQiIT10eXBlb2YgcHJvY2Vzcz9wcm9jZXNzLmV4aXQoMSk6c2VsZi5wb3N0TWVzc2FnZSh7dHlwZToiZXJyb3IiLGVycm9yOmUubWVzc2FnZX0pfSk7Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPWJhYnltb25nby1zZXJ2ZXItd29ya2VyLmpzLm1hcAo=",import.meta.url))}const c=new b(Z,{workerData:l.workerData});return new fl(c)}sendRequest(l,b={}){const d=vl.start("ipc","serialize"),Z=this._nextId++,c=Tl(l);vl.end(d);const i={type:"request",id:Z,payload:c};return new Promise((l,d)=>{let c;b.timeout&&(c=setTimeout(()=>{this._pending.delete(Z),d(new Error(`Worker request timed out after ${b.timeout}ms`))},b.timeout));const m=vl.start("ipc","roundtrip",{requestId:Z}),G=l,X=d;l=l=>{vl.end(m),G(l)},d=l=>{vl.end(m),X(l)},this._pending.set(Z,{resolve:l,reject:d,timeoutHandle:c}),this._post(i)})}async terminate(){this._terminating=!0;for(const[l,b]of this._pending.entries())clearTimeout(b.timeoutHandle);this._pending.clear(),await this._terminateImpl()}_handleMessage(l){const b=l?.data??l;if(b){if("response"===b.type){const l=this._pending.get(b.id);if(!l)return;if(this._pending.delete(b.id),clearTimeout(l.timeoutHandle),b.success){const d=vl.start("ipc","deserialize"),Z=Ul(b.result);vl.end(d),l.resolve(Z)}else{const d=new Error(b.error?.message||"Worker error");b.error?.name&&(d.name=b.error.name),b.error?.stack&&(d.stack=b.error.stack),b.error?.code&&(d.code=b.error.code),b.error?.$err&&(d.$err=b.error.$err),l.reject(d)}return}if("event"===b.type){const l=Ul(b.payload);this.emit("event",b.event,l)}}}_handleError(l){if(!this._terminating){for(const[b,d]of this._pending.entries())clearTimeout(d.timeoutHandle),d.reject(l);this._pending.clear(),this.emit("error",l)}}_attach(){throw new Error("Not implemented")}_post(){throw new Error("Not implemented")}_terminateImpl(){throw new Error("Not implemented")}}class Ql extends Bl{constructor(l={}){const b=globalThis.Worker;if(!b)throw new Error("Worker API is not available in this environment");super(new b(l.workerUrl||"/build/babymongo-server-worker.js",{type:"module"}))}_attach(){this.worker.onmessage=this._handleMessage,this.worker.onerror=this._handleError}_post(l){this.worker.postMessage(l)}_terminateImpl(){this.worker.terminate()}}class fl extends Bl{constructor(l){super(l)}_attach(){this.worker.on("message",this._handleMessage),this.worker.on("error",this._handleError),this.worker.on("exit",l=>{0===l||this._terminating||this._handleError(new Error(`Worker stopped with exit code ${l}`))})}_post(l){this.worker.postMessage(l)}_terminateImpl(){return this.worker.terminate()}}export{K as BadValueError,R as BulkWriteError,a as CannotCreateIndexError,zl as ChangeStream,V as CursorError,y as CursorNotFoundError,X as DuplicateKeyError,Z as ErrorCodes,u as IndexError,n as IndexExistsError,W as IndexNotFoundError,s as InvalidNamespaceError,N as MongoClient,m as MongoDriverError,c as MongoError,r as MongoNetworkError,i as MongoServerError,h as NamespaceError,o as NamespaceNotFoundError,I as NotImplementedError,L as ObjectId,Y as OperationNotSupportedError,Fl as PerformanceTimer,e as QueryError,p as TypeMismatchError,t as ValidationError,Bl as WorkerBridge,G as WriteError,vl as globalTimer};
//# sourceMappingURL=babymongo-browser.min.js.map

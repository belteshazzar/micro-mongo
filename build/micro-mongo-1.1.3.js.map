{"version":3,"file":"micro-mongo-1.1.3.js","sources":["../src/ObjectId.js","../src/utils.js","../src/Cursor.js","../src/SortedCursor.js","../node_modules/stemmer/index.js","../src/TextIndex.js","../src/queryMatcher.js","../src/updates.js","../src/CollectionIndex.js","../src/RegularCollectionIndex.js","../src/TextCollectionIndex.js","../src/RTree.js","../src/GeospatialCollectionIndex.js","../src/Collection.js","../src/StorageEngine.js","../src/ObjectStorageEngine.js","../src/DB.js","../src/MongoClient.js","../src/IndexedDbStorageEngine.js","../main.js"],"sourcesContent":["/**\r\n * ObjectId class - MongoDB-compatible 24-character hex string identifier\r\n * Format: 8-char timestamp + 16-char random data\r\n */\r\nexport class ObjectId {\r\n  constructor(id) {\r\n    if (id === undefined || id === null) {\r\n      // Generate new ObjectId\r\n      this.id = ObjectId.generate();\r\n    } else if (typeof id === 'string') {\r\n      // Create from hex string\r\n      if (!ObjectId.isValid(id)) {\r\n        throw new Error(`Argument passed in must be a string of 24 hex characters, got: ${id}`);\r\n      }\r\n      this.id = id.toLowerCase();\r\n    } else if (id instanceof ObjectId) {\r\n      // Copy constructor\r\n      this.id = id.id;\r\n    } else {\r\n      throw new Error(`Argument passed in must be a string of 24 hex characters or an ObjectId`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Returns the ObjectId as a 24-character hex string\r\n   */\r\n  toString() {\r\n    return this.id;\r\n  }\r\n\r\n  /**\r\n   * Returns the ObjectId as a 24-character hex string (alias for toString)\r\n   */\r\n  toHexString() {\r\n    return this.id;\r\n  }\r\n\r\n  /**\r\n   * Returns the timestamp portion of the ObjectId as a Date\r\n   */\r\n  getTimestamp() {\r\n    const timestamp = parseInt(this.id.substring(0, 8), 16);\r\n    return new Date(timestamp * 1000);\r\n  }\r\n\r\n  /**\r\n   * Compares this ObjectId with another for equality\r\n   */\r\n  equals(other) {\r\n    if (!other) return false;\r\n    \r\n    if (other instanceof ObjectId) {\r\n      return this.id === other.id;\r\n    }\r\n    \r\n    if (typeof other === 'string') {\r\n      return this.id === other.toLowerCase();\r\n    }\r\n    \r\n    // Handle objects with id property\r\n    if (other.id) {\r\n      return this.id === other.id;\r\n    }\r\n    \r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Returns the ObjectId in JSON format (as hex string)\r\n   */\r\n  toJSON() {\r\n    return this.id;\r\n  }\r\n\r\n  /**\r\n   * Custom inspect for Node.js console.log\r\n   */\r\n  inspect() {\r\n    return `ObjectId(\"${this.id}\")`;\r\n  }\r\n\r\n  /**\r\n   * Validates if a string is a valid ObjectId hex string\r\n   */\r\n  static isValid(id) {\r\n    if (!id) return false;\r\n    if (typeof id !== 'string') return false;\r\n    if (id.length !== 24) return false;\r\n    return /^[0-9a-fA-F]{24}$/.test(id);\r\n  }\r\n\r\n  /**\r\n   * Creates an ObjectId from a timestamp\r\n   */\r\n  static createFromTime(timestamp) {\r\n    const ts = Math.floor(timestamp / 1000);\r\n    const tsHex = ('00000000' + ts.toString(16)).slice(-8);\r\n    const tail = '0000000000000000'; // Zero out the random portion\r\n    return new ObjectId(tsHex + tail);\r\n  }\r\n\r\n  /**\r\n   * Generates a new ObjectId hex string\r\n   * Format: 8-char timestamp (4 bytes) + 16-char random data (8 bytes)\r\n   */\r\n  static generate() {\r\n    const ts = Math.floor(Date.now() / 1000);\r\n    \r\n    // Generate 8 random bytes\r\n    const rand = typeof crypto !== 'undefined' && crypto.getRandomValues ? new Uint8Array(8) : null;\r\n    let tail = '';\r\n    \r\n    if (rand) {\r\n      crypto.getRandomValues(rand);\r\n      for (let i = 0; i < rand.length; i++) {\r\n        tail += ('0' + rand[i].toString(16)).slice(-2);\r\n      }\r\n    } else {\r\n      // Fallback for environments without crypto\r\n      // Generate two 8-character hex strings\r\n      tail = Math.random().toString(16).slice(2).padEnd(8, '0').slice(0, 8) +\r\n             Math.random().toString(16).slice(2).padEnd(8, '0').slice(0, 8);\r\n    }\r\n    \r\n    const tsHex = ('00000000' + ts.toString(16)).slice(-8);\r\n    return (tsHex + tail).slice(0, 24);\r\n  }\r\n}","/**\n * Utility functions for MicroMongoDB\n */\n\nimport { ObjectId } from './ObjectId.js';\n\n/**\n * Compare two values for equality, handling ObjectId instances\n */\nfunction valuesEqual(a, b) {\n\t// Handle ObjectId comparison\n\tif (a instanceof ObjectId || b instanceof ObjectId) {\n\t\tif (a instanceof ObjectId && b instanceof ObjectId) {\n\t\t\treturn a.equals(b);\n\t\t}\n\t\tif (a instanceof ObjectId && typeof b === 'string') {\n\t\t\treturn a.equals(b);\n\t\t}\n\t\tif (b instanceof ObjectId && typeof a === 'string') {\n\t\t\treturn b.equals(a);\n\t\t}\n\t\treturn false;\n\t}\n\t\n\t// Regular equality\n\treturn a == b;\n}\n\n/**\n * Deep copy an object or array\n */\nexport function copy(o) {\n\t// Handle ObjectId\n\tif (o instanceof ObjectId) {\n\t\treturn new ObjectId(o.id);\n\t}\n\t\n\tvar out, v, key;\n\tout = Array.isArray(o) ? [] : {};\n\tfor (key in o) {\n\t\tv = o[key];\n\t\tout[key] = (typeof v === \"object\" && v !== null) ? copy(v) : v;\n\t}\n\treturn out;\n}\n\n/**\n * Get a property from an object using dot notation\n */\nexport function getProp(obj, name) {\n\tvar path = name.split(\".\");\n\tvar result = obj[path[0]];\n\tfor (var i = 1; i < path.length; i++) {\n\t\tif (result == undefined || result == null) return result;\n\t\tresult = result[path[i]];\n\t}\n\treturn result;\n}\n\n/**\n * Check if value is an array\n */\nexport function isArray(o) {\n\treturn Array == o.constructor;\n}\n\n/**\n * Convert object to array of key-value pairs\n */\nexport function toArray(obj) {\n\tvar arr = [];\n\tfor (var key in obj) {\n\t\tif (obj.hasOwnProperty(key)) {\n\t\t\tvar el = {};\n\t\t\tel[key] = obj[key];\n\t\t\tarr.push(el);\n\t\t}\n\t}\n\treturn arr;\n}\n\n/**\n * Check if a value is in an array\n */\nexport function isIn(val, values) {\n\tfor (var i = 0; i < values.length; i++) {\n\t\tif (valuesEqual(values[i], val)) return true;\n\t}\n\treturn false;\n}\n\n/**\n * Check if two arrays match\n */\nexport function arrayMatches(x, y) {\n\tif (x.length != y.length) return false;\n\tfor (var i = 0; i < x.length; i++) {\n\t\tif (valuesEqual(x[i], y[i])) continue;\n\t\tif (typeof (x[i]) != typeof (y[i])) return false;\n\t\tif (typeof (x[i]) == \"object\" && x[i] !== null) {\n\t\t\tif (isArray(x[i])) {\n\t\t\t\tif (!arrayMatches(x[i], y[i])) return false;\n\t\t\t} else {\n\t\t\t\tif (!objectMatches(x[i], y[i])) return false;\n\t\t\t}\n\t\t} else {\n\t\t\tif (!valuesEqual(x[i], y[i])) return false;\n\t\t}\n\t}\n\treturn true;\n}\n\n/**\n * Check if two objects match\n */\nexport function objectMatches(x, y) {\n\tfor (var p in x) {\n\t\tif (!x.hasOwnProperty(p)) continue;\n\t\tif (!y.hasOwnProperty(p)) return false;\n\t\tif (valuesEqual(x[p], y[p])) continue;\n\t\tif (typeof (x[p]) != typeof (y[p])) return false;\n\t\tif (typeof (x[p]) == \"object\" && x[p] !== null) {\n\t\t\tif (isArray(x[p])) {\n\t\t\t\tif (!arrayMatches(x[p], y[p])) return false;\n\t\t\t} else {\n\t\t\t\tif (!objectMatches(x[p], y[p])) return false;\n\t\t\t}\n\t\t} else {\n\t\t\tif (!valuesEqual(x[p], y[p])) return false;\n\t\t}\n\t}\n\tfor (var p in y) {\n\t\tif (y.hasOwnProperty(p) && !x.hasOwnProperty(p)) return false;\n\t}\n\treturn true;\n}\n\n/**\n * Apply projection to a document\n */\nexport function applyProjection(projection, doc) {\n\tvar result = {};\n\tvar keys = Object.keys(projection);\n\tif (keys.length == 0) return doc;\n\t\n\t// Check for mixed inclusion/exclusion (except _id which can be excluded in inclusion projection)\n\tvar hasInclusion = false;\n\tvar hasExclusion = false;\n\tfor (var i = 0; i < keys.length; i++) {\n\t\tif (keys[i] === '_id') continue; // _id is special\n\t\tif (projection[keys[i]]) hasInclusion = true;\n\t\telse hasExclusion = true;\n\t}\n\t\n\tif (hasInclusion && hasExclusion) {\n\t\tthrow { $err: \"Can't canonicalize query: BadValue Projection cannot have a mix of inclusion and exclusion.\", code: 17287 };\n\t}\n\t\n\tif (projection[keys[0]] || hasInclusion) {\n\t\t// inclusion with _id (unless explicitly excluded)\n\t\tif (projection._id !== 0) {\n\t\t\tresult._id = doc._id;\n\t\t}\n\t\tfor (var i = 0; i < keys.length; i++) {\n\t\t\tif (keys[i] === '_id') continue;\n\t\t\tif (!projection[keys[i]]) continue;\n\t\t\tresult[keys[i]] = doc[keys[i]];\n\t\t}\n\t} else {\n\t\t// exclusion\n\t\tfor (var key in doc) {\n\t\t\tresult[key] = doc[key];\n\t\t}\n\t\tfor (var i = 0; i < keys.length; i++) {\n\t\t\tif (projection[keys[i]]) continue;\n\t\t\tdelete result[keys[i]];\n\t\t}\n\t}\n\treturn result;\n}\n\n/**\n * Convert bbox to GeoJSON\n */\nexport function bboxToGeojson(bbox) {\n\tconst minLon = bbox[0][0];\n\tconst maxLat = bbox[0][1];\n\tconst maxLon = bbox[1][0];\n\tconst minLat = bbox[1][1];\n\treturn {\n\t\ttype: 'FeatureCollection',\n\t\tfeatures: [{\n\t\t\ttype: 'Feature',\n\t\t\tproperties: {},\n\t\t\tgeometry: {\n\t\t\t\ttype: 'Polygon',\n\t\t\t\tcoordinates: [[\n\t\t\t\t\t[minLon, maxLat],\n\t\t\t\t\t[minLon, minLat],\n\t\t\t\t\t[maxLon, minLat],\n\t\t\t\t\t[maxLon, maxLat],\n\t\t\t\t\t[minLon, maxLat]\n\t\t\t\t]]\n\t\t\t}\n\t\t}]\n\t};\n}\n","import { applyProjection } from './utils.js';\n\n/**\n * Cursor class for iterating over query results\n */\nexport class Cursor {\n\tconstructor(collection, query, projection, matches, storage, indexes, planQuery, SortedCursor) {\n\t\tthis.collection = collection;\n\t\tthis.query = query;\n\t\tthis.projection = projection;\n\t\tthis.matches = matches;\n\t\tthis.storage = storage;\n\t\tthis.indexes = indexes;\n\t\tthis.planQuery = planQuery;\n\t\tthis.SortedCursor = SortedCursor;\n\t\t\n\t\t// Validate projection if provided\n\t\tif (projection && Object.keys(projection).length > 0) {\n\t\t\tconst keys = Object.keys(projection);\n\t\t\tlet hasInclusion = false;\n\t\t\tlet hasExclusion = false;\n\t\t\tfor (let i = 0; i < keys.length; i++) {\n\t\t\t\tif (keys[i] === '_id') continue; // _id is special\n\t\t\t\tif (projection[keys[i]]) hasInclusion = true;\n\t\t\t\telse hasExclusion = true;\n\t\t\t}\n\t\t\t\n\t\t\tif (hasInclusion && hasExclusion) {\n\t\t\t\tthrow { $err: \"Can't canonicalize query: BadValue Projection cannot have a mix of inclusion and exclusion.\", code: 17287 };\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.pos = 0;\n\t\tthis.max = 0;\n\t\tthis._next = false; // false == unknown, null == no more, !null == next\n\t\t\n\t\t// Query planning - check if we can use an index\n\t\tconst queryPlan = this.planQuery(this.query);\n\t\tthis.indexDocIds = null;\n\t\tthis.indexPos = 0;\n\t\tthis.fullScanDocIds = {}; // Track which docs we've seen to avoid duplicates\n\n\t\t// If using index, get the document IDs from the index\n\t\tif (queryPlan && queryPlan.useIndex) {\n\t\t\tthis.indexDocIds = queryPlan.docIds ? queryPlan.docIds.slice() : [];\n\t\t}\n\t\t\n\t\t// Initialize by finding first document\n\t\tthis._findNext();\n\t}\n\n\t_findNext() {\n\t\t// First, try to get documents from index\n\t\twhile (this.indexDocIds !== null && this.indexPos < this.indexDocIds.length) {\n\t\t\tconst docId = this.indexDocIds[this.indexPos++];\n\t\t\tconst doc = this.storage.getStore()[docId];\n\t\t\tif (doc && this.matches(doc, this.query)) {\n\t\t\t\tthis.fullScanDocIds[doc._id] = true;\n\t\t\t\tthis._next = doc;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// If doc doesn't match (shouldn't happen with good index), continue to next\n\t\t}\n\n\t\t// Then fall back to full scan for remaining documents\n\t\t// This handles complex queries where index only partially matches\n\t\twhile (this.pos < this.storage.size() && (this.max == 0 || this.pos < this.max)) {\n\t\t\tconst cur = this.storage.get(this.pos++);\n\t\t\t// Skip docs we already returned from index\n\t\t\tif (cur && !this.fullScanDocIds[cur._id] && this.matches(cur, this.query)) {\n\t\t\t\tthis.fullScanDocIds[cur._id] = true;\n\t\t\t\tthis._next = cur;\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tthis._next = null;\n\t}\n\n\tbatchSize() { throw \"Not Implemented\"; }\n\tclose() { throw \"Not Implemented\"; }\n\tcomment() { throw \"Not Implemented\"; }\n\t\n\tcount() {\n\t\tlet num = 0;\n\t\tconst c = new Cursor(this.collection, this.query, null, this.matches, this.storage, this.indexes, this.planQuery, this.SortedCursor);\n\t\twhile (c.hasNext()) {\n\t\t\tnum++;\n\t\t\tc.next();\n\t\t}\n\t\treturn num;\n\t}\n\t\n\texplain() { throw \"Not Implemented\"; }\n\t\n\tasync forEach(fn) {\n\t\twhile (this.hasNext()) {\n\t\t\tawait fn(this.next());\n\t\t}\n\t}\n\t\n\thasNext() {\n\t\tif (this._next === false) this._findNext();\n\t\treturn this._next != null;\n\t}\n\t\n\thint() { throw \"Not Implemented\"; }\n\titcount() { throw \"Not Implemented\"; }\n\t\n\tlimit(_max) {\n\t\tthis.max = _max;\n\t\treturn this;\n\t}\n\t\n\tmap(fn) {\n\t\tconst results = [];\n\t\twhile (this.hasNext()) {\n\t\t\tresults.push(fn(this.next()));\n\t\t}\n\t\treturn results;\n\t}\n\t\n\tmaxScan() { throw \"Not Implemented\"; }\n\tmaxTimeMS() { throw \"Not Implemented\"; }\n\tmax() { throw \"Not Implemented\"; }\n\tmin() { throw \"Not Implemented\"; }\n\t\n\tnext() {\n\t\tif (this._next == null) throw \"Error: error hasNext: false\";\n\t\tconst result = this._next;\n\t\tthis._findNext();\n\t\tif (this.projection) return applyProjection(this.projection, result);\n\t\telse return result;\n\t}\n\t\n\tnoCursorTimeout() { throw \"Not Implemented\"; }\n\tobjsLeftInBatch() { throw \"Not Implemented\"; }\n\tpretty() { throw \"Not Implemented\"; }\n\treadConcern() { throw \"Not Implemented\"; }\n\treadPref() { throw \"Not Implemented\"; }\n\treturnKey() { throw \"Not Implemented\"; }\n\tshowRecordId() { throw \"Not Implemented\"; }\n\tsize() { throw \"Not Implemented\"; }\n\t\n\tskip(num) {\n\t\twhile (num > 0) {\n\t\t\tthis.next();\n\t\t\tnum--;\n\t\t}\n\t\treturn this;\n\t}\n\t\n\tsnapshot() { throw \"Not Implemented\"; }\n\t\n\tsort(s) {\n\t\treturn new this.SortedCursor(this.collection, this.query, this, s);\n\t}\n\t\n\ttailable() { throw \"Not Implemented\"; }\n\t\n\tasync toArray() {\n\t\tconst results = [];\n\t\twhile (this.hasNext()) {\n\t\t\tresults.push(this.next());\n\t\t}\n\t\treturn results;\n\t}\n\t\n\t// Support for async iteration (for await...of)\n\tasync *[Symbol.asyncIterator]() {\n\t\twhile (this.hasNext()) {\n\t\t\tyield this.next();\n\t\t}\n\t}\n}\n","/**\n * SortedCursor class for iterating over sorted query results\n */\nexport class SortedCursor {\n\tconstructor(collection, query, cursor, sort) {\n\t\tthis.collection = collection;\n\t\tthis.query = query;\n\t\tthis.sortSpec = sort;\n\t\tthis.pos = 0;\n\t\tthis.items = [];\n\t\t\n\t\t// Collect all items from the cursor\n\t\twhile (cursor.hasNext()) {\n\t\t\tthis.items.push(cursor.next());\n\t\t}\n\t\t\n\t\t// Sort the items\n\t\tconst sortKeys = Object.keys(sort);\n\t\tthis.items.sort(function(a, b) {\n\t\t\tfor (let i = 0; i < sortKeys.length; i++) {\n\t\t\t\tif (a[sortKeys[i]] == undefined && b[sortKeys[i]] != undefined) return -1 * sort[sortKeys[i]];\n\t\t\t\tif (a[sortKeys[i]] != undefined && b[sortKeys[i]] == undefined) return 1 * sort[sortKeys[i]];\n\t\t\t\tif (a[sortKeys[i]] < b[sortKeys[i]]) return -1 * sort[sortKeys[i]];\n\t\t\t\tif (a[sortKeys[i]] > b[sortKeys[i]]) return 1 * sort[sortKeys[i]];\n\t\t\t}\n\t\t\treturn 0;\n\t\t});\n\t}\n\n\tbatchSize() { throw \"Not Implemented\"; }\n\tclose() { throw \"Not Implemented\"; }\n\tcomment() { throw \"Not Implemented\"; }\n\t\n\tcount() {\n\t\treturn this.items.length;\n\t}\n\t\n\texplain() { throw \"Not Implemented\"; }\n\t\n\tasync forEach(fn) {\n\t\twhile (this.hasNext()) {\n\t\t\tawait fn(this.next());\n\t\t}\n\t}\n\t\n\thasNext() {\n\t\treturn this.pos < this.items.length;\n\t}\n\t\n\thint() { throw \"Not Implemented\"; }\n\titcount() { throw \"Not Implemented\"; }\n\t\n\tlimit(max) {\n\t\tthis.items = this.items.slice(0, max);\n\t\treturn this;\n\t}\n\t\n\tmap(fn) {\n\t\tconst results = [];\n\t\twhile (this.hasNext()) {\n\t\t\tresults.push(fn(this.next()));\n\t\t}\n\t\treturn results;\n\t}\n\t\n\tmaxScan() { throw \"Not Implemented\"; }\n\tmaxTimeMS() { throw \"Not Implemented\"; }\n\tmax() { throw \"Not Implemented\"; }\n\tmin() { throw \"Not Implemented\"; }\n\t\n\tnext() {\n\t\treturn this.items[this.pos++];\n\t}\n\t\n\tnoCursorTimeout() { throw \"Not Implemented\"; }\n\tobjsLeftInBatch() { throw \"Not Implemented\"; }\n\tpretty() { throw \"Not Implemented\"; }\n\treadConcern() { throw \"Not Implemented\"; }\n\treadPref() { throw \"Not Implemented\"; }\n\treturnKey() { throw \"Not Implemented\"; }\n\tshowRecordId() { throw \"Not Implemented\"; }\n\tsize() { throw \"Not Implemented\"; }\n\t\n\tskip(num) {\n\t\twhile (num > 0) {\n\t\t\tthis.next();\n\t\t\tnum--;\n\t\t}\n\t\treturn this;\n\t}\n\t\n\tsnapshot() { throw \"Not Implemented\"; }\n\t\n\tsort(s) {\n\t\treturn new SortedCursor(this.collection, this.query, this, s);\n\t}\n\t\n\ttailable() { throw \"Not Implemented\"; }\n\t\n\tasync toArray() {\n\t\tconst results = [];\n\t\twhile (this.hasNext()) {\n\t\t\tresults.push(this.next());\n\t\t}\n\t\treturn results;\n\t}\n\t\n\t// Support for async iteration (for await...of)\n\tasync *[Symbol.asyncIterator]() {\n\t\twhile (this.hasNext()) {\n\t\t\tyield this.next();\n\t\t}\n\t}\n}\n","// Standard suffix manipulations.\n/** @type {Record<string, string>} */\nconst step2list = {\n  ational: 'ate',\n  tional: 'tion',\n  enci: 'ence',\n  anci: 'ance',\n  izer: 'ize',\n  bli: 'ble',\n  alli: 'al',\n  entli: 'ent',\n  eli: 'e',\n  ousli: 'ous',\n  ization: 'ize',\n  ation: 'ate',\n  ator: 'ate',\n  alism: 'al',\n  iveness: 'ive',\n  fulness: 'ful',\n  ousness: 'ous',\n  aliti: 'al',\n  iviti: 'ive',\n  biliti: 'ble',\n  logi: 'log'\n}\n\n/** @type {Record<string, string>} */\nconst step3list = {\n  icate: 'ic',\n  ative: '',\n  alize: 'al',\n  iciti: 'ic',\n  ical: 'ic',\n  ful: '',\n  ness: ''\n}\n\n// Consonant-vowel sequences.\nconst consonant = '[^aeiou]'\nconst vowel = '[aeiouy]'\nconst consonants = '(' + consonant + '[^aeiouy]*)'\nconst vowels = '(' + vowel + '[aeiou]*)'\n\nconst gt0 = new RegExp('^' + consonants + '?' + vowels + consonants)\nconst eq1 = new RegExp(\n  '^' + consonants + '?' + vowels + consonants + vowels + '?$'\n)\nconst gt1 = new RegExp('^' + consonants + '?(' + vowels + consonants + '){2,}')\nconst vowelInStem = new RegExp('^' + consonants + '?' + vowel)\nconst consonantLike = new RegExp('^' + consonants + vowel + '[^aeiouwxy]$')\n\n// Exception expressions.\nconst sfxLl = /ll$/\nconst sfxE = /^(.+?)e$/\nconst sfxY = /^(.+?)y$/\nconst sfxIon = /^(.+?(s|t))(ion)$/\nconst sfxEdOrIng = /^(.+?)(ed|ing)$/\nconst sfxAtOrBlOrIz = /(at|bl|iz)$/\nconst sfxEED = /^(.+?)eed$/\nconst sfxS = /^.+?[^s]s$/\nconst sfxSsesOrIes = /^.+?(ss|i)es$/\nconst sfxMultiConsonantLike = /([^aeiouylsz])\\1$/\nconst step2 =\n  /^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/\nconst step3 = /^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/\nconst step4 =\n  /^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/\n\n/**\n * Get the stem from a given value.\n *\n * @param {string} value\n *   Value to stem.\n * @returns {string}\n *   Stem for `value`\n */\n// eslint-disable-next-line complexity\nexport function stemmer(value) {\n  let result = String(value).toLowerCase()\n\n  // Exit early.\n  if (result.length < 3) {\n    return result\n  }\n\n  /** @type {boolean} */\n  let firstCharacterWasLowerCaseY = false\n\n  // Detect initial `y`, make sure it never matches.\n  if (\n    result.codePointAt(0) === 121 // Lowercase Y\n  ) {\n    firstCharacterWasLowerCaseY = true\n    result = 'Y' + result.slice(1)\n  }\n\n  // Step 1a.\n  if (sfxSsesOrIes.test(result)) {\n    // Remove last two characters.\n    result = result.slice(0, -2)\n  } else if (sfxS.test(result)) {\n    // Remove last character.\n    result = result.slice(0, -1)\n  }\n\n  /** @type {RegExpMatchArray|null} */\n  let match\n\n  // Step 1b.\n  if ((match = sfxEED.exec(result))) {\n    if (gt0.test(match[1])) {\n      // Remove last character.\n      result = result.slice(0, -1)\n    }\n  } else if ((match = sfxEdOrIng.exec(result)) && vowelInStem.test(match[1])) {\n    result = match[1]\n\n    if (sfxAtOrBlOrIz.test(result)) {\n      // Append `e`.\n      result += 'e'\n    } else if (sfxMultiConsonantLike.test(result)) {\n      // Remove last character.\n      result = result.slice(0, -1)\n    } else if (consonantLike.test(result)) {\n      // Append `e`.\n      result += 'e'\n    }\n  }\n\n  // Step 1c.\n  if ((match = sfxY.exec(result)) && vowelInStem.test(match[1])) {\n    // Remove suffixing `y` and append `i`.\n    result = match[1] + 'i'\n  }\n\n  // Step 2.\n  if ((match = step2.exec(result)) && gt0.test(match[1])) {\n    result = match[1] + step2list[match[2]]\n  }\n\n  // Step 3.\n  if ((match = step3.exec(result)) && gt0.test(match[1])) {\n    result = match[1] + step3list[match[2]]\n  }\n\n  // Step 4.\n  if ((match = step4.exec(result))) {\n    if (gt1.test(match[1])) {\n      result = match[1]\n    }\n  } else if ((match = sfxIon.exec(result)) && gt1.test(match[1])) {\n    result = match[1]\n  }\n\n  // Step 5.\n  if (\n    (match = sfxE.exec(result)) &&\n    (gt1.test(match[1]) ||\n      (eq1.test(match[1]) && !consonantLike.test(match[1])))\n  ) {\n    result = match[1]\n  }\n\n  if (sfxLl.test(result) && gt1.test(result)) {\n    result = result.slice(0, -1)\n  }\n\n  // Turn initial `Y` back to `y`.\n  if (firstCharacterWasLowerCaseY) {\n    result = 'y' + result.slice(1)\n  }\n\n  return result\n}\n","import { stemmer } from 'stemmer';\n\n// Common English stop words that don't add semantic value to searches\nconst STOPWORDS = new Set([\n  'a', 'about', 'after', 'all', 'also', 'am', 'an', 'and', 'another', 'any', 'are', \n  'around', 'as', 'at', 'be', 'because', 'been', 'before', 'being', 'between', 'both', \n  'but', 'by', 'came', 'can', 'come', 'could', 'did', 'do', 'each', 'for', 'from', \n  'get', 'got', 'has', 'had', 'he', 'have', 'her', 'here', 'him', 'himself', 'his', \n  'how', 'i', 'if', 'in', 'into', 'is', 'it', 'like', 'make', 'many', 'me', 'might', \n  'more', 'most', 'much', 'must', 'my', 'never', 'now', 'of', 'on', 'only', 'or', \n  'other', 'our', 'out', 'over', 'said', 'same', 'see', 'should', 'since', 'some', \n  'still', 'such', 'take', 'than', 'that', 'the', 'their', 'them', 'then', 'there', \n  'these', 'they', 'this', 'those', 'through', 'to', 'too', 'under', 'up', 'very', \n  'was', 'way', 'we', 'well', 'were', 'what', 'where', 'which', 'while', 'who', \n  'with', 'would', 'you', 'your'\n]);\n\n/**\n * TextIndex - A text index implementation using Porter stemmer algorithm\n * \n * This class provides full-text search capabilities by indexing terms\n * and associating them with document IDs. It uses the Porter stemmer\n * algorithm to normalize words to their root forms.\n */\nexport class TextIndex {\n  constructor(options = {}) {\n    // Map from stemmed term to Map of document IDs to term frequency\n    // Structure: term -> { docId: frequency }\n    this.index = new Map();\n    // Map from document ID to Map of stemmed terms to their frequency\n    // Structure: docId -> { term: frequency }\n    this.documentTerms = new Map();\n    // Map from document ID to total term count (for normalization)\n    this.documentLengths = new Map();\n    // Stop words configuration\n    this.useStopWords = options.useStopWords !== false; // default: true\n    // Create a copy of STOPWORDS to avoid mutating the global set\n    this.stopWords = options.stopWords || new Set(STOPWORDS);\n  }\n\n  /**\n   * Tokenize text into individual words\n   * @param {string} text - The text to tokenize\n   * @returns {string[]} Array of words\n   */\n  _tokenize(text) {\n    if (typeof text !== 'string') {\n      return [];\n    }\n    // Split on non-word characters and filter out empty strings\n    const words = text.toLowerCase()\n      .split(/\\W+/)\n      .filter(word => word.length > 0);\n    \n    // Filter stop words if enabled\n    if (this.useStopWords) {\n      return words.filter(word => !this.stopWords.has(word));\n    }\n    \n    return words;\n  }\n\n  /**\n   * Add terms from text to the index for a given document ID\n   * @param {string} docId - The document identifier\n   * @param {string} text - The text content to index\n   */\n  add(docId, text) {\n    if (!docId) {\n      throw new Error('Document ID is required');\n    }\n\n    const words = this._tokenize(text);\n    const termFrequency = new Map();\n\n    // Count term frequencies\n    words.forEach(word => {\n      const stem = stemmer(word);\n      termFrequency.set(stem, (termFrequency.get(stem) || 0) + 1);\n    });\n\n    // Add to index\n    termFrequency.forEach((frequency, stem) => {\n      if (!this.index.has(stem)) {\n        this.index.set(stem, new Map());\n      }\n      this.index.get(stem).set(docId, frequency);\n    });\n\n    // Track document terms and frequencies\n    this.documentTerms.set(docId, termFrequency);\n    this.documentLengths.set(docId, words.length);\n  }\n\n  /**\n   * Remove all indexed terms for a given document ID\n   * @param {string} docId - The document identifier to remove\n   * @returns {boolean} True if document was found and removed, false otherwise\n   */\n  remove(docId) {\n    if (!this.documentTerms.has(docId)) {\n      return false;\n    }\n\n    // Get all terms associated with this document\n    const terms = this.documentTerms.get(docId);\n\n    // Remove document ID from each term's posting list\n    terms.forEach((frequency, term) => {\n      if (this.index.has(term)) {\n        this.index.get(term).delete(docId);\n        // Clean up empty term entries\n        if (this.index.get(term).size === 0) {\n          this.index.delete(term);\n        }\n      }\n    });\n\n    // Remove document from tracking\n    this.documentTerms.delete(docId);\n    this.documentLengths.delete(docId);\n    return true;\n  }\n\n  /**\n   * Query the index for documents containing the given terms with relevance scoring\n   * @param {string} queryText - The search query text\n   * @param {Object} options - Query options\n   * @param {boolean} options.scored - If true, return scored results; if false, return just IDs (default: true)\n   * @param {boolean} options.requireAll - If true, require ALL terms; if false, rank by relevance (default: false)\n   * @returns {Array} Array of document IDs (if scored=false) or objects with {id, score} (if scored=true)\n   */\n  query(queryText, options = { scored: true, requireAll: false }) {\n    const words = this._tokenize(queryText);\n    if (words.length === 0) {\n      return [];\n    }\n\n    // Get stemmed versions of query terms\n    const stemmedTerms = words.map(word => stemmer(word));\n    const uniqueTerms = [...new Set(stemmedTerms)];\n\n    if (options.requireAll) {\n      // Strict AND logic - document must contain ALL terms\n      const docSets = uniqueTerms.map(term => {\n        const termDocs = this.index.get(term);\n        return termDocs ? new Set(termDocs.keys()) : new Set();\n      });\n\n      if (docSets.length === 0) {\n        return [];\n      }\n\n      // Compute intersection of all document sets\n      const intersection = new Set(docSets[0]);\n      for (let i = 1; i < docSets.length; i++) {\n        for (const docId of intersection) {\n          if (!docSets[i].has(docId)) {\n            intersection.delete(docId);\n          }\n        }\n      }\n\n      return Array.from(intersection);\n    }\n\n    // Relevance-based scoring (OR logic with ranking)\n    // Calculate IDF (Inverse Document Frequency) for each term\n    const totalDocs = this.documentLengths.size;\n    const idf = new Map();\n    \n    uniqueTerms.forEach(term => {\n      const docsWithTerm = this.index.get(term)?.size || 0;\n      if (docsWithTerm > 0) {\n        // IDF = log(totalDocs / docsWithTerm)\n        idf.set(term, Math.log(totalDocs / docsWithTerm));\n      }\n    });\n\n    // Collect all documents that contain at least one query term\n    const docScores = new Map();\n\n    uniqueTerms.forEach(term => {\n      const termDocs = this.index.get(term);\n      if (!termDocs) return;\n\n      termDocs.forEach((termFreq, docId) => {\n        if (!docScores.has(docId)) {\n          docScores.set(docId, 0);\n        }\n\n        // Calculate TF-IDF score\n        // TF = term frequency in document / total terms in document\n        const docLength = this.documentLengths.get(docId) || 1;\n        const tf = termFreq / docLength;\n        \n        // Add to document's total score\n        const termIdf = idf.get(term) || 0;\n        const tfIdf = tf * termIdf;\n        \n        docScores.set(docId, docScores.get(docId) + tfIdf);\n      });\n    });\n\n    // Bonus for documents containing multiple query terms\n    docScores.forEach((score, docId) => {\n      const docTerms = this.documentTerms.get(docId);\n      if (docTerms) {\n        const matchingTerms = uniqueTerms.filter(term => docTerms.has(term)).length;\n        // Boost score based on term coverage (what % of query terms are present)\n        const coverage = matchingTerms / uniqueTerms.length;\n        docScores.set(docId, score * (1 + coverage));\n      }\n    });\n\n    // Sort by score (highest first)\n    const results = Array.from(docScores.entries())\n      .map(([id, score]) => ({ id, score }))\n      .sort((a, b) => b.score - a.score);\n\n    // Return based on options\n    if (options.scored === false) {\n      return results.map(r => r.id);\n    }\n    \n    return results;\n  }\n\n  /**\n   * Get the number of unique terms in the index\n   * @returns {number} Number of unique terms\n   */\n  getTermCount() {\n    return this.index.size;\n  }\n\n  /**\n   * Get the number of documents in the index\n   * @returns {number} Number of indexed documents\n   */\n  getDocumentCount() {\n    return this.documentTerms.size;\n  }\n\n  /**\n   * Clear all data from the index\n   */\n  clear() {\n    this.index.clear();\n    this.documentTerms.clear();\n    this.documentLengths.clear();\n  }\n\n  /**\n   * Add custom stop words\n   * @param {...string} words - Words to add to stop word list\n   * @returns {TextIndex} this for chaining\n   */\n  addStopWords(...words) {\n    words.forEach(word => this.stopWords.add(word.toLowerCase()));\n    return this;\n  }\n\n  /**\n   * Remove words from stop word list\n   * @param {...string} words - Words to remove from stop word list\n   * @returns {TextIndex} this for chaining\n   */\n  removeStopWords(...words) {\n    words.forEach(word => this.stopWords.delete(word.toLowerCase()));\n    return this;\n  }\n\n  /**\n   * Enable or disable stop word filtering\n   * @param {boolean} enabled - Whether to filter stop words\n   * @returns {TextIndex} this for chaining\n   */\n  setStopWordFiltering(enabled) {\n    this.useStopWords = enabled;\n    return this;\n  }\n\n  /**\n   * Serialize the text index state for storage\n   * @returns {Object} Serializable state\n   */\n  serialize() {\n    // Convert Maps to plain objects for JSON serialization\n    const indexObj = {};\n    this.index.forEach((docs, term) => {\n      const docsObj = {};\n      docs.forEach((freq, docId) => {\n        docsObj[docId] = freq;\n      });\n      indexObj[term] = docsObj;\n    });\n\n    const documentTermsObj = {};\n    this.documentTerms.forEach((terms, docId) => {\n      const termsObj = {};\n      terms.forEach((freq, term) => {\n        termsObj[term] = freq;\n      });\n      documentTermsObj[docId] = termsObj;\n    });\n\n    const documentLengthsObj = {};\n    this.documentLengths.forEach((length, docId) => {\n      documentLengthsObj[docId] = length;\n    });\n\n    return {\n      index: indexObj,\n      documentTerms: documentTermsObj,\n      documentLengths: documentLengthsObj,\n      useStopWords: this.useStopWords,\n      stopWords: Array.from(this.stopWords)\n    };\n  }\n\n  /**\n   * Restore the text index state from serialized data\n   * @param {Object} state - Serialized state\n   */\n  deserialize(state) {\n    // Restore index\n    this.index = new Map();\n    for (const term in state.index) {\n      const docs = new Map();\n      for (const docId in state.index[term]) {\n        docs.set(docId, state.index[term][docId]);\n      }\n      this.index.set(term, docs);\n    }\n\n    // Restore documentTerms\n    this.documentTerms = new Map();\n    for (const docId in state.documentTerms) {\n      const terms = new Map();\n      for (const term in state.documentTerms[docId]) {\n        terms.set(term, state.documentTerms[docId][term]);\n      }\n      this.documentTerms.set(docId, terms);\n    }\n\n    // Restore documentLengths\n    this.documentLengths = new Map();\n    for (const docId in state.documentLengths) {\n      this.documentLengths.set(docId, state.documentLengths[docId]);\n    }\n\n    // Restore settings\n    this.useStopWords = state.useStopWords !== false;\n    if (state.stopWords) {\n      this.stopWords = new Set(state.stopWords);\n    }\n  }\n}\n","import { getProp, isArray, arrayMatches, objectMatches, toArray, isIn, bboxToGeojson } from './utils.js';\nimport { TextIndex } from './TextIndex.js';\nimport { ObjectId } from './ObjectId.js';\n\n/**\n * Compare two values for equality, handling ObjectId instances\n */\nfunction valuesEqual(a, b) {\n\t// Handle ObjectId comparison\n\tif (a instanceof ObjectId || b instanceof ObjectId) {\n\t\tif (a instanceof ObjectId && b instanceof ObjectId) {\n\t\t\treturn a.equals(b);\n\t\t}\n\t\tif (a instanceof ObjectId && typeof b === 'string') {\n\t\t\treturn a.equals(b);\n\t\t}\n\t\tif (b instanceof ObjectId && typeof a === 'string') {\n\t\t\treturn b.equals(a);\n\t\t}\n\t\treturn false;\n\t}\n\t\n\t// Regular equality\n\treturn a == b;\n}\n\n/**\n * Compare two values with a comparison operator, handling ObjectId instances\n */\nfunction compareValues(a, b, operator) {\n\t// Convert ObjectIds to comparable values (use timestamp for ordering)\n\tlet aVal = a;\n\tlet bVal = b;\n\t\n\tif (a instanceof ObjectId) {\n\t\taVal = a.toString();\n\t}\n\tif (b instanceof ObjectId) {\n\t\tbVal = b.toString();\n\t}\n\t\n\tswitch(operator) {\n\t\tcase '>': return aVal > bVal;\n\t\tcase '>=': return aVal >= bVal;\n\t\tcase '<': return aVal < bVal;\n\t\tcase '<=': return aVal <= bVal;\n\t\tdefault: return false;\n\t}\n}\n\n/**\n * Text search helper\n * Creates a temporary TextIndex to check if the text matches the query\n */\nexport function text(prop, query) {\n\tconst textIndex = new TextIndex();\n\ttextIndex.add('id', prop);\n\tconst results = textIndex.query(query, { scored: false });\n\treturn results.length === 1;\n}\n\n/**\n * Geo within helper - using bounding box logic instead of de9im\n * This is a simpler implementation that doesn't require de9im dependency\n */\nexport function geoWithin(prop, query) {\n\ttry {\n\t\t// bbox format: [[minLon, maxLat], [maxLon, minLat]]\n\t\tif (!Array.isArray(query) || query.length !== 2) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst minLon = query[0][0];\n\t\tconst maxLat = query[0][1];\n\t\tconst maxLon = query[1][0];\n\t\tconst minLat = query[1][1];\n\n\t\t// Check if geometry is within bounding box\n\t\treturn isGeometryWithinBBox(prop, minLon, maxLon, minLat, maxLat);\n\t} catch (e) {\n\t\treturn false;\n\t}\n}\n\n/**\n * Check if a GeoJSON geometry is within a bounding box\n * For Points: checks if the point is within the bbox\n * For Polygons: checks if ALL vertices are within the bbox\n */\nfunction isGeometryWithinBBox(geoJson, minLon, maxLon, minLat, maxLat) {\n\tif (!geoJson) return false;\n\n\t// Handle GeoJSON FeatureCollection\n\tif (geoJson.type === 'FeatureCollection' && geoJson.features && geoJson.features.length > 0) {\n\t\t// All features must be within the bbox\n\t\tfor (const feature of geoJson.features) {\n\t\t\tif (feature.geometry) {\n\t\t\t\tif (!isGeometryWithinBBox(feature.geometry, minLon, maxLon, minLat, maxLat)) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\t// Handle GeoJSON Feature\n\tif (geoJson.type === 'Feature' && geoJson.geometry) {\n\t\treturn isGeometryWithinBBox(geoJson.geometry, minLon, maxLon, minLat, maxLat);\n\t}\n\n\t// Handle GeoJSON Point\n\tif (geoJson.type === 'Point' && geoJson.coordinates) {\n\t\tconst [lng, lat] = geoJson.coordinates;\n\t\tif (typeof lng === 'number' && typeof lat === 'number') {\n\t\t\treturn lng >= minLon && lng <= maxLon && lat >= minLat && lat <= maxLat;\n\t\t}\n\t}\n\n\t// Handle GeoJSON Polygon - ALL vertices must be within the bbox\n\tif (geoJson.type === 'Polygon' && geoJson.coordinates && geoJson.coordinates.length > 0) {\n\t\tfor (const ring of geoJson.coordinates) {\n\t\t\tfor (const coord of ring) {\n\t\t\t\tconst lng = coord[0];\n\t\t\t\tconst lat = coord[1];\n\t\t\t\tif (lng < minLon || lng > maxLon || lat < minLat || lat > maxLat) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\treturn false;\n}\n\n/**\n * Extract coordinates from a GeoJSON object for indexing purposes\n * This uses centroid for polygons to get a single point to index\n * @param {Object} geoJson - The GeoJSON object\n * @returns {Object|null} Object with lat and lng, or null if invalid\n */\nfunction extractCoordinatesFromGeoJSON(geoJson) {\n\tif (!geoJson) return null;\n\n\t// Handle GeoJSON FeatureCollection\n\tif (geoJson.type === 'FeatureCollection' && geoJson.features && geoJson.features.length > 0) {\n\t\tconst feature = geoJson.features[0];\n\t\tif (feature.geometry) {\n\t\t\treturn extractCoordinatesFromGeoJSON(feature.geometry);\n\t\t}\n\t}\n\n\t// Handle GeoJSON Feature\n\tif (geoJson.type === 'Feature' && geoJson.geometry) {\n\t\treturn extractCoordinatesFromGeoJSON(geoJson.geometry);\n\t}\n\n\t// Handle GeoJSON Point\n\tif (geoJson.type === 'Point' && geoJson.coordinates) {\n\t\tconst [lng, lat] = geoJson.coordinates;\n\t\tif (typeof lng === 'number' && typeof lat === 'number') {\n\t\t\treturn { lat, lng };\n\t\t}\n\t}\n\n\t// Handle GeoJSON Polygon - use centroid of first coordinate ring\n\tif (geoJson.type === 'Polygon' && geoJson.coordinates && geoJson.coordinates.length > 0) {\n\t\tconst ring = geoJson.coordinates[0];\n\t\tif (ring.length > 0) {\n\t\t\tlet sumLat = 0, sumLng = 0;\n\t\t\tfor (const coord of ring) {\n\t\t\t\tsumLng += coord[0];\n\t\t\t\tsumLat += coord[1];\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tlat: sumLat / ring.length,\n\t\t\t\tlng: sumLng / ring.length\n\t\t\t};\n\t\t}\n\t}\n\n\treturn null;\n}\n\n/**\n * $where operator implementation\n * SECURITY NOTE: This uses Function constructor which can execute arbitrary code.\n * This is acceptable for a local/in-memory database but should NOT be used\n * in environments where untrusted user input is processed.\n */\nexport function where(doc, value) {\n\tif (typeof value === 'function') {\n\t\ttry {\n\t\t\treturn value.call(doc);\n\t\t} catch (e) {\n\t\t\treturn false;\n\t\t}\n\t} else if (typeof value === 'string') {\n\t\t// Evaluate the string as a function\n\t\ttry {\n\t\t\tvar fn = new Function('return ' + value);\n\t\t\treturn fn.call(doc);\n\t\t} catch (e) {\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn false;\n}\n\n/**\n * Top-level match function\n */\nexport function tlMatches(doc, query) {\n\tvar key = Object.keys(query)[0];\n\tvar value = query[key];\n\tif (key.charAt(0) == \"$\") {\n\t\tif (key == \"$and\") return and(doc, value);\n\t\telse if (key == \"$or\") return or(doc, value);\n\t\telse if (key == \"$not\") return not(doc, value);\n\t\telse if (key == \"$nor\") return nor(doc, value);\n\t\telse if (key == \"$where\") return where(doc, value);\n\t\telse throw { $err: \"Can't canonicalize query: BadValue unknown top level operator: \" + key, code: 17287 };\n\t} else {\n\t\treturn opMatches(doc, key, value);\n\t}\n}\n\n/**\n * Operator match function\n */\nexport function opMatches(doc, key, value) {\n\tif (typeof (value) == \"string\") return valuesEqual(getProp(doc, key), value);\n\telse if (typeof (value) == \"number\") return valuesEqual(getProp(doc, key), value);\n\telse if (typeof (value) == \"boolean\") return valuesEqual(getProp(doc, key), value);\n\telse if (value instanceof ObjectId) return valuesEqual(getProp(doc, key), value);\n\telse if (typeof (value) == \"object\") {\n\t\tif (value instanceof RegExp) return getProp(doc, key) && getProp(doc, key).match(value);\n\t\telse if (isArray(value)) return getProp(doc, key) && arrayMatches(getProp(doc, key), value);\n\t\telse {\n\t\t\tvar keys = Object.keys(value);\n\t\t\tif (keys[0].charAt(0) == \"$\") {\n\t\t\t\tfor (var i = 0; i < keys.length; i++) {\n\t\t\t\t\tvar operator = Object.keys(value)[i];\n\t\t\t\t\tvar operand = value[operator];\n\t\t\t\t\tif (operator == \"$eq\") {\n\t\t\t\t\t\tif (getProp(doc, key) == undefined || !valuesEqual(getProp(doc, key), operand)) return false;\n\t\t\t\t\t} else if (operator == \"$gt\") {\n\t\t\t\t\t\tif (getProp(doc, key) == undefined || !compareValues(getProp(doc, key), operand, '>')) return false;\n\t\t\t\t\t} else if (operator == \"$gte\") {\n\t\t\t\t\t\tif (getProp(doc, key) == undefined || !compareValues(getProp(doc, key), operand, '>=')) return false;\n\t\t\t\t\t} else if (operator == \"$lt\") {\n\t\t\t\t\t\tif (getProp(doc, key) == undefined || !compareValues(getProp(doc, key), operand, '<')) return false;\n\t\t\t\t\t} else if (operator == \"$lte\") {\n\t\t\t\t\t\tif (getProp(doc, key) == undefined || !compareValues(getProp(doc, key), operand, '<=')) return false;\n\t\t\t\t\t} else if (operator == \"$ne\") {\n\t\t\t\t\t\tif (getProp(doc, key) == undefined || !(!valuesEqual(getProp(doc, key), operand))) return false;\n\t\t\t\t\t} else if (operator == \"$in\") {\n\t\t\t\t\t\tif (getProp(doc, key) == undefined || !isIn(getProp(doc, key), operand)) return false;\n\t\t\t\t\t} else if (operator == \"$nin\") {\n\t\t\t\t\t\tif (getProp(doc, key) == undefined || isIn(getProp(doc, key), operand)) return false;\n\t\t\t\t\t} else if (operator == \"$exists\") {\n\t\t\t\t\t\tif (operand ? getProp(doc, key) == undefined : getProp(doc, key) != undefined) return false;\n\t\t\t\t\t} else if (operator == \"$type\") {\n\t\t\t\t\t\tif (typeof (getProp(doc, key)) != operand) return false;\n\t\t\t\t\t} else if (operator == \"$mod\") {\n\t\t\t\t\t\tif (operand.length != 2) throw { $err: \"Can't canonicalize query: BadValue malformed mod, not enough elements\", code: 17287 };\n\t\t\t\t\t\tif (getProp(doc, key) == undefined || (getProp(doc, key) % operand[0] != operand[1])) return false;\n\t\t\t\t\t} else if (operator == \"$regex\") {\n\t\t\t\t\t\tif (getProp(doc, key) == undefined || !getProp(doc, key).match(operand)) return false;\n\t\t\t\t\t} else if (operator == \"$text\") {\n\t\t\t\t\t\tif (getProp(doc, key) == undefined || !text(getProp(doc, key), operand)) return false;\n\t\t\t\t\t} else if (operator == \"$geoWithin\") {\n\t\t\t\t\t\tif (getProp(doc, key) == undefined || !geoWithin(getProp(doc, key), operand)) return false;\n\t\t\t\t\t} else if (operator == \"$not\") {\n\t\t\t\t\t\tif (opMatches(doc, key, operand)) return false;\n\t\t\t\t\t} else if (operator == \"$all\") {\n\t\t\t\t\t\tvar fieldValue = getProp(doc, key);\n\t\t\t\t\t\tif (fieldValue == undefined || !isArray(fieldValue)) return false;\n\t\t\t\t\t\tfor (var j = 0; j < operand.length; j++) {\n\t\t\t\t\t\t\tif (!isIn(operand[j], fieldValue)) return false;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (operator == \"$elemMatch\") {\n\t\t\t\t\t\tvar fieldValue = getProp(doc, key);\n\t\t\t\t\t\tif (fieldValue == undefined || !isArray(fieldValue)) return false;\n\t\t\t\t\t\tvar found = false;\n\t\t\t\t\t\tfor (var j = 0; j < fieldValue.length; j++) {\n\t\t\t\t\t\t\tvar element = fieldValue[j];\n\t\t\t\t\t\t\t// Check if element matches the query\n\t\t\t\t\t\t\tif (typeof element === 'object' && !isArray(element)) {\n\t\t\t\t\t\t\t\t// For objects, use matches\n\t\t\t\t\t\t\t\tif (matches(element, operand)) {\n\t\t\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// For primitive values, check operators directly\n\t\t\t\t\t\t\t\tvar matchesPrimitive = true;\n\t\t\t\t\t\t\t\tvar opKeys = Object.keys(operand);\n\t\t\t\t\t\t\t\tfor (var k = 0; k < opKeys.length; k++) {\n\t\t\t\t\t\t\t\t\tvar op = opKeys[k];\n\t\t\t\t\t\t\t\t\tvar opValue = operand[op];\n\t\t\t\t\t\t\t\t\tif (op == \"$gte\" && !(element >= opValue)) matchesPrimitive = false;\n\t\t\t\t\t\t\t\t\telse if (op == \"$gt\" && !(element > opValue)) matchesPrimitive = false;\n\t\t\t\t\t\t\t\t\telse if (op == \"$lte\" && !(element <= opValue)) matchesPrimitive = false;\n\t\t\t\t\t\t\t\t\telse if (op == \"$lt\" && !(element < opValue)) matchesPrimitive = false;\n\t\t\t\t\t\t\t\t\telse if (op == \"$eq\" && !(element == opValue)) matchesPrimitive = false;\n\t\t\t\t\t\t\t\t\telse if (op == \"$ne\" && !(element != opValue)) matchesPrimitive = false;\n\t\t\t\t\t\t\t\t\telse if (op == \"$in\" && !isIn(element, opValue)) matchesPrimitive = false;\n\t\t\t\t\t\t\t\t\telse if (op == \"$nin\" && isIn(element, opValue)) matchesPrimitive = false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (matchesPrimitive) {\n\t\t\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!found) return false;\n\t\t\t\t\t} else if (operator == \"$size\") {\n\t\t\t\t\t\tvar fieldValue = getProp(doc, key);\n\t\t\t\t\t\tif (fieldValue == undefined || !isArray(fieldValue)) return false;\n\t\t\t\t\t\tif (fieldValue.length != operand) return false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow { $err: \"Can't canonicalize query: BadValue unknown operator: \" + operator, code: 17287 };\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\treturn getProp(doc, key) && objectMatches(getProp(doc, key), value);\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\n * $not operator\n */\nexport function not(doc, value) {\n\treturn !tlMatches(doc, value);\n}\n\n/**\n * $and operator\n */\nexport function and(doc, els) {\n\tfor (var i = 0; i < els.length; i++) {\n\t\tif (!tlMatches(doc, els[i])) {\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn true;\n}\n\n/**\n * $or operator\n */\nexport function or(doc, els) {\n\tfor (var i = 0; i < els.length; i++) {\n\t\tif (tlMatches(doc, els[i])) return true;\n\t}\n\treturn false;\n}\n\n/**\n * $nor operator\n */\nexport function nor(doc, els) {\n\tfor (var i = 0; i < els.length; i++) {\n\t\tif (tlMatches(doc, els[i])) return false;\n\t}\n\treturn true;\n}\n\n/**\n * Main matches function - query structure: (top level operators ( \"age\" : (operators) ))\n * top, top level query, implicit $and\n */\nexport function matches(doc, query) {\n\treturn and(doc, toArray(query));\n}\n","/**\n * Update operations module\n */\n\n/**\n * Apply update operators to a document\n */\nexport function applyUpdates(updates, doc, setOnInsert) {\n\tvar keys = Object.keys(updates);\n\tfor (var i = 0; i < keys.length; i++) {\n\t\tvar key = keys[i];\n\t\tvar value = updates[key];\n\t\tif (key == \"$inc\") {\n\t\t\tvar fields = Object.keys(value);\n\t\t\tfor (var j = 0; j < fields.length; j++) {\n\t\t\t\tvar field = fields[j];\n\t\t\t\tvar amount = value[field];\n\t\t\t\tdoc[field] = doc[field] + amount;\n\t\t\t}\n\t\t} else if (key == \"$mul\") {\n\t\t\tvar fields = Object.keys(value);\n\t\t\tfor (var j = 0; j < fields.length; j++) {\n\t\t\t\tvar field = fields[j];\n\t\t\t\tvar amount = value[field];\n\t\t\t\tdoc[field] = doc[field] * amount;\n\t\t\t}\n\t\t} else if (key == \"$rename\") {\n\t\t\tvar fields = Object.keys(value);\n\t\t\tfor (var j = 0; j < fields.length; j++) {\n\t\t\t\tvar field = fields[j];\n\t\t\t\tvar newName = value[field];\n\t\t\t\tdoc[newName] = doc[field];\n\t\t\t\tdelete doc[field];\n\t\t\t}\n\t\t} else if (key == \"$setOnInsert\" && setOnInsert) {\n\t\t\tvar fields = Object.keys(value);\n\t\t\tfor (var j = 0; j < fields.length; j++) {\n\t\t\t\tdoc[fields[j]] = value[fields[j]];\n\t\t\t}\n\t\t} else if (key == \"$set\") {\n\t\t\tvar fields = Object.keys(value);\n\t\t\tfor (var j = 0; j < fields.length; j++) {\n\t\t\t\tdoc[fields[j]] = value[fields[j]];\n\t\t\t}\n\t\t} else if (key == \"$unset\") {\n\t\t\tvar fields = Object.keys(value);\n\t\t\tfor (var j = 0; j < fields.length; j++) {\n\t\t\t\tdelete doc[fields[j]];\n\t\t\t}\n\t\t} else if (key == \"$min\") {\n\t\t\tvar fields = Object.keys(value);\n\t\t\tfor (var j = 0; j < fields.length; j++) {\n\t\t\t\tvar field = fields[j];\n\t\t\t\tvar amount = value[field];\n\t\t\t\tdoc[field] = Math.min(doc[field], amount);\n\t\t\t}\n\t\t} else if (key == \"$max\") {\n\t\t\tvar fields = Object.keys(value);\n\t\t\tfor (var j = 0; j < fields.length; j++) {\n\t\t\t\tvar field = fields[j];\n\t\t\t\tvar amount = value[field];\n\t\t\t\tdoc[field] = Math.max(doc[field], amount);\n\t\t\t}\n\t\t} else if (key == \"$currentDate\") {  // TODO not the same as mongo\n\t\t\tvar fields = Object.keys(value);\n\t\t\tfor (var j = 0; j < fields.length; j++) {\n\t\t\t\tdoc[fields[j]] = new Date();\n\t\t\t}\n\t\t} else if (key == \"$addToSet\") {\n\t\t\tvar fields = Object.keys(value);\n\t\t\tfor (var j = 0; j < fields.length; j++) {\n\t\t\t\tvar field = fields[j];\n\t\t\t\tvar value = value[field];\n\t\t\t\tdoc[field].push(value);\n\t\t\t}\n\t\t} else if (key == \"$pop\") {\n\t\t\tvar fields = Object.keys(value);\n\t\t\tfor (var j = 0; j < fields.length; j++) {\n\t\t\t\tvar field = fields[j];\n\t\t\t\tvar value = value[field];\n\t\t\t\tif (value == 1) {\n\t\t\t\t\tdoc[field].pop();\n\t\t\t\t} else if (value == -1) {\n\t\t\t\t\tdoc[field].shift();\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (key == \"$pullAll\") {\n\t\t\tvar fields = Object.keys(value);\n\t\t\tfor (var j = 0; j < fields.length; j++) {\n\t\t\t\tvar src = doc[fields[j]];\n\t\t\t\tvar toRemove = value[fields[j]];\n\t\t\t\tvar notRemoved = [];\n\t\t\t\tfor (var k = 0; k < src.length; k++) {\n\t\t\t\t\tvar removed = false;\n\t\t\t\t\tfor (var l = 0; l < toRemove.length; l++) {\n\t\t\t\t\t\tif (src[k] == toRemove[l]) {\n\t\t\t\t\t\t\tremoved = true;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (!removed) notRemoved.push(src[k]);\n\t\t\t\t}\n\t\t\t\tdoc[fields[j]] = notRemoved;\n\t\t\t}\n\t\t} else if (key == \"$pushAll\") {\n\t\t\tvar fields = Object.keys(value);\n\t\t\tfor (var j = 0; j < fields.length; j++) {\n\t\t\t\tvar field = fields[j];\n\t\t\t\tvar values = value[field];\n\t\t\t\tfor (var k = 0; k < values.length; k++) {\n\t\t\t\t\tdoc[field].push(values[k]);\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (key == \"$push\") {\n\t\t\tvar fields = Object.keys(value);\n\t\t\tfor (var j = 0; j < fields.length; j++) {\n\t\t\t\tvar field = fields[j];\n\t\t\t\tdoc[field].push(value[field]);\n\t\t\t}\n\t\t} else if (key == \"$bit\") {\n\t\t\tvar field = Object.keys(value)[0];\n\t\t\tvar operation = value[field];\n\t\t\tvar operator = Object.keys(operation)[0];\n\t\t\tvar operand = operation[operator];\n\t\t\tif (operator == \"and\") {\n\t\t\t\tdoc[field] = doc[field] & operand;\n\t\t\t} else if (operator == \"or\") {\n\t\t\t\tdoc[field] = doc[field] | operand;\n\t\t\t} else if (operator == \"xor\") {\n\t\t\t\tdoc[field] = doc[field] ^ operand;\n\t\t\t} else {\n\t\t\t\tthrow \"unknown $bit operator: \" + operator;\n\t\t\t}\n\t\t} else {\n\t\t\tthrow \"unknown update operator: \" + key;\n\t\t}\n\t}\n}\n\n/**\n * Create a new document from query and update operators for upsert\n */\nexport function createDocFromUpdate(query, updates, idGenerator) {\n\tvar newDoc = { _id: idGenerator() };\n\tvar onlyFields = true;\n\tvar updateKeys = Object.keys(updates);\n\tfor (var i = 0; i < updateKeys.length; i++) {\n\t\tif (updateKeys[i].charAt(0) == \"$\") {\n\t\t\tonlyFields = false;\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (onlyFields) {\n\t\tfor (var i = 0; i < updateKeys.length; i++) {\n\t\t\tnewDoc[updateKeys[i]] = updates[updateKeys[i]];\n\t\t}\n\t} else {\n\t\tvar queryKeys = Object.keys(query);\n\t\tfor (var i = 0; i < queryKeys.length; i++) {\n\t\t\tnewDoc[queryKeys[i]] = query[queryKeys[i]];\n\t\t}\n\t\tapplyUpdates(updates, newDoc, true);\n\t}\n\treturn newDoc;\n}\n","/**\n * Base class for collection indexes\n * Provides a common interface for different types of indexes (e.g., regular, text, geo)\n */\nexport class CollectionIndex {\n\tconstructor(keys, options = {}) {\n\t\tthis.keys = keys;\n\t\tthis.options = options;\n\t\tthis.name = options.name || this.generateIndexName(keys);\n\t}\n\n\t/**\n\t * Generate index name from keys\n\t */\n\tgenerateIndexName(keys) {\n\t\tconst parts = [];\n\t\tfor (const field in keys) {\n\t\t\tif (keys.hasOwnProperty(field)) {\n\t\t\t\tparts.push(field + '_' + keys[field]);\n\t\t\t}\n\t\t}\n\t\treturn parts.join('_');\n\t}\n\n\t/**\n\t * Add a document to the index\n\t * @param {Object} doc - The document to index\n\t */\n\tadd(doc) {\n\t\tthrow new Error('add() must be implemented by subclass');\n\t}\n\n\t/**\n\t * Remove a document from the index\n\t * @param {Object} doc - The document to remove\n\t */\n\tremove(doc) {\n\t\tthrow new Error('remove() must be implemented by subclass');\n\t}\n\n\t/**\n\t * Update a document in the index (remove old, add new)\n\t * @param {Object} oldDoc - The old document\n\t * @param {Object} newDoc - The new document\n\t */\n\tupdate(oldDoc, newDoc) {\n\t\tthis.remove(oldDoc);\n\t\tthis.add(newDoc);\n\t}\n\n\t/**\n\t * Query the index\n\t * @param {*} query - The query to execute\n\t * @returns {Array} Array of document IDs or null if index cannot satisfy query\n\t */\n\tquery(query) {\n\t\tthrow new Error('query() must be implemented by subclass');\n\t}\n\n\t/**\n\t * Clear all data from the index\n\t */\n\tclear() {\n\t\tthrow new Error('clear() must be implemented by subclass');\n\t}\n\n\t/**\n\t * Get index specification (for getIndexes())\n\t */\n\tgetSpec() {\n\t\treturn {\n\t\t\tname: this.name,\n\t\t\tkey: this.keys\n\t\t};\n\t}\n\n\t/**\n\t * Serialize index state for storage\n\t * @returns {Object} Serializable index state\n\t */\n\tserialize() {\n\t\tthrow new Error('serialize() must be implemented by subclass');\n\t}\n\n\t/**\n\t * Restore index state from serialized data\n\t * @param {Object} data - Serialized index state\n\t */\n\tdeserialize(data) {\n\t\tthrow new Error('deserialize() must be implemented by subclass');\n\t}\n}\n","import { CollectionIndex } from './CollectionIndex.js';\nimport { getProp } from './utils.js';\n\n/**\n * Regular (B-tree style) index implementation\n * Supports equality queries on indexed fields\n */\nexport class RegularCollectionIndex extends CollectionIndex {\n\tconstructor(keys, options = {}) {\n\t\tsuper(keys, options);\n\t\t// Map of key value to array of document _ids\n\t\tthis.data = {};\n\t}\n\n\t/**\n\t * Extract index key value from a document\n\t */\n\textractIndexKey(doc) {\n\t\tconst keyFields = Object.keys(this.keys);\n\t\tif (keyFields.length === 0) return null;\n\n\t\t// For simple single-field index\n\t\tif (keyFields.length === 1) {\n\t\t\tconst field = keyFields[0];\n\t\t\tconst value = getProp(doc, field);\n\t\t\tif (value === undefined) return null;\n\t\t\t// Preserve type information in the key\n\t\t\treturn JSON.stringify({ t: typeof value, v: value });\n\t\t}\n\n\t\t// For compound index, concatenate values with type preservation\n\t\tconst keyParts = [];\n\t\tfor (let i = 0; i < keyFields.length; i++) {\n\t\t\tconst value = getProp(doc, keyFields[i]);\n\t\t\tif (value === undefined) return null;\n\t\t\tkeyParts.push(JSON.stringify(value));\n\t\t}\n\t\t// Use a separator that won't appear in JSON\n\t\treturn keyParts.join('\\x00');\n\t}\n\n\t/**\n\t * Add a document to the index\n\t * @param {Object} doc - The document to index\n\t */\n\tadd(doc) {\n\t\tconst indexKey = this.extractIndexKey(doc);\n\t\tif (indexKey !== null) {\n\t\t\tif (!this.data[indexKey]) {\n\t\t\t\tthis.data[indexKey] = [];\n\t\t\t}\n\t\t\tthis.data[indexKey].push(doc._id);\n\t\t}\n\t}\n\n\t/**\n\t * Remove a document from the index\n\t * @param {Object} doc - The document to remove\n\t */\n\tremove(doc) {\n\t\tconst indexKey = this.extractIndexKey(doc);\n\t\tif (indexKey !== null && this.data[indexKey]) {\n\t\t\tconst arr = this.data[indexKey];\n\t\t\tconst idx = arr.indexOf(doc._id);\n\t\t\tif (idx !== -1) {\n\t\t\t\tarr.splice(idx, 1);\n\t\t\t}\n\t\t\tif (arr.length === 0) {\n\t\t\t\tdelete this.data[indexKey];\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Query the index\n\t * @param {*} query - The query object\n\t * @returns {Array|null} Array of document IDs or null if index cannot satisfy query\n\t */\n\tquery(query) {\n\t\tconst queryKeys = Object.keys(query);\n\t\tconst indexFields = Object.keys(this.keys);\n\n\t\t// Check if query matches index (simple case: single field equality)\n\t\tif (indexFields.length === 1) {\n\t\t\tconst field = indexFields[0];\n\t\t\t// Check for simple equality\n\t\t\tif (queryKeys.indexOf(field) !== -1) {\n\t\t\t\tconst queryValue = query[field];\n\t\t\t\t// Only use index for simple equality (not operators like $gt, $lt, etc.)\n\t\t\t\tif (typeof queryValue !== 'object' || queryValue === null) {\n\t\t\t\t\tconst indexKey = JSON.stringify({ t: typeof queryValue, v: queryValue });\n\t\t\t\t\treturn this.data[indexKey] || [];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * Clear all data from the index\n\t */\n\tclear() {\n\t\tthis.data = {};\n\t}\n\n\t/**\n\t * Serialize index state for storage\n\t * @returns {Object} Serializable index state\n\t */\n\tserialize() {\n\t\treturn {\n\t\t\ttype: 'regular',\n\t\t\tkeys: this.keys,\n\t\t\toptions: this.options,\n\t\t\tdata: this.data\n\t\t};\n\t}\n\n\t/**\n\t * Restore index state from serialized data\n\t * @param {Object} state - Serialized index state\n\t */\n\tdeserialize(state) {\n\t\tthis.data = state.data || {};\n\t}\n}\n","import { CollectionIndex } from './CollectionIndex.js';\nimport { TextIndex } from './TextIndex.js';\nimport { getProp } from './utils.js';\n\n/**\n * Text index implementation using TextIndex\n * Supports full-text search on one or more fields\n */\nexport class TextCollectionIndex extends CollectionIndex {\n\tconstructor(keys, options = {}) {\n\t\tsuper(keys, options);\n\t\t// Create the underlying TextIndex\n\t\tthis.textIndex = new TextIndex(options);\n\t\t// Track which fields are indexed\n\t\tthis.indexedFields = [];\n\t\tfor (const field in keys) {\n\t\t\tif (keys[field] === 'text') {\n\t\t\t\tthis.indexedFields.push(field);\n\t\t\t}\n\t\t}\n\t\tif (this.indexedFields.length === 0) {\n\t\t\tthrow new Error('Text index must have at least one field with type \"text\"');\n\t\t}\n\t}\n\n\t/**\n\t * Extract text content from a document for the indexed fields\n\t * @param {Object} doc - The document\n\t * @returns {string} Combined text from all indexed fields\n\t */\n\t_extractText(doc) {\n\t\tconst textParts = [];\n\t\tfor (const field of this.indexedFields) {\n\t\t\tconst value = getProp(doc, field);\n\t\t\tif (value !== undefined && value !== null) {\n\t\t\t\ttextParts.push(String(value));\n\t\t\t}\n\t\t}\n\t\treturn textParts.join(' ');\n\t}\n\n\t/**\n\t * Add a document to the text index\n\t * @param {Object} doc - The document to index\n\t */\n\tadd(doc) {\n\t\tif (!doc._id) {\n\t\t\tthrow new Error('Document must have an _id field');\n\t\t}\n\t\tconst text = this._extractText(doc);\n\t\tif (text) {\n\t\t\tthis.textIndex.add(String(doc._id), text);\n\t\t}\n\t}\n\n\t/**\n\t * Remove a document from the text index\n\t * @param {Object} doc - The document to remove\n\t */\n\tremove(doc) {\n\t\tif (!doc._id) {\n\t\t\treturn;\n\t\t}\n\t\tthis.textIndex.remove(String(doc._id));\n\t}\n\n\t/**\n\t * Query the text index\n\t * @param {*} query - The query object\n\t * @returns {Array|null} Array of document IDs or null if query is not a text search\n\t */\n\tquery(query) {\n\t\t// This method is used for query planning\n\t\t// Text queries are handled separately in queryMatcher\n\t\treturn null;\n\t}\n\n\t/**\n\t * Search the text index\n\t * @param {string} searchText - The text to search for\n\t * @param {Object} options - Search options\n\t * @returns {Array} Array of document IDs\n\t */\n\tsearch(searchText, options = {}) {\n\t\tconst results = this.textIndex.query(searchText, { scored: false, ...options });\n\t\treturn results;\n\t}\n\n\t/**\n\t * Clear all data from the index\n\t */\n\tclear() {\n\t\tthis.textIndex.clear();\n\t}\n\n\t/**\n\t * Get index specification\n\t */\n\tgetSpec() {\n\t\treturn {\n\t\t\tname: this.name,\n\t\t\tkey: this.keys,\n\t\t\ttextIndexVersion: 3,\n\t\t\tweights: this._getWeights()\n\t\t};\n\t}\n\n\t/**\n\t * Get field weights (all default to 1 for now)\n\t */\n\t_getWeights() {\n\t\tconst weights = {};\n\t\tfor (const field of this.indexedFields) {\n\t\t\tweights[field] = 1;\n\t\t}\n\t\treturn weights;\n\t}\n\n\t/**\n\t * Serialize index state for storage\n\t * @returns {Object} Serializable index state\n\t */\n\tserialize() {\n\t\treturn {\n\t\t\ttype: 'text',\n\t\t\tkeys: this.keys,\n\t\t\toptions: this.options,\n\t\t\tindexedFields: this.indexedFields,\n\t\t\ttextIndexState: this.textIndex.serialize()\n\t\t};\n\t}\n\n\t/**\n\t * Restore index state from serialized data\n\t * @param {Object} state - Serialized index state\n\t */\n\tdeserialize(state) {\n\t\tthis.indexedFields = state.indexedFields || [];\n\t\tif (state.textIndexState) {\n\t\t\tthis.textIndex.deserialize(state.textIndexState);\n\t\t}\n\t}\n}\n","/**\n * R-tree implementation for geospatial indexing\n * \n * This implementation supports:\n * - Adding points with lat/lng coordinates\n * - Removing points\n * - Bounding box queries\n * - Location + radius queries (converted to bounding box)\n */\n\n/**\n * Calculate distance between two points using Haversine formula\n * @param {number} lat1 - Latitude of first point\n * @param {number} lng1 - Longitude of first point\n * @param {number} lat2 - Latitude of second point\n * @param {number} lng2 - Longitude of second point\n * @returns {number} Distance in kilometers\n */\nfunction haversineDistance(lat1, lng1, lat2, lng2) {\n\tconst R = 6371; // Earth's radius in kilometers\n\tconst dLat = (lat2 - lat1) * Math.PI / 180;\n\tconst dLng = (lng2 - lng1) * Math.PI / 180;\n\tconst a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n\t\tMath.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *\n\t\tMath.sin(dLng / 2) * Math.sin(dLng / 2);\n\tconst c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n\treturn R * c;\n}\n\n/**\n * Convert radius query to bounding box\n * Approximation: 1 degree latitude  111 km\n * @param {number} lat - Center latitude\n * @param {number} lng - Center longitude\n * @param {number} radiusKm - Radius in kilometers\n * @returns {Object} Bounding box {minLat, maxLat, minLng, maxLng}\n */\nfunction radiusToBoundingBox(lat, lng, radiusKm) {\n\tconst latDelta = radiusKm / 111; // degrees\n\tconst lngDelta = radiusKm / (111 * Math.cos(lat * Math.PI / 180)); // degrees\n\t\n\treturn {\n\t\tminLat: lat - latDelta,\n\t\tmaxLat: lat + latDelta,\n\t\tminLng: lng - lngDelta,\n\t\tmaxLng: lng + lngDelta\n\t};\n}\n\n/**\n * Check if two bounding boxes intersect\n */\nfunction intersects(bbox1, bbox2) {\n\treturn !(bbox1.maxLat < bbox2.minLat ||\n\t\tbbox1.minLat > bbox2.maxLat ||\n\t\tbbox1.maxLng < bbox2.minLng ||\n\t\tbbox1.minLng > bbox2.maxLng);\n}\n\n/**\n * Check if bbox1 contains bbox2\n */\nfunction contains(bbox1, bbox2) {\n\treturn bbox1.minLat <= bbox2.minLat &&\n\t\tbbox1.maxLat >= bbox2.maxLat &&\n\t\tbbox1.minLng <= bbox2.minLng &&\n\t\tbbox1.maxLng >= bbox2.maxLng;\n}\n\n/**\n * Calculate the area of a bounding box\n */\nfunction area(bbox) {\n\treturn (bbox.maxLat - bbox.minLat) * (bbox.maxLng - bbox.minLng);\n}\n\n/**\n * Calculate the bounding box that contains both input boxes\n */\nfunction union(bbox1, bbox2) {\n\treturn {\n\t\tminLat: Math.min(bbox1.minLat, bbox2.minLat),\n\t\tmaxLat: Math.max(bbox1.maxLat, bbox2.maxLat),\n\t\tminLng: Math.min(bbox1.minLng, bbox2.minLng),\n\t\tmaxLng: Math.max(bbox1.maxLng, bbox2.maxLng)\n\t};\n}\n\n/**\n * Calculate the enlargement needed to include bbox2 in bbox1\n */\nfunction enlargement(bbox1, bbox2) {\n\tconst unionBox = union(bbox1, bbox2);\n\treturn area(unionBox) - area(bbox1);\n}\n\n/**\n * R-tree Node class\n */\nclass RTreeNode {\n\tconstructor(isLeaf = false) {\n\t\tthis.isLeaf = isLeaf;\n\t\tthis.children = []; // For internal nodes: child nodes; For leaf nodes: data entries\n\t\tthis.bbox = null;\n\t}\n\n\t/**\n\t * Update the bounding box to contain all children\n\t */\n\tupdateBBox() {\n\t\tif (this.children.length === 0) {\n\t\t\tthis.bbox = null;\n\t\t\treturn;\n\t\t}\n\n\t\tlet minLat = Infinity, maxLat = -Infinity;\n\t\tlet minLng = Infinity, maxLng = -Infinity;\n\n\t\tfor (const child of this.children) {\n\t\t\tconst bbox = child.bbox;\n\t\t\tminLat = Math.min(minLat, bbox.minLat);\n\t\t\tmaxLat = Math.max(maxLat, bbox.maxLat);\n\t\t\tminLng = Math.min(minLng, bbox.minLng);\n\t\t\tmaxLng = Math.max(maxLng, bbox.maxLng);\n\t\t}\n\n\t\tthis.bbox = { minLat, maxLat, minLng, maxLng };\n\t}\n}\n\n/**\n * R-tree implementation\n */\nexport class RTree {\n\tconstructor(maxEntries = 9) {\n\t\tthis.maxEntries = maxEntries;\n\t\tthis.minEntries = Math.max(2, Math.ceil(maxEntries / 2));\n\t\tthis.root = new RTreeNode(true);\n\t\tthis._size = 0; // Track size for O(1) queries\n\t}\n\n\t/**\n\t * Insert a point into the R-tree\n\t * @param {number} lat - Latitude\n\t * @param {number} lng - Longitude\n\t * @param {*} data - Associated data\n\t */\n\tinsert(lat, lng, data) {\n\t\t// Create a point bounding box (bbox with zero area)\n\t\tconst bbox = {\n\t\t\tminLat: lat,\n\t\t\tmaxLat: lat,\n\t\t\tminLng: lng,\n\t\t\tmaxLng: lng\n\t\t};\n\n\t\tconst entry = { bbox, lat, lng, data };\n\t\tthis._insert(entry, this.root, 1);\n\t\tthis._size++;\n\t}\n\n\t/**\n\t * Internal insert method\n\t */\n\t_insert(entry, node, level) {\n\t\tif (node.isLeaf) {\n\t\t\tnode.children.push(entry);\n\t\t\tnode.updateBBox();\n\n\t\t\tif (node.children.length > this.maxEntries) {\n\t\t\t\treturn this._split(node);\n\t\t\t}\n\t\t} else {\n\t\t\t// Choose subtree\n\t\t\tconst target = this._chooseSubtree(entry.bbox, node);\n\t\t\tconst splitNode = this._insert(entry, target, level + 1);\n\n\t\t\tif (splitNode) {\n\t\t\t\tnode.children.push(splitNode);\n\t\t\t\tnode.updateBBox();\n\n\t\t\t\tif (node.children.length > this.maxEntries) {\n\t\t\t\t\treturn this._split(node);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tnode.updateBBox();\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\t/**\n\t * Choose the best subtree to insert an entry\n\t */\n\t_chooseSubtree(bbox, node) {\n\t\tlet minEnlargement = Infinity;\n\t\tlet minArea = Infinity;\n\t\tlet targetNode = null;\n\n\t\tfor (const child of node.children) {\n\t\t\tconst enl = enlargement(child.bbox, bbox);\n\t\t\tconst ar = area(child.bbox);\n\n\t\t\tif (enl < minEnlargement || (enl === minEnlargement && ar < minArea)) {\n\t\t\t\tminEnlargement = enl;\n\t\t\t\tminArea = ar;\n\t\t\t\ttargetNode = child;\n\t\t\t}\n\t\t}\n\n\t\treturn targetNode;\n\t}\n\n\t/**\n\t * Split an overflowing node\n\t */\n\t_split(node) {\n\t\t// Simple linear split algorithm\n\t\tconst children = node.children;\n\t\tconst isLeaf = node.isLeaf;\n\n\t\t// Find two seeds (most distant entries)\n\t\tlet maxDist = -Infinity;\n\t\tlet seed1Idx = 0, seed2Idx = 1;\n\n\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\tfor (let j = i + 1; j < children.length; j++) {\n\t\t\t\tconst bbox1 = children[i].bbox;\n\t\t\t\tconst bbox2 = children[j].bbox;\n\t\t\t\tconst combinedBox = union(bbox1, bbox2);\n\t\t\t\tconst waste = area(combinedBox) - area(bbox1) - area(bbox2);\n\t\t\t\t\n\t\t\t\tif (waste > maxDist) {\n\t\t\t\t\tmaxDist = waste;\n\t\t\t\t\tseed1Idx = i;\n\t\t\t\t\tseed2Idx = j;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Create two new nodes\n\t\tconst node1 = new RTreeNode(isLeaf);\n\t\tconst node2 = new RTreeNode(isLeaf);\n\n\t\tnode1.children.push(children[seed1Idx]);\n\t\tnode2.children.push(children[seed2Idx]);\n\n\t\t// Distribute remaining entries\n\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\tif (i === seed1Idx || i === seed2Idx) continue;\n\n\t\t\tconst child = children[i];\n\t\t\tconst bbox = child.bbox;\n\t\t\t\n\t\t\tconst enl1 = node1.children.length === 0 ? Infinity : enlargement(node1.bbox || bbox, bbox);\n\t\t\tconst enl2 = node2.children.length === 0 ? Infinity : enlargement(node2.bbox || bbox, bbox);\n\n\t\t\tif (node1.children.length < this.minEntries && \n\t\t\t\tchildren.length - i + node1.children.length <= this.minEntries) {\n\t\t\t\tnode1.children.push(child);\n\t\t\t} else if (node2.children.length < this.minEntries && \n\t\t\t\tchildren.length - i + node2.children.length <= this.minEntries) {\n\t\t\t\tnode2.children.push(child);\n\t\t\t} else if (enl1 < enl2) {\n\t\t\t\tnode1.children.push(child);\n\t\t\t} else if (enl2 < enl1) {\n\t\t\t\tnode2.children.push(child);\n\t\t\t} else {\n\t\t\t\t// Equal enlargement, choose the one with smaller area\n\t\t\t\tconst area1 = node1.bbox ? area(node1.bbox) : 0;\n\t\t\t\tconst area2 = node2.bbox ? area(node2.bbox) : 0;\n\t\t\t\tif (area1 < area2) {\n\t\t\t\t\tnode1.children.push(child);\n\t\t\t\t} else {\n\t\t\t\t\tnode2.children.push(child);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tnode1.updateBBox();\n\t\t\tnode2.updateBBox();\n\t\t}\n\n\t\t// Update the original node with one group\n\t\tnode.children = node1.children;\n\t\tnode.updateBBox();\n\n\t\t// If this was the root, create a new root\n\t\tif (node === this.root) {\n\t\t\tconst newRoot = new RTreeNode(false);\n\t\t\tnewRoot.children = [node1, node2];\n\t\t\tnewRoot.updateBBox();\n\t\t\tthis.root = newRoot;\n\t\t\treturn null;\n\t\t}\n\n\t\treturn node2;\n\t}\n\n\t/**\n\t * Search for points within a bounding box\n\t * @param {Object} bbox - Bounding box {minLat, maxLat, minLng, maxLng}\n\t * @returns {Array} Array of matching entries\n\t */\n\tsearchBBox(bbox) {\n\t\tconst results = [];\n\t\tthis._searchBBox(bbox, this.root, results);\n\t\treturn results;\n\t}\n\n\t/**\n\t * Internal bounding box search\n\t */\n\t_searchBBox(bbox, node, results) {\n\t\tif (!node.bbox || !intersects(bbox, node.bbox)) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (node.isLeaf) {\n\t\t\tfor (const entry of node.children) {\n\t\t\t\tif (intersects(bbox, entry.bbox)) {\n\t\t\t\t\tresults.push(entry);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tfor (const child of node.children) {\n\t\t\t\tthis._searchBBox(bbox, child, results);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Search for points within a radius of a location\n\t * @param {number} lat - Center latitude\n\t * @param {number} lng - Center longitude\n\t * @param {number} radiusKm - Radius in kilometers\n\t * @returns {Array} Array of matching entries\n\t */\n\tsearchRadius(lat, lng, radiusKm) {\n\t\t// Convert radius to bounding box for initial filtering\n\t\tconst bbox = radiusToBoundingBox(lat, lng, radiusKm);\n\t\tconst candidates = this.searchBBox(bbox);\n\n\t\t// Filter by actual distance\n\t\tconst results = [];\n\t\tfor (const entry of candidates) {\n\t\t\tconst dist = haversineDistance(lat, lng, entry.lat, entry.lng);\n\t\t\tif (dist <= radiusKm) {\n\t\t\t\tresults.push(entry);\n\t\t\t}\n\t\t}\n\n\t\treturn results;\n\t}\n\n\t/**\n\t * Remove a point from the R-tree\n\t * @param {number} lat - Latitude\n\t * @param {number} lng - Longitude\n\t * @param {*} data - Associated data (optional, for exact match)\n\t * @returns {boolean} True if removed, false if not found\n\t */\n\tremove(lat, lng, data = null) {\n\t\tconst bbox = {\n\t\t\tminLat: lat,\n\t\t\tmaxLat: lat,\n\t\t\tminLng: lng,\n\t\t\tmaxLng: lng\n\t\t};\n\n\t\tconst removed = this._remove(bbox, data, this.root, null, -1);\n\t\t\n\t\tif (removed) {\n\t\t\tthis._size--;\n\t\t}\n\t\t\n\t\t// If root has only one child after removal, make that child the new root\n\t\tif (this.root.children.length === 1 && !this.root.isLeaf) {\n\t\t\tthis.root = this.root.children[0];\n\t\t}\n\n\t\treturn removed;\n\t}\n\n\t/**\n\t * Internal remove method\n\t */\n\t_remove(bbox, data, node, parent, indexInParent) {\n\t\tif (!node.bbox || !intersects(bbox, node.bbox)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (node.isLeaf) {\n\t\t\tfor (let i = 0; i < node.children.length; i++) {\n\t\t\t\tconst entry = node.children[i];\n\t\t\t\tif (entry.lat === bbox.minLat && entry.lng === bbox.minLng) {\n\t\t\t\t\t// If data is specified, check for match\n\t\t\t\t\tconst dataMatches = data === null || \n\t\t\t\t\t\tJSON.stringify(entry.data) === JSON.stringify(data);\n\t\t\t\t\t\n\t\t\t\t\tif (dataMatches) {\n\t\t\t\t\t\tnode.children.splice(i, 1);\n\t\t\t\t\t\tnode.updateBBox();\n\t\t\t\t\t\t\n\t\t\t\t\t\t// Handle underflow\n\t\t\t\t\t\tif (node.children.length < this.minEntries && node !== this.root) {\n\t\t\t\t\t\t\t// Simple approach: reinsert all entries from this node\n\t\t\t\t\t\t\tconst entries = node.children.slice();\n\t\t\t\t\t\t\tnode.children = [];\n\t\t\t\t\t\t\tnode.updateBBox();\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// Remove this node from parent\n\t\t\t\t\t\t\tif (parent) {\n\t\t\t\t\t\t\t\tparent.children.splice(indexInParent, 1);\n\t\t\t\t\t\t\t\tparent.updateBBox();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// Reinsert entries\n\t\t\t\t\t\t\tfor (const e of entries) {\n\t\t\t\t\t\t\t\tthis._insert(e, this.root, 1);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tfor (let i = 0; i < node.children.length; i++) {\n\t\t\t\tconst child = node.children[i];\n\t\t\t\tif (this._remove(bbox, data, child, node, i)) {\n\t\t\t\t\tnode.updateBBox();\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t/**\n\t * Get all entries in the tree\n\t * @returns {Array} All entries\n\t */\n\tgetAll() {\n\t\tconst results = [];\n\t\tthis._getAll(this.root, results);\n\t\treturn results;\n\t}\n\n\t/**\n\t * Internal method to get all entries\n\t */\n\t_getAll(node, results) {\n\t\tif (node.isLeaf) {\n\t\t\tresults.push(...node.children);\n\t\t} else {\n\t\t\tfor (const child of node.children) {\n\t\t\t\tthis._getAll(child, results);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Get the number of entries in the tree\n\t * @returns {number} Number of entries\n\t */\n\tsize() {\n\t\treturn this._size;\n\t}\n\n\t/**\n\t * Clear all entries from the tree\n\t */\n\tclear() {\n\t\tthis.root = new RTreeNode(true);\n\t\tthis._size = 0;\n\t}\n\n\t/**\n\t * Serialize the R-tree state for storage\n\t * @returns {Object} Serializable state\n\t */\n\tserialize() {\n\t\treturn {\n\t\t\tmaxEntries: this.maxEntries,\n\t\t\tminEntries: this.minEntries,\n\t\t\tsize: this._size,\n\t\t\troot: this._serializeNode(this.root)\n\t\t};\n\t}\n\n\t/**\n\t * Serialize a node recursively\n\t */\n\t_serializeNode(node) {\n\t\tconst serialized = {\n\t\t\tisLeaf: node.isLeaf,\n\t\t\tbbox: node.bbox,\n\t\t\tchildren: []\n\t\t};\n\n\t\tif (node.isLeaf) {\n\t\t\t// Leaf nodes contain entries\n\t\t\tserialized.children = node.children.map(entry => ({\n\t\t\t\tbbox: entry.bbox,\n\t\t\t\tlat: entry.lat,\n\t\t\t\tlng: entry.lng,\n\t\t\t\tdata: entry.data\n\t\t\t}));\n\t\t} else {\n\t\t\t// Internal nodes contain child nodes\n\t\t\tserialized.children = node.children.map(child => this._serializeNode(child));\n\t\t}\n\n\t\treturn serialized;\n\t}\n\n\t/**\n\t * Restore the R-tree state from serialized data\n\t * @param {Object} state - Serialized state\n\t */\n\tdeserialize(state) {\n\t\tthis.maxEntries = state.maxEntries || 9;\n\t\tthis.minEntries = state.minEntries || Math.ceil(this.maxEntries / 2);\n\t\tthis._size = state.size || 0;\n\t\tthis.root = this._deserializeNode(state.root);\n\t}\n\n\t/**\n\t * Deserialize a node recursively\n\t */\n\t_deserializeNode(serialized) {\n\t\tconst node = new RTreeNode(serialized.isLeaf);\n\t\tnode.bbox = serialized.bbox;\n\n\t\tif (serialized.isLeaf) {\n\t\t\t// Restore leaf entries\n\t\t\tnode.children = serialized.children.map(entry => ({\n\t\t\t\tbbox: entry.bbox,\n\t\t\t\tlat: entry.lat,\n\t\t\t\tlng: entry.lng,\n\t\t\t\tdata: entry.data\n\t\t\t}));\n\t\t} else {\n\t\t\t// Restore child nodes\n\t\t\tnode.children = serialized.children.map(child => this._deserializeNode(child));\n\t\t}\n\n\t\treturn node;\n\t}\n}\n\nexport default RTree;\n","import { CollectionIndex } from './CollectionIndex.js';\nimport { RTree } from './RTree.js';\nimport { getProp } from './utils.js';\n\n/**\n * Geospatial index implementation using RTree\n * Supports geospatial queries on GeoJSON fields\n */\nexport class GeospatialCollectionIndex extends CollectionIndex {\n\tconstructor(keys, options = {}) {\n\t\tsuper(keys, options);\n\t\t// Create the underlying RTree\n\t\tthis.rtree = new RTree();\n\t\t// Track which field is the geospatial field\n\t\tthis.geoField = null;\n\t\tfor (const field in keys) {\n\t\t\tif (keys[field] === '2dsphere' || keys[field] === '2d') {\n\t\t\t\tthis.geoField = field;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!this.geoField) {\n\t\t\tthrow new Error('Geospatial index must have at least one field with type \"2dsphere\" or \"2d\"');\n\t\t}\n\t}\n\n\t/**\n\t * Extract coordinates from a GeoJSON object\n\t * @param {Object} geoJson - The GeoJSON object\n\t * @returns {Object|null} Object with lat and lng, or null if invalid\n\t */\n\t_extractCoordinates(geoJson) {\n\t\tif (!geoJson) return null;\n\n\t\t// Handle GeoJSON FeatureCollection\n\t\tif (geoJson.type === 'FeatureCollection' && geoJson.features && geoJson.features.length > 0) {\n\t\t\tconst feature = geoJson.features[0];\n\t\t\tif (feature.geometry) {\n\t\t\t\treturn this._extractCoordinates(feature.geometry);\n\t\t\t}\n\t\t}\n\n\t\t// Handle GeoJSON Feature\n\t\tif (geoJson.type === 'Feature' && geoJson.geometry) {\n\t\t\treturn this._extractCoordinates(geoJson.geometry);\n\t\t}\n\n\t\t// Handle GeoJSON Point\n\t\tif (geoJson.type === 'Point' && geoJson.coordinates) {\n\t\t\tconst [lng, lat] = geoJson.coordinates;\n\t\t\tif (typeof lng === 'number' && typeof lat === 'number') {\n\t\t\t\treturn { lat, lng };\n\t\t\t}\n\t\t}\n\n\t\t// Handle GeoJSON Polygon - use centroid of first coordinate\n\t\tif (geoJson.type === 'Polygon' && geoJson.coordinates && geoJson.coordinates.length > 0) {\n\t\t\tconst ring = geoJson.coordinates[0];\n\t\t\tif (ring.length > 0) {\n\t\t\t\tlet sumLat = 0, sumLng = 0;\n\t\t\t\tfor (const coord of ring) {\n\t\t\t\t\tsumLng += coord[0];\n\t\t\t\t\tsumLat += coord[1];\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tlat: sumLat / ring.length,\n\t\t\t\t\tlng: sumLng / ring.length\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * Add a document to the geospatial index\n\t * @param {Object} doc - The document to index\n\t */\n\tadd(doc) {\n\t\tif (!doc._id) {\n\t\t\tthrow new Error('Document must have an _id field');\n\t\t}\n\t\tconst geoValue = getProp(doc, this.geoField);\n\t\tconst coords = this._extractCoordinates(geoValue);\n\t\tif (coords) {\n\t\t\tthis.rtree.insert(coords.lat, coords.lng, { \n\t\t\t\t_id: doc._id, \n\t\t\t\tgeoJson: geoValue \n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * Remove a document from the geospatial index\n\t * @param {Object} doc - The document to remove\n\t */\n\tremove(doc) {\n\t\tif (!doc._id) {\n\t\t\treturn;\n\t\t}\n\t\tconst geoValue = getProp(doc, this.geoField);\n\t\tconst coords = this._extractCoordinates(geoValue);\n\t\tif (coords) {\n\t\t\tthis.rtree.remove(coords.lat, coords.lng, { \n\t\t\t\t_id: doc._id, \n\t\t\t\tgeoJson: geoValue \n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * Query the geospatial index\n\t * @param {*} query - The query object\n\t * @returns {Array|null} Array of document IDs or null if query is not a geospatial query\n\t */\n\tquery(query) {\n\t\t// Check if this is a geospatial query on our indexed field\n\t\tif (!query[this.geoField]) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst geoQuery = query[this.geoField];\n\n\t\t// Handle $geoWithin with bounding box\n\t\tif (geoQuery.$geoWithin) {\n\t\t\tconst bbox = geoQuery.$geoWithin;\n\t\t\t// bbox format: [[minLon, maxLat], [maxLon, minLat]]\n\t\t\tif (Array.isArray(bbox) && bbox.length === 2) {\n\t\t\t\tconst minLon = bbox[0][0];\n\t\t\t\tconst maxLat = bbox[0][1];\n\t\t\t\tconst maxLon = bbox[1][0];\n\t\t\t\tconst minLat = bbox[1][1];\n\n\t\t\t\tconst results = this.rtree.searchBBox({\n\t\t\t\t\tminLat: minLat,\n\t\t\t\t\tmaxLat: maxLat,\n\t\t\t\t\tminLng: minLon,\n\t\t\t\t\tmaxLng: maxLon\n\t\t\t\t});\n\n\t\t\t\t// Extract document IDs\n\t\t\t\treturn results.map(entry => entry.data._id);\n\t\t\t}\n\t\t}\n\n\t\t// Handle $near with radius (future enhancement)\n\t\t// if (geoQuery.$near) {\n\t\t//   const center = geoQuery.$near;\n\t\t//   const maxDistance = geoQuery.$maxDistance || 1000; // default 1000km\n\t\t//   // Implementation would use rtree.searchRadius\n\t\t// }\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * Clear all data from the index\n\t */\n\tclear() {\n\t\tthis.rtree.clear();\n\t}\n\n\t/**\n\t * Get index specification\n\t */\n\tgetSpec() {\n\t\treturn {\n\t\t\tname: this.name,\n\t\t\tkey: this.keys,\n\t\t\t'2dsphereIndexVersion': 3\n\t\t};\n\t}\n\n\t/**\n\t * Serialize index state for storage\n\t * @returns {Object} Serializable index state\n\t */\n\tserialize() {\n\t\treturn {\n\t\t\ttype: 'geospatial',\n\t\t\tkeys: this.keys,\n\t\t\toptions: this.options,\n\t\t\tgeoField: this.geoField,\n\t\t\trtreeState: this.rtree.serialize()\n\t\t};\n\t}\n\n\t/**\n\t * Restore index state from serialized data\n\t * @param {Object} state - Serialized index state\n\t */\n\tdeserialize(state) {\n\t\tthis.geoField = state.geoField;\n\t\tif (state.rtreeState) {\n\t\t\tthis.rtree.deserialize(state.rtreeState);\n\t\t}\n\t}\n}\n","import { Cursor } from './Cursor.js';\nimport { SortedCursor } from './SortedCursor.js';\nimport { isArray, getProp, applyProjection, copy } from './utils.js';\nimport { matches } from './queryMatcher.js';\nimport { applyUpdates, createDocFromUpdate } from './updates.js';\nimport { RegularCollectionIndex } from './RegularCollectionIndex.js';\nimport { TextCollectionIndex } from './TextCollectionIndex.js';\nimport { GeospatialCollectionIndex } from './GeospatialCollectionIndex.js';\n\n/**\n * Collection class\n */\nexport class Collection {\n\tconstructor(db, storage, idGenerator) {\n\t\tthis.db = db;\n\t\tthis.storage = storage;\n\t\tthis.idGenerator = idGenerator;\n\t\tthis.indexes = {}; // Index storage - map of index name to index structure\n\t\tthis.isCollection = true; // TODO used by dropDatabase, ugly\n\t}\n\n\t/**\n\t * Generate index name from keys\n\t */\n\tgenerateIndexName(keys) {\n\t\tconst parts = [];\n\t\tfor (const field in keys) {\n\t\t\tif (keys.hasOwnProperty(field)) {\n\t\t\t\tparts.push(field + '_' + keys[field]);\n\t\t\t}\n\t\t}\n\t\treturn parts.join('_');\n\t}\n\n\t/**\n\t * Determine if keys specify a text index\n\t */\n\tisTextIndex(keys) {\n\t\tfor (const field in keys) {\n\t\t\tif (keys[field] === 'text') {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t * Determine if keys specify a geospatial index\n\t */\n\tisGeospatialIndex(keys) {\n\t\tfor (const field in keys) {\n\t\t\tif (keys[field] === '2dsphere' || keys[field] === '2d') {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t * Build/rebuild an index\n\t */\n\tbuildIndex(indexName, keys, options = {}) {\n\t\tlet index;\n\t\t\n\t\t// Create appropriate index type\n\t\tif (this.isTextIndex(keys)) {\n\t\t\tindex = new TextCollectionIndex(keys, { ...options, name: indexName });\n\t\t} else if (this.isGeospatialIndex(keys)) {\n\t\t\tindex = new GeospatialCollectionIndex(keys, { ...options, name: indexName });\n\t\t} else {\n\t\t\tindex = new RegularCollectionIndex(keys, { ...options, name: indexName });\n\t\t}\n\n\t\t// Build index by scanning all documents\n\t\tfor (let i = 0; i < this.storage.size(); i++) {\n\t\t\tconst doc = this.storage.get(i);\n\t\t\tif (doc) {\n\t\t\t\tindex.add(doc);\n\t\t\t}\n\t\t}\n\n\t\tthis.indexes[indexName] = index;\n\t\treturn index;\n\t}\n\n\t/**\n\t * Update indexes when a document is inserted\n\t */\n\tupdateIndexesOnInsert(doc) {\n\t\tfor (const indexName in this.indexes) {\n\t\t\tif (this.indexes.hasOwnProperty(indexName)) {\n\t\t\t\tconst index = this.indexes[indexName];\n\t\t\t\tindex.add(doc);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Update indexes when a document is deleted\n\t */\n\tupdateIndexesOnDelete(doc) {\n\t\tfor (const indexName in this.indexes) {\n\t\t\tif (this.indexes.hasOwnProperty(indexName)) {\n\t\t\t\tconst index = this.indexes[indexName];\n\t\t\t\tindex.remove(doc);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Query planner - analyze query and determine if an index can be used\n\t */\n\tplanQuery(query) {\n\t\t// Simple query planner - look for equality queries on indexed fields\n\t\tconst queryKeys = Object.keys(query);\n\n\t\tfor (const indexName in this.indexes) {\n\t\t\tif (this.indexes.hasOwnProperty(indexName)) {\n\t\t\t\tconst index = this.indexes[indexName];\n\t\t\t\t\n\t\t\t\t// Skip text indexes - they are handled separately\n\t\t\t\tif (index instanceof TextCollectionIndex) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// Try geospatial indexes\n\t\t\t\tif (index instanceof GeospatialCollectionIndex) {\n\t\t\t\t\tconst docIds = index.query(query);\n\t\t\t\t\tif (docIds !== null) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tuseIndex: true,\n\t\t\t\t\t\t\tindexName: indexName,\n\t\t\t\t\t\t\tdocIds: docIds\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tconst indexFields = Object.keys(index.keys);\n\n\t\t\t\t// Check if query matches index (simple case: single field equality)\n\t\t\t\t// Note: Compound indexes are created but only single-field equality queries use them\n\t\t\t\tif (indexFields.length === 1) {\n\t\t\t\t\tconst field = indexFields[0];\n\t\t\t\t\t// Check for simple equality\n\t\t\t\t\tif (queryKeys.indexOf(field) !== -1) {\n\t\t\t\t\t\tconst queryValue = query[field];\n\t\t\t\t\t\t// Only use index for simple equality (not operators like $gt, $lt, etc.)\n\t\t\t\t\t\tif (typeof queryValue !== 'object' || queryValue === null) {\n\t\t\t\t\t\t\tconst docIds = index.query(query);\n\t\t\t\t\t\t\tif (docIds !== null) {\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\tuseIndex: true,\n\t\t\t\t\t\t\t\t\tindexName: indexName,\n\t\t\t\t\t\t\t\t\tdocIds: docIds\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * Get a text index for the given field\n\t * @param {string} field - The field name\n\t * @returns {TextCollectionIndex|null} The text index or null if not found\n\t */\n\tgetTextIndex(field) {\n\t\tfor (const indexName in this.indexes) {\n\t\t\tif (this.indexes.hasOwnProperty(indexName)) {\n\t\t\t\tconst index = this.indexes[indexName];\n\t\t\t\tif (index instanceof TextCollectionIndex) {\n\t\t\t\t\t// Check if this field is indexed\n\t\t\t\t\tif (index.indexedFields.includes(field)) {\n\t\t\t\t\t\treturn index;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\t// Collection methods\n\taggregate(pipeline) {\n\t\tif (!pipeline || !isArray(pipeline)) {\n\t\t\tthrow { $err: \"Pipeline must be an array\", code: 17287 };\n\t\t}\n\n\t\t// Start with all documents\n\t\tlet results = [];\n\t\tconst cursor = this.find({});\n\t\twhile (cursor.hasNext()) {\n\t\t\tresults.push(cursor.next());\n\t\t}\n\n\t\t// Process each stage in the pipeline\n\t\tfor (let i = 0; i < pipeline.length; i++) {\n\t\t\tconst stage = pipeline[i];\n\t\t\tconst stageKeys = Object.keys(stage);\n\t\t\tif (stageKeys.length !== 1) {\n\t\t\t\tthrow { $err: \"Each pipeline stage must have exactly one key\", code: 17287 };\n\t\t\t}\n\t\t\tconst stageType = stageKeys[0];\n\t\t\tconst stageSpec = stage[stageType];\n\n\t\t\tif (stageType === \"$match\") {\n\t\t\t\t// Filter documents based on query\n\t\t\t\tconst matched = [];\n\t\t\t\tfor (let j = 0; j < results.length; j++) {\n\t\t\t\t\tif (matches(results[j], stageSpec)) {\n\t\t\t\t\t\tmatched.push(results[j]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tresults = matched;\n\t\t\t} else if (stageType === \"$project\") {\n\t\t\t\t// Reshape documents\n\t\t\t\tconst projected = [];\n\t\t\t\tfor (let j = 0; j < results.length; j++) {\n\t\t\t\t\tprojected.push(applyProjection(stageSpec, results[j]));\n\t\t\t\t}\n\t\t\t\tresults = projected;\n\t\t\t} else if (stageType === \"$sort\") {\n\t\t\t\t// Sort documents\n\t\t\t\tconst sortKeys = Object.keys(stageSpec);\n\t\t\t\tresults.sort(function (a, b) {\n\t\t\t\t\tfor (let k = 0; k < sortKeys.length; k++) {\n\t\t\t\t\t\tconst key = sortKeys[k];\n\t\t\t\t\t\tif (a[key] === undefined && b[key] !== undefined) return -1 * stageSpec[key];\n\t\t\t\t\t\tif (a[key] !== undefined && b[key] === undefined) return 1 * stageSpec[key];\n\t\t\t\t\t\tif (a[key] < b[key]) return -1 * stageSpec[key];\n\t\t\t\t\t\tif (a[key] > b[key]) return 1 * stageSpec[key];\n\t\t\t\t\t}\n\t\t\t\t\treturn 0;\n\t\t\t\t});\n\t\t\t} else if (stageType === \"$limit\") {\n\t\t\t\t// Limit number of documents\n\t\t\t\tresults = results.slice(0, stageSpec);\n\t\t\t} else if (stageType === \"$skip\") {\n\t\t\t\t// Skip documents\n\t\t\t\tresults = results.slice(stageSpec);\n\t\t\t} else if (stageType === \"$group\") {\n\t\t\t\t// Group documents\n\t\t\t\tconst groups = {};\n\t\t\t\tconst groupId = stageSpec._id;\n\n\t\t\t\tfor (let j = 0; j < results.length; j++) {\n\t\t\t\t\tconst doc = results[j];\n\t\t\t\t\tlet key;\n\n\t\t\t\t\t// Compute group key\n\t\t\t\t\tif (groupId === null || groupId === undefined) {\n\t\t\t\t\t\tkey = null;\n\t\t\t\t\t} else if (typeof groupId === 'string' && groupId.charAt(0) === '$') {\n\t\t\t\t\t\t// Field reference\n\t\t\t\t\t\tkey = getProp(doc, groupId.substring(1));\n\t\t\t\t\t} else if (typeof groupId === 'object') {\n\t\t\t\t\t\t// Computed key\n\t\t\t\t\t\tkey = JSON.stringify(groupId);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tkey = groupId;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst keyStr = JSON.stringify(key);\n\n\t\t\t\t\t// Initialize group\n\t\t\t\t\tif (!groups[keyStr]) {\n\t\t\t\t\t\tgroups[keyStr] = {\n\t\t\t\t\t\t\t_id: key,\n\t\t\t\t\t\t\tdocs: [],\n\t\t\t\t\t\t\taccumulators: {}\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\n\t\t\t\t\tgroups[keyStr].docs.push(doc);\n\t\t\t\t}\n\n\t\t\t\t// Apply accumulators\n\t\t\t\tconst grouped = [];\n\t\t\t\tfor (const groupKey in groups) {\n\t\t\t\t\tconst group = groups[groupKey];\n\t\t\t\t\tconst result = { _id: group._id };\n\n\t\t\t\t\t// Process each accumulator field\n\t\t\t\t\tfor (const field in stageSpec) {\n\t\t\t\t\t\tif (field === '_id') continue;\n\n\t\t\t\t\t\tconst accumulator = stageSpec[field];\n\t\t\t\t\t\tconst accKeys = Object.keys(accumulator);\n\t\t\t\t\t\tif (accKeys.length !== 1) continue;\n\n\t\t\t\t\t\tconst accType = accKeys[0];\n\t\t\t\t\t\tconst accExpr = accumulator[accType];\n\n\t\t\t\t\t\tif (accType === '$sum') {\n\t\t\t\t\t\t\tlet sum = 0;\n\t\t\t\t\t\t\tfor (let k = 0; k < group.docs.length; k++) {\n\t\t\t\t\t\t\t\tif (typeof accExpr === 'number') {\n\t\t\t\t\t\t\t\t\tsum += accExpr;\n\t\t\t\t\t\t\t\t} else if (typeof accExpr === 'string' && accExpr.charAt(0) === '$') {\n\t\t\t\t\t\t\t\t\tconst val = getProp(group.docs[k], accExpr.substring(1));\n\t\t\t\t\t\t\t\t\tsum += val || 0;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tresult[field] = sum;\n\t\t\t\t\t\t} else if (accType === '$avg') {\n\t\t\t\t\t\t\tlet sum = 0;\n\t\t\t\t\t\t\tlet count = 0;\n\t\t\t\t\t\t\tfor (let k = 0; k < group.docs.length; k++) {\n\t\t\t\t\t\t\t\tif (typeof accExpr === 'string' && accExpr.charAt(0) === '$') {\n\t\t\t\t\t\t\t\t\tconst val = getProp(group.docs[k], accExpr.substring(1));\n\t\t\t\t\t\t\t\t\tif (val !== undefined && val !== null) {\n\t\t\t\t\t\t\t\t\t\tsum += val;\n\t\t\t\t\t\t\t\t\t\tcount++;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tresult[field] = count > 0 ? sum / count : 0;\n\t\t\t\t\t\t} else if (accType === '$min') {\n\t\t\t\t\t\t\tlet min = undefined;\n\t\t\t\t\t\t\tfor (let k = 0; k < group.docs.length; k++) {\n\t\t\t\t\t\t\t\tif (typeof accExpr === 'string' && accExpr.charAt(0) === '$') {\n\t\t\t\t\t\t\t\t\tconst val = getProp(group.docs[k], accExpr.substring(1));\n\t\t\t\t\t\t\t\t\tif (val !== undefined && (min === undefined || val < min)) {\n\t\t\t\t\t\t\t\t\t\tmin = val;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tresult[field] = min;\n\t\t\t\t\t\t} else if (accType === '$max') {\n\t\t\t\t\t\t\tlet max = undefined;\n\t\t\t\t\t\t\tfor (let k = 0; k < group.docs.length; k++) {\n\t\t\t\t\t\t\t\tif (typeof accExpr === 'string' && accExpr.charAt(0) === '$') {\n\t\t\t\t\t\t\t\t\tconst val = getProp(group.docs[k], accExpr.substring(1));\n\t\t\t\t\t\t\t\t\tif (val !== undefined && (max === undefined || val > max)) {\n\t\t\t\t\t\t\t\t\t\tmax = val;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tresult[field] = max;\n\t\t\t\t\t\t} else if (accType === '$push') {\n\t\t\t\t\t\t\tconst arr = [];\n\t\t\t\t\t\t\tfor (let k = 0; k < group.docs.length; k++) {\n\t\t\t\t\t\t\t\tif (typeof accExpr === 'string' && accExpr.charAt(0) === '$') {\n\t\t\t\t\t\t\t\t\tconst val = getProp(group.docs[k], accExpr.substring(1));\n\t\t\t\t\t\t\t\t\tarr.push(val);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tresult[field] = arr;\n\t\t\t\t\t\t} else if (accType === '$addToSet') {\n\t\t\t\t\t\t\tconst set = {};\n\t\t\t\t\t\t\tfor (let k = 0; k < group.docs.length; k++) {\n\t\t\t\t\t\t\t\tif (typeof accExpr === 'string' && accExpr.charAt(0) === '$') {\n\t\t\t\t\t\t\t\t\tconst val = getProp(group.docs[k], accExpr.substring(1));\n\t\t\t\t\t\t\t\t\tset[JSON.stringify(val)] = val;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst arr = [];\n\t\t\t\t\t\t\tfor (const valKey in set) {\n\t\t\t\t\t\t\t\tarr.push(set[valKey]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tresult[field] = arr;\n\t\t\t\t\t\t} else if (accType === '$first') {\n\t\t\t\t\t\t\tif (group.docs.length > 0) {\n\t\t\t\t\t\t\t\tif (typeof accExpr === 'string' && accExpr.charAt(0) === '$') {\n\t\t\t\t\t\t\t\t\tresult[field] = getProp(group.docs[0], accExpr.substring(1));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (accType === '$last') {\n\t\t\t\t\t\t\tif (group.docs.length > 0) {\n\t\t\t\t\t\t\t\tif (typeof accExpr === 'string' && accExpr.charAt(0) === '$') {\n\t\t\t\t\t\t\t\t\tresult[field] = getProp(group.docs[group.docs.length - 1], accExpr.substring(1));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tgrouped.push(result);\n\t\t\t\t}\n\t\t\t\tresults = grouped;\n\t\t\t} else if (stageType === \"$count\") {\n\t\t\t\t// Count documents and return single document with count\n\t\t\t\tresults = [{ [stageSpec]: results.length }];\n\t\t\t} else if (stageType === \"$unwind\") {\n\t\t\t\t// Unwind array field\n\t\t\t\tconst unwound = [];\n\t\t\t\tlet fieldPath = stageSpec;\n\t\t\t\tif (typeof fieldPath === 'string' && fieldPath.charAt(0) === '$') {\n\t\t\t\t\tfieldPath = fieldPath.substring(1);\n\t\t\t\t}\n\n\t\t\t\tfor (let j = 0; j < results.length; j++) {\n\t\t\t\t\tconst doc = results[j];\n\t\t\t\t\tconst arr = getProp(doc, fieldPath);\n\n\t\t\t\t\tif (arr && isArray(arr) && arr.length > 0) {\n\t\t\t\t\t\tfor (let k = 0; k < arr.length; k++) {\n\t\t\t\t\t\t\tconst unwoundDoc = copy(doc);\n\t\t\t\t\t\t\t// Set the unwound value\n\t\t\t\t\t\t\tconst parts = fieldPath.split('.');\n\t\t\t\t\t\t\tlet target = unwoundDoc;\n\t\t\t\t\t\t\tfor (let l = 0; l < parts.length - 1; l++) {\n\t\t\t\t\t\t\t\tif (!target[parts[l]]) {\n\t\t\t\t\t\t\t\t\ttarget[parts[l]] = {};\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\ttarget = target[parts[l]];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttarget[parts[parts.length - 1]] = arr[k];\n\t\t\t\t\t\t\tunwound.push(unwoundDoc);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// MongoDB's default behavior: skip documents where field is missing, null, empty array, or not an array\n\t\t\t\t}\n\t\t\t\tresults = unwound;\n\t\t\t} else {\n\t\t\t\tthrow { $err: \"Unsupported aggregation stage: \" + stageType, code: 17287 };\n\t\t\t}\n\t\t}\n\n\t\treturn results;\n\t}\n\n\tbulkWrite() { throw \"Not Implemented\"; }\n\n\tasync count() {\n\t\treturn this.storage.size();\n\t}\n\n\tasync copyTo(destCollectionName) {\n\t\tif (!this.db[destCollectionName]) {\n\t\t\tthis.db.createCollection(destCollectionName);\n\t\t}\n\t\tconst destCol = this.db[destCollectionName];\n\t\tlet numCopied = 0;\n\t\tconst c = this.find({});\n\t\twhile (c.hasNext()) {\n\t\t\tawait destCol.insertOne(c.next());\n\t\t\tnumCopied++;\n\t\t}\n\t\treturn numCopied;\n\t}\n\n\tasync createIndex(keys, options) {\n\t\t// MongoDB-compliant createIndex\n\t\t// keys: { fieldName: 1 } for ascending, { fieldName: -1 } for descending, { fieldName: 'text' } for text\n\t\t// options: { name: \"indexName\", unique: true, ... }\n\n\t\tif (!keys || typeof keys !== 'object' || Array.isArray(keys)) {\n\t\t\tthrow { $err: \"createIndex requires a key specification object\", code: 2 };\n\t\t}\n\n\t\tconst indexName = (options && options.name) ? options.name : this.generateIndexName(keys);\n\n\t\t// Check if index already exists\n\t\tif (this.indexes[indexName]) {\n\t\t\t// MongoDB checks for key specification conflicts\n\t\t\tconst existingIndex = this.indexes[indexName];\n\t\t\tconst existingKeys = JSON.stringify(existingIndex.keys);\n\t\t\tconst newKeys = JSON.stringify(keys);\n\t\t\tif (existingKeys !== newKeys) {\n\t\t\t\tthrow { $err: \"Index with name '\" + indexName + \"' already exists with a different key specification\", code: 85 };\n\t\t\t}\n\t\t\t// Same index, return without error\n\t\t\treturn indexName;\n\t\t}\n\n\t\t// Build the index\n\t\tthis.buildIndex(indexName, keys, options);\n\n\t\treturn indexName;\n\t}\n\n\tdataSize() { throw \"Not Implemented\"; }\n\n\tasync deleteOne(query) {\n\t\tconst doc = await this.findOne(query);\n\t\tif (doc) {\n\t\t\tthis.updateIndexesOnDelete(doc);\n\t\t\tthis.storage.remove(doc._id);\n\t\t\treturn { deletedCount: 1 };\n\t\t} else {\n\t\t\treturn { deletedCount: 0 };\n\t\t}\n\t}\n\n\tasync deleteMany(query) {\n\t\tconst c = this.find(query);\n\t\tconst ids = [];\n\t\tconst docs = [];\n\t\twhile (c.hasNext()) {\n\t\t\tconst doc = c.next();\n\t\t\tids.push(doc._id);\n\t\t\tdocs.push(doc);\n\t\t}\n\t\tconst deletedCount = ids.length;\n\t\tfor (let i = 0; i < ids.length; i++) {\n\t\t\tthis.updateIndexesOnDelete(docs[i]);\n\t\t\tthis.storage.remove(ids[i]);\n\t\t}\n\t\treturn { deletedCount: deletedCount };\n\t}\n\n\tasync distinct(field, query) {\n\t\tconst vals = {};\n\t\tconst c = this.find(query);\n\t\twhile (c.hasNext()) {\n\t\t\tconst d = c.next();\n\t\t\tif (d[field]) {\n\t\t\t\tvals[d[field]] = true;\n\t\t\t}\n\t\t}\n\t\treturn Object.keys(vals);\n\t}\n\n\tdrop() {\n\t\tthis.storage.clear();\n\t\t// Clear all indexes\n\t\tfor (const indexName in this.indexes) {\n\t\t\tif (this.indexes.hasOwnProperty(indexName)) {\n\t\t\t\tthis.indexes[indexName].clear();\n\t\t\t}\n\t\t}\n\t}\n\n\tdropIndex(indexName) {\n\t\tif (!this.indexes[indexName]) {\n\t\t\tthrow { $err: \"Index not found with name: \" + indexName, code: 27 };\n\t\t}\n\t\tthis.indexes[indexName].clear();\n\t\tdelete this.indexes[indexName];\n\t\treturn { nIndexesWas: Object.keys(this.indexes).length + 1, ok: 1 };\n\t}\n\n\tdropIndexes() {\n\t\tconst count = Object.keys(this.indexes).length;\n\t\tfor (const indexName in this.indexes) {\n\t\t\tif (this.indexes.hasOwnProperty(indexName)) {\n\t\t\t\tthis.indexes[indexName].clear();\n\t\t\t}\n\t\t}\n\t\tthis.indexes = {};\n\t\treturn { nIndexesWas: count, msg: \"non-_id indexes dropped\", ok: 1 };\n\t}\n\tensureIndex() { throw \"Not Implemented\"; }\n\texplain() { throw \"Not Implemented\"; }\n\n\tfind(query, projection) {\n\t\treturn new Cursor(\n\t\t\tthis,\n\t\t\t(query == undefined ? {} : query),\n\t\t\tprojection,\n\t\t\tmatches,\n\t\t\tthis.storage,\n\t\t\tthis.indexes,\n\t\t\tthis.planQuery.bind(this),\n\t\t\tSortedCursor\n\t\t);\n\t}\n\n\tfindAndModify() { throw \"Not Implemented\"; }\n\n\tasync findOne(query, projection) {\n\t\tconst cursor = this.find(query, projection);\n\t\tif (cursor.hasNext()) {\n\t\t\treturn cursor.next();\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tasync findOneAndDelete(filter, options) {\n\t\tlet c = this.find(filter);\n\t\tif (options && options.sort) c = c.sort(options.sort);\n\t\tif (!c.hasNext()) return null;\n\t\tconst doc = c.next();\n\t\tthis.storage.remove(doc._id);\n\t\tif (options && options.projection) return applyProjection(options.projection, doc);\n\t\telse return doc;\n\t}\n\n\tasync findOneAndReplace(filter, replacement, options) {\n\t\tlet c = this.find(filter);\n\t\tif (options && options.sort) c = c.sort(options.sort);\n\t\tif (!c.hasNext()) return null;\n\t\tconst doc = c.next();\n\t\treplacement._id = doc._id;\n\t\tthis.storage.set(doc._id, replacement);\n\t\tif (options && options.returnNewDocument) {\n\t\t\tif (options && options.projection) return applyProjection(options.projection, replacement);\n\t\t\telse return replacement;\n\t\t} else {\n\t\t\tif (options && options.projection) return applyProjection(options.projection, doc);\n\t\t\telse return doc;\n\t\t}\n\t}\n\n\tasync findOneAndUpdate(filter, update, options) {\n\t\tlet c = this.find(filter);\n\t\tif (options && options.sort) c = c.sort(options.sort);\n\t\tif (!c.hasNext()) return null;\n\t\tconst doc = c.next();\n\t\tconst clone = Object.assign({}, doc);\n\t\tapplyUpdates(update, clone);\n\t\tthis.storage.set(doc._id, clone);\n\t\tif (options && options.returnNewDocument) {\n\t\t\tif (options && options.projection) return applyProjection(options.projection, clone);\n\t\t\telse return clone;\n\t\t} else {\n\t\t\tif (options && options.projection) return applyProjection(options.projection, doc);\n\t\t\telse return doc;\n\t\t}\n\t}\n\n\tgetIndexes() {\n\t\t// Return array of index specifications\n\t\tconst result = [];\n\t\tfor (const indexName in this.indexes) {\n\t\t\tif (this.indexes.hasOwnProperty(indexName)) {\n\t\t\t\tresult.push(this.indexes[indexName].getSpec());\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tgetShardDistribution() { throw \"Not Implemented\"; }\n\tgetShardVersion() { throw \"Not Implemented\"; }\n\n\t// non-mongo\n\tgetStore() {\n\t\treturn this.storage.getStore();\n\t}\n\n\tgroup() { throw \"Not Implemented\"; }\n\n\tasync insert(doc) {\n\t\tif (Array == doc.constructor) {\n\t\t\treturn await this.insertMany(doc);\n\t\t} else {\n\t\t\treturn await this.insertOne(doc);\n\t\t}\n\t}\n\n\tasync insertOne(doc) {\n\t\tif (doc._id == undefined) doc._id = this.idGenerator();\n\t\tthis.storage.set(doc._id, doc);\n\t\tthis.updateIndexesOnInsert(doc);\n\t\treturn { insertedId: doc._id };\n\t}\n\n\tasync insertMany(docs) {\n\t\tconst insertedIds = [];\n\t\tfor (let i = 0; i < docs.length; i++) {\n\t\t\tconst result = await this.insertOne(docs[i]);\n\t\t\tinsertedIds.push(result.insertedId);\n\t\t}\n\t\treturn { insertedIds: insertedIds };\n\t}\n\n\tisCapped() { throw \"Not Implemented\"; }\n\tmapReduce() { throw \"Not Implemented\"; }\n\treIndex() { throw \"Not Implemented\"; }\n\n\tasync replaceOne(query, replacement, options) { // only replace\n\t\t// first\n\t\tconst result = {};\n\t\tconst c = this.find(query);\n\t\tresult.matchedCount = c.count();\n\t\tif (result.matchedCount == 0) {\n\t\t\tresult.modifiedCount = 0;\n\t\t\tif (options && options.upsert) {\n\t\t\t\tconst newDoc = replacement;\n\t\t\t\tnewDoc._id = this.idGenerator();\n\t\t\t\tthis.storage.set(newDoc._id, newDoc);\n\t\t\t\tresult.upsertedId = newDoc._id;\n\t\t\t}\n\t\t} else {\n\t\t\tresult.modifiedCount = 1;\n\t\t\tconst doc = c.next();\n\t\t\tthis.updateIndexesOnDelete(doc);\n\t\t\treplacement._id = doc._id;\n\t\t\tthis.storage.set(doc._id, replacement);\n\t\t\tthis.updateIndexesOnInsert(replacement);\n\t\t}\n\t\treturn result;\n\t}\n\n\tremove(query, options) {\n\t\tconst c = this.find(query);\n\t\tif (!c.hasNext()) return;\n\t\tif (options === true || (options && options.justOne)) {\n\t\t\tconst doc = c.next();\n\t\t\tthis.updateIndexesOnDelete(doc);\n\t\t\tthis.storage.remove(doc._id);\n\t\t} else {\n\t\t\twhile (c.hasNext()) {\n\t\t\t\tconst doc = c.next();\n\t\t\t\tthis.updateIndexesOnDelete(doc);\n\t\t\t\tthis.storage.remove(doc._id);\n\t\t\t}\n\t\t}\n\t}\n\n\trenameCollection() { throw \"Not Implemented\"; }\n\tsave() { throw \"Not Implemented\"; }\n\tstats() { throw \"Not Implemented\"; }\n\tstorageSize() { throw \"Not Implemented\"; }\n\ttotalSize() { throw \"Not Implemented\"; }\n\ttotalIndexSize() { throw \"Not Implemented\"; }\n\n\tupdate(query, updates, options) {\n\t\tconst c = this.find(query);\n\t\tif (c.hasNext()) {\n\t\t\tif (options && options.multi) {\n\t\t\t\twhile (c.hasNext()) {\n\t\t\t\t\tconst doc = c.next();\n\t\t\t\t\tthis.updateIndexesOnDelete(doc);\n\t\t\t\t\tapplyUpdates(updates, doc);\n\t\t\t\t\tthis.storage.set(doc._id, doc);\n\t\t\t\t\tthis.updateIndexesOnInsert(doc);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst doc = c.next();\n\t\t\t\tthis.updateIndexesOnDelete(doc);\n\t\t\t\tapplyUpdates(updates, doc);\n\t\t\t\tthis.storage.set(doc._id, doc);\n\t\t\t\tthis.updateIndexesOnInsert(doc);\n\t\t\t}\n\t\t} else {\n\t\t\tif (options && options.upsert) {\n\t\t\t\tconst newDoc = createDocFromUpdate(query, updates, this.idGenerator);\n\t\t\t\tthis.storage.set(newDoc._id, newDoc);\n\t\t\t\tthis.updateIndexesOnInsert(newDoc);\n\t\t\t}\n\t\t}\n\t}\n\n\tasync updateOne(query, updates, options) {\n\t\tconst c = this.find(query);\n\t\tif (c.hasNext()) {\n\t\t\tconst doc = c.next();\n\t\t\tthis.updateIndexesOnDelete(doc);\n\t\t\tapplyUpdates(updates, doc);\n\t\t\tthis.storage.set(doc._id, doc);\n\t\t\tthis.updateIndexesOnInsert(doc);\n\t\t} else {\n\t\t\tif (options && options.upsert) {\n\t\t\t\tconst newDoc = createDocFromUpdate(query, updates, this.idGenerator);\n\t\t\t\tthis.storage.set(newDoc._id, newDoc);\n\t\t\t\tthis.updateIndexesOnInsert(newDoc);\n\t\t\t}\n\t\t}\n\t}\n\n\tasync updateMany(query, updates, options) {\n\t\tconst c = this.find(query);\n\t\tif (c.hasNext()) {\n\t\t\twhile (c.hasNext()) {\n\t\t\t\tconst doc = c.next();\n\t\t\t\tthis.updateIndexesOnDelete(doc);\n\t\t\t\tapplyUpdates(updates, doc);\n\t\t\t\tthis.storage.set(doc._id, doc);\n\t\t\t\tthis.updateIndexesOnInsert(doc);\n\t\t\t}\n\t\t} else {\n\t\t\tif (options && options.upsert) {\n\t\t\t\tconst newDoc = createDocFromUpdate(query, updates, this.idGenerator);\n\t\t\t\tthis.storage.set(newDoc._id, newDoc);\n\t\t\t\tthis.updateIndexesOnInsert(newDoc);\n\t\t\t}\n\t\t}\n\t}\n\n\tvalidate() { throw \"Not Implemented\"; }\n\n\t/**\n\t * Export collection state for storage\n\t * @returns {Object} Collection state including documents and indexes\n\t */\n\texportState() {\n\t\t// Export all documents\n\t\tconst documents = [];\n\t\tfor (let i = 0; i < this.storage.size(); i++) {\n\t\t\tconst doc = this.storage.get(i);\n\t\t\tif (doc) {\n\t\t\t\tdocuments.push(doc);\n\t\t\t}\n\t\t}\n\n\t\t// Export all indexes\n\t\tconst indexes = [];\n\t\tfor (const indexName in this.indexes) {\n\t\t\tif (this.indexes.hasOwnProperty(indexName)) {\n\t\t\t\tconst index = this.indexes[indexName];\n\t\t\t\tindexes.push(index.serialize());\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tdocuments: documents,\n\t\t\tindexes: indexes\n\t\t};\n\t}\n\n\t/**\n\t * Import collection state from storage\n\t * @param {Object} state - Collection state including documents and indexes\n\t */\n\tasync importState(state) {\n\t\t// Clear existing data\n\t\tthis.storage.clear();\n\t\tfor (const indexName in this.indexes) {\n\t\t\tif (this.indexes.hasOwnProperty(indexName)) {\n\t\t\t\tthis.indexes[indexName].clear();\n\t\t\t}\n\t\t}\n\t\tthis.indexes = {};\n\n\t\t// Import documents\n\t\tif (state.documents && Array.isArray(state.documents)) {\n\t\t\tfor (const doc of state.documents) {\n\t\t\t\tthis.storage.set(doc._id, doc);\n\t\t\t}\n\t\t}\n\n\t\t// Import indexes\n\t\tif (state.indexes && Array.isArray(state.indexes)) {\n\t\t\tfor (const indexState of state.indexes) {\n\t\t\t\t// Recreate the index based on its type\n\t\t\t\tlet index;\n\t\t\t\tif (indexState.type === 'text') {\n\t\t\t\t\tindex = new TextCollectionIndex(indexState.keys, indexState.options);\n\t\t\t\t\tindex.deserialize(indexState);\n\t\t\t\t} else if (indexState.type === 'geospatial') {\n\t\t\t\t\tindex = new GeospatialCollectionIndex(indexState.keys, indexState.options);\n\t\t\t\t\tindex.deserialize(indexState);\n\t\t\t\t} else {\n\t\t\t\t\t// Default to regular index\n\t\t\t\t\tindex = new RegularCollectionIndex(indexState.keys, indexState.options);\n\t\t\t\t\tindex.deserialize(indexState);\n\t\t\t\t}\n\t\t\t\tthis.indexes[index.name] = index;\n\t\t\t}\n\t\t}\n\t}\n}\n","/**\n * Abstract base class for storage engines\n * Defines the interface for storing and retrieving database state\n */\nexport class StorageEngine {\n\tconstructor() {\n\t\tif (new.target === StorageEngine) {\n\t\t\tthrow new TypeError(\"Cannot construct StorageEngine instances directly\");\n\t\t}\n\t}\n\n\t/**\n\t * Initialize the storage engine\n\t * @returns {Promise<void>}\n\t */\n\tasync initialize() {\n\t\tthrow new Error('initialize() must be implemented by subclass');\n\t}\n\n\t/**\n\t * Save the entire database state\n\t * @param {Object} dbState - The database state to save\n\t * @param {string} dbState.name - The database name\n\t * @param {Object} dbState.collections - Map of collection names to collection data\n\t * @returns {Promise<void>}\n\t */\n\tasync saveDatabase(dbState) {\n\t\tthrow new Error('saveDatabase() must be implemented by subclass');\n\t}\n\n\t/**\n\t * Load the entire database state\n\t * @param {string} dbName - The database name\n\t * @returns {Promise<Object|null>} The database state or null if not found\n\t */\n\tasync loadDatabase(dbName) {\n\t\tthrow new Error('loadDatabase() must be implemented by subclass');\n\t}\n\n\t/**\n\t * Save a single collection's state\n\t * @param {string} dbName - The database name\n\t * @param {string} collectionName - The collection name\n\t * @param {Object} collectionState - The collection state to save\n\t * @param {Array} collectionState.documents - The documents in the collection\n\t * @param {Array} collectionState.indexes - The indexes in the collection\n\t * @returns {Promise<void>}\n\t */\n\tasync saveCollection(dbName, collectionName, collectionState) {\n\t\tthrow new Error('saveCollection() must be implemented by subclass');\n\t}\n\n\t/**\n\t * Load a single collection's state\n\t * @param {string} dbName - The database name\n\t * @param {string} collectionName - The collection name\n\t * @returns {Promise<Object|null>} The collection state or null if not found\n\t */\n\tasync loadCollection(dbName, collectionName) {\n\t\tthrow new Error('loadCollection() must be implemented by subclass');\n\t}\n\n\t/**\n\t * Delete a collection\n\t * @param {string} dbName - The database name\n\t * @param {string} collectionName - The collection name\n\t * @returns {Promise<void>}\n\t */\n\tasync deleteCollection(dbName, collectionName) {\n\t\tthrow new Error('deleteCollection() must be implemented by subclass');\n\t}\n\n\t/**\n\t * Delete the entire database\n\t * @param {string} dbName - The database name\n\t * @returns {Promise<void>}\n\t */\n\tasync deleteDatabase(dbName) {\n\t\tthrow new Error('deleteDatabase() must be implemented by subclass');\n\t}\n\n\t/**\n\t * Close/cleanup the storage engine\n\t * @returns {Promise<void>}\n\t */\n\tasync close() {\n\t\tthrow new Error('close() must be implemented by subclass');\n\t}\n}\n","import { StorageEngine } from './StorageEngine.js';\n\n/**\n * In-memory storage engine (default)\n * Does not persist data between sessions\n */\nexport class ObjectStorageEngine extends StorageEngine {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.databases = {};\n\t}\n\n\t/**\n\t * Initialize the storage engine\n\t * @returns {Promise<void>}\n\t */\n\tasync initialize() {\n\t\t// No initialization needed for in-memory storage\n\t}\n\n\t/**\n\t * Save the entire database state\n\t * @param {Object} dbState - The database state to save\n\t * @returns {Promise<void>}\n\t */\n\tasync saveDatabase(dbState) {\n\t\tthis.databases[dbState.name] = JSON.parse(JSON.stringify(dbState));\n\t}\n\n\t/**\n\t * Load the entire database state\n\t * @param {string} dbName - The database name\n\t * @returns {Promise<Object|null>} The database state or null if not found\n\t */\n\tasync loadDatabase(dbName) {\n\t\tif (this.databases[dbName]) {\n\t\t\treturn JSON.parse(JSON.stringify(this.databases[dbName]));\n\t\t}\n\t\treturn null;\n\t}\n\n\t/**\n\t * Save a single collection's state\n\t * @param {string} dbName - The database name\n\t * @param {string} collectionName - The collection name\n\t * @param {Object} collectionState - The collection state to save\n\t * @returns {Promise<void>}\n\t */\n\tasync saveCollection(dbName, collectionName, collectionState) {\n\t\tif (!this.databases[dbName]) {\n\t\t\tthis.databases[dbName] = {\n\t\t\t\tname: dbName,\n\t\t\t\tcollections: {}\n\t\t\t};\n\t\t}\n\t\tthis.databases[dbName].collections[collectionName] = JSON.parse(JSON.stringify(collectionState));\n\t}\n\n\t/**\n\t * Load a single collection's state\n\t * @param {string} dbName - The database name\n\t * @param {string} collectionName - The collection name\n\t * @returns {Promise<Object|null>} The collection state or null if not found\n\t */\n\tasync loadCollection(dbName, collectionName) {\n\t\tif (this.databases[dbName] && this.databases[dbName].collections[collectionName]) {\n\t\t\treturn JSON.parse(JSON.stringify(this.databases[dbName].collections[collectionName]));\n\t\t}\n\t\treturn null;\n\t}\n\n\t/**\n\t * Delete a collection\n\t * @param {string} dbName - The database name\n\t * @param {string} collectionName - The collection name\n\t * @returns {Promise<void>}\n\t */\n\tasync deleteCollection(dbName, collectionName) {\n\t\tif (this.databases[dbName] && this.databases[dbName].collections) {\n\t\t\tdelete this.databases[dbName].collections[collectionName];\n\t\t}\n\t}\n\n\t/**\n\t * Delete the entire database\n\t * @param {string} dbName - The database name\n\t * @returns {Promise<void>}\n\t */\n\tasync deleteDatabase(dbName) {\n\t\tdelete this.databases[dbName];\n\t}\n\n\t/**\n\t * Close/cleanup the storage engine\n\t * @returns {Promise<void>}\n\t */\n\tasync close() {\n\t\t// No cleanup needed for in-memory storage\n\t}\n}\n","import { Collection } from './Collection.js';\nimport { LocalStorageStore, ObjectStore } from '../main.js';\nimport { ObjectId } from './ObjectId.js';\nimport { ObjectStorageEngine } from './ObjectStorageEngine.js';\n\n/**\n * DB class\n */\nexport class DB {\n\tconstructor(options) {\n\t\tthis.options = options || {};\n\t\tthis.dbName = this.options.dbName || 'default';\n\t\t\n\t\t// Initialize storage engine if provided\n\t\tthis.storageEngine = this.options.storageEngine || null;\n\t\t\n\t\t// Initialize localStorage collection if available\n\t\tif (typeof localStorage !== \"undefined\") {\n\t\t\tthis.localStorage = new Collection(\n\t\t\t\tthis,\n\t\t\t\t(this.options.localStorage ? this.options.localStorage : LocalStorageStore),\n\t\t\t\tthis._id.bind(this)\n\t\t\t);\n\t\t} else {\n\t\t\tthis.localStorage = null;\n\t\t}\n\n\t\t// Return a Proxy to enable dynamic collection creation\n\t\treturn new Proxy(this, {\n\t\t\tget(target, property, receiver) {\n\t\t\t\t// If property exists on target (including undefined values), return it\n\t\t\t\tif (property in target) {\n\t\t\t\t\treturn Reflect.get(target, property, receiver);\n\t\t\t\t}\n\n\t\t\t\t// If property is a symbol or special property, return undefined\n\t\t\t\tif (typeof property === 'symbol' || property.startsWith('_')) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\n\t\t\t\t// For collection names, create the collection if it doesn't exist\n\t\t\t\t// Only auto-create if it's a valid collection name and doesn't already exist\n\t\t\t\tif (typeof property === 'string' && property !== 'localStorage') {\n\t\t\t\t\t// Don't auto-create if property was explicitly deleted\n\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(target, property)) {\n\t\t\t\t\t\treturn target[property];\n\t\t\t\t\t}\n\t\t\t\t\t// Auto-create the collection\n\t\t\t\t\ttarget.createCollection(property);\n\t\t\t\t\treturn target[property];\n\t\t\t\t}\n\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Log function\n\t */\n\t_log(msg) {\n\t\tif (this.options && this.options.print) this.options.print(msg);\n\t\telse console.log(msg);\n\t}\n\n\t/**\n\t * ID generator function\n\t */\n\t_id() {\n\t\tif (this.options && this.options.id) return this.options.id();\n\t\telse return new ObjectId();\n\t}\n\n\t// DB Methods\n\tcloneCollection() { throw \"Not Implemented\"; }\n\tcloneDatabase() { throw \"Not Implemented\"; }\n\tcommandHelp() { throw \"Not Implemented\"; }\n\tcopyDatabase() { throw \"Not Implemented\"; }\n\n\tcreateCollection(name) {\n\t\tif (!name) return;\n\t\tif (name == \"localStorage\") {\n\t\t\tthis.localStorage = new Collection(\n\t\t\t\tthis,\n\t\t\t\t(this.options.localStorage ? this.options.localStorage : LocalStorageStore),\n\t\t\t\tthis._id.bind(this)\n\t\t\t);\n\t\t} else {\n\t\t\tthis[name] = new Collection(\n\t\t\t\tthis,\n\t\t\t\t(this.options && this.options.storage ? new this.options.storage() : new ObjectStore()),\n\t\t\t\tthis._id.bind(this)\n\t\t\t);\n\t\t}\n\t}\n\n\tcurrentOp() { throw \"Not Implemented\"; }\n\n\tdropDatabase() {\n\t\tfor (const key in this) {\n\t\t\tif (this[key] != null && this[key].isCollection) {\n\t\t\t\tthis[key].drop(); // drop the contents\n\t\t\t\tdelete this[key];\n\t\t\t}\n\t\t}\n\t}\n\n\teval() { throw \"Not Implemented\"; }\n\tfsyncLock() { throw \"Not Implemented\"; }\n\tfsyncUnlock() { throw \"Not Implemented\"; }\n\tgetCollection() { throw \"Not Implemented\"; }\n\tgetCollectionInfos() { throw \"Not Implemented\"; }\n\n\tgetCollectionNames() {\n\t\tconst names = [];\n\t\tfor (const key in this) {\n\t\t\tif (this[key] != null && this[key].isCollection) {\n\t\t\t\tnames.push(key);\n\t\t\t}\n\t\t}\n\t\treturn names;\n\t}\n\n\tgetLastError() { throw \"Not Implemented\"; }\n\tgetLastErrorObj() { throw \"Not Implemented\"; }\n\tgetLogComponents() { throw \"Not Implemented\"; }\n\tgetMongo() { throw \"Not Implemented\"; }\n\tgetName() { throw \"Not Implemented\"; }\n\tgetPrevError() { throw \"Not Implemented\"; }\n\tgetProfilingLevel() { throw \"Not Implemented\"; }\n\tgetProfilingStatus() { throw \"Not Implemented\"; }\n\tgetReplicationInfo() { throw \"Not Implemented\"; }\n\tgetSiblingDB() { throw \"Not Implemented\"; }\n\n\thelp() {\n\t\tthis._log(\"        help mr                      mapreduce\");\n\t\tthis._log(\"        db.foo.find()                list objects in collection foo\");\n\t\tthis._log(\"        db.foo.find( { a : 1 } )     list objects in foo where a == 1\");\n\t\tthis._log(\"        it                           result of the last line evaluated; use to further iterate\");\n\t}\n\n\thostInfo() { throw \"Not Implemented\"; }\n\tisMaster() { throw \"Not Implemented\"; }\n\tkillOp() { throw \"Not Implemented\"; }\n\tlistCommands() { throw \"Not Implemented\"; }\n\tloadServerScripts() { throw \"Not Implemented\"; }\n\tlogout() { throw \"Not Implemented\"; }\n\tprintCollectionStats() { throw \"Not Implemented\"; }\n\tprintReplicationInfo() { throw \"Not Implemented\"; }\n\tprintShardingStatus() { throw \"Not Implemented\"; }\n\tprintSlaveReplicationInfo() { throw \"Not Implemented\"; }\n\trepairDatabase() { throw \"Not Implemented\"; }\n\tresetError() { throw \"Not Implemented\"; }\n\trunCommand() { throw \"Not Implemented\"; }\n\tserverBuildInfo() { throw \"Not Implemented\"; }\n\tserverCmdLineOpts() { throw \"Not Implemented\"; }\n\tserverStatus() { throw \"Not Implemented\"; }\n\tsetLogLevel() { throw \"Not Implemented\"; }\n\tsetProfilingLevel() { throw \"Not Implemented\"; }\n\tshutdownServer() { throw \"Not Implemented\"; }\n\tstats() { throw \"Not Implemented\"; }\n\tversion() { throw \"Not Implemented\"; }\n\tupgradeCheck() { throw \"Not Implemented\"; }\n\tupgradeCheckAllDBs() { throw \"Not Implemented\"; }\n\n\t/**\n\t * Save database state to storage engine\n\t * @returns {Promise<void>}\n\t */\n\tasync saveToStorage() {\n\t\tif (!this.storageEngine) {\n\t\t\tthrow new Error('No storage engine configured. Pass a storageEngine option when creating the DB.');\n\t\t}\n\n\t\t// Initialize storage engine if needed\n\t\tif (this.storageEngine.initialize) {\n\t\t\tawait this.storageEngine.initialize();\n\t\t}\n\n\t\t// Collect all collections and their states\n\t\tconst collections = {};\n\t\tfor (const key in this) {\n\t\t\tif (this[key] != null && this[key].isCollection) {\n\t\t\t\tcollections[key] = this[key].exportState();\n\t\t\t}\n\t\t}\n\n\t\t// Save to storage engine\n\t\tawait this.storageEngine.saveDatabase({\n\t\t\tname: this.dbName,\n\t\t\tcollections: collections\n\t\t});\n\t}\n\n\t/**\n\t * Load database state from storage engine\n\t * @returns {Promise<void>}\n\t */\n\tasync loadFromStorage() {\n\t\tif (!this.storageEngine) {\n\t\t\tthrow new Error('No storage engine configured. Pass a storageEngine option when creating the DB.');\n\t\t}\n\n\t\t// Initialize storage engine if needed\n\t\tif (this.storageEngine.initialize) {\n\t\t\tawait this.storageEngine.initialize();\n\t\t}\n\n\t\t// Load from storage engine\n\t\tconst dbState = await this.storageEngine.loadDatabase(this.dbName);\n\t\t\n\t\tif (!dbState || !dbState.collections) {\n\t\t\treturn; // No saved state\n\t\t}\n\n\t\t// Drop existing collections\n\t\tthis.dropDatabase();\n\n\t\t// Restore collections\n\t\tfor (const collectionName in dbState.collections) {\n\t\t\tif (dbState.collections.hasOwnProperty(collectionName)) {\n\t\t\t\tthis.createCollection(collectionName);\n\t\t\t\tawait this[collectionName].importState(dbState.collections[collectionName]);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Save a specific collection to storage engine\n\t * @param {string} collectionName - Name of the collection to save\n\t * @returns {Promise<void>}\n\t */\n\tasync saveCollection(collectionName) {\n\t\tif (!this.storageEngine) {\n\t\t\tthrow new Error('No storage engine configured. Pass a storageEngine option when creating the DB.');\n\t\t}\n\n\t\tif (!this[collectionName] || !this[collectionName].isCollection) {\n\t\t\tthrow new Error(`Collection '${collectionName}' does not exist`);\n\t\t}\n\n\t\t// Initialize storage engine if needed\n\t\tif (this.storageEngine.initialize) {\n\t\t\tawait this.storageEngine.initialize();\n\t\t}\n\n\t\tconst collectionState = this[collectionName].exportState();\n\t\tawait this.storageEngine.saveCollection(this.dbName, collectionName, collectionState);\n\t}\n\n\t/**\n\t * Load a specific collection from storage engine\n\t * @param {string} collectionName - Name of the collection to load\n\t * @returns {Promise<void>}\n\t */\n\tasync loadCollection(collectionName) {\n\t\tif (!this.storageEngine) {\n\t\t\tthrow new Error('No storage engine configured. Pass a storageEngine option when creating the DB.');\n\t\t}\n\n\t\t// Initialize storage engine if needed\n\t\tif (this.storageEngine.initialize) {\n\t\t\tawait this.storageEngine.initialize();\n\t\t}\n\n\t\tconst collectionState = await this.storageEngine.loadCollection(this.dbName, collectionName);\n\t\t\n\t\tif (!collectionState) {\n\t\t\treturn; // No saved state for this collection\n\t\t}\n\n\t\t// Create or recreate the collection\n\t\tif (!this[collectionName]) {\n\t\t\tthis.createCollection(collectionName);\n\t\t}\n\n\t\tawait this[collectionName].importState(collectionState);\n\t}\n}\n","\r\nimport { DB } from './DB.js'\r\n// https://mongodb.github.io/node-mongodb-native/6.20/classes/MongoClient.html\r\nexport class MongoClient {\r\n\r\n  constructor(uri, options = {}) {\r\n    this.uri = uri;\r\n    this.options = options;\r\n  }\r\n\r\n  static async connect(uri, options = {}) {\r\n    return new MongoClient(uri, options);\r\n  }\r\n\r\n  db(name, opts = {}) {\r\n    // Merge client options with db-specific options\r\n    const dbOptions = { ...this.options, ...opts, dbName: name };\r\n    return new DB(dbOptions);\r\n  }\r\n\r\n  async close() {\r\n    /* no-op for in-memory */ \r\n  }\r\n}","import { StorageEngine } from './StorageEngine.js';\n\n/**\n * IndexedDB-based storage engine for persistent storage\n * Stores each collection separately in IndexedDB\n */\nexport class IndexedDbStorageEngine extends StorageEngine {\n\tconstructor(dbName = 'micro-mongo') {\n\t\tsuper();\n\t\tthis.dbName = dbName;\n\t\tthis.db = null;\n\t\tthis.indexedDBName = `micro-mongo-${dbName}`;\n\t}\n\n\t/**\n\t * Initialize the IndexedDB connection\n\t * @returns {Promise<void>}\n\t */\n\tasync initialize() {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst request = indexedDB.open(this.indexedDBName, 1);\n\n\t\t\trequest.onerror = () => {\n\t\t\t\treject(new Error('Failed to open IndexedDB: ' + request.error));\n\t\t\t};\n\n\t\t\trequest.onsuccess = () => {\n\t\t\t\tthis.db = request.result;\n\t\t\t\tresolve();\n\t\t\t};\n\n\t\t\trequest.onupgradeneeded = (event) => {\n\t\t\t\tconst db = event.target.result;\n\t\t\t\t\n\t\t\t\t// Create object stores for collections and metadata\n\t\t\t\tif (!db.objectStoreNames.contains('collections')) {\n\t\t\t\t\tdb.createObjectStore('collections', { keyPath: 'name' });\n\t\t\t\t}\n\t\t\t\tif (!db.objectStoreNames.contains('metadata')) {\n\t\t\t\t\tdb.createObjectStore('metadata', { keyPath: 'key' });\n\t\t\t\t}\n\t\t\t};\n\t\t});\n\t}\n\n\t/**\n\t * Save the entire database state\n\t * @param {Object} dbState - The database state to save\n\t * @returns {Promise<void>}\n\t */\n\tasync saveDatabase(dbState) {\n\t\tif (!this.db) {\n\t\t\tawait this.initialize();\n\t\t}\n\n\t\t// Save metadata\n\t\tconst transaction = this.db.transaction(['metadata'], 'readwrite');\n\t\tconst metadataStore = transaction.objectStore('metadata');\n\t\t\n\t\tawait new Promise((resolve, reject) => {\n\t\t\tconst request = metadataStore.put({\n\t\t\t\tkey: 'dbName',\n\t\t\t\tvalue: dbState.name\n\t\t\t});\n\t\t\trequest.onsuccess = () => resolve();\n\t\t\trequest.onerror = () => reject(request.error);\n\t\t});\n\n\t\t// Save each collection\n\t\tfor (const collectionName in dbState.collections) {\n\t\t\tif (dbState.collections.hasOwnProperty(collectionName)) {\n\t\t\t\tawait this.saveCollection(dbState.name, collectionName, dbState.collections[collectionName]);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Load the entire database state\n\t * @param {string} dbName - The database name\n\t * @returns {Promise<Object|null>} The database state or null if not found\n\t */\n\tasync loadDatabase(dbName) {\n\t\tif (!this.db) {\n\t\t\tawait this.initialize();\n\t\t}\n\n\t\tconst transaction = this.db.transaction(['collections'], 'readonly');\n\t\tconst collectionsStore = transaction.objectStore('collections');\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst request = collectionsStore.getAll();\n\t\t\t\n\t\t\trequest.onsuccess = () => {\n\t\t\t\tconst collections = {};\n\t\t\t\tfor (const collectionData of request.result) {\n\t\t\t\t\tcollections[collectionData.name] = {\n\t\t\t\t\t\tdocuments: collectionData.documents || [],\n\t\t\t\t\t\tindexes: collectionData.indexes || []\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tresolve({\n\t\t\t\t\tname: dbName,\n\t\t\t\t\tcollections: collections\n\t\t\t\t});\n\t\t\t};\n\t\t\t\n\t\t\trequest.onerror = () => reject(request.error);\n\t\t});\n\t}\n\n\t/**\n\t * Save a single collection's state\n\t * @param {string} dbName - The database name\n\t * @param {string} collectionName - The collection name\n\t * @param {Object} collectionState - The collection state to save\n\t * @returns {Promise<void>}\n\t */\n\tasync saveCollection(dbName, collectionName, collectionState) {\n\t\tif (!this.db) {\n\t\t\tawait this.initialize();\n\t\t}\n\n\t\tconst transaction = this.db.transaction(['collections'], 'readwrite');\n\t\tconst collectionsStore = transaction.objectStore('collections');\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst request = collectionsStore.put({\n\t\t\t\tname: collectionName,\n\t\t\t\tdocuments: collectionState.documents || [],\n\t\t\t\tindexes: collectionState.indexes || []\n\t\t\t});\n\t\t\t\n\t\t\trequest.onsuccess = () => resolve();\n\t\t\trequest.onerror = () => reject(request.error);\n\t\t});\n\t}\n\n\t/**\n\t * Load a single collection's state\n\t * @param {string} dbName - The database name\n\t * @param {string} collectionName - The collection name\n\t * @returns {Promise<Object|null>} The collection state or null if not found\n\t */\n\tasync loadCollection(dbName, collectionName) {\n\t\tif (!this.db) {\n\t\t\tawait this.initialize();\n\t\t}\n\n\t\tconst transaction = this.db.transaction(['collections'], 'readonly');\n\t\tconst collectionsStore = transaction.objectStore('collections');\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst request = collectionsStore.get(collectionName);\n\t\t\t\n\t\t\trequest.onsuccess = () => {\n\t\t\t\tif (request.result) {\n\t\t\t\t\tresolve({\n\t\t\t\t\t\tdocuments: request.result.documents || [],\n\t\t\t\t\t\tindexes: request.result.indexes || []\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tresolve(null);\n\t\t\t\t}\n\t\t\t};\n\t\t\t\n\t\t\trequest.onerror = () => reject(request.error);\n\t\t});\n\t}\n\n\t/**\n\t * Delete a collection\n\t * @param {string} dbName - The database name\n\t * @param {string} collectionName - The collection name\n\t * @returns {Promise<void>}\n\t */\n\tasync deleteCollection(dbName, collectionName) {\n\t\tif (!this.db) {\n\t\t\tawait this.initialize();\n\t\t}\n\n\t\tconst transaction = this.db.transaction(['collections'], 'readwrite');\n\t\tconst collectionsStore = transaction.objectStore('collections');\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst request = collectionsStore.delete(collectionName);\n\t\t\trequest.onsuccess = () => resolve();\n\t\t\trequest.onerror = () => reject(request.error);\n\t\t});\n\t}\n\n\t/**\n\t * Delete the entire database\n\t * @param {string} dbName - The database name\n\t * @returns {Promise<void>}\n\t */\n\tasync deleteDatabase(dbName) {\n\t\tif (this.db) {\n\t\t\tthis.db.close();\n\t\t\tthis.db = null;\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst request = indexedDB.deleteDatabase(this.indexedDBName);\n\t\t\trequest.onsuccess = () => resolve();\n\t\t\trequest.onerror = () => reject(request.error);\n\t\t});\n\t}\n\n\t/**\n\t * Close/cleanup the storage engine\n\t * @returns {Promise<void>}\n\t */\n\tasync close() {\n\t\tif (this.db) {\n\t\t\tthis.db.close();\n\t\t\tthis.db = null;\n\t\t}\n\t}\n}\n","/**\n * MicroMongoDB - Lightweight MongoDB-compatible database\n * Refactored into separate class files\n */\n\n/**\n * MicroMongoDB.LocalStorageStore\n * \n * Singleton\n */\nexport const LocalStorageStore = (function() {\n\n\treturn {\n\t\tclear : function() {\n\t\t\tlocalStorage.clear();\n\t\t},\n\t\tget : function(i) {\n\t\t\treturn JSON.parse(localStorage.getItem(localStorage.key(i)));\n\t\t},\n\t\tgetStore : function() {\n\t\t\treturn localStorage;\n\t\t},\n\t\tremove : function(key) {\n\t\t\tlocalStorage.removeItem(key);\n\t\t},\n\t\tset : async function(key,val) {\n\t\t\tlocalStorage.setItem(key,JSON.stringify(val));\n\t\t},\n\t\tsize : function() {\n\t\t\treturn localStorage.length;\n\t\t}\n\t};\n\n})(); // MicroMongoDB.LocalStorageStore\n\n/**\n * MicroMongoDB.ObjectStore\n * \n * Public Constructor Function\n */\nexport const ObjectStore = function() {\n\n\tvar objs = {};\n\n\treturn {\n\t\tclear : function() {\n\t\t\tobjs = {};\n\t\t},\n\t\tget : function(i) {\n\t\t\treturn objs[Object.keys(objs)[i]];\n\t\t},\n\t\tgetStore : function() {\n\t\t\treturn objs;\n\t\t},\n\t\tremove : function(key) {\n\t\t\tdelete objs[key];\n\t\t},\n\t\tset : function(key,val) {\n\t\t\tobjs[key] = val;\n\t\t},\n\t\tsize : function() {\n\t\t\treturn Object.keys(objs).length;\n\t\t}\n\t}; // MicroMongoDB.ObjectStore return\n}; // MicroMongoDB.ObjectStore\n\n// Export refactored classes\nexport { MongoClient } from './src/MongoClient.js';\nexport { ObjectId } from './src/ObjectId.js';\nexport { StorageEngine } from './src/StorageEngine.js';\nexport { IndexedDbStorageEngine } from './src/IndexedDbStorageEngine.js';\nexport { ObjectStorageEngine } from './src/ObjectStorageEngine.js';\n"],"names":["valuesEqual","matches","SortedCursor","text"],"mappings":"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","x_google_ignoreList":[4]}
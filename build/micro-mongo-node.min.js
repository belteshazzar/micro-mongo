var l,b={exports:{}};var d=function(){if(l)return b.exports;l=1;var d,Z="object"==typeof Reflect?Reflect:null,c=Z&&"function"==typeof Z.apply?Z.apply:function(l,b,d){return Function.prototype.apply.call(l,b,d)};d=Z&&"function"==typeof Z.ownKeys?Z.ownKeys:Object.getOwnPropertySymbols?function(l){return Object.getOwnPropertyNames(l).concat(Object.getOwnPropertySymbols(l))}:function(l){return Object.getOwnPropertyNames(l)};var m=Number.isNaN||function(l){return l!=l};function i(){i.init.call(this)}b.exports=i,b.exports.once=function(l,b){return new Promise(function(d,Z){function c(d){l.removeListener(b,m),Z(d)}function m(){"function"==typeof l.removeListener&&l.removeListener("error",c),d([].slice.call(arguments))}h(l,b,m,{once:!0}),"error"!==b&&function(l,b,d){"function"==typeof l.on&&h(l,"error",b,d)}(l,c,{once:!0})})},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var G=10;function X(l){if("function"!=typeof l)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof l)}function t(l){return void 0===l._maxListeners?i.defaultMaxListeners:l._maxListeners}function u(l,b,d,Z){var c,m,i,G;if(X(d),void 0===(m=l._events)?(m=l._events=/* @__PURE__ */Object.create(null),l._eventsCount=0):(void 0!==m.newListener&&(l.emit("newListener",b,d.listener?d.listener:d),m=l._events),i=m[b]),void 0===i)i=m[b]=d,++l._eventsCount;else if("function"==typeof i?i=m[b]=Z?[d,i]:[i,d]:Z?i.unshift(d):i.push(d),(c=t(l))>0&&i.length>c&&!i.warned){i.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+i.length+" "+String(b)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=l,u.type=b,u.count=i.length,G=u,console&&console.warn&&console.warn(G)}return l}function n(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function e(l,b,d){var Z={fired:!1,wrapFn:void 0,target:l,type:b,listener:d},c=n.bind(Z);return c.listener=d,Z.wrapFn=c,c}function W(l,b,d){var Z=l._events;if(void 0===Z)return[];var c=Z[b];return void 0===c?[]:"function"==typeof c?d?[c.listener||c]:[c]:d?function(l){for(var b=new Array(l.length),d=0;d<b.length;++d)b[d]=l[d].listener||l[d];return b}(c):a(c,c.length)}function p(l){var b=this._events;if(void 0!==b){var d=b[l];if("function"==typeof d)return 1;if(void 0!==d)return d.length}return 0}function a(l,b){for(var d=new Array(b),Z=0;Z<b;++Z)d[Z]=l[Z];return d}function h(l,b,d,Z){if("function"==typeof l.on)Z.once?l.once(b,d):l.on(b,d);else{if("function"!=typeof l.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof l);l.addEventListener(b,function c(m){Z.once&&l.removeEventListener(b,c),d(m)})}}return Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return G},set:function(l){if("number"!=typeof l||l<0||m(l))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+l+".");G=l}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=/* @__PURE__ */Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(l){if("number"!=typeof l||l<0||m(l))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+l+".");return this._maxListeners=l,this},i.prototype.getMaxListeners=function(){return t(this)},i.prototype.emit=function(l){for(var b=[],d=1;d<arguments.length;d++)b.push(arguments[d]);var Z="error"===l,m=this._events;if(void 0!==m)Z=Z&&void 0===m.error;else if(!Z)return!1;if(Z){var i;if(b.length>0&&(i=b[0]),i instanceof Error)throw i;var G=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw G.context=i,G}var X=m[l];if(void 0===X)return!1;if("function"==typeof X)c(X,this,b);else{var t=X.length,u=a(X,t);for(d=0;d<t;++d)c(u[d],this,b)}return!0},i.prototype.addListener=function(l,b){return u(this,l,b,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(l,b){return u(this,l,b,!0)},i.prototype.once=function(l,b){return X(b),this.on(l,e(this,l,b)),this},i.prototype.prependOnceListener=function(l,b){return X(b),this.prependListener(l,e(this,l,b)),this},i.prototype.removeListener=function(l,b){var d,Z,c,m,i;if(X(b),void 0===(Z=this._events))return this;if(void 0===(d=Z[l]))return this;if(d===b||d.listener===b)0===--this._eventsCount?this._events=/* @__PURE__ */Object.create(null):(delete Z[l],Z.removeListener&&this.emit("removeListener",l,d.listener||b));else if("function"!=typeof d){for(c=-1,m=d.length-1;m>=0;m--)if(d[m]===b||d[m].listener===b){i=d[m].listener,c=m;break}if(c<0)return this;0===c?d.shift():function(l,b){for(;b+1<l.length;b++)l[b]=l[b+1];l.pop()}(d,c),1===d.length&&(Z[l]=d[0]),void 0!==Z.removeListener&&this.emit("removeListener",l,i||b)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(l){var b,d,Z;if(void 0===(d=this._events))return this;if(void 0===d.removeListener)return 0===arguments.length?(this._events=/* @__PURE__ */Object.create(null),this._eventsCount=0):void 0!==d[l]&&(0===--this._eventsCount?this._events=/* @__PURE__ */Object.create(null):delete d[l]),this;if(0===arguments.length){var c,m=Object.keys(d);for(Z=0;Z<m.length;++Z)"removeListener"!==(c=m[Z])&&this.removeAllListeners(c);return this.removeAllListeners("removeListener"),this._events=/* @__PURE__ */Object.create(null),this._eventsCount=0,this}if("function"==typeof(b=d[l]))this.removeListener(l,b);else if(void 0!==b)for(Z=b.length-1;Z>=0;Z--)this.removeListener(l,b[Z]);return this},i.prototype.listeners=function(l){return W(this,l,!0)},i.prototype.rawListeners=function(l){return W(this,l,!1)},i.listenerCount=function(l,b){return"function"==typeof l.listenerCount?l.listenerCount(b):p.call(l,b)},i.prototype.listenerCount=p,i.prototype.eventNames=function(){return this._eventsCount>0?d(this._events):[]},b.exports}();const Z={OK:0,INTERNAL_ERROR:1,BAD_VALUE:2,NO_SUCH_KEY:4,GRAPH_CONTAINS_CYCLE:5,HOST_UNREACHABLE:6,HOST_NOT_FOUND:7,UNKNOWN_ERROR:8,FAILED_TO_PARSE:17287,CANNOT_MUTATE_OBJECT:10,USER_NOT_FOUND:11,UNSUPPORTED_FORMAT:12,UNAUTHORIZED:13,TYPE_MISMATCH:14,OVERFLOW:15,INVALID_LENGTH:16,PROTOCOL_ERROR:17,AUTHENTICATION_FAILED:18,ILLEGAL_OPERATION:20,NAMESPACE_NOT_FOUND:26,INDEX_NOT_FOUND:27,PATH_NOT_VIABLE:28,CANNOT_CREATE_INDEX:67,INDEX_ALREADY_EXISTS:68,INDEX_EXISTS:68,COMMAND_NOT_FOUND:59,NAMESPACE_EXISTS:48,INVALID_NAMESPACE:73,INDEX_OPTIONS_CONFLICT:85,INVALID_INDEX_SPECIFICATION_OPTION:197,WRITE_CONFLICT:112,DUPLICATE_KEY:11e3,DUPLICATE_KEY_UPDATE:11001,DOCUMENT_VALIDATION_FAILURE:121,BAD_QUERY:2,CANNOT_INDEX_PARALLEL_ARRAYS:171,CURSOR_NOT_FOUND:43,COLLECTION_IS_EMPTY:26,CANNOT_DO_EXCLUSION_ON_FIELD_ID_IN_INCLUSION_PROJECTION:31254,NOT_IMPLEMENTED:999,OPERATION_NOT_SUPPORTED:998};class c extends Error{constructor(l,b={}){super(l),this.name="MongoError",this.code=b.code||Z.UNKNOWN_ERROR,this.codeName=this._getCodeName(this.code),this.$err=l,b.collection&&(this.collection=b.collection),b.database&&(this.database=b.database),b.operation&&(this.operation=b.operation),b.query&&(this.query=b.query),b.document&&(this.document=b.document),b.field&&(this.field=b.field),b.index&&(this.index=b.index),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}_getCodeName(l){return{0:"OK",1:"InternalError",2:"BadValue",4:"NoSuchKey",5:"GraphContainsCycle",6:"HostUnreachable",7:"HostNotFound",8:"UnknownError",10:"CannotMutateObject",11:"UserNotFound",12:"UnsupportedFormat",13:"Unauthorized",14:"TypeMismatch",15:"Overflow",16:"InvalidLength",17:"ProtocolError",18:"AuthenticationFailed",20:"IllegalOperation",26:"NamespaceNotFound",27:"IndexNotFound",28:"PathNotViable",43:"CursorNotFound",48:"NamespaceExists",59:"CommandNotFound",67:"CannotCreateIndex",68:"IndexExists",73:"InvalidNamespace",85:"IndexOptionsConflict",112:"WriteConflict",121:"DocumentValidationFailure",171:"CannotIndexParallelArrays",197:"InvalidIndexSpecificationOption",998:"OperationNotSupported",999:"NotImplemented",11e3:"DuplicateKey",11001:"DuplicateKeyUpdate",17287:"FailedToParse"}[l]||"UnknownError"}toJSON(){const l={name:this.name,message:this.message,code:this.code,codeName:this.codeName};return this.collection&&(l.collection=this.collection),this.database&&(l.database=this.database),this.operation&&(l.operation=this.operation),this.index&&(l.index=this.index),this.indexName&&(l.indexName=this.indexName),this.field&&(l.field=this.field),this.query&&(l.query=this.query),this.document&&(l.document=this.document),this.namespace&&(l.namespace=this.namespace),this.cursorId&&(l.cursorId=this.cursorId),this.feature&&(l.feature=this.feature),this.keyPattern&&(l.keyPattern=this.keyPattern),this.keyValue&&(l.keyValue=this.keyValue),this.writeErrors&&(l.writeErrors=this.writeErrors),l}}class m extends c{constructor(l,b={}){super(l,b),this.name="MongoServerError"}}class i extends c{constructor(l,b={}){super(l,b),this.name="MongoDriverError",this.code=b.code||Z.INTERNAL_ERROR}}class G extends c{constructor(l,b={}){super(l,b),this.name="WriteError",this.code=b.code||Z.WRITE_CONFLICT}}class X extends G{constructor(l,b={}){const d=JSON.stringify(l);super(`E11000 duplicate key error${b.collection?` collection: ${b.collection}`:""} index: ${d} dup key: ${d}`,{...b,code:Z.DUPLICATE_KEY}),this.name="DuplicateKeyError",this.keyPattern=l,this.keyValue=b.keyValue||l}}class t extends c{constructor(l,b={}){super(l,b),this.name="ValidationError",this.code=b.code||Z.DOCUMENT_VALIDATION_FAILURE,this.validationErrors=b.validationErrors||[]}}class u extends c{constructor(l,b={}){super(l,b),this.name="IndexError"}}class n extends u{constructor(l,b={}){super(`Index with name '${l}' already exists`,{...b,code:Z.INDEX_EXISTS}),this.name="IndexExistsError",this.indexName=l}}class e extends u{constructor(l,b={}){super(`Index '${l}' not found`,{...b,code:Z.INDEX_NOT_FOUND,index:l}),this.name="IndexNotFoundError",this.indexName=l}}class W extends u{constructor(l,b={}){super(`Cannot create index: ${l}`,{...b,code:Z.CANNOT_CREATE_INDEX}),this.name="CannotCreateIndexError"}}class p extends c{constructor(l,b={}){super(l,b),this.name="QueryError",this.code=b.code||Z.BAD_QUERY}}class a extends c{constructor(l,b,d,c={}){super(`Type mismatch for field '${l}': expected ${b}, got ${d}`,{...c,code:Z.TYPE_MISMATCH,field:l}),this.name="TypeMismatchError",this.expectedType=b,this.actualType=d}}class h extends c{constructor(l,b={}){super(l,b),this.name="NamespaceError"}}class o extends h{constructor(l,b={}){super(`Namespace '${l}' not found`,{...b,code:Z.NAMESPACE_NOT_FOUND}),this.name="NamespaceNotFoundError",this.namespace=l}}class s extends h{constructor(l,b,d={}){"object"!=typeof b||d||(d=b,b=void 0);super(b?`Invalid namespace '${l}': ${b}`:`Invalid namespace '${l}'`,{...d,code:Z.INVALID_NAMESPACE}),this.name="InvalidNamespaceError",this.namespace=l}}class V extends c{constructor(l,b={}){super(l,b),this.name="CursorError"}}class y extends V{constructor(l,b={}){super(`Cursor ${l} not found`,{...b,code:Z.CURSOR_NOT_FOUND}),this.name="CursorNotFoundError",this.cursorId=l}}class I extends c{constructor(l,b={}){super(`${l} is not implemented in micro-mongo`,{...b,code:Z.NOT_IMPLEMENTED}),this.name="NotImplementedError",this.feature=l}}class Y extends c{constructor(l,b,d={}){"object"!=typeof b||d||(d=b,b=void 0);super(b?`Operation '${l}' is not supported: ${b}`:`Operation '${l}' is not supported`,{...d,code:Z.OPERATION_NOT_SUPPORTED,operation:l}),this.name="OperationNotSupportedError"}}class K extends c{constructor(l,b,d,c={}){super(`Bad value for field '${l}': ${d}`,{...c,code:Z.BAD_VALUE,field:l}),this.name="BadValueError",this.value=b}}class R extends c{constructor(l=[],b={}){super(`Bulk write operation error: ${l.length} error(s)`,b),this.name="BulkWriteError",this.writeErrors=l,this.code=b.code||Z.WRITE_CONFLICT}}class r extends c{constructor(l,b={}){super(l,b),this.name="MongoNetworkError",this.code=b.code||Z.HOST_UNREACHABLE}}class J extends d.EventEmitter{static create({bridge:l,database:b,collection:d,streamId:Z,pipeline:c=[],options:m={}}){const i=new J({bridge:l,streamId:Z});if(!Z){let Z,G;null==b?(Z="client",G="watch"):null==d?(Z="db",G="watch"):(Z="collection",G="watch"),l.sendRequest({target:Z,database:b,collection:d,method:G,args:[c,m]}).then(l=>{l&&l.streamId&&(i.streamId=l.streamId)}).catch(()=>{})}return i}constructor({bridge:l,streamId:b}){super(),this.bridge=l,this.streamId=b,this.closed=!1,this._pendingNext=[],this._onEvent=this._onEvent.bind(this),this.bridge.on("event",this._onEvent)}_onEvent(l,b){if("changeStream"!==l)return;if(!b||b.streamId!==this.streamId)return;const{type:d,data:Z}=b;"change"===d&&this.emit("change",Z),"error"===d&&this.emit("error",Z),"close"===d&&(this.emit("close"),this._cleanup())}_cleanup(){this.bridge.off("event",this._onEvent)}async close(){if(!this.closed){this.closed=!0;for(const l of this._pendingNext)l.resolve(null);this._pendingNext=[],this.bridge.sendRequest({target:"changestream",streamId:this.streamId,method:"close"}).catch(()=>{}),this.emit("close"),this._cleanup()}}async next(){return this.closed?null:new Promise((l,b)=>{const d=b=>{this._removePending(m),this.off("change",d),this.off("error",Z),this.off("close",c),l(b)},Z=l=>{this._removePending(m),this.off("change",d),this.off("error",Z),this.off("close",c),b(l)},c=()=>{this._removePending(m),this.off("change",d),this.off("error",Z),this.off("close",c),l(null)},m={resolve:l,reject:b};this._pendingNext.push(m),this.on("change",d),this.on("error",Z),this.on("close",c)})}_removePending(l){const b=this._pendingNext.indexOf(l);-1!==b&&this._pendingNext.splice(b,1)}async*[Symbol.asyncIterator](){for(;!this.closed;){const l=await this.next();if(null===l)break;yield l}}}class C{constructor({bridge:l,cursorId:b,batch:d=[],exhausted:Z=!1,batchSize:c=100,requestPromise:m,requestPayload:i}){this.bridge=l,this.cursorId=b,this.buffer=Array.isArray(d)?d:[],this.exhausted=Z||!1,this._batchSize=c,this._requestPromise=m||null,this._requestPayload=i||null,this._initialized=!m&&!i}async _ensureInitialized(){if(!this._initialized)if(this._requestPayload){const l={};void 0!==this._limit&&(l.limit=this._limit),void 0!==this._skip&&(l.skip=this._skip),void 0!==this._sort&&(l.sort=this._sort),void 0!==this._min&&(l.min=this._min),void 0!==this._max&&(l.max=this._max),void 0!==this._hint&&(l.hint=this._hint),void 0!==this._comment&&(l.comment=this._comment),void 0!==this._maxTimeMS&&(l.maxTimeMS=this._maxTimeMS),void 0!==this._maxScan&&(l.maxScan=this._maxScan),void 0!==this._returnKey&&(l.returnKey=this._returnKey),void 0!==this._showRecordId&&(l.showRecordId=this._showRecordId),void 0!==this._collation&&(l.collation=this._collation),this._requestPayload.cursorOpts=l;const b=await this.bridge.sendRequest(this._requestPayload);this.cursorId=b.cursorId,this.buffer=b.batch||[],this.exhausted=b.exhausted||!1,this._batchSize=b.batchSize||100,this._requestPayload=null,this._initialized=!0}else if(this._requestPromise){const l=await this._requestPromise;this.cursorId=l.cursorId,this.buffer=l.batch||[],this.exhausted=l.exhausted||!1,this._batchSize=l.batchSize||100,this._requestPromise=null,this._initialized=!0}}async hasNext(){return!this._closed&&(await this._ensureInitialized(),this.buffer.length>0||!this.exhausted&&(await this._getMore(),this.buffer.length>0))}async next(){return await this.hasNext()?this.buffer.shift():null}async toArray(){await this._ensureInitialized();const l=[...this.buffer];for(this.buffer=[];!this.exhausted;)await this._getMore(),l.push(...this.buffer),this.buffer=[];return l}async count(){return(await this.toArray()).length}limit(l){return this._limit=l,this}skip(l){return this._skip=l,this}sort(l){return this._sort=l,this}batchSize(l){return this._batchSize=l,this}async close(){return this._closed=!0,await this._closeRemote(),!1}isClosed(){return this._closed||!1}comment(l){return this._comment=l,this}hint(l){return this._hint=l,this}explain(l="queryPlanner"){const b={queryPlanner:{plannerVersion:1,namespace:"unknown",indexFilterSet:!1,parsedQuery:{},winningPlan:{stage:"COLLSCAN"}},ok:1};return"executionStats"!==l&&"allPlansExecution"!==l||(b.executionStats={executionSuccess:!0,nReturned:0,executionTimeMillis:0}),b}async itcount(){let l=0;for(;await this.hasNext();)await this.next(),l++;return l}size(){return this.buffer.length}min(l){return this._min=l,this._minIndexBounds=l,this}max(l){return this._max=l,this._maxIndexBounds=l,this}maxTimeMS(l){return this._maxTimeMS=l,this}maxScan(l){return this._maxScan=l,this}noCursorTimeout(){return this._noCursorTimeout=!0,this}objsLeftInBatch(){return this.buffer.length}pretty(){return this._pretty=!0,this}readConcern(l){return this._readConcern=l,this}readPref(l,b){return this._readPref={mode:l,tagSet:b},this}returnKey(l=!0){return this._returnKey=l,this}showRecordId(l=!0){return this._showRecordId=l,this}allowDiskUse(l=!0){return this._allowDiskUse=l,this}collation(l){return this._collation=l,this}async forEach(l){for(;await this.hasNext();){const b=await this.next();await l(b)}}async map(l){const b=[];for(;await this.hasNext();){const d=await this.next();b.push(await l(d))}return b}async*[Symbol.asyncIterator](){for(;await this.hasNext();)yield await this.next()}async _getMore(){if(this.exhausted)return;const l=await this.bridge.sendRequest({target:"cursor",cursorId:this.cursorId,method:"getMore",args:[{batchSize:this._batchSize}]});this.buffer=l?.batch||[],this.exhausted=!!l?.exhausted,this.exhausted&&await this._closeRemote()}async _closeRemote(){if(this.cursorId){try{await this.bridge.sendRequest({target:"cursor",cursorId:this.cursorId,method:"close"})}catch(l){}this.cursorId=null}}}class g{constructor({dbName:l,name:b,bridge:d,db:Z}){return this.dbName=l,this.name=b,this.bridge=d,this._db=Z,this.indexes=[],new Proxy(this,{get:(l,b,d)=>b in l?Reflect.get(l,b,d):"symbol"==typeof b||String(b).startsWith("_")?void 0:"watch"===b?(...b)=>l._watch(...b):"find"===b||"aggregate"===b?(...d)=>l._cursorMethod(String(b),d):(...d)=>l._call(String(b),d)})}_cursorMethod(l,b=[]){"find"===l&&b.length>=2&&this._validateProjection(b[1]);const d={target:"collection",database:this.dbName,collection:this.name,method:l,args:b},Z=new C({bridge:this.bridge,requestPayload:d});return"aggregate"===l&&(Z.then=function(l,b){return this.toArray().then(l,b)}),Z}_validateProjection(l){if(!l||0===Object.keys(l).length)return;const b=Object.keys(l);let d=!1,c=!1;for(const Z of b)if("_id"!==Z&&(l[Z]?d=!0:c=!0,d&&c))break;if(d&&c)throw new p("Cannot do exclusion on field in inclusion projection",{code:Z.CANNOT_DO_EXCLUSION_ON_FIELD_ID_IN_INCLUSION_PROJECTION,collection:this.name})}_call(l,b=[]){return this.bridge.sendRequest({target:"collection",database:this.dbName,collection:this.name,method:l,args:b}).then(d=>{if(d&&d.cursorId)return new C({bridge:this.bridge,cursorId:d.cursorId,batch:d.batch,exhausted:d.exhausted,batchSize:d.batchSize});if("copyTo"===l&&b.length>0&&this._db&&this._db.collection(b[0]),"createIndex"===l){const l=b[0],d=b[1]||{},Z=d.name||Object.entries(l).map(([l,b])=>`${l}_${b}`).join("_");this.indexes.find(l=>l.name===Z)||this.indexes.push({name:Z,key:l,...d})}if("dropIndex"===l){const l=b[0];this.indexes=this.indexes.filter(b=>b.name!==l)}return"dropIndexes"===l&&(this.indexes=[]),"drop"===l&&(this.indexes=[]),d})}getIndexes(){return this.indexes}_watch(l=[],b={}){return J.create({bridge:this.bridge,database:this.dbName,collection:this.name,pipeline:l,options:b})}}class S{constructor({dbName:l,bridge:b,options:d={}}){this.dbName=l,this.bridge=b,this.options=d,this.collections=/* @__PURE__ */new Map;const Z=/* @__PURE__ */new Set(["getCollectionNames","getCollectionInfos","createCollection","dropCollection","dropDatabase","collection","getCollection","watch"]);return this._methodNames=Z,new Proxy(this,{get:(l,b,d)=>b in l?Reflect.get(l,b,d):"symbol"==typeof b||String(b).startsWith("_")?void 0:Z.has(b)?"createCollection"===b?(...Z)=>{const c=Z[0];return l.collection(c,d),l._call(String(b),Z)}:"dropCollection"===b?(...d)=>{const Z=d[0];return l.collections.delete(Z),l._call(String(b),d)}:"dropDatabase"===b?(...d)=>(l.collections.clear(),l._call(String(b),d)):"watch"===b?(...b)=>l._watch(...b):(...d)=>l._call(String(b),d):l.collection(b,d)})}collection(l,b){if(this.collections.has(l))return this.collections.get(l);const d=new g({dbName:this.dbName,name:l,bridge:this.bridge,db:b||this});return this.collections.set(l,d),d}getCollectionNames(){return Array.from(this.collections.keys())}async close(){}_call(l,b=[]){return this.bridge.sendRequest({target:"db",database:this.dbName,method:l,args:b}).then(l=>l&&l.streamId?J.create({bridge:this.bridge,database:this.dbName,collection:null,streamId:l.streamId}):l)}_watch(l=[],b={}){return J.create({bridge:this.bridge,database:this.dbName,collection:null,pipeline:l,options:b})}}class N extends d.EventEmitter{constructor(l="mongodb://localhost:27017",b={}){if(super(),this.uri=l,this.options=Object.freeze({...b}),this._isConnected=!1,this._defaultDb=this._parseDefaultDbName(l),this._databases=/* @__PURE__ */new Map,!b.workerBridge)throw new Error("workerBridge is required. Create one with: const bridge = await WorkerBridge.create()");this._bridge=b.workerBridge,this._ownsBridge=!1}static async connect(l,b={}){const d=new N(l,b);return await d.connect(),d}async connect(){return this._isConnected||(this._isConnected=!0,this.emit("open",this)),this}db(l,b={}){const d=l||this._defaultDb;if(!d)throw new Error("No database name provided and no default in connection string");if(this._databases.has(d))return this._databases.get(d);const Z=new S({dbName:d,bridge:this._bridge,options:{...this.options,...b}});return this._databases.set(d,Z),Z}async close(){this._bridge&&this._ownsBridge&&(await this._bridge.terminate(),this._bridge=null),this._isConnected=!1,this.emit("close")}async close(l=!1){if(this._isConnected){for(const[l,b]of this._databases)await b.close();this._databases.clear(),this._isConnected=!1,this.emit("close")}}startSession(l={}){return{id:crypto.randomUUID(),endSession:()=>{},withTransaction:async l=>await l(this)}}async withSession(l,b){const d=this.startSession("function"==typeof l?{}:l),Z="function"==typeof l?l:b;try{return await Z(d)}finally{d.endSession()}}get readConcern(){return this.options.readConcern}get writeConcern(){return this.options.writeConcern}get readPreference(){return this.options.readPreference}watch(l=[],b={}){return J.create({bridge:this._bridge,database:null,collection:null,pipeline:l,options:b})}_parseDefaultDbName(l){const b=l.match(/\/([^/?]+)/);return b?b[1]:null}_parseUriParams(l){const b={},d=l.indexOf("?");if(-1===d)return b;const Z=l.substring(d+1).split("&");for(const c of Z){const[l,d]=c.split("=");l&&("true"===d?b[l]=!0:"false"===d?b[l]=!1:isNaN(d)?b[l]=decodeURIComponent(d||""):b[l]=Number(d))}return b}}class L{constructor(l){if(null==l)this.id=L.generate();else if("string"==typeof l){if(!L.isValid(l))throw new Error(`Argument passed in must be a string of 24 hex characters, got: ${l}`);this.id=l.toLowerCase()}else if(l instanceof Uint8Array&&12===l.length)this.id=Array.from(l).map(l=>l.toString(16).padStart(2,"0")).join("");else{if(!(l instanceof L))throw new Error("Argument passed in must be a string of 24 hex characters or an ObjectId");this.id=l.id}}toString(){return this.id}toHexString(){return this.id}getTimestamp(){const l=parseInt(this.id.substring(0,8),16);return new Date(1e3*l)}equals(l){if(!(l instanceof L))throw new Error("Can only compare with another ObjectId");return this.id===l.id}compare(l){if(!(l instanceof L))throw new Error("Can only compare with another ObjectId");return this.id.localeCompare(l.id)}toJSON(){return this.id}inspect(){return`ObjectId("${this.id}")`}toBytes(){const l=new Uint8Array(12);for(let b=0;b<12;b++)l[b]=parseInt(this.id.substring(2*b,2*b+2),16);return l}static isValid(l){return!!l&&("string"==typeof l&&(24===l.length&&/^[0-9a-fA-F]{24}$/.test(l)))}static createFromTime(l){const b=("00000000"+Math.floor(l/1e3).toString(16)).slice(-8);return new L(b+"0000000000000000")}static generate(){const l=Math.floor(Date.now()/1e3),b="undefined"!=typeof crypto&&crypto.getRandomValues?new Uint8Array(8):null;let d="";if(b){crypto.getRandomValues(b);for(let l=0;l<b.length;l++)d+=("0"+b[l].toString(16)).slice(-2)}else d=Math.random().toString(16).slice(2).padEnd(8,"0").slice(0,8)+Math.random().toString(16).slice(2).padEnd(8,"0").slice(0,8);return(("00000000"+l.toString(16)).slice(-8)+d).slice(0,24)}}function H(l,b){return l instanceof L||b instanceof L?l instanceof L&&b instanceof L||l instanceof L&&"string"==typeof b?l.equals(b):b instanceof L&&"string"==typeof l&&b.equals(l):l==b}function x(l,b){for(var d=b.split("."),Z=l[d[0]],c=1;c<d.length;c++){if(null==Z||null==Z)return Z;var m=d[c],i=parseInt(m,10);Z=k(Z)&&!isNaN(i)&&i>=0&&i<Z.length?Z[i]:Z[m]}return Z}function k(l){return Array==l.constructor}function z(l,b){for(var d=0;d<b.length;d++)if(H(b[d],l))return!0;return!1}function F(l,b){if(l.length!=b.length)return!1;for(var d=0;d<l.length;d++)if(!H(l[d],b[d])){if(typeof l[d]!=typeof b[d])return!1;if("object"==typeof l[d]&&null!==l[d]){if(k(l[d])){if(!F(l[d],b[d]))return!1}else if(!v(l[d],b[d]))return!1}else if(!H(l[d],b[d]))return!1}return!0}function v(l,b){for(var d in l)if(l.hasOwnProperty(d)){if(!b.hasOwnProperty(d))return!1;if(!H(l[d],b[d])){if(typeof l[d]!=typeof b[d])return!1;if("object"==typeof l[d]&&null!==l[d]){if(k(l[d])){if(!F(l[d],b[d]))return!1}else if(!v(l[d],b[d]))return!1}else if(!H(l[d],b[d]))return!1}}for(var d in b)if(b.hasOwnProperty(d)&&!l.hasOwnProperty(d))return!1;return!0}const T={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},B={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},U="[aeiouy]",Q="([^aeiou][^aeiouy]*)",f="("+U+"[aeiou]*)",P=new RegExp("^"+Q+"?"+f+Q),j=new RegExp("^"+Q+"?"+f+Q+f+"?$"),M=new RegExp("^"+Q+"?("+f+Q+"){2,}"),w=new RegExp("^"+Q+"?"+U),O=new RegExp("^"+Q+U+"[^aeiouwxy]$"),E=/ll$/,D=/^(.+?)e$/,A=/^(.+?)y$/,_=/^(.+?(s|t))(ion)$/,$=/^(.+?)(ed|ing)$/,q=/(at|bl|iz)$/,ll=/^(.+?)eed$/,bl=/^.+?[^s]s$/,dl=/^.+?(ss|i)es$/,Zl=/([^aeiouylsz])\1$/,cl=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/,ml=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/,il=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/;const Gl=/* @__PURE__ */new Set(["a","about","after","all","also","am","an","and","another","any","are","around","as","at","be","because","been","before","being","between","both","but","by","came","can","come","could","did","do","each","for","from","get","got","has","had","he","have","her","here","him","himself","his","how","i","if","in","into","is","it","like","make","many","me","might","more","most","much","must","my","never","now","of","on","only","or","other","our","out","over","said","same","see","should","since","some","still","such","take","than","that","the","their","them","then","there","these","they","this","those","through","to","too","under","up","very","was","way","we","well","were","what","where","which","while","who","with","would","you","your"]);function Xl(l,b){if(null==l)return l;if("boolean"==typeof l||"number"==typeof l)return l;if("string"==typeof l)return l.startsWith("$$")?"$$KEEP"===l||"$$PRUNE"===l||"$$DESCEND"===l?l:x(b,l.substring(2)):"$"===l.charAt(0)?x(b,l.substring(1)):l;if("object"==typeof l){if(Array.isArray(l))return l.map(l=>Xl(l,b));const d=Object.keys(l);if(0===d.length)return l;const Z=d[0];if("$"===Z.charAt(0)){return function(l,b,d){switch(l){case"$add":return function(l,b){if(!Array.isArray(l))return null;let d=0;for(const Z of l){const l=Xl(Z,b);l instanceof Date?d+=l.getTime():"number"==typeof l&&(d+=l)}return d}(b,d);case"$subtract":return function(l,b){if(!Array.isArray(l)||2!==l.length)return null;const d=Xl(l[0],b),Z=Xl(l[1],b);if(d instanceof Date&&Z instanceof Date)return d.getTime()-Z.getTime();if(d instanceof Date&&"number"==typeof Z)return new Date(d.getTime()-Z);if("number"==typeof d&&"number"==typeof Z)return d-Z;return null}(b,d);case"$multiply":return function(l,b){if(!Array.isArray(l))return null;let d=1;for(const Z of l){const l=Xl(Z,b);"number"==typeof l&&(d*=l)}return d}(b,d);case"$divide":return function(l,b){if(!Array.isArray(l)||2!==l.length)return null;const d=Xl(l[0],b),Z=Xl(l[1],b);if("number"==typeof d&&"number"==typeof Z&&0!==Z)return d/Z;return null}(b,d);case"$mod":return function(l,b){if(!Array.isArray(l)||2!==l.length)return null;const d=Xl(l[0],b),Z=Xl(l[1],b);if("number"==typeof d&&"number"==typeof Z&&0!==Z)return d%Z;return null}(b,d);case"$pow":return function(l,b){if(!Array.isArray(l)||2!==l.length)return null;const d=Xl(l[0],b),Z=Xl(l[1],b);if("number"==typeof d&&"number"==typeof Z)return Math.pow(d,Z);return null}(b,d);case"$sqrt":return function(l,b){const d=Xl(l,b);if("number"==typeof d&&d>=0)return Math.sqrt(d);return null}(b,d);case"$abs":return function(l,b){const d=Xl(l,b);if("number"==typeof d)return Math.abs(d);return null}(b,d);case"$ceil":return function(l,b){const d=Xl(l,b);if("number"==typeof d)return Math.ceil(d);return null}(b,d);case"$floor":return function(l,b){const d=Xl(l,b);if("number"==typeof d)return Math.floor(d);return null}(b,d);case"$trunc":return function(l,b){const d=Xl(l,b);if("number"==typeof d)return Math.trunc(d);return null}(b,d);case"$round":return function(l,b){const d=Xl(Array.isArray(l)?l[0]:l,b),Z=Array.isArray(l)&&void 0!==l[1]?Xl(l[1],b):0;if("number"==typeof d&&"number"==typeof Z){const l=Math.pow(10,Z);return Math.round(d*l)/l}return null}(b,d);case"$concat":return function(l,b){if(!Array.isArray(l))return null;let d="";for(const Z of l){const l=Xl(Z,b);null!=l&&(d+=String(l))}return d}(b,d);case"$substr":return function(l,b){if(!Array.isArray(l)||l.length<3)return null;const d=String(Xl(l[0],b)||""),Z=Xl(l[1],b),c=Xl(l[2],b);if("number"==typeof Z&&"number"==typeof c)return d.substr(Z,c);return null}(b,d);case"$toLower":return function(l,b){const d=Xl(l,b);return null!=d?String(d).toLowerCase():""}(b,d);case"$toUpper":return function(l,b){const d=Xl(l,b);return null!=d?String(d).toUpperCase():""}(b,d);case"$trim":return function(l,b){const d=Xl("object"==typeof l&&l.input?l.input:l,b),Z=l.chars?Xl(l.chars,b):null;let c=null!=d?String(d):"";if(Z){const l=new RegExp(`^[${tl(Z)}]+|[${tl(Z)}]+$`,"g");return c.replace(l,"")}return c.trim()}(b,d);case"$ltrim":return function(l,b){const d=Xl("object"==typeof l&&l.input?l.input:l,b),Z=l.chars?Xl(l.chars,b):null;let c=null!=d?String(d):"";if(Z){const l=new RegExp(`^[${tl(Z)}]+`,"g");return c.replace(l,"")}return c.replace(/^\s+/,"")}(b,d);case"$rtrim":return function(l,b){const d=Xl("object"==typeof l&&l.input?l.input:l,b),Z=l.chars?Xl(l.chars,b):null;let c=null!=d?String(d):"";if(Z){const l=new RegExp(`[${tl(Z)}]+$`,"g");return c.replace(l,"")}return c.replace(/\s+$/,"")}(b,d);case"$split":return function(l,b){if(!Array.isArray(l)||2!==l.length)return null;const d=String(Xl(l[0],b)||""),Z=String(Xl(l[1],b)||"");return d.split(Z)}(b,d);case"$strLenCP":return function(l,b){const d=Xl(l,b);return null!=d?String(d).length:0}(b,d);case"$strcasecmp":return function(l,b){if(!Array.isArray(l)||2!==l.length)return null;const d=String(Xl(l[0],b)||"").toLowerCase(),Z=String(Xl(l[1],b)||"").toLowerCase();return d<Z?-1:d>Z?1:0}(b,d);case"$indexOfCP":return function(l,b){if(!Array.isArray(l)||l.length<2)return null;const d=String(Xl(l[0],b)||""),Z=String(Xl(l[1],b)||""),c=void 0!==l[2]?Xl(l[2],b):0,m=void 0!==l[3]?Xl(l[3],b):d.length,i=d.substring(c,m).indexOf(Z);return-1===i?-1:i+c}(b,d);case"$replaceOne":return function(l,b){const d=String(Xl(l.input,b)||""),Z=String(Xl(l.find,b)||""),c=String(Xl(l.replacement,b)||"");return d.replace(Z,c)}(b,d);case"$replaceAll":return function(l,b){const d=String(Xl(l.input,b)||""),Z=String(Xl(l.find,b)||""),c=String(Xl(l.replacement,b)||"");return d.split(Z).join(c)}(b,d);case"$cmp":return function(l,b){if(!Array.isArray(l)||2!==l.length)return null;const d=Xl(l[0],b),Z=Xl(l[1],b);return d<Z?-1:d>Z?1:0}(b,d);case"$eq":return function(l,b){if(!Array.isArray(l)||2!==l.length)return null;const d=Xl(l[0],b),Z=Xl(l[1],b);return d===Z}(b,d);case"$ne":return function(l,b){if(!Array.isArray(l)||2!==l.length)return null;const d=Xl(l[0],b),Z=Xl(l[1],b);return d!==Z}(b,d);case"$gt":return function(l,b){if(!Array.isArray(l)||2!==l.length)return null;const d=Xl(l[0],b),Z=Xl(l[1],b);return d>Z}(b,d);case"$gte":return function(l,b){if(!Array.isArray(l)||2!==l.length)return null;const d=Xl(l[0],b),Z=Xl(l[1],b);return d>=Z}(b,d);case"$lt":return function(l,b){if(!Array.isArray(l)||2!==l.length)return null;const d=Xl(l[0],b),Z=Xl(l[1],b);return d<Z}(b,d);case"$lte":return function(l,b){if(!Array.isArray(l)||2!==l.length)return null;const d=Xl(l[0],b),Z=Xl(l[1],b);return d<=Z}(b,d);case"$and":return function(l,b){if(!Array.isArray(l))return null;for(const d of l){if(!Xl(d,b))return!1}return!0}(b,d);case"$or":return function(l,b){if(!Array.isArray(l))return null;for(const d of l){if(Xl(d,b))return!0}return!1}(b,d);case"$not":return function(l,b){const d=Xl(Array.isArray(l)?l[0]:l,b);return!d}(b,d);case"$cond":return function(l,b){let d,Z,c;if(Array.isArray(l)){if(3!==l.length)return null;[d,Z,c]=l}else{if("object"!=typeof l)return null;d=l.if,Z=l.then,c=l.else}const m=Xl(d,b);return Xl(m?Z:c,b)}(b,d);case"$ifNull":return function(l,b){if(!Array.isArray(l)||l.length<2)return null;for(let d=0;d<l.length;d++){const Z=Xl(l[d],b);if(null!=Z)return Z}return null}(b,d);case"$switch":return function(l,b){if("object"!=typeof l||!Array.isArray(l.branches))return null;for(const d of l.branches){if(Xl(d.case,b))return Xl(d.then,b)}return void 0!==l.default?Xl(l.default,b):null}(b,d);case"$year":return function(l,b){const d=Xl(l,b);if(d instanceof Date)return d.getUTCFullYear();return null}(b,d);case"$month":return function(l,b){const d=Xl(l,b);if(d instanceof Date)return d.getUTCMonth()+1;return null}(b,d);case"$dayOfMonth":return function(l,b){const d=Xl(l,b);if(d instanceof Date)return d.getUTCDate();return null}(b,d);case"$dayOfWeek":return function(l,b){const d=Xl(l,b);if(d instanceof Date)return d.getUTCDay()+1;return null}(b,d);case"$dayOfYear":return function(l,b){const d=Xl(l,b);if(d instanceof Date){const l=new Date(Date.UTC(d.getUTCFullYear(),0,0)),b=d-l,Z=864e5;return Math.floor(b/Z)}return null}(b,d);case"$hour":return function(l,b){const d=Xl(l,b);if(d instanceof Date)return d.getUTCHours();return null}(b,d);case"$minute":return function(l,b){const d=Xl(l,b);if(d instanceof Date)return d.getUTCMinutes();return null}(b,d);case"$second":return function(l,b){const d=Xl(l,b);if(d instanceof Date)return d.getUTCSeconds();return null}(b,d);case"$millisecond":return function(l,b){const d=Xl(l,b);if(d instanceof Date)return d.getUTCMilliseconds();return null}(b,d);case"$week":return function(l,b){const d=Xl(l,b);if(d instanceof Date){const l=new Date(Date.UTC(d.getUTCFullYear(),0,1));return Math.ceil(((d-l)/864e5+l.getUTCDay()+1)/7)-1}return null}(b,d);case"$isoWeek":return function(l,b){const d=Xl(l,b);if(d instanceof Date){const l=new Date(d.valueOf()),b=(d.getUTCDay()+6)%7;l.setUTCDate(l.getUTCDate()-b+3);const Z=l.valueOf();return l.setUTCMonth(0,1),4!==l.getUTCDay()&&l.setUTCMonth(0,1+(4-l.getUTCDay()+7)%7),1+Math.ceil((Z-l)/6048e5)}return null}(b,d);case"$isoWeekYear":return function(l,b){const d=Xl(l,b);if(d instanceof Date){const l=new Date(d.valueOf());return l.setUTCDate(l.getUTCDate()-(d.getUTCDay()+6)%7+3),l.getUTCFullYear()}return null}(b,d);case"$dateToString":return function(l,b){const d=l.format?Xl(l.format,b):"%Y-%m-%dT%H:%M:%S.%LZ",Z=Xl(l.date,b);return Z instanceof Date?d.replace("%Y",Z.getUTCFullYear()).replace("%m",String(Z.getUTCMonth()+1).padStart(2,"0")).replace("%d",String(Z.getUTCDate()).padStart(2,"0")).replace("%H",String(Z.getUTCHours()).padStart(2,"0")).replace("%M",String(Z.getUTCMinutes()).padStart(2,"0")).replace("%S",String(Z.getUTCSeconds()).padStart(2,"0")).replace("%L",String(Z.getUTCMilliseconds()).padStart(3,"0")):null}(b,d);case"$toDate":return function(l,b){const d=Xl(l,b);if(d instanceof Date)return d;if("string"==typeof d||"number"==typeof d){const l=new Date(d);return isNaN(l.getTime())?null:l}return null}(b,d);case"$arrayElemAt":return function(l,b){if(!Array.isArray(l)||2!==l.length)return null;const d=Xl(l[0],b),Z=Xl(l[1],b);if(!Array.isArray(d)||"number"!=typeof Z)return null;const c=Z<0?d.length+Z:Z;return d[c]}(b,d);case"$concatArrays":return function(l,b){if(!Array.isArray(l))return null;const d=[];for(const Z of l){const l=Xl(Z,b);Array.isArray(l)&&d.push(...l)}return d}(b,d);case"$filter":return function(l,b){const d=Xl(l.input,b),Z=l.as||"this",c=l.cond;return Array.isArray(d)?d.filter(l=>{const d={...b,[Z]:l};return Xl(c,d)}):null}(b,d);case"$in":return function(l,b){if(!Array.isArray(l)||2!==l.length)return null;const d=Xl(l[0],b),Z=Xl(l[1],b);return!!Array.isArray(Z)&&Z.includes(d)}(b,d);case"$indexOfArray":return function(l,b){if(!Array.isArray(l)||l.length<2)return null;const d=Xl(l[0],b),Z=Xl(l[1],b),c=void 0!==l[2]?Xl(l[2],b):0,m=void 0!==l[3]?Xl(l[3],b):d.length;if(!Array.isArray(d))return null;for(let i=c;i<m&&i<d.length;i++)if(d[i]===Z)return i;return-1}(b,d);case"$isArray":return function(l,b){const d=Xl(l,b);return Array.isArray(d)}(b,d);case"$map":return function(l,b){const d=Xl(l.input,b),Z=l.as||"this",c=l.in;return Array.isArray(d)?d.map(l=>{const d={...b,[Z]:l};return Xl(c,d)}):null}(b,d);case"$reduce":return function(l,b){const d=Xl(l.input,b),Z=Xl(l.initialValue,b),c=l.in;if(!Array.isArray(d))return null;let m=Z;for(const i of d){m=Xl(c,{...b,value:m,this:i})}return m}(b,d);case"$size":return function(l,b){const d=Xl(l,b);return Array.isArray(d)?d.length:null}(b,d);case"$slice":return function(l,b){if(!Array.isArray(l)||l.length<2)return null;const d=Xl(l[0],b);if(!Array.isArray(d))return null;if(2===l.length){const Z=Xl(l[1],b);return Z>=0?d.slice(0,Z):d.slice(Z)}{const Z=Xl(l[1],b),c=Xl(l[2],b);return d.slice(Z,Z+c)}}(b,d);case"$reverseArray":return function(l,b){const d=Xl(l,b);return Array.isArray(d)?d.slice().reverse():null}(b,d);case"$zip":return function(l,b){const d=l.inputs?Xl(l.inputs,b):null,Z=l.useLongestLength||!1,c=l.defaults;if(!Array.isArray(d))return null;const m=d.map(l=>Xl(l,b));if(!m.every(l=>Array.isArray(l)))return null;const i=Math.max(...m.map(l=>l.length)),G=Z?i:Math.min(...m.map(l=>l.length)),X=[];for(let t=0;t<G;t++){const l=[];for(let b=0;b<m.length;b++)t<m[b].length?l.push(m[b][t]):c&&b<c.length?l.push(c[b]):l.push(null);X.push(l)}return X}(b,d);case"$type":return function(l,b){const d=Xl(l,b);return null===d?"null":void 0===d?"missing":"boolean"==typeof d?"bool":"number"==typeof d?Number.isInteger(d)?"int":"double":"string"==typeof d?"string":d instanceof Date?"date":Array.isArray(d)?"array":"object"==typeof d?"object":"unknown"}(b,d);case"$convert":return function(l,b){const d=Xl(l.input,b),Z=l.to,c=l.onError,m=l.onNull;if(null===d)return void 0!==m?Xl(m,b):null;try{switch(Z){case"double":case"decimal":return parseFloat(d);case"int":case"long":return parseInt(d);case"bool":return Boolean(d);case"string":return String(d);case"date":return new Date(d);default:return d}}catch(i){return void 0!==c?Xl(c,b):null}}(b,d);case"$toBool":return function(l,b){const d=Xl(l,b);return Boolean(d)}(b,d);case"$toDecimal":return function(l,b){const d=Xl(l,b);return parseFloat(d)}(b,d);case"$toDouble":return function(l,b){const d=Xl(l,b);return parseFloat(d)}(b,d);case"$toInt":return function(l,b){const d=Xl(l,b);return parseInt(d)}(b,d);case"$toLong":return function(l,b){const d=Xl(l,b);return parseInt(d)}(b,d);case"$toString":return function(l,b){const d=Xl(l,b);return null==d?null:String(d)}(b,d);case"$objectToArray":return function(l,b){const d=Xl(l,b);if("object"!=typeof d||null===d||Array.isArray(d))return null;return Object.keys(d).map(l=>({k:l,v:d[l]}))}(b,d);case"$arrayToObject":return function(l,b){const d=Xl(l,b);if(!Array.isArray(d))return null;const Z={};for(const c of d)Array.isArray(c)&&2===c.length?Z[c[0]]=c[1]:"object"==typeof c&&void 0!==c.k&&void 0!==c.v&&(Z[c.k]=c.v);return Z}(b,d);case"$mergeObjects":return function(l,b){if(!Array.isArray(l))return Xl(l,b);const d={};for(const Z of l){const l=Xl(Z,b);"object"!=typeof l||null===l||Array.isArray(l)||Object.assign(d,l)}return d}(b,d);case"$literal":return b;default:throw new Error(`Unsupported aggregation operator: ${l}`)}}(Z,l[Z],b)}{const Z={};for(const c of d)Z[c]=Xl(l[c],b);return Z}}return l}function tl(l){return l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}const ul={1:"double",2:"string",3:"object",4:"array",5:"binData",6:"undefined",7:"objectId",8:"bool",9:"date",10:"null",11:"regex",13:"javascript",15:"javascriptWithScope",16:"int",17:"timestamp",18:"long",19:"decimal",127:"maxKey","-1":"minKey"},nl=Object.entries(ul).reduce((l,[b,d])=>(l[d]=parseInt(b),l),{});function el(l,b){if(k(b)){for(let d=0;d<b.length;d++)if(el(l,b[d]))return!0;return!1}const d="number"==typeof b?b:nl[b],Z=ul[d]||b;return null===l?"null"===Z||10===d:void 0===l?"undefined"===Z||6===d:"number"==typeof l?Number.isInteger(l)?"int"===Z||16===d:"double"===Z||1===d:"string"==typeof l?"string"===Z||2===d:"boolean"==typeof l?"bool"===Z||8===d:l instanceof Date?"date"===Z||9===d:l instanceof L?"objectId"===Z||7===d:l instanceof RegExp?"regex"===Z||11===d:k(l)?"array"===Z||4===d:"object"==typeof l?"object"===Z||3===d:typeof l===b}function Wl(l){if(k(l)){let b=0;for(let d=0;d<l.length;d++)b|=1<<l[d];return b}return"number"==typeof l?l:0}function pl(l,b){if("number"!=typeof l)return!1;const d=Wl(b);return(l&d)===d}function al(l,b){if("number"!=typeof l)return!1;return 0===(l&Wl(b))}function hl(l,b){if("number"!=typeof l)return!1;return 0!==(l&Wl(b))}function ol(l,b){if("number"!=typeof l)return!1;const d=Wl(b);return(l&d)!==d}function sl(l,b){if(b.type){const d=k(l)?"array":null===l?"null":typeof l;if(b.type!==d)return!1}if(b.required&&k(b.required))for(let d=0;d<b.required.length;d++)if(!(b.required[d]in l))return!1;if(b.properties)for(const d in b.properties){if(!(d in l))return!1;const Z=b.properties[d];if(!sl(l[d],Z))return!1}if(void 0!==b.minimum&&"number"==typeof l&&l<b.minimum)return!1;if(void 0!==b.maximum&&"number"==typeof l&&l>b.maximum)return!1;if(void 0!==b.minLength&&"string"==typeof l&&l.length<b.minLength)return!1;if(void 0!==b.maxLength&&"string"==typeof l&&l.length>b.maxLength)return!1;if(b.pattern&&"string"==typeof l){if(!new RegExp(b.pattern).test(l))return!1}return!(b.enum&&k(b.enum)&&!b.enum.includes(l))}function Vl(l,b){return l instanceof L&&b instanceof L?l.equals(b):l==b}function yl(l,b,d){let Z=l,c=b;switch(l instanceof L&&(Z=l.toString()),b instanceof L&&(c=b.toString()),d){case">":return Z>c;case">=":return Z>=c;case"<":return Z<c;case"<=":return Z<=c;default:return!1}}function Il(l,b){if(void 0===l)return!1;if(null===l)return b(l);if(k(l)){for(var d=0;d<l.length;d++)if(b(l[d]))return!0;return!1}return b(l)}function Yl(l){if("string"!=typeof l)return[];const b=function(l){return"string"!=typeof l?[]:l.toLowerCase().split(/\W+/).filter(l=>l.length>0).filter(l=>!Gl.has(l))}(l);return b.map(l=>function(l){let b=String(l).toLowerCase();if(b.length<3)return b;let d,Z=!1;return 121===b.codePointAt(0)&&(Z=!0,b="Y"+b.slice(1)),dl.test(b)?b=b.slice(0,-2):bl.test(b)&&(b=b.slice(0,-1)),(d=ll.exec(b))?P.test(d[1])&&(b=b.slice(0,-1)):(d=$.exec(b))&&w.test(d[1])&&(b=d[1],q.test(b)?b+="e":Zl.test(b)?b=b.slice(0,-1):O.test(b)&&(b+="e")),(d=A.exec(b))&&w.test(d[1])&&(b=d[1]+"i"),(d=cl.exec(b))&&P.test(d[1])&&(b=d[1]+T[d[2]]),(d=ml.exec(b))&&P.test(d[1])&&(b=d[1]+B[d[2]]),(d=il.exec(b))?M.test(d[1])&&(b=d[1]):(d=_.exec(b))&&M.test(d[1])&&(b=d[1]),(d=D.exec(b))&&(M.test(d[1])||j.test(d[1])&&!O.test(d[1]))&&(b=d[1]),E.test(b)&&M.test(b)&&(b=b.slice(0,-1)),Z&&(b="y"+b.slice(1)),b}(l))}function Kl(l,b){if("string"!=typeof l)return!1;const d=new Set(Yl(l));return Yl(b).some(l=>d.has(l))}function Rl(l,b){try{if(!Array.isArray(b)||2!==b.length)return!1;const d=b[0][0],Z=b[0][1],c=b[1][0];return rl(l,d,c,b[1][1],Z)}catch(d){return!1}}function rl(l,b,d,Z,c){if(!l)return!1;if("FeatureCollection"===l.type&&l.features&&l.features.length>0){for(const m of l.features)if(m.geometry&&!rl(m.geometry,b,d,Z,c))return!1;return!0}if("Feature"===l.type&&l.geometry)return rl(l.geometry,b,d,Z,c);if("Point"===l.type&&l.coordinates){const[m,i]=l.coordinates;if("number"==typeof m&&"number"==typeof i)return m>=b&&m<=d&&i>=Z&&i<=c}if("Polygon"===l.type&&l.coordinates&&l.coordinates.length>0){for(const m of l.coordinates)for(const l of m){const m=l[0],i=l[1];if(m<b||m>d||i<Z||i>c)return!1}return!0}return!1}function Jl(l){if(!l)return null;if("FeatureCollection"===l.type&&l.features&&l.features.length>0){const b=l.features[0];if(b.geometry)return Jl(b.geometry)}if("Feature"===l.type&&l.geometry)return Jl(l.geometry);if("Point"===l.type&&l.coordinates){const[b,d]=l.coordinates;if("number"==typeof b&&"number"==typeof d)return{lat:d,lng:b}}if("Polygon"===l.type&&l.coordinates&&l.coordinates.length>0){const b=l.coordinates[0];if(b.length>0){let l=0,d=0;for(const Z of b)d+=Z[0],l+=Z[1];return{lat:l/b.length,lng:d/b.length}}}return null}function Cl(l,b,d,Z){const c=(d-l)*Math.PI/180,m=(Z-b)*Math.PI/180,i=Math.sin(c/2)*Math.sin(c/2)+Math.cos(l*Math.PI/180)*Math.cos(d*Math.PI/180)*Math.sin(m/2)*Math.sin(m/2);return 6371*(2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i)))}function gl(l,b,d,Z){const c=Jl(l);if(!c)return!1;return 1e3*Cl(c.lat,c.lng,d,b)<=Z}function Sl(l,b){if(!l||!b)return!1;const d=Jl(b);if(!d)return!1;const Z=Jl(l);if(!Z)return!1;if("Polygon"===b.type&&"Point"===l.type)return Nl(Z.lng,Z.lat,b.coordinates[0]);if("Polygon"===l.type&&"Point"===b.type){const d=b.coordinates;return Nl(d[0],d[1],l.coordinates[0])}if("Point"===l.type&&"Point"===b.type){return Cl(Z.lat,Z.lng,d.lat,d.lng)<.001}return!1}function Nl(l,b,d){let Z=!1;for(let c=0,m=d.length-1;c<d.length;m=c++){const i=d[c][0],G=d[c][1],X=d[m][0],t=d[m][1];G>b!=t>b&&l<(X-i)*(b-G)/(t-G)+i&&(Z=!Z)}return Z}function Ll(l,b){var d=Object.keys(b)[0],Z=b[d];if("$"!=d.charAt(0))return Hl(l,d,Z);if("$and"==d)return xl(l,Z);if("$or"==d)return function(l,b){for(var d=0;d<b.length;d++)if(Ll(l,b[d]))return!0;return!1}(l,Z);if("$not"==d)return function(l,b){return!Ll(l,b)}(l,Z);if("$nor"==d)return function(l,b){for(var d=0;d<b.length;d++)if(Ll(l,b[d]))return!1;return!0}(l,Z);if("$where"==d)return function(l,b){if("function"==typeof b)try{return b.call(l)}catch(d){return!1}else if("string"==typeof b)try{return new Function("return "+b).call(l)}catch(d){return!1}return!1}(l,Z);if("$comment"==d)return!0;if("$jsonSchema"==d)return sl(l,Z);if("$text"==d){return function(l,b){return!(!l||"object"!=typeof l)&&function l(d){if("string"==typeof d)return Kl(d,b);if("object"!=typeof d||null===d)return!1;if(k(d)){for(let b=0;b<d.length;b++)if(l(d[b]))return!0;return!1}for(const b in d)if(d.hasOwnProperty(b)&&l(d[b]))return!0;return!1}(l)}(l,Z.$search||Z)}if("$expr"!=d)throw{$err:"Can't canonicalize query: BadValue unknown top level operator: "+d,code:17287};try{return Xl(Z,l)}catch(c){return!1}}function Hl(l,b,d){var Z=function(l,b){for(var d=b.split("."),Z=[l],c=0;c<d.length;c++){for(var m=d[c],i=parseInt(m,10),G=[],X=0;X<Z.length;X++){var t=Z[X];if(null!=t&&null!=t)if(k(t)&&!isNaN(i)&&i>=0)i<t.length&&G.push(t[i]);else if(k(t))for(var u=0;u<t.length;u++)null!=t[u]&&null!=t[u]&&"object"==typeof t[u]&&G.push(t[u][m]);else"object"==typeof t&&G.push(t[m])}Z=G}if(0!==(Z=Z.filter(function(l){return void 0!==l})).length)return 1===Z.length?Z[0]:Z}(l,b);if("string"==typeof d)return Il(Z,function(l){return Vl(l,d)});if("number"==typeof d)return Il(Z,function(l){return Vl(l,d)});if("boolean"==typeof d)return Il(Z,function(l){return Vl(l,d)});if(d instanceof L)return Il(Z,function(l){return Vl(l,d)});if("object"==typeof d){if(d instanceof RegExp)return null!=Z&&Il(Z,function(l){return l&&l.match(d)});if(k(d))return null!=Z&&Il(Z,function(l){return l&&F(l,d)});var c=Object.keys(d);if("$"==c[0].charAt(0)){for(var m=0;m<c.length;m++){var i=Object.keys(d)[m],G=d[i];if("$eq"==i){if(!Il(Z,function(l){return Vl(l,G)}))return!1}else if("$gt"==i){if(!Il(Z,function(l){return yl(l,G,">")}))return!1}else if("$gte"==i){if(!Il(Z,function(l){return yl(l,G,">=")}))return!1}else if("$lt"==i){if(!Il(Z,function(l){return yl(l,G,"<")}))return!1}else if("$lte"==i){if(!Il(Z,function(l){return yl(l,G,"<=")}))return!1}else if("$ne"==i){if(!Il(Z,function(l){return!Vl(l,G)}))return!1}else if("$in"==i){if(!Il(Z,function(l){return z(l,G)}))return!1}else if("$nin"==i){if(Il(Z,function(l){return z(l,G)}))return!1}else if("$exists"==i){var X=x(l,b);if(G?null==X:null!=X)return!1}else if("$type"==i){if(void 0===Z){if(6!==("number"==typeof G?G:nl[G]))return!1}else if(!el(Z,G))return!1}else if("$mod"==i){if(2!=G.length)throw{$err:"Can't canonicalize query: BadValue malformed mod, not enough elements",code:17287};if(!Il(Z,function(l){return null!=l&&l%G[0]==G[1]}))return!1}else if("$regex"==i){var t=G,u=d.$options||"",n="string"==typeof t?new RegExp(t,u):t;if(!Il(Z,function(l){return null!=l&&n.test(l)}))return!1}else{if("$options"==i)continue;if("$text"==i){if(!Il(Z,function(l){return null!=l&&Kl(l,G)}))return!1}else if("$expr"==i)try{if(!Xl(G,l))return!1}catch(Y){return!1}else if("$geoWithin"==i){if(!Il(Z,function(l){return null!=l&&Rl(l,G)}))return!1}else if("$near"==i||"$nearSphere"==i){let l;if(G.$geometry?l=G.$geometry.coordinates:G.coordinates?l=G.coordinates:Array.isArray(G)&&(l=G),!(l&&l.length>=2))return!1;{const[b,d]=l,c=G.$maxDistance||1e6;if(!Il(Z,function(l){return null!=l&&gl(l,b,d,c)}))return!1}}else if("$geoIntersects"==i){const l=G.$geometry||G;if(!Il(Z,function(b){return null!=b&&Sl(b,l)}))return!1}else if("$not"==i){if(Hl(l,b,G))return!1}else if("$all"==i){if(null==(W=x(l,b))||!k(W))return!1;for(var e=0;e<G.length;e++)if(!z(G[e],W))return!1}else if("$elemMatch"==i){var W;if(null==(W=x(l,b))||!k(W))return!1;var p=!1;for(e=0;e<W.length;e++){var a=W[e];if("object"!=typeof a||k(a)){for(var h=!0,o=Object.keys(G),s=0;s<o.length;s++){var V=o[s],y=G[V];("$gte"!=V||a>=y)&&("$gt"!=V||a>y)&&("$lte"!=V||a<=y)&&("$lt"!=V||a<y)?"$eq"==V&&a!=y||"$ne"==V&&a==y?h=!1:"$in"!=V||z(a,y)?"$nin"==V&&z(a,y)&&(h=!1):h=!1:h=!1}if(h){p=!0;break}}else if(kl(a,G)){p=!0;break}}if(!p)return!1}else if("$size"==i){var I=x(l,b);if(null==I||!k(I))return!1;if(I.length!=G)return!1}else if("$bitsAllSet"==i){if(!Il(Z,function(l){return pl(l,G)}))return!1}else if("$bitsAllClear"==i){if(!Il(Z,function(l){return al(l,G)}))return!1}else if("$bitsAnySet"==i){if(!Il(Z,function(l){return hl(l,G)}))return!1}else{if("$bitsAnyClear"!=i)throw{$err:"Can't canonicalize query: BadValue unknown operator: "+i,code:17287};if(!Il(Z,function(l){return ol(l,G)}))return!1}}}return!0}return x(l,b)&&v(x(l,b),d)}}function xl(l,b){for(var d=0;d<b.length;d++)if(!Ll(l,b[d]))return!1;return!0}function kl(l,b){return xl(l,function(l){var b=[];for(var d in l)if(l.hasOwnProperty(d)){var Z={};Z[d]=l[d],b.push(Z)}return b}(b))}class zl extends d.EventEmitter{constructor(l,b=[],d={}){super(),this.target=l,this.pipeline=b,this.options=d,this.closed=!1,this._listeners=/* @__PURE__ */new Map,this._changeCounter=0,this._startWatching()}_isDB(l){return l&&"string"==typeof l.dbName&&"function"==typeof l.getCollectionNames&&l.collections instanceof Map}_isServer(l){return l&&l.databases instanceof Map&&"function"==typeof l._getDB}_isMongoClient(l){return l&&"function"==typeof l.connect&&"function"==typeof l.db&&"MongoClient"===l.constructor.name}_startWatching(){if(this.closed)return;const l=this._getCollectionsToWatch();for(const b of l)this._watchCollection(b);this._isServer(this.target)&&this._interceptServerDBCreation(),this._isDB(this.target)&&this._interceptDBCollectionCreation(),this._isMongoClient(this.target)&&this._interceptClientDBCreation()}_getCollectionsToWatch(){const l=[];if(this._isServer(this.target)){for(const[b,d]of this.target.databases){const b=d.getCollectionNames();for(const Z of b){const b=d[Z];b&&b.isCollection&&l.push(b)}}return l}if(this._isMongoClient(this.target))return this._monitorClient(),l;if(this._isDB(this.target)){const b=this.target.getCollectionNames();for(const d of b){const b=this.target[d];b&&b.isCollection&&l.push(b)}this._monitorDB()}return this.target.isCollection&&l.push(this.target),l}_watchCollection(l){if(this.closed)return;if(!l)return;if("function"!=typeof l.on)return;if(!l.isCollection)return;if(this._listeners.has(l))return;const b={insert:b=>this._emitChange("insert",l,b),update:(b,d)=>this._emitChange("update",l,b,d),replace:b=>this._emitChange("replace",l,b),delete:b=>this._emitChange("delete",l,b)};this._listeners.set(l,b),l.on("insert",b.insert),l.on("update",b.update),l.on("replace",b.replace),l.on("delete",b.delete)}_emitChange(l,b,d,Z=null){if(this.closed)return;const c=this._createChangeEvent(l,b,d,Z);this._matchesPipeline(c)&&this.emit("change",c)}_createChangeEvent(l,b,d,Z){const c={_id:{_data:btoa(String(++this._changeCounter))},operationType:l,clusterTime:/* @__PURE__ */new Date,ns:{db:b.db.dbName,coll:b.name},documentKey:{_id:d._id}};switch(l){case"insert":case"replace":c.fullDocument=d;break;case"update":c.updateDescription=Z||{updatedFields:{},removedFields:[],truncatedArrays:[]},"updateLookup"===this.options.fullDocument&&(c.fullDocument=d)}return c}_matchesPipeline(l){if(!this.pipeline||0===this.pipeline.length)return!0;for(const b of this.pipeline)if(b.$match&&!kl(l,b.$match))return!1;return!0}_getNestedValue(l,b){return b.split(".").reduce((l,b)=>l?.[b],l)}_monitorClient(){}_interceptClientDBCreation(){const l=this.target,b=l.db.bind(l),d=this;this._watchedDBs=/* @__PURE__ */new Map,l.db=function(l,Z){const c=b(l,Z),m=c.dbName;if(!d._watchedDBs.has(m)){d._watchedDBs.set(m,c);const l=c.getCollectionNames();for(const b of l){const l=c[b];l&&l.isCollection&&!d._listeners.has(l)&&d._watchCollection(l)}d._interceptDBCollectionCreationForClient(c)}return c},this._originalClientMethods={db:b}}_interceptServerDBCreation(){const l=this.target,b=l._getDB.bind(l),d=this;this._watchedDBs=/* @__PURE__ */new Map,l._getDB=function(l){const Z=b(l);if(!d._watchedDBs.has(l)){d._watchedDBs.set(l,Z);const b=Z.getCollectionNames();for(const l of b){const b=Z[l];b&&b.isCollection&&!d._listeners.has(b)&&d._watchCollection(b)}d._interceptDBCollectionCreationForServer(Z)}return Z},this._originalServerMethods={_getDB:b}}_interceptDBCollectionCreationForServer(l){const b=l.collection.bind(l),d=l.createCollection.bind(l),Z=this;l.collection=function(l){const d=b(l);return d&&d.isCollection&&!Z._listeners.has(d)&&Z._watchCollection(d),d},l.createCollection=function(b){d(b);const c=l[b];c&&c.isCollection&&!Z._listeners.has(c)&&Z._watchCollection(c)}}_interceptDBCollectionCreationForClient(l){const b=l.collection.bind(l),d=l.createCollection.bind(l),Z=this;l.collection=function(l){const d=b(l);return d&&d.isCollection&&!Z._listeners.has(d)&&Z._watchCollection(d),d},l.createCollection=function(b){d(b);const c=l[b];c&&c.isCollection&&!Z._listeners.has(c)&&Z._watchCollection(c)}}_monitorDB(){}_interceptDBCollectionCreation(){const l=this.target,b=l.getCollection.bind(l),d=l.createCollection?l.createCollection.bind(l):null,Z=this;l.getCollection=function(l){const d=b(l);return d&&d.isCollection&&!Z._listeners.has(d)&&Z._watchCollection(d),d},d&&(l.createCollection=function(b){d(b);const c=l[b];c&&c.isCollection&&!Z._listeners.has(c)&&Z._watchCollection(c)}),this._originalDBMethods={getCollection:b,createCollection:d}}close(){if(!this.closed){this.closed=!0;for(const[l,b]of this._listeners)l.off("insert",b.insert),l.off("update",b.update),l.off("replace",b.replace),l.off("delete",b.delete);this._listeners.clear(),this._originalServerMethods&&"Server"===this.target.constructor.name&&(this.target._getDB=this._originalServerMethods._getDB),this._originalDBMethods&&"DB"===this.target.constructor.name&&(this.target.collection=this._originalDBMethods.collection,this.target.createCollection=this._originalDBMethods.createCollection),this._originalClientMethods&&"MongoClient"===this.target.constructor.name&&(this.target.db=this._originalClientMethods.db),this.emit("close"),this.removeAllListeners()}}get isClosed(){return this.closed}async*[Symbol.asyncIterator](){const l=[];let b=null,d=!1;const Z=d=>{b?(b({value:d,done:!1}),b=null):l.push(d)},c=()=>{d=!0,b&&(b({done:!0}),b=null)},m=l=>{b&&(b(Promise.reject(l)),b=null)};this.on("change",Z),this.on("close",c),this.on("error",m);try{for(;!d;)if(l.length>0)yield l.shift();else{const l=await new Promise(l=>{b=l,d&&l({done:!0})});if(l.done)break;yield l.value}}finally{this.off("change",Z),this.off("close",c),this.off("error",m)}}async next(){return new Promise((l,b)=>{const d=b=>{m(),l(b)},Z=()=>{m(),l(null)},c=l=>{m(),b(l)},m=()=>{this.off("change",d),this.off("close",Z),this.off("error",c)};this.closed?l(null):(this.once("change",d),this.once("close",Z),this.once("error",c))})}}class Fl{constructor(l=!1){this.enabled=l,this.timings=[],this.nestedLevel=0}setEnabled(l){this.enabled=l}start(l,b,d={}){return this.enabled?{category:l,operation:b,details:d,startTime:performance.now(),nestedLevel:this.nestedLevel++}:null}end(l,b={}){if(!this.enabled||!l)return;this.nestedLevel>0&&this.nestedLevel--;const d=performance.now()-l.startTime;this.timings.push({category:l.category,operation:l.operation,duration:d,details:{...l.details,...b},nestedLevel:l.nestedLevel,timestamp:l.startTime})}getTimings(){return this.timings}getTimingsByCategory(){const l={};for(const b of this.timings)l[b.category]||(l[b.category]=[]),l[b.category].push(b);return l}getSummary(){const l={};for(const b of this.timings){const d=`${b.category}.${b.operation}`;l[d]||(l[d]={category:b.category,operation:b.operation,count:0,total:0,min:1/0,max:-1/0,avg:0});const Z=l[d];Z.count++,Z.total+=b.duration,Z.min=Math.min(Z.min,b.duration),Z.max=Math.max(Z.max,b.duration),Z.avg=Z.total/Z.count}return Object.values(l)}clear(){this.timings=[],this.nestedLevel=0}formatTimings(){const l=this.getSummary();if(0===l.length)return"No timing data collected";let b="\n"+"=".repeat(80)+"\n";b+="PERFORMANCE TIMING REPORT\n",b+="=".repeat(80)+"\n\n";const d={};for(const Z of l)d[Z.category]||(d[Z.category]=[]),d[Z.category].push(Z);for(const[Z,c]of Object.entries(d)){b+=`${Z.toUpperCase()}\n`,b+="-".repeat(80)+"\n",b+="Operation".padEnd(30)+"Count".padStart(8)+"Total(ms)".padStart(12)+"Avg(ms)".padStart(12)+"Min(ms)".padStart(12)+"Max(ms)".padStart(12)+"\n",b+="-".repeat(80)+"\n";for(const l of c)b+=l.operation.padEnd(30)+l.count.toString().padStart(8)+l.total.toFixed(3).padStart(12)+l.avg.toFixed(3).padStart(12)+l.min.toFixed(3).padStart(12)+l.max.toFixed(3).padStart(12)+"\n";b+="\n"}return b+="=".repeat(80)+"\n",b}}const vl=new Fl(!1);function Tl(l){if(null==l)return l;if("function"==typeof l)return{__function:l.toString()};if(l&&"object"==typeof l&&"function"==typeof l.toString)try{const b=l.toString();if(b&&24===b.length&&/^[0-9a-f]{24}$/i.test(b)&&l.constructor&&"ObjectId"===l.constructor.name)return{__objectId:b}}catch(b){}if(l instanceof L)return{__objectId:l.toString()};if(l instanceof Date)return{__date:l.toISOString()};if(Array.isArray(l))return l.map(Tl);if("object"==typeof l){const b={};for(const[d,Z]of Object.entries(l))b[d]=Tl(Z);return b}return l}function Bl(l){if(null==l)return l;if("object"==typeof l&&l.__function)return"string"==typeof l.__function?`(${l.__function}).call(this)`:void 0;if("object"==typeof l&&l.__objectId)return new L(l.__objectId);if("object"==typeof l&&l.__date)return new Date(l.__date);if(Array.isArray(l))return l.map(Bl);if("object"==typeof l){const b={};for(const[d,Z]of Object.entries(l))b[d]=Bl(Z);return b}return l}class Ul extends d.EventEmitter{constructor(l){super(),this.worker=l,this._nextId=1,this._pending=/* @__PURE__ */new Map,this._terminating=!1,this._handleMessage=this._handleMessage.bind(this),this._handleError=this._handleError.bind(this),this._attach()}static async create(l={}){if("undefined"!=typeof window&&void 0!==globalThis.Worker)return new Ql(l);const{Worker:b}=await import("worker_threads"),{fileURLToPath:d}=await import("url");let Z=l.workerPath;if(!Z){Z=d(new URL("data:text/javascript;base64,dmFyIGUsdD17ZXhwb3J0czp7fX07dmFyIG49ZnVuY3Rpb24oKXtpZihlKXJldHVybiB0LmV4cG9ydHM7ZT0xO3ZhciBuLHI9Im9iamVjdCI9PXR5cGVvZiBSZWZsZWN0P1JlZmxlY3Q6bnVsbCxpPXImJiJmdW5jdGlvbiI9PXR5cGVvZiByLmFwcGx5P3IuYXBwbHk6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBGdW5jdGlvbi5wcm90b3R5cGUuYXBwbHkuY2FsbChlLHQsbil9O249ciYmImZ1bmN0aW9uIj09dHlwZW9mIHIub3duS2V5cz9yLm93bktleXM6T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scz9mdW5jdGlvbihlKXtyZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoZSkuY29uY2F0KE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSkpfTpmdW5jdGlvbihlKXtyZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoZSl9O3ZhciBzPU51bWJlci5pc05hTnx8ZnVuY3Rpb24oZSl7cmV0dXJuIGUhPWV9O2Z1bmN0aW9uIG8oKXtvLmluaXQuY2FsbCh0aGlzKX10LmV4cG9ydHM9byx0LmV4cG9ydHMub25jZT1mdW5jdGlvbihlLHQpe3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihuLHIpe2Z1bmN0aW9uIGkobil7ZS5yZW1vdmVMaXN0ZW5lcih0LHMpLHIobil9ZnVuY3Rpb24gcygpeyJmdW5jdGlvbiI9PXR5cGVvZiBlLnJlbW92ZUxpc3RlbmVyJiZlLnJlbW92ZUxpc3RlbmVyKCJlcnJvciIsaSksbihbXS5zbGljZS5jYWxsKGFyZ3VtZW50cykpfW0oZSx0LHMse29uY2U6ITB9KSwiZXJyb3IiIT09dCYmZnVuY3Rpb24oZSx0LG4peyJmdW5jdGlvbiI9PXR5cGVvZiBlLm9uJiZtKGUsImVycm9yIix0LG4pfShlLGkse29uY2U6ITB9KX0pfSxvLkV2ZW50RW1pdHRlcj1vLG8ucHJvdG90eXBlLl9ldmVudHM9dm9pZCAwLG8ucHJvdG90eXBlLl9ldmVudHNDb3VudD0wLG8ucHJvdG90eXBlLl9tYXhMaXN0ZW5lcnM9dm9pZCAwO3ZhciBhPTEwO2Z1bmN0aW9uIGMoZSl7aWYoImZ1bmN0aW9uIiE9dHlwZW9mIGUpdGhyb3cgbmV3IFR5cGVFcnJvcignVGhlICJsaXN0ZW5lciIgYXJndW1lbnQgbXVzdCBiZSBvZiB0eXBlIEZ1bmN0aW9uLiBSZWNlaXZlZCB0eXBlICcrdHlwZW9mIGUpfWZ1bmN0aW9uIGwoZSl7cmV0dXJuIHZvaWQgMD09PWUuX21heExpc3RlbmVycz9vLmRlZmF1bHRNYXhMaXN0ZW5lcnM6ZS5fbWF4TGlzdGVuZXJzfWZ1bmN0aW9uIHUoZSx0LG4scil7dmFyIGkscyxvLGE7aWYoYyhuKSx2b2lkIDA9PT0ocz1lLl9ldmVudHMpPyhzPWUuX2V2ZW50cz0vKiBAX19QVVJFX18gKi9PYmplY3QuY3JlYXRlKG51bGwpLGUuX2V2ZW50c0NvdW50PTApOih2b2lkIDAhPT1zLm5ld0xpc3RlbmVyJiYoZS5lbWl0KCJuZXdMaXN0ZW5lciIsdCxuLmxpc3RlbmVyP24ubGlzdGVuZXI6bikscz1lLl9ldmVudHMpLG89c1t0XSksdm9pZCAwPT09bylvPXNbdF09biwrK2UuX2V2ZW50c0NvdW50O2Vsc2UgaWYoImZ1bmN0aW9uIj09dHlwZW9mIG8/bz1zW3RdPXI/W24sb106W28sbl06cj9vLnVuc2hpZnQobik6by5wdXNoKG4pLChpPWwoZSkpPjAmJm8ubGVuZ3RoPmkmJiFvLndhcm5lZCl7by53YXJuZWQ9ITA7dmFyIHU9bmV3IEVycm9yKCJQb3NzaWJsZSBFdmVudEVtaXR0ZXIgbWVtb3J5IGxlYWsgZGV0ZWN0ZWQuICIrby5sZW5ndGgrIiAiK1N0cmluZyh0KSsiIGxpc3RlbmVycyBhZGRlZC4gVXNlIGVtaXR0ZXIuc2V0TWF4TGlzdGVuZXJzKCkgdG8gaW5jcmVhc2UgbGltaXQiKTt1Lm5hbWU9Ik1heExpc3RlbmVyc0V4Y2VlZGVkV2FybmluZyIsdS5lbWl0dGVyPWUsdS50eXBlPXQsdS5jb3VudD1vLmxlbmd0aCxhPXUsY29uc29sZSYmY29uc29sZS53YXJuJiZjb25zb2xlLndhcm4oYSl9cmV0dXJuIGV9ZnVuY3Rpb24gaCgpe2lmKCF0aGlzLmZpcmVkKXJldHVybiB0aGlzLnRhcmdldC5yZW1vdmVMaXN0ZW5lcih0aGlzLnR5cGUsdGhpcy53cmFwRm4pLHRoaXMuZmlyZWQ9ITAsMD09PWFyZ3VtZW50cy5sZW5ndGg/dGhpcy5saXN0ZW5lci5jYWxsKHRoaXMudGFyZ2V0KTp0aGlzLmxpc3RlbmVyLmFwcGx5KHRoaXMudGFyZ2V0LGFyZ3VtZW50cyl9ZnVuY3Rpb24gZihlLHQsbil7dmFyIHI9e2ZpcmVkOiExLHdyYXBGbjp2b2lkIDAsdGFyZ2V0OmUsdHlwZTp0LGxpc3RlbmVyOm59LGk9aC5iaW5kKHIpO3JldHVybiBpLmxpc3RlbmVyPW4sci53cmFwRm49aSxpfWZ1bmN0aW9uIGQoZSx0LG4pe3ZhciByPWUuX2V2ZW50cztpZih2b2lkIDA9PT1yKXJldHVybltdO3ZhciBpPXJbdF07cmV0dXJuIHZvaWQgMD09PWk/W106ImZ1bmN0aW9uIj09dHlwZW9mIGk/bj9baS5saXN0ZW5lcnx8aV06W2ldOm4/ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PW5ldyBBcnJheShlLmxlbmd0aCksbj0wO248dC5sZW5ndGg7KytuKXRbbl09ZVtuXS5saXN0ZW5lcnx8ZVtuXTtyZXR1cm4gdH0oaSk6ZyhpLGkubGVuZ3RoKX1mdW5jdGlvbiBwKGUpe3ZhciB0PXRoaXMuX2V2ZW50cztpZih2b2lkIDAhPT10KXt2YXIgbj10W2VdO2lmKCJmdW5jdGlvbiI9PXR5cGVvZiBuKXJldHVybiAxO2lmKHZvaWQgMCE9PW4pcmV0dXJuIG4ubGVuZ3RofXJldHVybiAwfWZ1bmN0aW9uIGcoZSx0KXtmb3IodmFyIG49bmV3IEFycmF5KHQpLHI9MDtyPHQ7KytyKW5bcl09ZVtyXTtyZXR1cm4gbn1mdW5jdGlvbiBtKGUsdCxuLHIpe2lmKCJmdW5jdGlvbiI9PXR5cGVvZiBlLm9uKXIub25jZT9lLm9uY2UodCxuKTplLm9uKHQsbik7ZWxzZXtpZigiZnVuY3Rpb24iIT10eXBlb2YgZS5hZGRFdmVudExpc3RlbmVyKXRocm93IG5ldyBUeXBlRXJyb3IoJ1RoZSAiZW1pdHRlciIgYXJndW1lbnQgbXVzdCBiZSBvZiB0eXBlIEV2ZW50RW1pdHRlci4gUmVjZWl2ZWQgdHlwZSAnK3R5cGVvZiBlKTtlLmFkZEV2ZW50TGlzdGVuZXIodCxmdW5jdGlvbiBpKHMpe3Iub25jZSYmZS5yZW1vdmVFdmVudExpc3RlbmVyKHQsaSksbihzKX0pfX1yZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sImRlZmF1bHRNYXhMaXN0ZW5lcnMiLHtlbnVtZXJhYmxlOiEwLGdldDpmdW5jdGlvbigpe3JldHVybiBhfSxzZXQ6ZnVuY3Rpb24oZSl7aWYoIm51bWJlciIhPXR5cGVvZiBlfHxlPDB8fHMoZSkpdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1RoZSB2YWx1ZSBvZiAiZGVmYXVsdE1heExpc3RlbmVycyIgaXMgb3V0IG9mIHJhbmdlLiBJdCBtdXN0IGJlIGEgbm9uLW5lZ2F0aXZlIG51bWJlci4gUmVjZWl2ZWQgJytlKyIuIik7YT1lfX0pLG8uaW5pdD1mdW5jdGlvbigpe3ZvaWQgMCE9PXRoaXMuX2V2ZW50cyYmdGhpcy5fZXZlbnRzIT09T2JqZWN0LmdldFByb3RvdHlwZU9mKHRoaXMpLl9ldmVudHN8fCh0aGlzLl9ldmVudHM9LyogQF9fUFVSRV9fICovT2JqZWN0LmNyZWF0ZShudWxsKSx0aGlzLl9ldmVudHNDb3VudD0wKSx0aGlzLl9tYXhMaXN0ZW5lcnM9dGhpcy5fbWF4TGlzdGVuZXJzfHx2b2lkIDB9LG8ucHJvdG90eXBlLnNldE1heExpc3RlbmVycz1mdW5jdGlvbihlKXtpZigibnVtYmVyIiE9dHlwZW9mIGV8fGU8MHx8cyhlKSl0aHJvdyBuZXcgUmFuZ2VFcnJvcignVGhlIHZhbHVlIG9mICJuIiBpcyBvdXQgb2YgcmFuZ2UuIEl0IG11c3QgYmUgYSBub24tbmVnYXRpdmUgbnVtYmVyLiBSZWNlaXZlZCAnK2UrIi4iKTtyZXR1cm4gdGhpcy5fbWF4TGlzdGVuZXJzPWUsdGhpc30sby5wcm90b3R5cGUuZ2V0TWF4TGlzdGVuZXJzPWZ1bmN0aW9uKCl7cmV0dXJuIGwodGhpcyl9LG8ucHJvdG90eXBlLmVtaXQ9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PVtdLG49MTtuPGFyZ3VtZW50cy5sZW5ndGg7bisrKXQucHVzaChhcmd1bWVudHNbbl0pO3ZhciByPSJlcnJvciI9PT1lLHM9dGhpcy5fZXZlbnRzO2lmKHZvaWQgMCE9PXMpcj1yJiZ2b2lkIDA9PT1zLmVycm9yO2Vsc2UgaWYoIXIpcmV0dXJuITE7aWYocil7dmFyIG87aWYodC5sZW5ndGg+MCYmKG89dFswXSksbyBpbnN0YW5jZW9mIEVycm9yKXRocm93IG87dmFyIGE9bmV3IEVycm9yKCJVbmhhbmRsZWQgZXJyb3IuIisobz8iICgiK28ubWVzc2FnZSsiKSI6IiIpKTt0aHJvdyBhLmNvbnRleHQ9byxhfXZhciBjPXNbZV07aWYodm9pZCAwPT09YylyZXR1cm4hMTtpZigiZnVuY3Rpb24iPT10eXBlb2YgYylpKGMsdGhpcyx0KTtlbHNle3ZhciBsPWMubGVuZ3RoLHU9ZyhjLGwpO2ZvcihuPTA7bjxsOysrbilpKHVbbl0sdGhpcyx0KX1yZXR1cm4hMH0sby5wcm90b3R5cGUuYWRkTGlzdGVuZXI9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdSh0aGlzLGUsdCwhMSl9LG8ucHJvdG90eXBlLm9uPW8ucHJvdG90eXBlLmFkZExpc3RlbmVyLG8ucHJvdG90eXBlLnByZXBlbmRMaXN0ZW5lcj1mdW5jdGlvbihlLHQpe3JldHVybiB1KHRoaXMsZSx0LCEwKX0sby5wcm90b3R5cGUub25jZT1mdW5jdGlvbihlLHQpe3JldHVybiBjKHQpLHRoaXMub24oZSxmKHRoaXMsZSx0KSksdGhpc30sby5wcm90b3R5cGUucHJlcGVuZE9uY2VMaXN0ZW5lcj1mdW5jdGlvbihlLHQpe3JldHVybiBjKHQpLHRoaXMucHJlcGVuZExpc3RlbmVyKGUsZih0aGlzLGUsdCkpLHRoaXN9LG8ucHJvdG90eXBlLnJlbW92ZUxpc3RlbmVyPWZ1bmN0aW9uKGUsdCl7dmFyIG4scixpLHMsbztpZihjKHQpLHZvaWQgMD09PShyPXRoaXMuX2V2ZW50cykpcmV0dXJuIHRoaXM7aWYodm9pZCAwPT09KG49cltlXSkpcmV0dXJuIHRoaXM7aWYobj09PXR8fG4ubGlzdGVuZXI9PT10KTA9PT0tLXRoaXMuX2V2ZW50c0NvdW50P3RoaXMuX2V2ZW50cz0vKiBAX19QVVJFX18gKi9PYmplY3QuY3JlYXRlKG51bGwpOihkZWxldGUgcltlXSxyLnJlbW92ZUxpc3RlbmVyJiZ0aGlzLmVtaXQoInJlbW92ZUxpc3RlbmVyIixlLG4ubGlzdGVuZXJ8fHQpKTtlbHNlIGlmKCJmdW5jdGlvbiIhPXR5cGVvZiBuKXtmb3IoaT0tMSxzPW4ubGVuZ3RoLTE7cz49MDtzLS0paWYobltzXT09PXR8fG5bc10ubGlzdGVuZXI9PT10KXtvPW5bc10ubGlzdGVuZXIsaT1zO2JyZWFrfWlmKGk8MClyZXR1cm4gdGhpczswPT09aT9uLnNoaWZ0KCk6ZnVuY3Rpb24oZSx0KXtmb3IoO3QrMTxlLmxlbmd0aDt0KyspZVt0XT1lW3QrMV07ZS5wb3AoKX0obixpKSwxPT09bi5sZW5ndGgmJihyW2VdPW5bMF0pLHZvaWQgMCE9PXIucmVtb3ZlTGlzdGVuZXImJnRoaXMuZW1pdCgicmVtb3ZlTGlzdGVuZXIiLGUsb3x8dCl9cmV0dXJuIHRoaXN9LG8ucHJvdG90eXBlLm9mZj1vLnByb3RvdHlwZS5yZW1vdmVMaXN0ZW5lcixvLnByb3RvdHlwZS5yZW1vdmVBbGxMaXN0ZW5lcnM9ZnVuY3Rpb24oZSl7dmFyIHQsbixyO2lmKHZvaWQgMD09PShuPXRoaXMuX2V2ZW50cykpcmV0dXJuIHRoaXM7aWYodm9pZCAwPT09bi5yZW1vdmVMaXN0ZW5lcilyZXR1cm4gMD09PWFyZ3VtZW50cy5sZW5ndGg/KHRoaXMuX2V2ZW50cz0vKiBAX19QVVJFX18gKi9PYmplY3QuY3JlYXRlKG51bGwpLHRoaXMuX2V2ZW50c0NvdW50PTApOnZvaWQgMCE9PW5bZV0mJigwPT09LS10aGlzLl9ldmVudHNDb3VudD90aGlzLl9ldmVudHM9LyogQF9fUFVSRV9fICovT2JqZWN0LmNyZWF0ZShudWxsKTpkZWxldGUgbltlXSksdGhpcztpZigwPT09YXJndW1lbnRzLmxlbmd0aCl7dmFyIGkscz1PYmplY3Qua2V5cyhuKTtmb3Iocj0wO3I8cy5sZW5ndGg7KytyKSJyZW1vdmVMaXN0ZW5lciIhPT0oaT1zW3JdKSYmdGhpcy5yZW1vdmVBbGxMaXN0ZW5lcnMoaSk7cmV0dXJuIHRoaXMucmVtb3ZlQWxsTGlzdGVuZXJzKCJyZW1vdmVMaXN0ZW5lciIpLHRoaXMuX2V2ZW50cz0vKiBAX19QVVJFX18gKi9PYmplY3QuY3JlYXRlKG51bGwpLHRoaXMuX2V2ZW50c0NvdW50PTAsdGhpc31pZigiZnVuY3Rpb24iPT10eXBlb2YodD1uW2VdKSl0aGlzLnJlbW92ZUxpc3RlbmVyKGUsdCk7ZWxzZSBpZih2b2lkIDAhPT10KWZvcihyPXQubGVuZ3RoLTE7cj49MDtyLS0pdGhpcy5yZW1vdmVMaXN0ZW5lcihlLHRbcl0pO3JldHVybiB0aGlzfSxvLnByb3RvdHlwZS5saXN0ZW5lcnM9ZnVuY3Rpb24oZSl7cmV0dXJuIGQodGhpcyxlLCEwKX0sby5wcm90b3R5cGUucmF3TGlzdGVuZXJzPWZ1bmN0aW9uKGUpe3JldHVybiBkKHRoaXMsZSwhMSl9LG8ubGlzdGVuZXJDb3VudD1mdW5jdGlvbihlLHQpe3JldHVybiJmdW5jdGlvbiI9PXR5cGVvZiBlLmxpc3RlbmVyQ291bnQ/ZS5saXN0ZW5lckNvdW50KHQpOnAuY2FsbChlLHQpfSxvLnByb3RvdHlwZS5saXN0ZW5lckNvdW50PXAsby5wcm90b3R5cGUuZXZlbnROYW1lcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9ldmVudHNDb3VudD4wP24odGhpcy5fZXZlbnRzKTpbXX0sdC5leHBvcnRzfSgpO2NvbnN0IHI9MCxpPTEscz0yLG89MyxhPTQsYz01LGw9Nix1PTcsaD04LGY9OSxkPTE2LHA9MTc7Y2xhc3MgZ3tjb25zdHJ1Y3RvcihlKXtpZihudWxsPT1lKXRoaXMuaWQ9Zy5nZW5lcmF0ZSgpO2Vsc2UgaWYoInN0cmluZyI9PXR5cGVvZiBlKXtpZighZy5pc1ZhbGlkKGUpKXRocm93IG5ldyBFcnJvcihgQXJndW1lbnQgcGFzc2VkIGluIG11c3QgYmUgYSBzdHJpbmcgb2YgMjQgaGV4IGNoYXJhY3RlcnMsIGdvdDogJHtlfWApO3RoaXMuaWQ9ZS50b0xvd2VyQ2FzZSgpfWVsc2UgaWYoZSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkmJjEyPT09ZS5sZW5ndGgpdGhpcy5pZD1BcnJheS5mcm9tKGUpLm1hcChlPT5lLnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLCIwIikpLmpvaW4oIiIpO2Vsc2V7aWYoIShlIGluc3RhbmNlb2YgZykpdGhyb3cgbmV3IEVycm9yKCJBcmd1bWVudCBwYXNzZWQgaW4gbXVzdCBiZSBhIHN0cmluZyBvZiAyNCBoZXggY2hhcmFjdGVycyBvciBhbiBPYmplY3RJZCIpO3RoaXMuaWQ9ZS5pZH19dG9TdHJpbmcoKXtyZXR1cm4gdGhpcy5pZH10b0hleFN0cmluZygpe3JldHVybiB0aGlzLmlkfWdldFRpbWVzdGFtcCgpe2NvbnN0IGU9cGFyc2VJbnQodGhpcy5pZC5zdWJzdHJpbmcoMCw4KSwxNik7cmV0dXJuIG5ldyBEYXRlKDFlMyplKX1lcXVhbHMoZSl7aWYoIShlIGluc3RhbmNlb2YgZykpdGhyb3cgbmV3IEVycm9yKCJDYW4gb25seSBjb21wYXJlIHdpdGggYW5vdGhlciBPYmplY3RJZCIpO3JldHVybiB0aGlzLmlkPT09ZS5pZH1jb21wYXJlKGUpe2lmKCEoZSBpbnN0YW5jZW9mIGcpKXRocm93IG5ldyBFcnJvcigiQ2FuIG9ubHkgY29tcGFyZSB3aXRoIGFub3RoZXIgT2JqZWN0SWQiKTtyZXR1cm4gdGhpcy5pZC5sb2NhbGVDb21wYXJlKGUuaWQpfXRvSlNPTigpe3JldHVybiB0aGlzLmlkfWluc3BlY3QoKXtyZXR1cm5gT2JqZWN0SWQoIiR7dGhpcy5pZH0iKWB9dG9CeXRlcygpe2NvbnN0IGU9bmV3IFVpbnQ4QXJyYXkoMTIpO2ZvcihsZXQgdD0wO3Q8MTI7dCsrKWVbdF09cGFyc2VJbnQodGhpcy5pZC5zdWJzdHJpbmcoMip0LDIqdCsyKSwxNik7cmV0dXJuIGV9c3RhdGljIGlzVmFsaWQoZSl7cmV0dXJuISFlJiYoInN0cmluZyI9PXR5cGVvZiBlJiYoMjQ9PT1lLmxlbmd0aCYmL15bMC05YS1mQS1GXXsyNH0kLy50ZXN0KGUpKSl9c3RhdGljIGNyZWF0ZUZyb21UaW1lKGUpe2NvbnN0IHQ9KCIwMDAwMDAwMCIrTWF0aC5mbG9vcihlLzFlMykudG9TdHJpbmcoMTYpKS5zbGljZSgtOCk7cmV0dXJuIG5ldyBnKHQrIjAwMDAwMDAwMDAwMDAwMDAiKX1zdGF0aWMgZ2VuZXJhdGUoKXtjb25zdCBlPU1hdGguZmxvb3IoRGF0ZS5ub3coKS8xZTMpLHQ9InVuZGVmaW5lZCIhPXR5cGVvZiBjcnlwdG8mJmNyeXB0by5nZXRSYW5kb21WYWx1ZXM/bmV3IFVpbnQ4QXJyYXkoOCk6bnVsbDtsZXQgbj0iIjtpZih0KXtjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKHQpO2ZvcihsZXQgZT0wO2U8dC5sZW5ndGg7ZSsrKW4rPSgiMCIrdFtlXS50b1N0cmluZygxNikpLnNsaWNlKC0yKX1lbHNlIG49TWF0aC5yYW5kb20oKS50b1N0cmluZygxNikuc2xpY2UoMikucGFkRW5kKDgsIjAiKS5zbGljZSgwLDgpK01hdGgucmFuZG9tKCkudG9TdHJpbmcoMTYpLnNsaWNlKDIpLnBhZEVuZCg4LCIwIikuc2xpY2UoMCw4KTtyZXR1cm4oKCIwMDAwMDAwMCIrZS50b1N0cmluZygxNikpLnNsaWNlKC04KStuKS5zbGljZSgwLDI0KX19Y2xhc3MgbXtjb25zdHJ1Y3RvcihlKXtpZihudWxsPT1lKXRocm93IG5ldyBFcnJvcigiUG9pbnRlciBvZmZzZXQgbXVzdCBiZSBhIG51bWJlciIpO2lmKCJudW1iZXIiIT10eXBlb2YgZSl0aHJvdyBuZXcgRXJyb3IoIlBvaW50ZXIgb2Zmc2V0IG11c3QgYmUgYSBudW1iZXIiKTtpZighTnVtYmVyLmlzSW50ZWdlcihlKSl0aHJvdyBuZXcgRXJyb3IoIlBvaW50ZXIgb2Zmc2V0IG11c3QgYmUgYW4gaW50ZWdlciIpO2lmKGU8MCl0aHJvdyBuZXcgRXJyb3IoIlBvaW50ZXIgb2Zmc2V0IG11c3QgYmUgbm9uLW5lZ2F0aXZlIik7aWYoZT5OdW1iZXIuTUFYX1NBRkVfSU5URUdFUil0aHJvdyBuZXcgRXJyb3IoIlBvaW50ZXIgb2Zmc2V0IGV4Y2VlZHMgbWF4aW11bSBzYWZlIGludGVnZXIiKTt0aGlzLm9mZnNldD1lfXZhbHVlT2YoKXtyZXR1cm4gdGhpcy5vZmZzZXR9dG9TdHJpbmcoKXtyZXR1cm4gdGhpcy5vZmZzZXQudG9TdHJpbmcoKX10b0pTT04oKXtyZXR1cm4gdGhpcy5vZmZzZXR9aW5zcGVjdCgpe3JldHVybmBQb2ludGVyKCR7dGhpcy5vZmZzZXR9KWB9ZXF1YWxzKGUpe3JldHVybiBlIGluc3RhbmNlb2YgbSYmdGhpcy5vZmZzZXQ9PT1lLm9mZnNldH19ZnVuY3Rpb24geShlKXtjb25zdCB0PVtdOyFmdW5jdGlvbiBlKG4pe2lmKG51bGw9PT1uKXQucHVzaChuZXcgVWludDhBcnJheShbcl0pKTtlbHNlIGlmKCExPT09bil0LnB1c2gobmV3IFVpbnQ4QXJyYXkoW2ldKSk7ZWxzZSBpZighMD09PW4pdC5wdXNoKG5ldyBVaW50OEFycmF5KFtzXSkpO2Vsc2UgaWYobiBpbnN0YW5jZW9mIGcpdC5wdXNoKG5ldyBVaW50OEFycmF5KFtsXSkpLHQucHVzaChuLnRvQnl0ZXMoKSk7ZWxzZSBpZihuIGluc3RhbmNlb2YgRGF0ZSl7dC5wdXNoKG5ldyBVaW50OEFycmF5KFt1XSkpO2NvbnN0IGU9bmV3IEFycmF5QnVmZmVyKDgpO25ldyBEYXRhVmlldyhlKS5zZXRCaWdJbnQ2NCgwLEJpZ0ludChuLmdldFRpbWUoKSksITApLHQucHVzaChuZXcgVWludDhBcnJheShlKSl9ZWxzZSBpZihuIGluc3RhbmNlb2YgbSl7dC5wdXNoKG5ldyBVaW50OEFycmF5KFtoXSkpO2NvbnN0IGU9bmV3IEFycmF5QnVmZmVyKDgpO25ldyBEYXRhVmlldyhlKS5zZXRCaWdVaW50NjQoMCxCaWdJbnQobi5vZmZzZXQpLCEwKSx0LnB1c2gobmV3IFVpbnQ4QXJyYXkoZSkpfWVsc2UgaWYobiBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpe3QucHVzaChuZXcgVWludDhBcnJheShbZl0pKTtjb25zdCBlPW5ldyBBcnJheUJ1ZmZlcig0KTtuZXcgRGF0YVZpZXcoZSkuc2V0VWludDMyKDAsbi5sZW5ndGgsITApLHQucHVzaChuZXcgVWludDhBcnJheShlKSksdC5wdXNoKG4pfWVsc2UgaWYoIm51bWJlciI9PXR5cGVvZiBuKWlmKE51bWJlci5pc0ludGVnZXIobikmJk51bWJlci5pc1NhZmVJbnRlZ2VyKG4pKXt0LnB1c2gobmV3IFVpbnQ4QXJyYXkoW29dKSk7Y29uc3QgZT1uZXcgQXJyYXlCdWZmZXIoOCk7bmV3IERhdGFWaWV3KGUpLnNldEJpZ0ludDY0KDAsQmlnSW50KG4pLCEwKSx0LnB1c2gobmV3IFVpbnQ4QXJyYXkoZSkpfWVsc2V7dC5wdXNoKG5ldyBVaW50OEFycmF5KFthXSkpO2NvbnN0IGU9bmV3IEFycmF5QnVmZmVyKDgpO25ldyBEYXRhVmlldyhlKS5zZXRGbG9hdDY0KDAsbiwhMCksdC5wdXNoKG5ldyBVaW50OEFycmF5KGUpKX1lbHNlIGlmKCJzdHJpbmciPT10eXBlb2Ygbil7dC5wdXNoKG5ldyBVaW50OEFycmF5KFtjXSkpO2NvbnN0IGU9KG5ldyBUZXh0RW5jb2RlcikuZW5jb2RlKG4pLHI9bmV3IEFycmF5QnVmZmVyKDQpO25ldyBEYXRhVmlldyhyKS5zZXRVaW50MzIoMCxlLmxlbmd0aCwhMCksdC5wdXNoKG5ldyBVaW50OEFycmF5KHIpKSx0LnB1c2goZSl9ZWxzZSBpZihBcnJheS5pc0FycmF5KG4pKXtjb25zdCByPVtdLGk9bmV3IEFycmF5QnVmZmVyKDQpO25ldyBEYXRhVmlldyhpKS5zZXRVaW50MzIoMCxuLmxlbmd0aCwhMCksci5wdXNoKG5ldyBVaW50OEFycmF5KGkpKTtjb25zdCBzPXQubGVuZ3RoO2Zvcihjb25zdCB0IG9mIG4pZSh0KTtjb25zdCBvPXQuc3BsaWNlKHMpO3IucHVzaCguLi5vKTtjb25zdCBhPXIucmVkdWNlKChlLHQpPT5lK3QubGVuZ3RoLDApO3QucHVzaChuZXcgVWludDhBcnJheShbZF0pKTtjb25zdCBjPW5ldyBBcnJheUJ1ZmZlcig0KTtuZXcgRGF0YVZpZXcoYykuc2V0VWludDMyKDAsYSwhMCksdC5wdXNoKG5ldyBVaW50OEFycmF5KGMpKSx0LnB1c2goLi4ucil9ZWxzZXtpZigib2JqZWN0IiE9dHlwZW9mIG4pdGhyb3cgbmV3IEVycm9yKCJVbnN1cHBvcnRlZCB0eXBlOiAiK3R5cGVvZiBuKTt7Y29uc3Qgcj1bXSxpPU9iamVjdC5rZXlzKG4pLHM9bmV3IEFycmF5QnVmZmVyKDQpO25ldyBEYXRhVmlldyhzKS5zZXRVaW50MzIoMCxpLmxlbmd0aCwhMCksci5wdXNoKG5ldyBVaW50OEFycmF5KHMpKTtjb25zdCBvPXQubGVuZ3RoO2Zvcihjb25zdCB1IG9mIGkpe2NvbnN0IHI9KG5ldyBUZXh0RW5jb2RlcikuZW5jb2RlKHUpLGk9bmV3IEFycmF5QnVmZmVyKDQpO25ldyBEYXRhVmlldyhpKS5zZXRVaW50MzIoMCxyLmxlbmd0aCwhMCksdC5wdXNoKG5ldyBVaW50OEFycmF5KGkpKSx0LnB1c2gociksZShuW3VdKX1jb25zdCBhPXQuc3BsaWNlKG8pO3IucHVzaCguLi5hKTtjb25zdCBjPXIucmVkdWNlKChlLHQpPT5lK3QubGVuZ3RoLDApO3QucHVzaChuZXcgVWludDhBcnJheShbcF0pKTtjb25zdCBsPW5ldyBBcnJheUJ1ZmZlcig0KTtuZXcgRGF0YVZpZXcobCkuc2V0VWludDMyKDAsYywhMCksdC5wdXNoKG5ldyBVaW50OEFycmF5KGwpKSx0LnB1c2goLi4ucil9fX0oZSk7Y29uc3Qgbj10LnJlZHVjZSgoZSx0KT0+ZSt0Lmxlbmd0aCwwKSx5PW5ldyBVaW50OEFycmF5KG4pO2xldCB3PTA7Zm9yKGNvbnN0IHIgb2YgdCl5LnNldChyLHcpLHcrPXIubGVuZ3RoO3JldHVybiB5fWZ1bmN0aW9uIHcoZSl7bGV0IHQ9MDtyZXR1cm4gZnVuY3Rpb24gbigpe2lmKHQ+PWUubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiVW5leHBlY3RlZCBlbmQgb2YgZGF0YSIpO2NvbnN0IHk9ZVt0KytdO3N3aXRjaCh5KXtjYXNlIHI6cmV0dXJuIG51bGw7Y2FzZSBpOnJldHVybiExO2Nhc2UgczpyZXR1cm4hMDtjYXNlIG86e2lmKHQrND5lLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoIlVuZXhwZWN0ZWQgZW5kIG9mIGRhdGEgZm9yIElOVCIpO2NvbnN0IG49bmV3IERhdGFWaWV3KGUuYnVmZmVyLGUuYnl0ZU9mZnNldCt0LDgpLmdldEJpZ0ludDY0KDAsITApO2lmKHQrPTgsbjxCaWdJbnQoTnVtYmVyLk1JTl9TQUZFX0lOVEVHRVIpfHxuPkJpZ0ludChOdW1iZXIuTUFYX1NBRkVfSU5URUdFUikpdGhyb3cgbmV3IEVycm9yKCJEZWNvZGVkIGludGVnZXIgZXhjZWVkcyBzYWZlIHJhbmdlIik7cmV0dXJuIE51bWJlcihuKX1jYXNlIGE6e2lmKHQrOD5lLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoIlVuZXhwZWN0ZWQgZW5kIG9mIGRhdGEgZm9yIEZMT0FUIik7Y29uc3Qgbj1uZXcgRGF0YVZpZXcoZS5idWZmZXIsZS5ieXRlT2Zmc2V0K3QsOCkuZ2V0RmxvYXQ2NCgwLCEwKTtyZXR1cm4gdCs9OCxufWNhc2UgYzp7aWYodCs0PmUubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiVW5leHBlY3RlZCBlbmQgb2YgZGF0YSBmb3IgU1RSSU5HIGxlbmd0aCIpO2NvbnN0IG49bmV3IERhdGFWaWV3KGUuYnVmZmVyLGUuYnl0ZU9mZnNldCt0LDQpLmdldFVpbnQzMigwLCEwKTtpZih0Kz00LHQrbj5lLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoIlVuZXhwZWN0ZWQgZW5kIG9mIGRhdGEgZm9yIFNUUklORyBjb250ZW50Iik7Y29uc3Qgcj1lLnNsaWNlKHQsdCtuKTtyZXR1cm4gdCs9biwobmV3IFRleHREZWNvZGVyKS5kZWNvZGUocil9Y2FzZSBsOntpZih0KzEyPmUubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiVW5leHBlY3RlZCBlbmQgb2YgZGF0YSBmb3IgT0lEIik7Y29uc3Qgbj1lLnNsaWNlKHQsdCsxMik7cmV0dXJuIHQrPTEyLG5ldyBnKG4pfWNhc2UgdTp7aWYodCs4PmUubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiVW5leHBlY3RlZCBlbmQgb2YgZGF0YSBmb3IgREFURSIpO2NvbnN0IG49bmV3IERhdGFWaWV3KGUuYnVmZmVyLGUuYnl0ZU9mZnNldCt0LDgpLmdldEJpZ0ludDY0KDAsITApO3JldHVybiB0Kz04LG5ldyBEYXRlKE51bWJlcihuKSl9Y2FzZSBoOntpZih0Kzg+ZS5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKCJVbmV4cGVjdGVkIGVuZCBvZiBkYXRhIGZvciBQT0lOVEVSIik7Y29uc3Qgbj1uZXcgRGF0YVZpZXcoZS5idWZmZXIsZS5ieXRlT2Zmc2V0K3QsOCkuZ2V0QmlnVWludDY0KDAsITApO2lmKHQrPTgsbj5CaWdJbnQoTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIpKXRocm93IG5ldyBFcnJvcigiUG9pbnRlciBvZmZzZXQgb3V0IG9mIHZhbGlkIHJhbmdlIik7cmV0dXJuIG5ldyBtKE51bWJlcihuKSl9Y2FzZSBmOntpZih0KzQ+ZS5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKCJVbmV4cGVjdGVkIGVuZCBvZiBkYXRhIGZvciBCSU5BUlkgbGVuZ3RoIik7Y29uc3Qgbj1uZXcgRGF0YVZpZXcoZS5idWZmZXIsZS5ieXRlT2Zmc2V0K3QsNCkuZ2V0VWludDMyKDAsITApO2lmKHQrPTQsdCtuPmUubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiVW5leHBlY3RlZCBlbmQgb2YgZGF0YSBmb3IgQklOQVJZIGNvbnRlbnQiKTtjb25zdCByPWUuc2xpY2UodCx0K24pO3JldHVybiB0Kz1uLHJ9Y2FzZSBkOntpZih0KzQ+ZS5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKCJVbmV4cGVjdGVkIGVuZCBvZiBkYXRhIGZvciBBUlJBWSBzaXplIik7Y29uc3Qgcj1uZXcgRGF0YVZpZXcoZS5idWZmZXIsZS5ieXRlT2Zmc2V0K3QsNCkuZ2V0VWludDMyKDAsITApO2lmKHQrPTQsdCtyPmUubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiVW5leHBlY3RlZCBlbmQgb2YgZGF0YSBmb3IgQVJSQVkgY29udGVudCIpO2NvbnN0IGk9bmV3IERhdGFWaWV3KGUuYnVmZmVyLGUuYnl0ZU9mZnNldCt0LDQpLmdldFVpbnQzMigwLCEwKTt0Kz00O2NvbnN0IHM9W107Zm9yKGxldCBlPTA7ZTxpO2UrKylzLnB1c2gobigpKTtyZXR1cm4gc31jYXNlIHA6e2lmKHQrND5lLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoIlVuZXhwZWN0ZWQgZW5kIG9mIGRhdGEgZm9yIE9CSkVDVCBzaXplIik7Y29uc3Qgcj1uZXcgRGF0YVZpZXcoZS5idWZmZXIsZS5ieXRlT2Zmc2V0K3QsNCkuZ2V0VWludDMyKDAsITApO2lmKHQrPTQsdCtyPmUubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiVW5leHBlY3RlZCBlbmQgb2YgZGF0YSBmb3IgT0JKRUNUIGNvbnRlbnQiKTtjb25zdCBpPW5ldyBEYXRhVmlldyhlLmJ1ZmZlcixlLmJ5dGVPZmZzZXQrdCw0KS5nZXRVaW50MzIoMCwhMCk7dCs9NDtjb25zdCBzPXt9O2ZvcihsZXQgbz0wO288aTtvKyspe2lmKHQrND5lLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoIlVuZXhwZWN0ZWQgZW5kIG9mIGRhdGEgZm9yIE9CSkVDVCBrZXkgbGVuZ3RoIik7Y29uc3Qgcj1uZXcgRGF0YVZpZXcoZS5idWZmZXIsZS5ieXRlT2Zmc2V0K3QsNCkuZ2V0VWludDMyKDAsITApO2lmKHQrPTQsdCtyPmUubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiVW5leHBlY3RlZCBlbmQgb2YgZGF0YSBmb3IgT0JKRUNUIGtleSIpO2NvbnN0IGk9ZS5zbGljZSh0LHQrcik7dCs9cjtzWyhuZXcgVGV4dERlY29kZXIpLmRlY29kZShpKV09bigpfXJldHVybiBzfWRlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKGBVbmtub3duIHR5cGUgYnl0ZTogMHgke3kudG9TdHJpbmcoMTYpfWApfX0oKX1jbGFzcyBie2NvbnN0cnVjdG9yKGUpe2lmKCFlKXRocm93IG5ldyBFcnJvcigiRmlsZVN5c3RlbVN5bmNBY2Nlc3NIYW5kbGUgaXMgcmVxdWlyZWQiKTt0aGlzLnN5bmNBY2Nlc3NIYW5kbGU9ZX0jZShlLHQpe2NvbnN0IG49bmV3IFVpbnQ4QXJyYXkodCkscj10aGlzLnN5bmNBY2Nlc3NIYW5kbGUucmVhZChuLHthdDplfSk7cmV0dXJuIHI8dD9uLnNsaWNlKDAscik6bn1nZXRGaWxlU2l6ZSgpe3JldHVybiB0aGlzLnN5bmNBY2Nlc3NIYW5kbGUuZ2V0U2l6ZSgpfXdyaXRlKGUpe2NvbnN0IHQ9eShlKTt0aGlzLnN5bmNBY2Nlc3NIYW5kbGUudHJ1bmNhdGUoMCksdGhpcy5zeW5jQWNjZXNzSGFuZGxlLndyaXRlKHQse2F0OjB9KX1yZWFkKGU9bmV3IG0oMCkpe2NvbnN0IHQ9dGhpcy5nZXRGaWxlU2l6ZSgpO2lmKDA9PT10KXRocm93IG5ldyBFcnJvcigiRmlsZSBpcyBlbXB0eSIpO2NvbnN0IG49ZS52YWx1ZU9mKCk7aWYobjwwfHxuPj10KXRocm93IG5ldyBFcnJvcihgUG9pbnRlciBvZmZzZXQgJHtlfSBvdXQgb2YgZmlsZSBib3VuZHMgWzAsICR7dH0pYCk7cmV0dXJuIHcodGhpcy4jZShuLHQtbikpfWFwcGVuZChlKXtjb25zdCB0PXkoZSksbj10aGlzLmdldEZpbGVTaXplKCk7dGhpcy5zeW5jQWNjZXNzSGFuZGxlLndyaXRlKHQse2F0Om59KX1mbHVzaCgpe3RoaXMuc3luY0FjY2Vzc0hhbmRsZS5mbHVzaCgpfSpzY2FuKCl7Y29uc3QgZT10aGlzLmdldEZpbGVTaXplKCk7aWYoMD09PWUpcmV0dXJuO2xldCB0PTA7Zm9yKDt0PGU7KXtjb25zdCBlPShlPT57bGV0IHQ9dGhpcy4jZShlLDEpO2NvbnN0IG49dFswXTtzd2l0Y2gobil7Y2FzZSByOmNhc2UgaTpjYXNlIHM6cmV0dXJuIDE7Y2FzZSBvOmNhc2UgYTpjYXNlIHU6Y2FzZSBoOnJldHVybiA5O2Nhc2UgbDpyZXR1cm4gMTM7Y2FzZSBjOnQ9dGhpcy4jZShlKzEsNCk7cmV0dXJuIDUrbmV3IERhdGFWaWV3KHQuYnVmZmVyLHQuYnl0ZU9mZnNldCw0KS5nZXRVaW50MzIoMCwhMCk7Y2FzZSBmOnQ9dGhpcy4jZShlKzEsNCk7cmV0dXJuIDUrbmV3IERhdGFWaWV3KHQuYnVmZmVyLHQuYnl0ZU9mZnNldCw0KS5nZXRVaW50MzIoMCwhMCk7Y2FzZSBkOnQ9dGhpcy4jZShlKzEsNCk7cmV0dXJuIDUrbmV3IERhdGFWaWV3KHQuYnVmZmVyLHQuYnl0ZU9mZnNldCw0KS5nZXRVaW50MzIoMCwhMCk7Y2FzZSBwOnQ9dGhpcy4jZShlKzEsNCk7cmV0dXJuIDUrbmV3IERhdGFWaWV3KHQuYnVmZmVyLHQuYnl0ZU9mZnNldCw0KS5nZXRVaW50MzIoMCwhMCk7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gdHlwZSBieXRlOiAweCR7bi50b1N0cmluZygxNil9YCl9fSkodCksbj10aGlzLiNlKHQsZSk7dCs9ZSx5aWVsZCB3KG4pfX19ZnVuY3Rpb24geChlLHQpe3JldHVybiBlIGluc3RhbmNlb2YgZ3x8dCBpbnN0YW5jZW9mIGc/ZSBpbnN0YW5jZW9mIGcmJnQgaW5zdGFuY2VvZiBnfHxlIGluc3RhbmNlb2YgZyYmInN0cmluZyI9PXR5cGVvZiB0P2UuZXF1YWxzKHQpOnQgaW5zdGFuY2VvZiBnJiYic3RyaW5nIj09dHlwZW9mIGUmJnQuZXF1YWxzKGUpOmU9PXR9ZnVuY3Rpb24gXyhlKXtpZihlIGluc3RhbmNlb2YgZylyZXR1cm4gbmV3IGcoZS5pZCk7aWYoZSBpbnN0YW5jZW9mIERhdGUpcmV0dXJuIG5ldyBEYXRlKGUuZ2V0VGltZSgpKTt2YXIgdCxuLHI7Zm9yKHIgaW4gdD1BcnJheS5pc0FycmF5KGUpP1tdOnt9LGUpbj1lW3JdLHRbcl09Im9iamVjdCI9PXR5cGVvZiBuJiZudWxsIT09bj9fKG4pOm47cmV0dXJuIHR9ZnVuY3Rpb24gdihlLHQpe2Zvcih2YXIgbj10LnNwbGl0KCIuIikscj1lW25bMF1dLGk9MTtpPG4ubGVuZ3RoO2krKyl7aWYobnVsbD09cnx8bnVsbD09cilyZXR1cm4gcjt2YXIgcz1uW2ldLG89cGFyc2VJbnQocywxMCk7cj1OKHIpJiYhaXNOYU4obykmJm8+PTAmJm88ci5sZW5ndGg/cltvXTpyW3NdfXJldHVybiByfWZ1bmN0aW9uICQoZSx0KXtmb3IodmFyIG49dC5zcGxpdCgiLiIpLHI9W2VdLGk9MDtpPG4ubGVuZ3RoO2krKyl7Zm9yKHZhciBzPW5baV0sbz1wYXJzZUludChzLDEwKSxhPVtdLGM9MDtjPHIubGVuZ3RoO2MrKyl7dmFyIGw9cltjXTtpZihudWxsIT1sJiZudWxsIT1sKWlmKE4obCkmJiFpc05hTihvKSYmbz49MClvPGwubGVuZ3RoJiZhLnB1c2gobFtvXSk7ZWxzZSBpZihOKGwpKWZvcih2YXIgdT0wO3U8bC5sZW5ndGg7dSsrKW51bGwhPWxbdV0mJm51bGwhPWxbdV0mJiJvYmplY3QiPT10eXBlb2YgbFt1XSYmYS5wdXNoKGxbdV1bc10pO2Vsc2Uib2JqZWN0Ij09dHlwZW9mIGwmJmEucHVzaChsW3NdKX1yPWF9aWYoMCE9PShyPXIuZmlsdGVyKGZ1bmN0aW9uKGUpe3JldHVybiB2b2lkIDAhPT1lfSkpLmxlbmd0aClyZXR1cm4gMT09PXIubGVuZ3RoP3JbMF06cn1mdW5jdGlvbiBJKGUsdCxuKXtpZigtMSE9PXQuaW5kZXhPZigiJFtdIikpcmV0dXJuIGZ1bmN0aW9uKGUsdCxuKXtmb3IodmFyIHI9dC5zcGxpdCgiLiIpLGk9ZSxzPTA7czxyLmxlbmd0aDtzKyspe3ZhciBvPXJbc107aWYoIiRbXSI9PT1vKXtpZighQXJyYXkuaXNBcnJheShpKSl0aHJvdyBuZXcgRXJyb3IoIlRoZSBwb3NpdGlvbmFsIG9wZXJhdG9yIGRpZCBub3QgZmluZCB0aGUgbWF0Y2ggbmVlZGVkIGZyb20gdGhlIHF1ZXJ5LiIpO2Zvcih2YXIgYT1yLnNsaWNlKHMrMSkuam9pbigiLiIpLGM9MDtjPGkubGVuZ3RoO2MrKylhP0koaVtjXSxhLG4pOmlbY109bjtyZXR1cm59dmFyIGw9cGFyc2VJbnQobywxMCk7aWYoTihpKSYmIWlzTmFOKGwpJiZsPj0wKWk9aVtsXTtlbHNle2lmKG51bGw9PWlbb118fG51bGw9PWlbb10pe3ZhciB1PXMrMTxyLmxlbmd0aD9yW3MrMV06bnVsbDtpZigiJFtdIj09PXUpaVtvXT1bXTtlbHNle3ZhciBoPXBhcnNlSW50KHUsMTApOyFpc05hTihoKSYmaD49MD9pW29dPVtdOmlbb109e319fWk9aVtvXX19fShlLHQsbik7Zm9yKHZhciByPXQuc3BsaXQoIi4iKSxpPWUscz0wO3M8ci5sZW5ndGgtMTtzKyspe3ZhciBvPXJbc10sYT1wYXJzZUludChvLDEwKTtpZihOKGkpJiYhaXNOYU4oYSkmJmE+PTApe2Zvcig7aS5sZW5ndGg8PWE7KWkucHVzaCh2b2lkIDApO2lmKG51bGw9PWlbYV18fG51bGw9PWlbYV0pe3ZhciBjPXJbcysxXSxsPXBhcnNlSW50KGMsMTApOyFpc05hTihsKSYmbD49MD9pW2FdPVtdOmlbYV09e319aT1pW2FdfWVsc2V7aWYobnVsbD09aVtvXXx8bnVsbD09aVtvXSl7Yz1yW3MrMV0sbD1wYXJzZUludChjLDEwKTshaXNOYU4obCkmJmw+PTA/aVtvXT1bXTppW29dPXt9fWk9aVtvXX19dmFyIHU9cltyLmxlbmd0aC0xXSxoPXBhcnNlSW50KHUsMTApO2lmKE4oaSkmJiFpc05hTihoKSYmaD49MCl7Zm9yKDtpLmxlbmd0aDw9aDspaS5wdXNoKHZvaWQgMCk7aVtoXT1ufWVsc2UgaVt1XT1ufWZ1bmN0aW9uIE4oZSl7cmV0dXJuIEFycmF5PT1lLmNvbnN0cnVjdG9yfWZ1bmN0aW9uIFMoZSl7dmFyIHQ9W107Zm9yKHZhciBuIGluIGUpaWYoZS5oYXNPd25Qcm9wZXJ0eShuKSl7dmFyIHI9e307cltuXT1lW25dLHQucHVzaChyKX1yZXR1cm4gdH1mdW5jdGlvbiBPKGUsdCl7Zm9yKHZhciBuPTA7bjx0Lmxlbmd0aDtuKyspaWYoeCh0W25dLGUpKXJldHVybiEwO3JldHVybiExfWZ1bmN0aW9uIEEoZSx0KXtpZihlLmxlbmd0aCE9dC5sZW5ndGgpcmV0dXJuITE7Zm9yKHZhciBuPTA7bjxlLmxlbmd0aDtuKyspaWYoIXgoZVtuXSx0W25dKSl7aWYodHlwZW9mIGVbbl0hPXR5cGVvZiB0W25dKXJldHVybiExO2lmKCJvYmplY3QiPT10eXBlb2YgZVtuXSYmbnVsbCE9PWVbbl0pe2lmKE4oZVtuXSkpe2lmKCFBKGVbbl0sdFtuXSkpcmV0dXJuITF9ZWxzZSBpZighQyhlW25dLHRbbl0pKXJldHVybiExfWVsc2UgaWYoIXgoZVtuXSx0W25dKSlyZXR1cm4hMX1yZXR1cm4hMH1mdW5jdGlvbiBDKGUsdCl7Zm9yKHZhciBuIGluIGUpaWYoZS5oYXNPd25Qcm9wZXJ0eShuKSl7aWYoIXQuaGFzT3duUHJvcGVydHkobikpcmV0dXJuITE7aWYoIXgoZVtuXSx0W25dKSl7aWYodHlwZW9mIGVbbl0hPXR5cGVvZiB0W25dKXJldHVybiExO2lmKCJvYmplY3QiPT10eXBlb2YgZVtuXSYmbnVsbCE9PWVbbl0pe2lmKE4oZVtuXSkpe2lmKCFBKGVbbl0sdFtuXSkpcmV0dXJuITF9ZWxzZSBpZighQyhlW25dLHRbbl0pKXJldHVybiExfWVsc2UgaWYoIXgoZVtuXSx0W25dKSlyZXR1cm4hMX19Zm9yKHZhciBuIGluIHQpaWYodC5oYXNPd25Qcm9wZXJ0eShuKSYmIWUuaGFzT3duUHJvcGVydHkobikpcmV0dXJuITE7cmV0dXJuITB9ZnVuY3Rpb24gRShlLHQpe3ZhciBuPXt9LHI9T2JqZWN0LmtleXMoZSk7aWYoMD09ci5sZW5ndGgpcmV0dXJuIHQ7Zm9yKHZhciBpPSExLHM9ITEsbz0wO288ci5sZW5ndGg7bysrKSJfaWQiIT09cltvXSYmKGVbcltvXV0/aT0hMDpzPSEwKTtpZihpJiZzKXRocm93eyRlcnI6IkNhbid0IGNhbm9uaWNhbGl6ZSBxdWVyeTogQmFkVmFsdWUgUHJvamVjdGlvbiBjYW5ub3QgaGF2ZSBhIG1peCBvZiBpbmNsdXNpb24gYW5kIGV4Y2x1c2lvbi4iLGNvZGU6MTcyODd9O2lmKGVbclswXV18fGkpezAhPT1lLl9pZCYmKG4uX2lkPXQuX2lkKTtmb3Iobz0wO288ci5sZW5ndGg7bysrKWlmKCJfaWQiIT09cltvXSYmZVtyW29dXSl7dmFyIGE9dih0LHU9cltvXSk7dm9pZCAwIT09YSYmSShuLHUsYSl9fWVsc2V7Zm9yKHZhciBjIGluIHQpaWYodC5oYXNPd25Qcm9wZXJ0eShjKSl7dmFyIGw9dFtjXTsib2JqZWN0IiE9dHlwZW9mIGx8fG51bGw9PT1sfHxOKGwpP04obCk/bltjXT1sLnNsaWNlKCk6bltjXT1sOm5bY109XyhsKX1mb3Iobz0wO288ci5sZW5ndGg7bysrKWlmKCFlW3Jbb11dKXt2YXIgdSxoPSh1PXJbb10pLnNwbGl0KCIuIik7aWYoMT09PWgubGVuZ3RoKWRlbGV0ZSBuW3VdO2Vsc2V7Zm9yKHZhciBmPW4sZD0wO2Q8aC5sZW5ndGgtMSYmKG51bGwhPWYmJm51bGwhPWYpO2QrKylmPWZbaFtkXV07bnVsbCE9ZiYmbnVsbCE9ZiYmZGVsZXRlIGZbaFtoLmxlbmd0aC0xXV19fX1yZXR1cm4gbn1jb25zdCBqPTIsRD04LGs9MTcyODcsUD0yNixNPTI3LEw9ODUsVD0xMWUzLEY9MixCPTMxMjU0LHo9OTk5O2NsYXNzIFUgZXh0ZW5kcyBFcnJvcntjb25zdHJ1Y3RvcihlLHQ9e30pe3N1cGVyKGUpLHRoaXMubmFtZT0iTW9uZ29FcnJvciIsdGhpcy5jb2RlPXQuY29kZXx8RCx0aGlzLmNvZGVOYW1lPXRoaXMuX2dldENvZGVOYW1lKHRoaXMuY29kZSksdGhpcy4kZXJyPWUsdC5jb2xsZWN0aW9uJiYodGhpcy5jb2xsZWN0aW9uPXQuY29sbGVjdGlvbiksdC5kYXRhYmFzZSYmKHRoaXMuZGF0YWJhc2U9dC5kYXRhYmFzZSksdC5vcGVyYXRpb24mJih0aGlzLm9wZXJhdGlvbj10Lm9wZXJhdGlvbiksdC5xdWVyeSYmKHRoaXMucXVlcnk9dC5xdWVyeSksdC5kb2N1bWVudCYmKHRoaXMuZG9jdW1lbnQ9dC5kb2N1bWVudCksdC5maWVsZCYmKHRoaXMuZmllbGQ9dC5maWVsZCksdC5pbmRleCYmKHRoaXMuaW5kZXg9dC5pbmRleCksRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UmJkVycm9yLmNhcHR1cmVTdGFja1RyYWNlKHRoaXMsdGhpcy5jb25zdHJ1Y3Rvcil9X2dldENvZGVOYW1lKGUpe3JldHVybnswOiJPSyIsMToiSW50ZXJuYWxFcnJvciIsMjoiQmFkVmFsdWUiLDQ6Ik5vU3VjaEtleSIsNToiR3JhcGhDb250YWluc0N5Y2xlIiw2OiJIb3N0VW5yZWFjaGFibGUiLDc6Ikhvc3ROb3RGb3VuZCIsODoiVW5rbm93bkVycm9yIiwxMDoiQ2Fubm90TXV0YXRlT2JqZWN0IiwxMToiVXNlck5vdEZvdW5kIiwxMjoiVW5zdXBwb3J0ZWRGb3JtYXQiLDEzOiJVbmF1dGhvcml6ZWQiLDE0OiJUeXBlTWlzbWF0Y2giLDE1OiJPdmVyZmxvdyIsMTY6IkludmFsaWRMZW5ndGgiLDE3OiJQcm90b2NvbEVycm9yIiwxODoiQXV0aGVudGljYXRpb25GYWlsZWQiLDIwOiJJbGxlZ2FsT3BlcmF0aW9uIiwyNjoiTmFtZXNwYWNlTm90Rm91bmQiLDI3OiJJbmRleE5vdEZvdW5kIiwyODoiUGF0aE5vdFZpYWJsZSIsNDM6IkN1cnNvck5vdEZvdW5kIiw0ODoiTmFtZXNwYWNlRXhpc3RzIiw1OToiQ29tbWFuZE5vdEZvdW5kIiw2NzoiQ2Fubm90Q3JlYXRlSW5kZXgiLDY4OiJJbmRleEV4aXN0cyIsNzM6IkludmFsaWROYW1lc3BhY2UiLDg1OiJJbmRleE9wdGlvbnNDb25mbGljdCIsMTEyOiJXcml0ZUNvbmZsaWN0IiwxMjE6IkRvY3VtZW50VmFsaWRhdGlvbkZhaWx1cmUiLDE3MToiQ2Fubm90SW5kZXhQYXJhbGxlbEFycmF5cyIsMTk3OiJJbnZhbGlkSW5kZXhTcGVjaWZpY2F0aW9uT3B0aW9uIiw5OTg6Ik9wZXJhdGlvbk5vdFN1cHBvcnRlZCIsOTk5OiJOb3RJbXBsZW1lbnRlZCIsMTFlMzoiRHVwbGljYXRlS2V5IiwxMTAwMToiRHVwbGljYXRlS2V5VXBkYXRlIiwxNzI4NzoiRmFpbGVkVG9QYXJzZSJ9W2VdfHwiVW5rbm93bkVycm9yIn10b0pTT04oKXtjb25zdCBlPXtuYW1lOnRoaXMubmFtZSxtZXNzYWdlOnRoaXMubWVzc2FnZSxjb2RlOnRoaXMuY29kZSxjb2RlTmFtZTp0aGlzLmNvZGVOYW1lfTtyZXR1cm4gdGhpcy5jb2xsZWN0aW9uJiYoZS5jb2xsZWN0aW9uPXRoaXMuY29sbGVjdGlvbiksdGhpcy5kYXRhYmFzZSYmKGUuZGF0YWJhc2U9dGhpcy5kYXRhYmFzZSksdGhpcy5vcGVyYXRpb24mJihlLm9wZXJhdGlvbj10aGlzLm9wZXJhdGlvbiksdGhpcy5pbmRleCYmKGUuaW5kZXg9dGhpcy5pbmRleCksdGhpcy5pbmRleE5hbWUmJihlLmluZGV4TmFtZT10aGlzLmluZGV4TmFtZSksdGhpcy5maWVsZCYmKGUuZmllbGQ9dGhpcy5maWVsZCksdGhpcy5xdWVyeSYmKGUucXVlcnk9dGhpcy5xdWVyeSksdGhpcy5kb2N1bWVudCYmKGUuZG9jdW1lbnQ9dGhpcy5kb2N1bWVudCksdGhpcy5uYW1lc3BhY2UmJihlLm5hbWVzcGFjZT10aGlzLm5hbWVzcGFjZSksdGhpcy5jdXJzb3JJZCYmKGUuY3Vyc29ySWQ9dGhpcy5jdXJzb3JJZCksdGhpcy5mZWF0dXJlJiYoZS5mZWF0dXJlPXRoaXMuZmVhdHVyZSksdGhpcy5rZXlQYXR0ZXJuJiYoZS5rZXlQYXR0ZXJuPXRoaXMua2V5UGF0dGVybiksdGhpcy5rZXlWYWx1ZSYmKGUua2V5VmFsdWU9dGhpcy5rZXlWYWx1ZSksdGhpcy53cml0ZUVycm9ycyYmKGUud3JpdGVFcnJvcnM9dGhpcy53cml0ZUVycm9ycyksZX19Y2xhc3MgUiBleHRlbmRzIFV7Y29uc3RydWN0b3IoZSx0PXt9KXtzdXBlcihlLHQpLHRoaXMubmFtZT0iSW5kZXhFcnJvciJ9fWNsYXNzIHEgZXh0ZW5kcyBSe2NvbnN0cnVjdG9yKGUsdD17fSl7c3VwZXIoYEluZGV4ICcke2V9JyBub3QgZm91bmRgLHsuLi50LGNvZGU6TSxpbmRleDplfSksdGhpcy5uYW1lPSJJbmRleE5vdEZvdW5kRXJyb3IiLHRoaXMuaW5kZXhOYW1lPWV9fWNsYXNzIFYgZXh0ZW5kcyBVe2NvbnN0cnVjdG9yKGUsdD17fSl7c3VwZXIoZSx0KSx0aGlzLm5hbWU9IlF1ZXJ5RXJyb3IiLHRoaXMuY29kZT10LmNvZGV8fEZ9fWNsYXNzIEggZXh0ZW5kcyBVe2NvbnN0cnVjdG9yKGUsdD17fSl7c3VwZXIoYCR7ZX0gaXMgbm90IGltcGxlbWVudGVkIGluIG1pY3JvLW1vbmdvYCx7Li4udCxjb2RlOnp9KSx0aGlzLm5hbWU9Ik5vdEltcGxlbWVudGVkRXJyb3IiLHRoaXMuZmVhdHVyZT1lfX1jbGFzcyBXIGV4dGVuZHMgVXtjb25zdHJ1Y3RvcihlLHQsbixyPXt9KXtzdXBlcihgQmFkIHZhbHVlIGZvciBmaWVsZCAnJHtlfSc6ICR7bn1gLHsuLi5yLGNvZGU6aixmaWVsZDplfSksdGhpcy5uYW1lPSJCYWRWYWx1ZUVycm9yIix0aGlzLnZhbHVlPXR9fWNsYXNzIFF7Y29uc3RydWN0b3IoZSx0LG4scixpKXtpZih0aGlzLmNvbGxlY3Rpb249ZSx0aGlzLnF1ZXJ5PXQsdGhpcy5wcm9qZWN0aW9uPW4sdGhpcy5fZG9jdW1lbnRzUHJvbWlzZT1yIGluc3RhbmNlb2YgUHJvbWlzZT9yOlByb21pc2UucmVzb2x2ZShyKSx0aGlzLmRvY3VtZW50cz1udWxsLHRoaXMuX2luaXRpYWxpemVkPSExLHRoaXMuU29ydGVkQ3Vyc29yPWksbiYmT2JqZWN0LmtleXMobikubGVuZ3RoPjApe2NvbnN0IHQ9T2JqZWN0LmtleXMobik7bGV0IHI9ITEsaT0hMTtmb3IobGV0IGU9MDtlPHQubGVuZ3RoO2UrKykiX2lkIiE9PXRbZV0mJihuW3RbZV1dP3I9ITA6aT0hMCk7aWYociYmaSl0aHJvdyBuZXcgVigiQ2FuJ3QgY2Fub25pY2FsaXplIHF1ZXJ5OiBCYWRWYWx1ZSBQcm9qZWN0aW9uIGNhbm5vdCBoYXZlIGEgbWl4IG9mIGluY2x1c2lvbiBhbmQgZXhjbHVzaW9uLiIse2NvZGU6ayxjb2xsZWN0aW9uOmUubmFtZX0pfXRoaXMucG9zPTAsdGhpcy5fbGltaXQ9MCx0aGlzLl9za2lwPTAsdGhpcy5fY2xvc2VkPSExfWFzeW5jIF9lbnN1cmVJbml0aWFsaXplZCgpe3RoaXMuX2luaXRpYWxpemVkfHwodGhpcy5kb2N1bWVudHM9YXdhaXQgdGhpcy5fZG9jdW1lbnRzUHJvbWlzZSx0aGlzLl9pbml0aWFsaXplZD0hMCl9YmF0Y2hTaXplKGUpe3JldHVybiB0aGlzLl9iYXRjaFNpemU9ZSx0aGlzfWNsb3NlKCl7dGhpcy5fY2xvc2VkPSEwLHRoaXMuZG9jdW1lbnRzJiYodGhpcy5wb3M9dGhpcy5kb2N1bWVudHMubGVuZ3RoKX1jb21tZW50KGUpe3JldHVybiB0aGlzLl9jb21tZW50PWUsdGhpc31hc3luYyBjb3VudCgpe3JldHVybiBhd2FpdCB0aGlzLl9lbnN1cmVJbml0aWFsaXplZCgpLHRoaXMuZG9jdW1lbnRzLmxlbmd0aH1leHBsYWluKGU9InF1ZXJ5UGxhbm5lciIpe3JldHVybntxdWVyeVBsYW5uZXI6e3BsYW5uZXJWZXJzaW9uOjEsbmFtZXNwYWNlOmAke3RoaXMuY29sbGVjdGlvbi5kYj8ubmFtZXx8ImRiIn0uJHt0aGlzLmNvbGxlY3Rpb24ubmFtZX1gLGluZGV4RmlsdGVyU2V0OiExLHBhcnNlZFF1ZXJ5OnRoaXMucXVlcnksd2lubmluZ1BsYW46e3N0YWdlOiJDT0xMU0NBTiIsZmlsdGVyOnRoaXMucXVlcnksZGlyZWN0aW9uOiJmb3J3YXJkIn19LGV4ZWN1dGlvblN0YXRzOiJleGVjdXRpb25TdGF0cyI9PT1lfHwiYWxsUGxhbnNFeGVjdXRpb24iPT09ZT97ZXhlY3V0aW9uU3VjY2VzczohMCxuUmV0dXJuZWQ6dGhpcy5kb2N1bWVudHM/dGhpcy5kb2N1bWVudHMubGVuZ3RoOjAsZXhlY3V0aW9uVGltZU1pbGxpczowLHRvdGFsS2V5c0V4YW1pbmVkOjAsdG90YWxEb2NzRXhhbWluZWQ6dGhpcy5kb2N1bWVudHM/dGhpcy5kb2N1bWVudHMubGVuZ3RoOjB9OnZvaWQgMCxvazoxfX1hc3luYyBmb3JFYWNoKGUpe2Zvcihhd2FpdCB0aGlzLl9lbnN1cmVJbml0aWFsaXplZCgpO2F3YWl0IHRoaXMuaGFzTmV4dCgpOylhd2FpdCBlKGF3YWl0IHRoaXMubmV4dCgpKX1hc3luYyBoYXNOZXh0KCl7aWYodGhpcy5fY2xvc2VkKXJldHVybiExO2xldCBlO3JldHVybiBhd2FpdCB0aGlzLl9lbnN1cmVJbml0aWFsaXplZCgpLDA9PT10aGlzLnBvcyYmdGhpcy5fc2tpcD4wJiYodGhpcy5wb3M9TWF0aC5taW4odGhpcy5fc2tpcCx0aGlzLmRvY3VtZW50cy5sZW5ndGgpKSxlPXRoaXMuX2xpbWl0PjA/TWF0aC5taW4odGhpcy5fc2tpcCt0aGlzLl9saW1pdCx0aGlzLmRvY3VtZW50cy5sZW5ndGgpOnRoaXMuZG9jdW1lbnRzLmxlbmd0aCx0aGlzLnBvczxlfWhpbnQoZSl7cmV0dXJuIHRoaXMuX2hpbnQ9ZSx0aGlzfWFzeW5jIGl0Y291bnQoKXthd2FpdCB0aGlzLl9lbnN1cmVJbml0aWFsaXplZCgpO2xldCBlPTA7Zm9yKDthd2FpdCB0aGlzLmhhc05leHQoKTspYXdhaXQgdGhpcy5uZXh0KCksZSsrO3JldHVybiBlfWxpbWl0KGUpe3JldHVybiB0aGlzLl9saW1pdD1lLHRoaXN9YXN5bmMgbWFwKGUpe2F3YWl0IHRoaXMuX2Vuc3VyZUluaXRpYWxpemVkKCk7Y29uc3QgdD1bXTtmb3IoO2F3YWl0IHRoaXMuaGFzTmV4dCgpOyl0LnB1c2goYXdhaXQgZShhd2FpdCB0aGlzLm5leHQoKSkpO3JldHVybiB0fW1heFNjYW4oZSl7cmV0dXJuIHRoaXMuX21heFNjYW49ZSx0aGlzfW1heFRpbWVNUyhlKXtyZXR1cm4gdGhpcy5fbWF4VGltZU1TPWUsdGhpc31tYXgoZSl7cmV0dXJuIHRoaXMuX21heEluZGV4Qm91bmRzPWUsdGhpc31taW4oZSl7cmV0dXJuIHRoaXMuX21pbkluZGV4Qm91bmRzPWUsdGhpc31hc3luYyBuZXh0KCl7aWYoIShhd2FpdCB0aGlzLmhhc05leHQoKSkpdGhyb3cgbmV3IFYoIkVycm9yOiBlcnJvciBoYXNOZXh0OiBmYWxzZSIse2NvbGxlY3Rpb246dGhpcy5jb2xsZWN0aW9uLm5hbWV9KTtjb25zdCBlPXRoaXMuZG9jdW1lbnRzW3RoaXMucG9zKytdO3JldHVybiB0aGlzLnByb2plY3Rpb24/RSh0aGlzLnByb2plY3Rpb24sZSk6ZX1ub0N1cnNvclRpbWVvdXQoKXtyZXR1cm4gdGhpcy5fbm9DdXJzb3JUaW1lb3V0PSEwLHRoaXN9b2Jqc0xlZnRJbkJhdGNoKCl7cmV0dXJuIHRoaXMuZG9jdW1lbnRzP3RoaXMuc2l6ZSgpOjB9cHJldHR5KCl7cmV0dXJuIHRoaXMuX3ByZXR0eT0hMCx0aGlzfXJlYWRDb25jZXJuKGUpe3JldHVybiB0aGlzLl9yZWFkQ29uY2Vybj1lLHRoaXN9cmVhZFByZWYoZSx0KXtyZXR1cm4gdGhpcy5fcmVhZFByZWY9e21vZGU6ZSx0YWdTZXQ6dH0sdGhpc31yZXR1cm5LZXkoZT0hMCl7cmV0dXJuIHRoaXMuX3JldHVybktleT1lLHRoaXN9c2hvd1JlY29yZElkKGU9ITApe3JldHVybiB0aGlzLl9zaG93UmVjb3JkSWQ9ZSx0aGlzfXNpemUoKXtpZighdGhpcy5kb2N1bWVudHMpcmV0dXJuIDA7Y29uc3QgZT10aGlzLmRvY3VtZW50cy5sZW5ndGgtdGhpcy5wb3M7aWYodGhpcy5fbGltaXQ+MCl7Y29uc3QgdD10aGlzLl9za2lwK3RoaXMuX2xpbWl0O3JldHVybiBNYXRoLm1pbih0LXRoaXMucG9zLGUpfXJldHVybiBlfXNraXAoZSl7cmV0dXJuIHRoaXMuX3NraXA9ZSwwPT09dGhpcy5wb3MmJnRoaXMuZG9jdW1lbnRzJiYodGhpcy5wb3M9TWF0aC5taW4oZSx0aGlzLmRvY3VtZW50cy5sZW5ndGgpKSx0aGlzfWlzQ2xvc2VkKCl7cmV0dXJuITA9PT10aGlzLl9jbG9zZWR9c25hcHNob3QoKXt0aHJvdyBuZXcgSCgic25hcHNob3QiKX1zb3J0KGUpe3JldHVybiBuZXcgdGhpcy5Tb3J0ZWRDdXJzb3IodGhpcy5jb2xsZWN0aW9uLHRoaXMucXVlcnksdGhpcyxlKX1hbGxvd0Rpc2tVc2UoZT0hMCl7cmV0dXJuIHRoaXMuX2FsbG93RGlza1VzZT1lLHRoaXN9Y29sbGF0aW9uKGUpe3JldHVybiB0aGlzLl9jb2xsYXRpb249ZSx0aGlzfXRhaWxhYmxlKCl7dGhyb3cgbmV3IEgoInRhaWxhYmxlIil9YXN5bmMgdG9BcnJheSgpe2F3YWl0IHRoaXMuX2Vuc3VyZUluaXRpYWxpemVkKCk7Y29uc3QgZT1bXTtmb3IoO2F3YWl0IHRoaXMuaGFzTmV4dCgpOyllLnB1c2goYXdhaXQgdGhpcy5uZXh0KCkpO3JldHVybiBlfWFzeW5jKltTeW1ib2wuYXN5bmNJdGVyYXRvcl0oKXtmb3IoYXdhaXQgdGhpcy5fZW5zdXJlSW5pdGlhbGl6ZWQoKTthd2FpdCB0aGlzLmhhc05leHQoKTspeWllbGQgYXdhaXQgdGhpcy5uZXh0KCl9fWNsYXNzIEp7Y29uc3RydWN0b3IoZSx0LG4scil7dGhpcy5jb2xsZWN0aW9uPWUsdGhpcy5xdWVyeT10LHRoaXMuc29ydFNwZWM9cix0aGlzLnBvcz0wLHRoaXMuX2N1cnNvcj1uLHRoaXMuX3NvcnQ9cix0aGlzLl9pbml0aWFsaXplZD0hMSx0aGlzLml0ZW1zPW51bGx9YXN5bmMgX2Vuc3VyZUluaXRpYWxpemVkKCl7aWYodGhpcy5faW5pdGlhbGl6ZWQpcmV0dXJuO2Zvcihhd2FpdCB0aGlzLl9jdXJzb3IuX2Vuc3VyZUluaXRpYWxpemVkKCksdGhpcy5pdGVtcz1bXTthd2FpdCB0aGlzLl9jdXJzb3IuaGFzTmV4dCgpOyl0aGlzLml0ZW1zLnB1c2goYXdhaXQgdGhpcy5fY3Vyc29yLm5leHQoKSk7Y29uc3QgZT1PYmplY3Qua2V5cyh0aGlzLl9zb3J0KTt0aGlzLml0ZW1zLnNvcnQoZnVuY3Rpb24odCxuKXtmb3IobGV0IHI9MDtyPGUubGVuZ3RoO3IrKyl7aWYobnVsbD09dFtlW3JdXSYmbnVsbCE9bltlW3JdXSlyZXR1cm4tMSp0aGlzLl9zb3J0W2Vbcl1dO2lmKG51bGwhPXRbZVtyXV0mJm51bGw9PW5bZVtyXV0pcmV0dXJuIDEqdGhpcy5fc29ydFtlW3JdXTtpZih0W2Vbcl1dPG5bZVtyXV0pcmV0dXJuLTEqdGhpcy5fc29ydFtlW3JdXTtpZih0W2Vbcl1dPm5bZVtyXV0pcmV0dXJuIDEqdGhpcy5fc29ydFtlW3JdXX1yZXR1cm4gMH0uYmluZCh0aGlzKSksdGhpcy5faW5pdGlhbGl6ZWQ9ITB9YmF0Y2hTaXplKCl7dGhyb3ciTm90IEltcGxlbWVudGVkIn1jbG9zZSgpe3Rocm93Ik5vdCBJbXBsZW1lbnRlZCJ9Y29tbWVudCgpe3Rocm93Ik5vdCBJbXBsZW1lbnRlZCJ9YXN5bmMgY291bnQoKXtyZXR1cm4gYXdhaXQgdGhpcy5fZW5zdXJlSW5pdGlhbGl6ZWQoKSx0aGlzLml0ZW1zLmxlbmd0aH1leHBsYWluKCl7dGhyb3ciTm90IEltcGxlbWVudGVkIn1hc3luYyBmb3JFYWNoKGUpe2Zvcihhd2FpdCB0aGlzLl9lbnN1cmVJbml0aWFsaXplZCgpO2F3YWl0IHRoaXMuaGFzTmV4dCgpOylhd2FpdCBlKGF3YWl0IHRoaXMubmV4dCgpKX1hc3luYyBoYXNOZXh0KCl7cmV0dXJuIGF3YWl0IHRoaXMuX2Vuc3VyZUluaXRpYWxpemVkKCksdGhpcy5wb3M8dGhpcy5pdGVtcy5sZW5ndGh9aGludCgpe3Rocm93Ik5vdCBJbXBsZW1lbnRlZCJ9aXRjb3VudCgpe3Rocm93Ik5vdCBJbXBsZW1lbnRlZCJ9YXN5bmMgbGltaXQoZSl7cmV0dXJuIGF3YWl0IHRoaXMuX2Vuc3VyZUluaXRpYWxpemVkKCksdGhpcy5pdGVtcz10aGlzLml0ZW1zLnNsaWNlKDAsZSksdGhpc31hc3luYyBtYXAoZSl7YXdhaXQgdGhpcy5fZW5zdXJlSW5pdGlhbGl6ZWQoKTtjb25zdCB0PVtdO2Zvcig7YXdhaXQgdGhpcy5oYXNOZXh0KCk7KXQucHVzaChhd2FpdCBlKGF3YWl0IHRoaXMubmV4dCgpKSk7cmV0dXJuIHR9bWF4U2Nhbigpe3Rocm93Ik5vdCBJbXBsZW1lbnRlZCJ9bWF4VGltZU1TKCl7dGhyb3ciTm90IEltcGxlbWVudGVkIn1tYXgoKXt0aHJvdyJOb3QgSW1wbGVtZW50ZWQifW1pbigpe3Rocm93Ik5vdCBJbXBsZW1lbnRlZCJ9YXN5bmMgbmV4dCgpe3JldHVybiBhd2FpdCB0aGlzLl9lbnN1cmVJbml0aWFsaXplZCgpLHRoaXMuaXRlbXNbdGhpcy5wb3MrK119bm9DdXJzb3JUaW1lb3V0KCl7dGhyb3ciTm90IEltcGxlbWVudGVkIn1vYmpzTGVmdEluQmF0Y2goKXt0aHJvdyJOb3QgSW1wbGVtZW50ZWQifXByZXR0eSgpe3Rocm93Ik5vdCBJbXBsZW1lbnRlZCJ9cmVhZENvbmNlcm4oKXt0aHJvdyJOb3QgSW1wbGVtZW50ZWQifXJlYWRQcmVmKCl7dGhyb3ciTm90IEltcGxlbWVudGVkIn1yZXR1cm5LZXkoKXt0aHJvdyJOb3QgSW1wbGVtZW50ZWQifXNob3dSZWNvcmRJZCgpe3Rocm93Ik5vdCBJbXBsZW1lbnRlZCJ9c2l6ZSgpe3Rocm93Ik5vdCBJbXBsZW1lbnRlZCJ9YXN5bmMgc2tpcChlKXtmb3IoYXdhaXQgdGhpcy5fZW5zdXJlSW5pdGlhbGl6ZWQoKTtlPjA7KWF3YWl0IHRoaXMubmV4dCgpLGUtLTtyZXR1cm4gdGhpc31zbmFwc2hvdCgpe3Rocm93Ik5vdCBJbXBsZW1lbnRlZCJ9c29ydChlKXtyZXR1cm4gbmV3IEoodGhpcy5jb2xsZWN0aW9uLHRoaXMucXVlcnksdGhpcyxlKX10YWlsYWJsZSgpe3Rocm93Ik5vdCBJbXBsZW1lbnRlZCJ9YXN5bmMgdG9BcnJheSgpe2F3YWl0IHRoaXMuX2Vuc3VyZUluaXRpYWxpemVkKCk7Y29uc3QgZT1bXTtmb3IoO2F3YWl0IHRoaXMuaGFzTmV4dCgpOyllLnB1c2godGhpcy5uZXh0KCkpO3JldHVybiBlfWFzeW5jKltTeW1ib2wuYXN5bmNJdGVyYXRvcl0oKXtmb3IoYXdhaXQgdGhpcy5fZW5zdXJlSW5pdGlhbGl6ZWQoKTthd2FpdCB0aGlzLmhhc05leHQoKTspeWllbGQgYXdhaXQgdGhpcy5uZXh0KCl9fWNvbnN0IEs9e2F0aW9uYWw6ImF0ZSIsdGlvbmFsOiJ0aW9uIixlbmNpOiJlbmNlIixhbmNpOiJhbmNlIixpemVyOiJpemUiLGJsaToiYmxlIixhbGxpOiJhbCIsZW50bGk6ImVudCIsZWxpOiJlIixvdXNsaToib3VzIixpemF0aW9uOiJpemUiLGF0aW9uOiJhdGUiLGF0b3I6ImF0ZSIsYWxpc206ImFsIixpdmVuZXNzOiJpdmUiLGZ1bG5lc3M6ImZ1bCIsb3VzbmVzczoib3VzIixhbGl0aToiYWwiLGl2aXRpOiJpdmUiLGJpbGl0aToiYmxlIixsb2dpOiJsb2cifSxHPXtpY2F0ZToiaWMiLGF0aXZlOiIiLGFsaXplOiJhbCIsaWNpdGk6ImljIixpY2FsOiJpYyIsZnVsOiIiLG5lc3M6IiJ9LFk9IlthZWlvdXldIixYPSIoW15hZWlvdV1bXmFlaW91eV0qKSIsWj0iKCIrWSsiW2FlaW91XSopIixlZT1uZXcgUmVnRXhwKCJeIitYKyI/IitaK1gpLHRlPW5ldyBSZWdFeHAoIl4iK1grIj8iK1orWCtaKyI/JCIpLG5lPW5ldyBSZWdFeHAoIl4iK1grIj8oIitaK1grIil7Mix9IikscmU9bmV3IFJlZ0V4cCgiXiIrWCsiPyIrWSksaWU9bmV3IFJlZ0V4cCgiXiIrWCtZKyJbXmFlaW91d3h5XSQiKSxzZT0vbGwkLyxvZT0vXiguKz8pZSQvLGFlPS9eKC4rPyl5JC8sY2U9L14oLis/KHN8dCkpKGlvbikkLyxsZT0vXiguKz8pKGVkfGluZykkLyx1ZT0vKGF0fGJsfGl6KSQvLGhlPS9eKC4rPyllZWQkLyxmZT0vXi4rP1tec11zJC8sZGU9L14uKz8oc3N8aSllcyQvLHBlPS8oW15hZWlvdXlsc3pdKVwxJC8sZ2U9L14oLis/KShhdGlvbmFsfHRpb25hbHxlbmNpfGFuY2l8aXplcnxibGl8YWxsaXxlbnRsaXxlbGl8b3VzbGl8aXphdGlvbnxhdGlvbnxhdG9yfGFsaXNtfGl2ZW5lc3N8ZnVsbmVzc3xvdXNuZXNzfGFsaXRpfGl2aXRpfGJpbGl0aXxsb2dpKSQvLG1lPS9eKC4rPykoaWNhdGV8YXRpdmV8YWxpemV8aWNpdGl8aWNhbHxmdWx8bmVzcykkLyx5ZT0vXiguKz8pKGFsfGFuY2V8ZW5jZXxlcnxpY3xhYmxlfGlibGV8YW50fGVtZW50fG1lbnR8ZW50fG91fGlzbXxhdGV8aXRpfG91c3xpdmV8aXplKSQvO2Z1bmN0aW9uIHdlKGUpe2xldCB0PVN0cmluZyhlKS50b0xvd2VyQ2FzZSgpO2lmKHQubGVuZ3RoPDMpcmV0dXJuIHQ7bGV0IG4scj0hMTtyZXR1cm4gMTIxPT09dC5jb2RlUG9pbnRBdCgwKSYmKHI9ITAsdD0iWSIrdC5zbGljZSgxKSksZGUudGVzdCh0KT90PXQuc2xpY2UoMCwtMik6ZmUudGVzdCh0KSYmKHQ9dC5zbGljZSgwLC0xKSksKG49aGUuZXhlYyh0KSk/ZWUudGVzdChuWzFdKSYmKHQ9dC5zbGljZSgwLC0xKSk6KG49bGUuZXhlYyh0KSkmJnJlLnRlc3QoblsxXSkmJih0PW5bMV0sdWUudGVzdCh0KT90Kz0iZSI6cGUudGVzdCh0KT90PXQuc2xpY2UoMCwtMSk6aWUudGVzdCh0KSYmKHQrPSJlIikpLChuPWFlLmV4ZWModCkpJiZyZS50ZXN0KG5bMV0pJiYodD1uWzFdKyJpIiksKG49Z2UuZXhlYyh0KSkmJmVlLnRlc3QoblsxXSkmJih0PW5bMV0rS1tuWzJdXSksKG49bWUuZXhlYyh0KSkmJmVlLnRlc3QoblsxXSkmJih0PW5bMV0rR1tuWzJdXSksKG49eWUuZXhlYyh0KSk/bmUudGVzdChuWzFdKSYmKHQ9blsxXSk6KG49Y2UuZXhlYyh0KSkmJm5lLnRlc3QoblsxXSkmJih0PW5bMV0pLChuPW9lLmV4ZWModCkpJiYobmUudGVzdChuWzFdKXx8dGUudGVzdChuWzFdKSYmIWllLnRlc3QoblsxXSkpJiYodD1uWzFdKSxzZS50ZXN0KHQpJiZuZS50ZXN0KHQpJiYodD10LnNsaWNlKDAsLTEpKSxyJiYodD0ieSIrdC5zbGljZSgxKSksdH1jbGFzcyBiZXtjb25zdHJ1Y3RvcihlLHQsbixyLGkscyl7dGhpcy5pZD1lLHRoaXMuaXNMZWFmPXQsdGhpcy5rZXlzPW4sdGhpcy52YWx1ZXM9cix0aGlzLmNoaWxkcmVuPWk7Zm9yKGxldCBvIG9mIGkpaWYoIShvIGluc3RhbmNlb2YgbSkpdGhyb3cgbmV3IEVycm9yKCJDaGlsZHJlbiBtdXN0IGJlIFBvaW50ZXIgb2JqZWN0cyIpO3RoaXMubmV4dD1zfX1jbGFzcyB4ZXtjb25zdHJ1Y3RvcihlLHQ9Myl7aWYodDwzKXRocm93IG5ldyBFcnJvcigiQisgdHJlZSBvcmRlciBtdXN0IGJlIGF0IGxlYXN0IDMiKTt0aGlzLmZpbGU9bmV3IGIoZSksdGhpcy5vcmRlcj10LHRoaXMubWluS2V5cz1NYXRoLmNlaWwodC8yKS0xLHRoaXMuaXNPcGVuPSExLHRoaXMucm9vdFBvaW50ZXI9bnVsbCx0aGlzLm5leHROb2RlSWQ9MCx0aGlzLl9zaXplPTB9YXN5bmMgb3Blbigpe2lmKHRoaXMuaXNPcGVuKXRocm93IG5ldyBFcnJvcigiVHJlZSBpcyBhbHJlYWR5IG9wZW4iKTt0aGlzLmZpbGUuZ2V0RmlsZVNpemUoKT4wP3RoaXMuX2xvYWRNZXRhZGF0YSgpOnRoaXMuX2luaXRpYWxpemVOZXdUcmVlKCksdGhpcy5pc09wZW49ITB9YXN5bmMgY2xvc2UoKXt0aGlzLmlzT3BlbiYmKHRoaXMuZmlsZSYmdGhpcy5maWxlLnN5bmNBY2Nlc3NIYW5kbGUmJih0aGlzLmZpbGUuZmx1c2goKSxhd2FpdCB0aGlzLmZpbGUuc3luY0FjY2Vzc0hhbmRsZS5jbG9zZSgpKSx0aGlzLmlzT3Blbj0hMSl9X2luaXRpYWxpemVOZXdUcmVlKCl7Y29uc3QgZT1uZXcgYmUoMCwhMCxbXSxbXSxbXSxudWxsKTt0aGlzLm5leHROb2RlSWQ9MSx0aGlzLl9zaXplPTA7Y29uc3QgdD10aGlzLl9zYXZlTm9kZShlKTt0aGlzLnJvb3RQb2ludGVyPXQsdGhpcy5fc2F2ZU1ldGFkYXRhKCl9X3NhdmVNZXRhZGF0YSgpe2NvbnN0IGU9e3ZlcnNpb246MSxtYXhFbnRyaWVzOnRoaXMub3JkZXIsbWluRW50cmllczp0aGlzLm1pbktleXMsc2l6ZTp0aGlzLl9zaXplLHJvb3RQb2ludGVyOnRoaXMucm9vdFBvaW50ZXIsbmV4dElkOnRoaXMubmV4dE5vZGVJZH07dGhpcy5maWxlLmFwcGVuZChlKX1fbG9hZE1ldGFkYXRhKCl7Y29uc3QgZT10aGlzLmZpbGUuZ2V0RmlsZVNpemUoKTtpZihlPDEzNSl0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgdHJlZSBmaWxlIik7Y29uc3QgdD1lLTEzNSxuPXRoaXMuZmlsZS5yZWFkKHQpO2lmKCFufHx2b2lkIDA9PT1uLm1heEVudHJpZXMpdGhyb3cgbmV3IEVycm9yKCJGYWlsZWQgdG8gcmVhZCBtZXRhZGF0YTogbWlzc2luZyByZXF1aXJlZCBmaWVsZHMiKTt0aGlzLm9yZGVyPW4ubWF4RW50cmllcyx0aGlzLm1pbktleXM9bi5taW5FbnRyaWVzLHRoaXMuX3NpemU9bi5zaXplLHRoaXMubmV4dE5vZGVJZD1uLm5leHRJZCx0aGlzLnJvb3RQb2ludGVyPW4ucm9vdFBvaW50ZXJ9X3NhdmVOb2RlKGUpe2NvbnN0IHQ9dGhpcy5maWxlLmdldEZpbGVTaXplKCk7cmV0dXJuIHRoaXMuZmlsZS5hcHBlbmQoZSksbmV3IG0odCl9X2xvYWROb2RlKGUpe2lmKCEoZSBpbnN0YW5jZW9mIG0pKXRocm93IG5ldyBFcnJvcigiRXhwZWN0ZWQgUG9pbnRlciBvYmplY3QiKTtjb25zdCB0PXRoaXMuZmlsZS5yZWFkKGUpO3JldHVybiBuZXcgYmUodC5pZCx0LmlzTGVhZix0LmtleXMsdC52YWx1ZXMsdC5jaGlsZHJlbix0Lm5leHQpfV9sb2FkUm9vdCgpe3JldHVybiB0aGlzLl9sb2FkTm9kZSh0aGlzLnJvb3RQb2ludGVyKX1zZWFyY2goZSl7Y29uc3QgdD10aGlzLl9sb2FkUm9vdCgpO3JldHVybiB0aGlzLl9zZWFyY2hOb2RlKHQsZSl9X3NlYXJjaE5vZGUoZSx0KXtpZighZS5pc0xlYWYpe2xldCBuPTA7Zm9yKDtuPGUua2V5cy5sZW5ndGgmJnQ+PWUua2V5c1tuXTspbisrO2NvbnN0IHI9dGhpcy5fbG9hZE5vZGUoZS5jaGlsZHJlbltuXSk7cmV0dXJuIHRoaXMuX3NlYXJjaE5vZGUocix0KX1mb3IobGV0IG49MDtuPGUua2V5cy5sZW5ndGg7bisrKWlmKHQ9PT1lLmtleXNbbl0pcmV0dXJuIGUudmFsdWVzW25dfWFkZChlLHQpe2NvbnN0IG49dGhpcy5fbG9hZFJvb3QoKSxyPXRoaXMuX2FkZFRvTm9kZShuLGUsdCk7bGV0IGk7aWYoci5uZXdOb2RlKWk9ci5uZXdOb2RlO2Vsc2V7Y29uc3QgZT10aGlzLl9zYXZlTm9kZShyLmxlZnQpLHQ9dGhpcy5fc2F2ZU5vZGUoci5yaWdodCk7aT1uZXcgYmUodGhpcy5uZXh0Tm9kZUlkKyssITEsW3Iuc3BsaXRLZXldLFtdLFtlLHRdLG51bGwpfWNvbnN0IHM9dGhpcy5fc2F2ZU5vZGUoaSk7dGhpcy5yb290UG9pbnRlcj1zLHRoaXMuX3NpemUrKyx0aGlzLl9zYXZlTWV0YWRhdGEoKX1fYWRkVG9Ob2RlKGUsdCxuKXtpZihlLmlzTGVhZil7Y29uc3Qgcj1bLi4uZS5rZXlzXSxpPVsuLi5lLnZhbHVlc10scz1yLmluZGV4T2YodCk7aWYoLTEhPT1zKXJldHVybiBpW3NdPW4se25ld05vZGU6bmV3IGJlKGUuaWQsITAscixpLFtdLG51bGwpfTtsZXQgbz0wO2Zvcig7bzxyLmxlbmd0aCYmdD5yW29dOylvKys7aWYoci5zcGxpY2UobywwLHQpLGkuc3BsaWNlKG8sMCxuKSxyLmxlbmd0aDx0aGlzLm9yZGVyKXJldHVybntuZXdOb2RlOm5ldyBiZShlLmlkLCEwLHIsaSxbXSxudWxsKX07e2NvbnN0IHQ9TWF0aC5jZWlsKHIubGVuZ3RoLzIpLG49ci5zbGljZSgwLHQpLHM9aS5zbGljZSgwLHQpLG89ci5zbGljZSh0KSxhPWkuc2xpY2UodCksYz1uZXcgYmUodGhpcy5uZXh0Tm9kZUlkKyssITAsbyxhLFtdLG51bGwpO3JldHVybntsZWZ0Om5ldyBiZShlLmlkLCEwLG4scyxbXSxudWxsKSxyaWdodDpjLHNwbGl0S2V5Om9bMF19fX17Y29uc3Qgcj1bLi4uZS5rZXlzXSxpPVsuLi5lLmNoaWxkcmVuXTtsZXQgcz0wO2Zvcig7czxyLmxlbmd0aCYmdD49cltzXTspcysrO2NvbnN0IG89dGhpcy5fbG9hZE5vZGUoaVtzXSksYT10aGlzLl9hZGRUb05vZGUobyx0LG4pO2lmKGEubmV3Tm9kZSl7Y29uc3QgdD10aGlzLl9zYXZlTm9kZShhLm5ld05vZGUpO3JldHVybiBpW3NdPXQse25ld05vZGU6bmV3IGJlKGUuaWQsITEscixbXSxpLG51bGwpfX17Y29uc3QgdD10aGlzLl9zYXZlTm9kZShhLmxlZnQpLG49dGhpcy5fc2F2ZU5vZGUoYS5yaWdodCk7aWYoci5zcGxpY2UocywwLGEuc3BsaXRLZXkpLGkuc3BsaWNlKHMsMSx0LG4pLHIubGVuZ3RoPHRoaXMub3JkZXIpcmV0dXJue25ld05vZGU6bmV3IGJlKGUuaWQsITEscixbXSxpLG51bGwpfTt7Y29uc3QgdD1NYXRoLmNlaWwoci5sZW5ndGgvMiktMSxuPXJbdF0scz1yLnNsaWNlKDAsdCksbz1yLnNsaWNlKHQrMSksYT1pLnNsaWNlKDAsdCsxKSxjPWkuc2xpY2UodCsxKTtyZXR1cm57bGVmdDpuZXcgYmUoZS5pZCwhMSxzLFtdLGEsbnVsbCkscmlnaHQ6bmV3IGJlKHRoaXMubmV4dE5vZGVJZCsrLCExLG8sW10sYyxudWxsKSxzcGxpdEtleTpufX19fX1kZWxldGUoZSl7Y29uc3QgdD10aGlzLl9sb2FkUm9vdCgpLG49dGhpcy5fZGVsZXRlRnJvbU5vZGUodCxlKTtpZighbilyZXR1cm47bGV0IHI9bjswPT09ci5rZXlzLmxlbmd0aCYmIXIuaXNMZWFmJiZyLmNoaWxkcmVuLmxlbmd0aD4wJiYocj10aGlzLl9sb2FkTm9kZShyLmNoaWxkcmVuWzBdKSk7Y29uc3QgaT10aGlzLl9zYXZlTm9kZShyKTt0aGlzLnJvb3RQb2ludGVyPWksdGhpcy5fc2l6ZS0tLHRoaXMuX3NhdmVNZXRhZGF0YSgpfV9kZWxldGVGcm9tTm9kZShlLHQpe2lmKGUuaXNMZWFmKXtjb25zdCBuPWUua2V5cy5pbmRleE9mKHQpO2lmKC0xPT09bilyZXR1cm4gbnVsbDtjb25zdCByPVsuLi5lLmtleXNdLGk9Wy4uLmUudmFsdWVzXTtyZXR1cm4gci5zcGxpY2UobiwxKSxpLnNwbGljZShuLDEpLG5ldyBiZShlLmlkLCEwLHIsaSxbXSxlLm5leHQpfXtsZXQgbj0wO2Zvcig7bjxlLmtleXMubGVuZ3RoJiZ0Pj1lLmtleXNbbl07KW4rKztjb25zdCByPXRoaXMuX2xvYWROb2RlKGUuY2hpbGRyZW5bbl0pLGk9dGhpcy5fZGVsZXRlRnJvbU5vZGUocix0KTtpZighaSlyZXR1cm4gbnVsbDtjb25zdCBzPVsuLi5lLmNoaWxkcmVuXSxvPXRoaXMuX3NhdmVOb2RlKGkpO3JldHVybiBzW25dPW8sbmV3IGJlKGUuaWQsITEsWy4uLmUua2V5c10sW10scyxudWxsKX19dG9BcnJheSgpe2NvbnN0IGU9W107cmV0dXJuIHRoaXMuX2NvbGxlY3RBbGxFbnRyaWVzKHRoaXMuX2xvYWRSb290KCksZSksZX1hc3luYypbU3ltYm9sLmFzeW5jSXRlcmF0b3JdKCl7aWYoIXRoaXMuaXNPcGVuKXRocm93IG5ldyBFcnJvcigiVHJlZSBtdXN0IGJlIG9wZW4gYmVmb3JlIGl0ZXJhdGlvbiIpOzAhPT10aGlzLl9zaXplJiYoeWllbGQqdGhpcy5faXRlcmF0ZU5vZGUodGhpcy5fbG9hZFJvb3QoKSkpfSpfaXRlcmF0ZU5vZGUoZSl7aWYoZS5pc0xlYWYpZm9yKGxldCB0PTA7dDxlLmtleXMubGVuZ3RoO3QrKyl5aWVsZHtrZXk6ZS5rZXlzW3RdLHZhbHVlOmUudmFsdWVzW3RdfTtlbHNlIGZvcihjb25zdCB0IG9mIGUuY2hpbGRyZW4pe2NvbnN0IGU9dGhpcy5fbG9hZE5vZGUodCk7eWllbGQqdGhpcy5faXRlcmF0ZU5vZGUoZSl9fV9jb2xsZWN0QWxsRW50cmllcyhlLHQpe2lmKGUuaXNMZWFmKWZvcihsZXQgbj0wO248ZS5rZXlzLmxlbmd0aDtuKyspdC5wdXNoKHtrZXk6ZS5rZXlzW25dLHZhbHVlOmUudmFsdWVzW25dfSk7ZWxzZSBmb3IoY29uc3QgbiBvZiBlLmNoaWxkcmVuKXtjb25zdCBlPXRoaXMuX2xvYWROb2RlKG4pO3RoaXMuX2NvbGxlY3RBbGxFbnRyaWVzKGUsdCl9fXNpemUoKXtyZXR1cm4gdGhpcy5fc2l6ZX1pc0VtcHR5KCl7cmV0dXJuIDA9PT10aGlzLl9zaXplfXJhbmdlU2VhcmNoKGUsdCl7Y29uc3Qgbj1bXTtyZXR1cm4gdGhpcy5fcmFuZ2VTZWFyY2hOb2RlKHRoaXMuX2xvYWRSb290KCksZSx0LG4pLG59X3JhbmdlU2VhcmNoTm9kZShlLHQsbixyKXtpZihlLmlzTGVhZilmb3IobGV0IGk9MDtpPGUua2V5cy5sZW5ndGg7aSsrKWUua2V5c1tpXT49dCYmZS5rZXlzW2ldPD1uJiZyLnB1c2goe2tleTplLmtleXNbaV0sdmFsdWU6ZS52YWx1ZXNbaV19KTtlbHNlIGZvcihjb25zdCBpIG9mIGUuY2hpbGRyZW4pe2NvbnN0IGU9dGhpcy5fbG9hZE5vZGUoaSk7dGhpcy5fcmFuZ2VTZWFyY2hOb2RlKGUsdCxuLHIpfX1nZXRIZWlnaHQoKXtsZXQgZT0wLHQ9dGhpcy5fbG9hZFJvb3QoKTtmb3IoOyF0LmlzTGVhZjspZSsrLHQ9dGhpcy5fbG9hZE5vZGUodC5jaGlsZHJlblswXSk7cmV0dXJuIGV9YXN5bmMgY29tcGFjdChlKXtpZighdGhpcy5pc09wZW4pdGhyb3cgbmV3IEVycm9yKCJUcmVlIGZpbGUgaXMgbm90IG9wZW4iKTtpZighZSl0aHJvdyBuZXcgRXJyb3IoIkRlc3RpbmF0aW9uIHN5bmMgaGFuZGxlIGlzIHJlcXVpcmVkIGZvciBjb21wYWN0aW9uIik7Y29uc3QgdD10aGlzLmZpbGUuZ2V0RmlsZVNpemUoKSxuPXRoaXMudG9BcnJheSgpLHI9bmV3IHhlKGUsdGhpcy5vcmRlcik7YXdhaXQgci5vcGVuKCk7Zm9yKGNvbnN0IHMgb2Ygbilhd2FpdCByLmFkZChzLmtleSxzLnZhbHVlKTtjb25zdCBpPXIuZmlsZS5nZXRGaWxlU2l6ZSgpO3JldHVybiBhd2FpdCByLmNsb3NlKCkse29sZFNpemU6dCxuZXdTaXplOmksYnl0ZXNTYXZlZDpNYXRoLm1heCgwLHQtaSl9fX1jb25zdCBfZT0vKiBAX19QVVJFX18gKi9uZXcgU2V0KFsiYSIsImFib3V0IiwiYWZ0ZXIiLCJhbGwiLCJhbHNvIiwiYW0iLCJhbiIsImFuZCIsImFub3RoZXIiLCJhbnkiLCJhcmUiLCJhcm91bmQiLCJhcyIsImF0IiwiYmUiLCJiZWNhdXNlIiwiYmVlbiIsImJlZm9yZSIsImJlaW5nIiwiYmV0d2VlbiIsImJvdGgiLCJidXQiLCJieSIsImNhbWUiLCJjYW4iLCJjb21lIiwiY291bGQiLCJkaWQiLCJkbyIsImVhY2giLCJmb3IiLCJmcm9tIiwiZ2V0IiwiZ290IiwiaGFzIiwiaGFkIiwiaGUiLCJoYXZlIiwiaGVyIiwiaGVyZSIsImhpbSIsImhpbXNlbGYiLCJoaXMiLCJob3ciLCJpIiwiaWYiLCJpbiIsImludG8iLCJpcyIsIml0IiwibGlrZSIsIm1ha2UiLCJtYW55IiwibWUiLCJtaWdodCIsIm1vcmUiLCJtb3N0IiwibXVjaCIsIm11c3QiLCJteSIsIm5ldmVyIiwibm93Iiwib2YiLCJvbiIsIm9ubHkiLCJvciIsIm90aGVyIiwib3VyIiwib3V0Iiwib3ZlciIsInNhaWQiLCJzYW1lIiwic2VlIiwic2hvdWxkIiwic2luY2UiLCJzb21lIiwic3RpbGwiLCJzdWNoIiwidGFrZSIsInRoYW4iLCJ0aGF0IiwidGhlIiwidGhlaXIiLCJ0aGVtIiwidGhlbiIsInRoZXJlIiwidGhlc2UiLCJ0aGV5IiwidGhpcyIsInRob3NlIiwidGhyb3VnaCIsInRvIiwidG9vIiwidW5kZXIiLCJ1cCIsInZlcnkiLCJ3YXMiLCJ3YXkiLCJ3ZSIsIndlbGwiLCJ3ZXJlIiwid2hhdCIsIndoZXJlIiwid2hpY2giLCJ3aGlsZSIsIndobyIsIndpdGgiLCJ3b3VsZCIsInlvdSIsInlvdXIiXSk7ZnVuY3Rpb24gdmUoZSl7aWYoInN0cmluZyIhPXR5cGVvZiBlKXJldHVybltdO3JldHVybiBlLnRvTG93ZXJDYXNlKCkuc3BsaXQoL1xXKy8pLmZpbHRlcihlPT5lLmxlbmd0aD4wKS5maWx0ZXIoZT0+IV9lLmhhcyhlKSl9Y2xhc3MgJGV7Y29uc3RydWN0b3IoZT17fSl7Y29uc3R7b3JkZXI6dD0xNix0cmVlczpufT1lO3RoaXMub3JkZXI9dCx0aGlzLmluZGV4PW4/LmluZGV4fHxudWxsLHRoaXMuZG9jdW1lbnRUZXJtcz1uPy5kb2N1bWVudFRlcm1zfHxudWxsLHRoaXMuZG9jdW1lbnRMZW5ndGhzPW4/LmRvY3VtZW50TGVuZ3Roc3x8bnVsbCx0aGlzLmlzT3Blbj0hMX1hc3luYyBvcGVuKCl7aWYodGhpcy5pc09wZW4pdGhyb3cgbmV3IEVycm9yKCJUZXh0SW5kZXggaXMgYWxyZWFkeSBvcGVuIik7aWYoIXRoaXMuaW5kZXh8fCF0aGlzLmRvY3VtZW50VGVybXN8fCF0aGlzLmRvY3VtZW50TGVuZ3Rocyl0aHJvdyBuZXcgRXJyb3IoIlRyZWVzIG11c3QgYmUgaW5pdGlhbGl6ZWQgYmVmb3JlIG9wZW5pbmciKTthd2FpdCBQcm9taXNlLmFsbChbdGhpcy5pbmRleC5vcGVuKCksdGhpcy5kb2N1bWVudFRlcm1zLm9wZW4oKSx0aGlzLmRvY3VtZW50TGVuZ3Rocy5vcGVuKCldKSx0aGlzLmlzT3Blbj0hMH1hc3luYyBjbG9zZSgpe3RoaXMuaXNPcGVuJiYoYXdhaXQgUHJvbWlzZS5hbGwoW3RoaXMuaW5kZXguY2xvc2UoKSx0aGlzLmRvY3VtZW50VGVybXMuY2xvc2UoKSx0aGlzLmRvY3VtZW50TGVuZ3Rocy5jbG9zZSgpXSksdGhpcy5pc09wZW49ITEpfV9lbnN1cmVPcGVuKCl7aWYoIXRoaXMuaXNPcGVuKXRocm93IG5ldyBFcnJvcigiVGV4dEluZGV4IGlzIG5vdCBvcGVuIil9YXN5bmMgYWRkKGUsdCl7aWYodGhpcy5fZW5zdXJlT3BlbigpLCFlKXRocm93IG5ldyBFcnJvcigiRG9jdW1lbnQgSUQgaXMgcmVxdWlyZWQiKTtjb25zdCBuPXZlKHQpLHI9LyogQF9fUFVSRV9fICovbmV3IE1hcDtuLmZvckVhY2goZT0+e2NvbnN0IHQ9d2UoZSk7ci5zZXQodCwoci5nZXQodCl8fDApKzEpfSk7Zm9yKGNvbnN0W28sYV1vZiByLmVudHJpZXMoKSl7Y29uc3QgdD1hd2FpdCB0aGlzLmluZGV4LnNlYXJjaChvKXx8e307dFtlXT1hLGF3YWl0IHRoaXMuaW5kZXguYWRkKG8sdCl9Y29uc3QgaT17Li4uYXdhaXQgdGhpcy5kb2N1bWVudFRlcm1zLnNlYXJjaChlKXx8e319O3IuZm9yRWFjaCgoZSx0KT0+e2lbdF09ZX0pO2NvbnN0IHM9T2JqZWN0LnZhbHVlcyhpKS5yZWR1Y2UoKGUsdCk9PmUrdCwwKTthd2FpdCB0aGlzLmRvY3VtZW50VGVybXMuYWRkKGUsaSksYXdhaXQgdGhpcy5kb2N1bWVudExlbmd0aHMuYWRkKGUscyl9YXN5bmMgcmVtb3ZlKGUpe3RoaXMuX2Vuc3VyZU9wZW4oKTtjb25zdCB0PWF3YWl0IHRoaXMuZG9jdW1lbnRUZXJtcy5zZWFyY2goZSk7aWYoIXQpcmV0dXJuITE7Zm9yKGNvbnN0W25db2YgT2JqZWN0LmVudHJpZXModCkpe2NvbnN0IHQ9YXdhaXQgdGhpcy5pbmRleC5zZWFyY2gobil8fHt9O2RlbGV0ZSB0W2VdLDA9PT1PYmplY3Qua2V5cyh0KS5sZW5ndGg/YXdhaXQgdGhpcy5pbmRleC5kZWxldGUobik6YXdhaXQgdGhpcy5pbmRleC5hZGQobix0KX1yZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudFRlcm1zLmRlbGV0ZShlKSxhd2FpdCB0aGlzLmRvY3VtZW50TGVuZ3Rocy5kZWxldGUoZSksITB9YXN5bmMgcXVlcnkoZSx0PXtzY29yZWQ6ITAscmVxdWlyZUFsbDohMX0pe3RoaXMuX2Vuc3VyZU9wZW4oKTtjb25zdCBuPXZlKGUpO2lmKDA9PT1uLmxlbmd0aClyZXR1cm5bXTtjb25zdCByPW4ubWFwKGU9PndlKGUpKSxpPVsuLi5uZXcgU2V0KHIpXTtpZih0LnJlcXVpcmVBbGwpe2NvbnN0IGU9W107Zm9yKGNvbnN0IG4gb2YgaSl7Y29uc3QgdD1hd2FpdCB0aGlzLmluZGV4LnNlYXJjaChuKTtlLnB1c2gobmV3IFNldChPYmplY3Qua2V5cyh0fHx7fSkpKX1pZigwPT09ZS5sZW5ndGgpcmV0dXJuW107Y29uc3QgdD1uZXcgU2V0KGVbMF0pO2ZvcihsZXQgbj0xO248ZS5sZW5ndGg7bisrKWZvcihjb25zdCByIG9mWy4uLnRdKWVbbl0uaGFzKHIpfHx0LmRlbGV0ZShyKTtyZXR1cm4gQXJyYXkuZnJvbSh0KX1jb25zdCBzPWF3YWl0IHRoaXMuZG9jdW1lbnRMZW5ndGhzLnRvQXJyYXkoKSxvPW5ldyBNYXAocy5tYXAoKHtrZXk6ZSx2YWx1ZTp0fSk9PltTdHJpbmcoZSksdHx8MV0pKSxhPXMubGVuZ3RoLGM9LyogQF9fUFVSRV9fICovbmV3IE1hcDtmb3IoY29uc3QgaCBvZiBpKXtjb25zdCBlPWF3YWl0IHRoaXMuaW5kZXguc2VhcmNoKGgpLHQ9ZT9PYmplY3Qua2V5cyhlKS5sZW5ndGg6MDt0PjAmJmMuc2V0KGgsTWF0aC5sb2coYS90KSl9Y29uc3QgbD0vKiBAX19QVVJFX18gKi9uZXcgTWFwO2Zvcihjb25zdCBoIG9mIGkpe2NvbnN0IGU9YXdhaXQgdGhpcy5pbmRleC5zZWFyY2goaCk7aWYoZSlmb3IoY29uc3RbdCxuXW9mIE9iamVjdC5lbnRyaWVzKGUpKXtjb25zdCBlPW4vKG8uZ2V0KHQpfHwxKSxyPWMuZ2V0KGgpfHwwLGk9bC5nZXQodCl8fDA7bC5zZXQodCxpK2Uqcil9fWZvcihjb25zdFtoLGZdb2YgbC5lbnRyaWVzKCkpe2NvbnN0IGU9YXdhaXQgdGhpcy5kb2N1bWVudFRlcm1zLnNlYXJjaChoKXx8e30sdD1pLmZpbHRlcih0PT4hIWVbdF0pLmxlbmd0aC9pLmxlbmd0aDtsLnNldChoLGYqKDErdCkpfWNvbnN0IHU9QXJyYXkuZnJvbShsLmVudHJpZXMoKSkubWFwKChbZSx0XSk9Pih7aWQ6ZSxzY29yZTp0fSkpLnNvcnQoKGUsdCk9PnQuc2NvcmUtZS5zY29yZSk7cmV0dXJuITE9PT10LnNjb3JlZD91Lm1hcChlPT5lLmlkKTp1fWFzeW5jIGdldFRlcm1Db3VudCgpe3RoaXMuX2Vuc3VyZU9wZW4oKTtyZXR1cm4oYXdhaXQgdGhpcy5pbmRleC50b0FycmF5KCkpLmxlbmd0aH1hc3luYyBnZXREb2N1bWVudENvdW50KCl7dGhpcy5fZW5zdXJlT3BlbigpO3JldHVybihhd2FpdCB0aGlzLmRvY3VtZW50VGVybXMudG9BcnJheSgpKS5sZW5ndGh9YXN5bmMgY2xlYXIoKXt0aGlzLl9lbnN1cmVPcGVuKCk7Y29uc3RbZSx0LG5dPWF3YWl0IFByb21pc2UuYWxsKFt0aGlzLmluZGV4LnRvQXJyYXkoKSx0aGlzLmRvY3VtZW50VGVybXMudG9BcnJheSgpLHRoaXMuZG9jdW1lbnRMZW5ndGhzLnRvQXJyYXkoKV0pO2Zvcihjb25zdCByIG9mIGUpYXdhaXQgdGhpcy5pbmRleC5kZWxldGUoci5rZXkpO2Zvcihjb25zdCByIG9mIHQpYXdhaXQgdGhpcy5kb2N1bWVudFRlcm1zLmRlbGV0ZShyLmtleSk7Zm9yKGNvbnN0IHIgb2Ygbilhd2FpdCB0aGlzLmRvY3VtZW50TGVuZ3Rocy5kZWxldGUoci5rZXkpfWFzeW5jIGNvbXBhY3Qoe2luZGV4OmUsZG9jdW1lbnRUZXJtczp0LGRvY3VtZW50TGVuZ3RoczpufSl7aWYodGhpcy5fZW5zdXJlT3BlbigpLCFlfHwhdHx8IW4pdGhyb3cgbmV3IEVycm9yKCJEZXN0aW5hdGlvbiB0cmVlcyBtdXN0IGJlIHByb3ZpZGVkIGZvciBjb21wYWN0aW9uIik7Y29uc3Qgcj1hd2FpdCB0aGlzLmluZGV4LmNvbXBhY3QoZS5maWxlLnN5bmNBY2Nlc3NIYW5kbGUpLGk9YXdhaXQgdGhpcy5kb2N1bWVudFRlcm1zLmNvbXBhY3QodC5maWxlLnN5bmNBY2Nlc3NIYW5kbGUpLHM9YXdhaXQgdGhpcy5kb2N1bWVudExlbmd0aHMuY29tcGFjdChuLmZpbGUuc3luY0FjY2Vzc0hhbmRsZSk7cmV0dXJuIGF3YWl0IHRoaXMuY2xvc2UoKSx0aGlzLmlzT3Blbj0hMSx7dGVybXM6cixkb2N1bWVudHM6aSxsZW5ndGhzOnN9fX1mdW5jdGlvbiBJZShlLHQpe2lmKG51bGw9PWUpcmV0dXJuIGU7aWYoImJvb2xlYW4iPT10eXBlb2YgZXx8Im51bWJlciI9PXR5cGVvZiBlKXJldHVybiBlO2lmKCJzdHJpbmciPT10eXBlb2YgZSlyZXR1cm4gZS5zdGFydHNXaXRoKCIkJCIpPyIkJEtFRVAiPT09ZXx8IiQkUFJVTkUiPT09ZXx8IiQkREVTQ0VORCI9PT1lP2U6dih0LGUuc3Vic3RyaW5nKDIpKToiJCI9PT1lLmNoYXJBdCgwKT92KHQsZS5zdWJzdHJpbmcoMSkpOmU7aWYoIm9iamVjdCI9PXR5cGVvZiBlKXtpZihBcnJheS5pc0FycmF5KGUpKXJldHVybiBlLm1hcChlPT5JZShlLHQpKTtjb25zdCBuPU9iamVjdC5rZXlzKGUpO2lmKDA9PT1uLmxlbmd0aClyZXR1cm4gZTtjb25zdCByPW5bMF07aWYoIiQiPT09ci5jaGFyQXQoMCkpe3JldHVybiBmdW5jdGlvbihlLHQsbil7c3dpdGNoKGUpe2Nhc2UiJGFkZCI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7aWYoIUFycmF5LmlzQXJyYXkoZSkpcmV0dXJuIG51bGw7bGV0IG49MDtmb3IoY29uc3QgciBvZiBlKXtjb25zdCBlPUllKHIsdCk7ZSBpbnN0YW5jZW9mIERhdGU/bis9ZS5nZXRUaW1lKCk6Im51bWJlciI9PXR5cGVvZiBlJiYobis9ZSl9cmV0dXJuIG59KHQsbik7Y2FzZSIkc3VidHJhY3QiOnJldHVybiBmdW5jdGlvbihlLHQpe2lmKCFBcnJheS5pc0FycmF5KGUpfHwyIT09ZS5sZW5ndGgpcmV0dXJuIG51bGw7Y29uc3Qgbj1JZShlWzBdLHQpLHI9SWUoZVsxXSx0KTtpZihuIGluc3RhbmNlb2YgRGF0ZSYmciBpbnN0YW5jZW9mIERhdGUpcmV0dXJuIG4uZ2V0VGltZSgpLXIuZ2V0VGltZSgpO2lmKG4gaW5zdGFuY2VvZiBEYXRlJiYibnVtYmVyIj09dHlwZW9mIHIpcmV0dXJuIG5ldyBEYXRlKG4uZ2V0VGltZSgpLXIpO2lmKCJudW1iZXIiPT10eXBlb2YgbiYmIm51bWJlciI9PXR5cGVvZiByKXJldHVybiBuLXI7cmV0dXJuIG51bGx9KHQsbik7Y2FzZSIkbXVsdGlwbHkiOnJldHVybiBmdW5jdGlvbihlLHQpe2lmKCFBcnJheS5pc0FycmF5KGUpKXJldHVybiBudWxsO2xldCBuPTE7Zm9yKGNvbnN0IHIgb2YgZSl7Y29uc3QgZT1JZShyLHQpOyJudW1iZXIiPT10eXBlb2YgZSYmKG4qPWUpfXJldHVybiBufSh0LG4pO2Nhc2UiJGRpdmlkZSI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7aWYoIUFycmF5LmlzQXJyYXkoZSl8fDIhPT1lLmxlbmd0aClyZXR1cm4gbnVsbDtjb25zdCBuPUllKGVbMF0sdCkscj1JZShlWzFdLHQpO2lmKCJudW1iZXIiPT10eXBlb2YgbiYmIm51bWJlciI9PXR5cGVvZiByJiYwIT09cilyZXR1cm4gbi9yO3JldHVybiBudWxsfSh0LG4pO2Nhc2UiJG1vZCI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7aWYoIUFycmF5LmlzQXJyYXkoZSl8fDIhPT1lLmxlbmd0aClyZXR1cm4gbnVsbDtjb25zdCBuPUllKGVbMF0sdCkscj1JZShlWzFdLHQpO2lmKCJudW1iZXIiPT10eXBlb2YgbiYmIm51bWJlciI9PXR5cGVvZiByJiYwIT09cilyZXR1cm4gbiVyO3JldHVybiBudWxsfSh0LG4pO2Nhc2UiJHBvdyI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7aWYoIUFycmF5LmlzQXJyYXkoZSl8fDIhPT1lLmxlbmd0aClyZXR1cm4gbnVsbDtjb25zdCBuPUllKGVbMF0sdCkscj1JZShlWzFdLHQpO2lmKCJudW1iZXIiPT10eXBlb2YgbiYmIm51bWJlciI9PXR5cGVvZiByKXJldHVybiBNYXRoLnBvdyhuLHIpO3JldHVybiBudWxsfSh0LG4pO2Nhc2UiJHNxcnQiOnJldHVybiBmdW5jdGlvbihlLHQpe2NvbnN0IG49SWUoZSx0KTtpZigibnVtYmVyIj09dHlwZW9mIG4mJm4+PTApcmV0dXJuIE1hdGguc3FydChuKTtyZXR1cm4gbnVsbH0odCxuKTtjYXNlIiRhYnMiOnJldHVybiBmdW5jdGlvbihlLHQpe2NvbnN0IG49SWUoZSx0KTtpZigibnVtYmVyIj09dHlwZW9mIG4pcmV0dXJuIE1hdGguYWJzKG4pO3JldHVybiBudWxsfSh0LG4pO2Nhc2UiJGNlaWwiOnJldHVybiBmdW5jdGlvbihlLHQpe2NvbnN0IG49SWUoZSx0KTtpZigibnVtYmVyIj09dHlwZW9mIG4pcmV0dXJuIE1hdGguY2VpbChuKTtyZXR1cm4gbnVsbH0odCxuKTtjYXNlIiRmbG9vciI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7Y29uc3Qgbj1JZShlLHQpO2lmKCJudW1iZXIiPT10eXBlb2YgbilyZXR1cm4gTWF0aC5mbG9vcihuKTtyZXR1cm4gbnVsbH0odCxuKTtjYXNlIiR0cnVuYyI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7Y29uc3Qgbj1JZShlLHQpO2lmKCJudW1iZXIiPT10eXBlb2YgbilyZXR1cm4gTWF0aC50cnVuYyhuKTtyZXR1cm4gbnVsbH0odCxuKTtjYXNlIiRyb3VuZCI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7Y29uc3Qgbj1JZShBcnJheS5pc0FycmF5KGUpP2VbMF06ZSx0KSxyPUFycmF5LmlzQXJyYXkoZSkmJnZvaWQgMCE9PWVbMV0/SWUoZVsxXSx0KTowO2lmKCJudW1iZXIiPT10eXBlb2YgbiYmIm51bWJlciI9PXR5cGVvZiByKXtjb25zdCBlPU1hdGgucG93KDEwLHIpO3JldHVybiBNYXRoLnJvdW5kKG4qZSkvZX1yZXR1cm4gbnVsbH0odCxuKTtjYXNlIiRjb25jYXQiOnJldHVybiBmdW5jdGlvbihlLHQpe2lmKCFBcnJheS5pc0FycmF5KGUpKXJldHVybiBudWxsO2xldCBuPSIiO2Zvcihjb25zdCByIG9mIGUpe2NvbnN0IGU9SWUocix0KTtudWxsIT1lJiYobis9U3RyaW5nKGUpKX1yZXR1cm4gbn0odCxuKTtjYXNlIiRzdWJzdHIiOnJldHVybiBmdW5jdGlvbihlLHQpe2lmKCFBcnJheS5pc0FycmF5KGUpfHxlLmxlbmd0aDwzKXJldHVybiBudWxsO2NvbnN0IG49U3RyaW5nKEllKGVbMF0sdCl8fCIiKSxyPUllKGVbMV0sdCksaT1JZShlWzJdLHQpO2lmKCJudW1iZXIiPT10eXBlb2YgciYmIm51bWJlciI9PXR5cGVvZiBpKXJldHVybiBuLnN1YnN0cihyLGkpO3JldHVybiBudWxsfSh0LG4pO2Nhc2UiJHRvTG93ZXIiOnJldHVybiBmdW5jdGlvbihlLHQpe2NvbnN0IG49SWUoZSx0KTtyZXR1cm4gbnVsbCE9bj9TdHJpbmcobikudG9Mb3dlckNhc2UoKToiIn0odCxuKTtjYXNlIiR0b1VwcGVyIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPUllKGUsdCk7cmV0dXJuIG51bGwhPW4/U3RyaW5nKG4pLnRvVXBwZXJDYXNlKCk6IiJ9KHQsbik7Y2FzZSIkdHJpbSI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7Y29uc3Qgbj1JZSgib2JqZWN0Ij09dHlwZW9mIGUmJmUuaW5wdXQ/ZS5pbnB1dDplLHQpLHI9ZS5jaGFycz9JZShlLmNoYXJzLHQpOm51bGw7bGV0IGk9bnVsbCE9bj9TdHJpbmcobik6IiI7aWYocil7Y29uc3QgZT1uZXcgUmVnRXhwKGBeWyR7TmUocil9XSt8WyR7TmUocil9XSskYCwiZyIpO3JldHVybiBpLnJlcGxhY2UoZSwiIil9cmV0dXJuIGkudHJpbSgpfSh0LG4pO2Nhc2UiJGx0cmltIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPUllKCJvYmplY3QiPT10eXBlb2YgZSYmZS5pbnB1dD9lLmlucHV0OmUsdCkscj1lLmNoYXJzP0llKGUuY2hhcnMsdCk6bnVsbDtsZXQgaT1udWxsIT1uP1N0cmluZyhuKToiIjtpZihyKXtjb25zdCBlPW5ldyBSZWdFeHAoYF5bJHtOZShyKX1dK2AsImciKTtyZXR1cm4gaS5yZXBsYWNlKGUsIiIpfXJldHVybiBpLnJlcGxhY2UoL15ccysvLCIiKX0odCxuKTtjYXNlIiRydHJpbSI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7Y29uc3Qgbj1JZSgib2JqZWN0Ij09dHlwZW9mIGUmJmUuaW5wdXQ/ZS5pbnB1dDplLHQpLHI9ZS5jaGFycz9JZShlLmNoYXJzLHQpOm51bGw7bGV0IGk9bnVsbCE9bj9TdHJpbmcobik6IiI7aWYocil7Y29uc3QgZT1uZXcgUmVnRXhwKGBbJHtOZShyKX1dKyRgLCJnIik7cmV0dXJuIGkucmVwbGFjZShlLCIiKX1yZXR1cm4gaS5yZXBsYWNlKC9ccyskLywiIil9KHQsbik7Y2FzZSIkc3BsaXQiOnJldHVybiBmdW5jdGlvbihlLHQpe2lmKCFBcnJheS5pc0FycmF5KGUpfHwyIT09ZS5sZW5ndGgpcmV0dXJuIG51bGw7Y29uc3Qgbj1TdHJpbmcoSWUoZVswXSx0KXx8IiIpLHI9U3RyaW5nKEllKGVbMV0sdCl8fCIiKTtyZXR1cm4gbi5zcGxpdChyKX0odCxuKTtjYXNlIiRzdHJMZW5DUCI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7Y29uc3Qgbj1JZShlLHQpO3JldHVybiBudWxsIT1uP1N0cmluZyhuKS5sZW5ndGg6MH0odCxuKTtjYXNlIiRzdHJjYXNlY21wIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtpZighQXJyYXkuaXNBcnJheShlKXx8MiE9PWUubGVuZ3RoKXJldHVybiBudWxsO2NvbnN0IG49U3RyaW5nKEllKGVbMF0sdCl8fCIiKS50b0xvd2VyQ2FzZSgpLHI9U3RyaW5nKEllKGVbMV0sdCl8fCIiKS50b0xvd2VyQ2FzZSgpO3JldHVybiBuPHI/LTE6bj5yPzE6MH0odCxuKTtjYXNlIiRpbmRleE9mQ1AiOnJldHVybiBmdW5jdGlvbihlLHQpe2lmKCFBcnJheS5pc0FycmF5KGUpfHxlLmxlbmd0aDwyKXJldHVybiBudWxsO2NvbnN0IG49U3RyaW5nKEllKGVbMF0sdCl8fCIiKSxyPVN0cmluZyhJZShlWzFdLHQpfHwiIiksaT12b2lkIDAhPT1lWzJdP0llKGVbMl0sdCk6MCxzPXZvaWQgMCE9PWVbM10/SWUoZVszXSx0KTpuLmxlbmd0aCxvPW4uc3Vic3RyaW5nKGkscykuaW5kZXhPZihyKTtyZXR1cm4tMT09PW8/LTE6bytpfSh0LG4pO2Nhc2UiJHJlcGxhY2VPbmUiOnJldHVybiBmdW5jdGlvbihlLHQpe2NvbnN0IG49U3RyaW5nKEllKGUuaW5wdXQsdCl8fCIiKSxyPVN0cmluZyhJZShlLmZpbmQsdCl8fCIiKSxpPVN0cmluZyhJZShlLnJlcGxhY2VtZW50LHQpfHwiIik7cmV0dXJuIG4ucmVwbGFjZShyLGkpfSh0LG4pO2Nhc2UiJHJlcGxhY2VBbGwiOnJldHVybiBmdW5jdGlvbihlLHQpe2NvbnN0IG49U3RyaW5nKEllKGUuaW5wdXQsdCl8fCIiKSxyPVN0cmluZyhJZShlLmZpbmQsdCl8fCIiKSxpPVN0cmluZyhJZShlLnJlcGxhY2VtZW50LHQpfHwiIik7cmV0dXJuIG4uc3BsaXQocikuam9pbihpKX0odCxuKTtjYXNlIiRjbXAiOnJldHVybiBmdW5jdGlvbihlLHQpe2lmKCFBcnJheS5pc0FycmF5KGUpfHwyIT09ZS5sZW5ndGgpcmV0dXJuIG51bGw7Y29uc3Qgbj1JZShlWzBdLHQpLHI9SWUoZVsxXSx0KTtyZXR1cm4gbjxyPy0xOm4+cj8xOjB9KHQsbik7Y2FzZSIkZXEiOnJldHVybiBmdW5jdGlvbihlLHQpe2lmKCFBcnJheS5pc0FycmF5KGUpfHwyIT09ZS5sZW5ndGgpcmV0dXJuIG51bGw7Y29uc3Qgbj1JZShlWzBdLHQpLHI9SWUoZVsxXSx0KTtyZXR1cm4gbj09PXJ9KHQsbik7Y2FzZSIkbmUiOnJldHVybiBmdW5jdGlvbihlLHQpe2lmKCFBcnJheS5pc0FycmF5KGUpfHwyIT09ZS5sZW5ndGgpcmV0dXJuIG51bGw7Y29uc3Qgbj1JZShlWzBdLHQpLHI9SWUoZVsxXSx0KTtyZXR1cm4gbiE9PXJ9KHQsbik7Y2FzZSIkZ3QiOnJldHVybiBmdW5jdGlvbihlLHQpe2lmKCFBcnJheS5pc0FycmF5KGUpfHwyIT09ZS5sZW5ndGgpcmV0dXJuIG51bGw7Y29uc3Qgbj1JZShlWzBdLHQpLHI9SWUoZVsxXSx0KTtyZXR1cm4gbj5yfSh0LG4pO2Nhc2UiJGd0ZSI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7aWYoIUFycmF5LmlzQXJyYXkoZSl8fDIhPT1lLmxlbmd0aClyZXR1cm4gbnVsbDtjb25zdCBuPUllKGVbMF0sdCkscj1JZShlWzFdLHQpO3JldHVybiBuPj1yfSh0LG4pO2Nhc2UiJGx0IjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtpZighQXJyYXkuaXNBcnJheShlKXx8MiE9PWUubGVuZ3RoKXJldHVybiBudWxsO2NvbnN0IG49SWUoZVswXSx0KSxyPUllKGVbMV0sdCk7cmV0dXJuIG48cn0odCxuKTtjYXNlIiRsdGUiOnJldHVybiBmdW5jdGlvbihlLHQpe2lmKCFBcnJheS5pc0FycmF5KGUpfHwyIT09ZS5sZW5ndGgpcmV0dXJuIG51bGw7Y29uc3Qgbj1JZShlWzBdLHQpLHI9SWUoZVsxXSx0KTtyZXR1cm4gbjw9cn0odCxuKTtjYXNlIiRhbmQiOnJldHVybiBmdW5jdGlvbihlLHQpe2lmKCFBcnJheS5pc0FycmF5KGUpKXJldHVybiBudWxsO2Zvcihjb25zdCBuIG9mIGUpe2lmKCFJZShuLHQpKXJldHVybiExfXJldHVybiEwfSh0LG4pO2Nhc2UiJG9yIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtpZighQXJyYXkuaXNBcnJheShlKSlyZXR1cm4gbnVsbDtmb3IoY29uc3QgbiBvZiBlKXtpZihJZShuLHQpKXJldHVybiEwfXJldHVybiExfSh0LG4pO2Nhc2UiJG5vdCI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7Y29uc3Qgbj1JZShBcnJheS5pc0FycmF5KGUpP2VbMF06ZSx0KTtyZXR1cm4hbn0odCxuKTtjYXNlIiRjb25kIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtsZXQgbixyLGk7aWYoQXJyYXkuaXNBcnJheShlKSl7aWYoMyE9PWUubGVuZ3RoKXJldHVybiBudWxsO1tuLHIsaV09ZX1lbHNle2lmKCJvYmplY3QiIT10eXBlb2YgZSlyZXR1cm4gbnVsbDtuPWUuaWYscj1lLnRoZW4saT1lLmVsc2V9Y29uc3Qgcz1JZShuLHQpO3JldHVybiBJZShzP3I6aSx0KX0odCxuKTtjYXNlIiRpZk51bGwiOnJldHVybiBmdW5jdGlvbihlLHQpe2lmKCFBcnJheS5pc0FycmF5KGUpfHxlLmxlbmd0aDwyKXJldHVybiBudWxsO2ZvcihsZXQgbj0wO248ZS5sZW5ndGg7bisrKXtjb25zdCByPUllKGVbbl0sdCk7aWYobnVsbCE9cilyZXR1cm4gcn1yZXR1cm4gbnVsbH0odCxuKTtjYXNlIiRzd2l0Y2giOnJldHVybiBmdW5jdGlvbihlLHQpe2lmKCJvYmplY3QiIT10eXBlb2YgZXx8IUFycmF5LmlzQXJyYXkoZS5icmFuY2hlcykpcmV0dXJuIG51bGw7Zm9yKGNvbnN0IG4gb2YgZS5icmFuY2hlcyl7aWYoSWUobi5jYXNlLHQpKXJldHVybiBJZShuLnRoZW4sdCl9cmV0dXJuIHZvaWQgMCE9PWUuZGVmYXVsdD9JZShlLmRlZmF1bHQsdCk6bnVsbH0odCxuKTtjYXNlIiR5ZWFyIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPUllKGUsdCk7aWYobiBpbnN0YW5jZW9mIERhdGUpcmV0dXJuIG4uZ2V0VVRDRnVsbFllYXIoKTtyZXR1cm4gbnVsbH0odCxuKTtjYXNlIiRtb250aCI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7Y29uc3Qgbj1JZShlLHQpO2lmKG4gaW5zdGFuY2VvZiBEYXRlKXJldHVybiBuLmdldFVUQ01vbnRoKCkrMTtyZXR1cm4gbnVsbH0odCxuKTtjYXNlIiRkYXlPZk1vbnRoIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPUllKGUsdCk7aWYobiBpbnN0YW5jZW9mIERhdGUpcmV0dXJuIG4uZ2V0VVRDRGF0ZSgpO3JldHVybiBudWxsfSh0LG4pO2Nhc2UiJGRheU9mV2VlayI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7Y29uc3Qgbj1JZShlLHQpO2lmKG4gaW5zdGFuY2VvZiBEYXRlKXJldHVybiBuLmdldFVUQ0RheSgpKzE7cmV0dXJuIG51bGx9KHQsbik7Y2FzZSIkZGF5T2ZZZWFyIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPUllKGUsdCk7aWYobiBpbnN0YW5jZW9mIERhdGUpe2NvbnN0IGU9bmV3IERhdGUoRGF0ZS5VVEMobi5nZXRVVENGdWxsWWVhcigpLDAsMCkpLHQ9bi1lLHI9ODY0ZTU7cmV0dXJuIE1hdGguZmxvb3IodC9yKX1yZXR1cm4gbnVsbH0odCxuKTtjYXNlIiRob3VyIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPUllKGUsdCk7aWYobiBpbnN0YW5jZW9mIERhdGUpcmV0dXJuIG4uZ2V0VVRDSG91cnMoKTtyZXR1cm4gbnVsbH0odCxuKTtjYXNlIiRtaW51dGUiOnJldHVybiBmdW5jdGlvbihlLHQpe2NvbnN0IG49SWUoZSx0KTtpZihuIGluc3RhbmNlb2YgRGF0ZSlyZXR1cm4gbi5nZXRVVENNaW51dGVzKCk7cmV0dXJuIG51bGx9KHQsbik7Y2FzZSIkc2Vjb25kIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPUllKGUsdCk7aWYobiBpbnN0YW5jZW9mIERhdGUpcmV0dXJuIG4uZ2V0VVRDU2Vjb25kcygpO3JldHVybiBudWxsfSh0LG4pO2Nhc2UiJG1pbGxpc2Vjb25kIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPUllKGUsdCk7aWYobiBpbnN0YW5jZW9mIERhdGUpcmV0dXJuIG4uZ2V0VVRDTWlsbGlzZWNvbmRzKCk7cmV0dXJuIG51bGx9KHQsbik7Y2FzZSIkd2VlayI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7Y29uc3Qgbj1JZShlLHQpO2lmKG4gaW5zdGFuY2VvZiBEYXRlKXtjb25zdCBlPW5ldyBEYXRlKERhdGUuVVRDKG4uZ2V0VVRDRnVsbFllYXIoKSwwLDEpKTtyZXR1cm4gTWF0aC5jZWlsKCgobi1lKS84NjRlNStlLmdldFVUQ0RheSgpKzEpLzcpLTF9cmV0dXJuIG51bGx9KHQsbik7Y2FzZSIkaXNvV2VlayI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7Y29uc3Qgbj1JZShlLHQpO2lmKG4gaW5zdGFuY2VvZiBEYXRlKXtjb25zdCBlPW5ldyBEYXRlKG4udmFsdWVPZigpKSx0PShuLmdldFVUQ0RheSgpKzYpJTc7ZS5zZXRVVENEYXRlKGUuZ2V0VVRDRGF0ZSgpLXQrMyk7Y29uc3Qgcj1lLnZhbHVlT2YoKTtyZXR1cm4gZS5zZXRVVENNb250aCgwLDEpLDQhPT1lLmdldFVUQ0RheSgpJiZlLnNldFVUQ01vbnRoKDAsMSsoNC1lLmdldFVUQ0RheSgpKzcpJTcpLDErTWF0aC5jZWlsKChyLWUpLzYwNDhlNSl9cmV0dXJuIG51bGx9KHQsbik7Y2FzZSIkaXNvV2Vla1llYXIiOnJldHVybiBmdW5jdGlvbihlLHQpe2NvbnN0IG49SWUoZSx0KTtpZihuIGluc3RhbmNlb2YgRGF0ZSl7Y29uc3QgZT1uZXcgRGF0ZShuLnZhbHVlT2YoKSk7cmV0dXJuIGUuc2V0VVRDRGF0ZShlLmdldFVUQ0RhdGUoKS0obi5nZXRVVENEYXkoKSs2KSU3KzMpLGUuZ2V0VVRDRnVsbFllYXIoKX1yZXR1cm4gbnVsbH0odCxuKTtjYXNlIiRkYXRlVG9TdHJpbmciOnJldHVybiBmdW5jdGlvbihlLHQpe2NvbnN0IG49ZS5mb3JtYXQ/SWUoZS5mb3JtYXQsdCk6IiVZLSVtLSVkVCVIOiVNOiVTLiVMWiIscj1JZShlLmRhdGUsdCk7cmV0dXJuIHIgaW5zdGFuY2VvZiBEYXRlP24ucmVwbGFjZSgiJVkiLHIuZ2V0VVRDRnVsbFllYXIoKSkucmVwbGFjZSgiJW0iLFN0cmluZyhyLmdldFVUQ01vbnRoKCkrMSkucGFkU3RhcnQoMiwiMCIpKS5yZXBsYWNlKCIlZCIsU3RyaW5nKHIuZ2V0VVRDRGF0ZSgpKS5wYWRTdGFydCgyLCIwIikpLnJlcGxhY2UoIiVIIixTdHJpbmcoci5nZXRVVENIb3VycygpKS5wYWRTdGFydCgyLCIwIikpLnJlcGxhY2UoIiVNIixTdHJpbmcoci5nZXRVVENNaW51dGVzKCkpLnBhZFN0YXJ0KDIsIjAiKSkucmVwbGFjZSgiJVMiLFN0cmluZyhyLmdldFVUQ1NlY29uZHMoKSkucGFkU3RhcnQoMiwiMCIpKS5yZXBsYWNlKCIlTCIsU3RyaW5nKHIuZ2V0VVRDTWlsbGlzZWNvbmRzKCkpLnBhZFN0YXJ0KDMsIjAiKSk6bnVsbH0odCxuKTtjYXNlIiR0b0RhdGUiOnJldHVybiBmdW5jdGlvbihlLHQpe2NvbnN0IG49SWUoZSx0KTtpZihuIGluc3RhbmNlb2YgRGF0ZSlyZXR1cm4gbjtpZigic3RyaW5nIj09dHlwZW9mIG58fCJudW1iZXIiPT10eXBlb2Ygbil7Y29uc3QgZT1uZXcgRGF0ZShuKTtyZXR1cm4gaXNOYU4oZS5nZXRUaW1lKCkpP251bGw6ZX1yZXR1cm4gbnVsbH0odCxuKTtjYXNlIiRhcnJheUVsZW1BdCI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7aWYoIUFycmF5LmlzQXJyYXkoZSl8fDIhPT1lLmxlbmd0aClyZXR1cm4gbnVsbDtjb25zdCBuPUllKGVbMF0sdCkscj1JZShlWzFdLHQpO2lmKCFBcnJheS5pc0FycmF5KG4pfHwibnVtYmVyIiE9dHlwZW9mIHIpcmV0dXJuIG51bGw7Y29uc3QgaT1yPDA/bi5sZW5ndGgrcjpyO3JldHVybiBuW2ldfSh0LG4pO2Nhc2UiJGNvbmNhdEFycmF5cyI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7aWYoIUFycmF5LmlzQXJyYXkoZSkpcmV0dXJuIG51bGw7Y29uc3Qgbj1bXTtmb3IoY29uc3QgciBvZiBlKXtjb25zdCBlPUllKHIsdCk7QXJyYXkuaXNBcnJheShlKSYmbi5wdXNoKC4uLmUpfXJldHVybiBufSh0LG4pO2Nhc2UiJGZpbHRlciI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7Y29uc3Qgbj1JZShlLmlucHV0LHQpLHI9ZS5hc3x8InRoaXMiLGk9ZS5jb25kO3JldHVybiBBcnJheS5pc0FycmF5KG4pP24uZmlsdGVyKGU9Pntjb25zdCBuPXsuLi50LFtyXTplfTtyZXR1cm4gSWUoaSxuKX0pOm51bGx9KHQsbik7Y2FzZSIkaW4iOnJldHVybiBmdW5jdGlvbihlLHQpe2lmKCFBcnJheS5pc0FycmF5KGUpfHwyIT09ZS5sZW5ndGgpcmV0dXJuIG51bGw7Y29uc3Qgbj1JZShlWzBdLHQpLHI9SWUoZVsxXSx0KTtyZXR1cm4hIUFycmF5LmlzQXJyYXkocikmJnIuaW5jbHVkZXMobil9KHQsbik7Y2FzZSIkaW5kZXhPZkFycmF5IjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtpZighQXJyYXkuaXNBcnJheShlKXx8ZS5sZW5ndGg8MilyZXR1cm4gbnVsbDtjb25zdCBuPUllKGVbMF0sdCkscj1JZShlWzFdLHQpLGk9dm9pZCAwIT09ZVsyXT9JZShlWzJdLHQpOjAscz12b2lkIDAhPT1lWzNdP0llKGVbM10sdCk6bi5sZW5ndGg7aWYoIUFycmF5LmlzQXJyYXkobikpcmV0dXJuIG51bGw7Zm9yKGxldCBvPWk7bzxzJiZvPG4ubGVuZ3RoO28rKylpZihuW29dPT09cilyZXR1cm4gbztyZXR1cm4tMX0odCxuKTtjYXNlIiRpc0FycmF5IjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPUllKGUsdCk7cmV0dXJuIEFycmF5LmlzQXJyYXkobil9KHQsbik7Y2FzZSIkbWFwIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPUllKGUuaW5wdXQsdCkscj1lLmFzfHwidGhpcyIsaT1lLmluO3JldHVybiBBcnJheS5pc0FycmF5KG4pP24ubWFwKGU9Pntjb25zdCBuPXsuLi50LFtyXTplfTtyZXR1cm4gSWUoaSxuKX0pOm51bGx9KHQsbik7Y2FzZSIkcmVkdWNlIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPUllKGUuaW5wdXQsdCkscj1JZShlLmluaXRpYWxWYWx1ZSx0KSxpPWUuaW47aWYoIUFycmF5LmlzQXJyYXkobikpcmV0dXJuIG51bGw7bGV0IHM9cjtmb3IoY29uc3QgbyBvZiBuKXtzPUllKGksey4uLnQsdmFsdWU6cyx0aGlzOm99KX1yZXR1cm4gc30odCxuKTtjYXNlIiRzaXplIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPUllKGUsdCk7cmV0dXJuIEFycmF5LmlzQXJyYXkobik/bi5sZW5ndGg6bnVsbH0odCxuKTtjYXNlIiRzbGljZSI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7aWYoIUFycmF5LmlzQXJyYXkoZSl8fGUubGVuZ3RoPDIpcmV0dXJuIG51bGw7Y29uc3Qgbj1JZShlWzBdLHQpO2lmKCFBcnJheS5pc0FycmF5KG4pKXJldHVybiBudWxsO2lmKDI9PT1lLmxlbmd0aCl7Y29uc3Qgcj1JZShlWzFdLHQpO3JldHVybiByPj0wP24uc2xpY2UoMCxyKTpuLnNsaWNlKHIpfXtjb25zdCByPUllKGVbMV0sdCksaT1JZShlWzJdLHQpO3JldHVybiBuLnNsaWNlKHIscitpKX19KHQsbik7Y2FzZSIkcmV2ZXJzZUFycmF5IjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPUllKGUsdCk7cmV0dXJuIEFycmF5LmlzQXJyYXkobik/bi5zbGljZSgpLnJldmVyc2UoKTpudWxsfSh0LG4pO2Nhc2UiJHppcCI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7Y29uc3Qgbj1lLmlucHV0cz9JZShlLmlucHV0cyx0KTpudWxsLHI9ZS51c2VMb25nZXN0TGVuZ3RofHwhMSxpPWUuZGVmYXVsdHM7aWYoIUFycmF5LmlzQXJyYXkobikpcmV0dXJuIG51bGw7Y29uc3Qgcz1uLm1hcChlPT5JZShlLHQpKTtpZighcy5ldmVyeShlPT5BcnJheS5pc0FycmF5KGUpKSlyZXR1cm4gbnVsbDtjb25zdCBvPU1hdGgubWF4KC4uLnMubWFwKGU9PmUubGVuZ3RoKSksYT1yP286TWF0aC5taW4oLi4ucy5tYXAoZT0+ZS5sZW5ndGgpKSxjPVtdO2ZvcihsZXQgbD0wO2w8YTtsKyspe2NvbnN0IGU9W107Zm9yKGxldCB0PTA7dDxzLmxlbmd0aDt0KyspbDxzW3RdLmxlbmd0aD9lLnB1c2goc1t0XVtsXSk6aSYmdDxpLmxlbmd0aD9lLnB1c2goaVt0XSk6ZS5wdXNoKG51bGwpO2MucHVzaChlKX1yZXR1cm4gY30odCxuKTtjYXNlIiR0eXBlIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPUllKGUsdCk7cmV0dXJuIG51bGw9PT1uPyJudWxsIjp2b2lkIDA9PT1uPyJtaXNzaW5nIjoiYm9vbGVhbiI9PXR5cGVvZiBuPyJib29sIjoibnVtYmVyIj09dHlwZW9mIG4/TnVtYmVyLmlzSW50ZWdlcihuKT8iaW50IjoiZG91YmxlIjoic3RyaW5nIj09dHlwZW9mIG4/InN0cmluZyI6biBpbnN0YW5jZW9mIERhdGU/ImRhdGUiOkFycmF5LmlzQXJyYXkobik/ImFycmF5Ijoib2JqZWN0Ij09dHlwZW9mIG4/Im9iamVjdCI6InVua25vd24ifSh0LG4pO2Nhc2UiJGNvbnZlcnQiOnJldHVybiBmdW5jdGlvbihlLHQpe2NvbnN0IG49SWUoZS5pbnB1dCx0KSxyPWUudG8saT1lLm9uRXJyb3Iscz1lLm9uTnVsbDtpZihudWxsPT09bilyZXR1cm4gdm9pZCAwIT09cz9JZShzLHQpOm51bGw7dHJ5e3N3aXRjaChyKXtjYXNlImRvdWJsZSI6Y2FzZSJkZWNpbWFsIjpyZXR1cm4gcGFyc2VGbG9hdChuKTtjYXNlImludCI6Y2FzZSJsb25nIjpyZXR1cm4gcGFyc2VJbnQobik7Y2FzZSJib29sIjpyZXR1cm4gQm9vbGVhbihuKTtjYXNlInN0cmluZyI6cmV0dXJuIFN0cmluZyhuKTtjYXNlImRhdGUiOnJldHVybiBuZXcgRGF0ZShuKTtkZWZhdWx0OnJldHVybiBufX1jYXRjaChvKXtyZXR1cm4gdm9pZCAwIT09aT9JZShpLHQpOm51bGx9fSh0LG4pO2Nhc2UiJHRvQm9vbCI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7Y29uc3Qgbj1JZShlLHQpO3JldHVybiBCb29sZWFuKG4pfSh0LG4pO2Nhc2UiJHRvRGVjaW1hbCI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7Y29uc3Qgbj1JZShlLHQpO3JldHVybiBwYXJzZUZsb2F0KG4pfSh0LG4pO2Nhc2UiJHRvRG91YmxlIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPUllKGUsdCk7cmV0dXJuIHBhcnNlRmxvYXQobil9KHQsbik7Y2FzZSIkdG9JbnQiOnJldHVybiBmdW5jdGlvbihlLHQpe2NvbnN0IG49SWUoZSx0KTtyZXR1cm4gcGFyc2VJbnQobil9KHQsbik7Y2FzZSIkdG9Mb25nIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPUllKGUsdCk7cmV0dXJuIHBhcnNlSW50KG4pfSh0LG4pO2Nhc2UiJHRvU3RyaW5nIjpyZXR1cm4gZnVuY3Rpb24oZSx0KXtjb25zdCBuPUllKGUsdCk7cmV0dXJuIG51bGw9PW4/bnVsbDpTdHJpbmcobil9KHQsbik7Y2FzZSIkb2JqZWN0VG9BcnJheSI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7Y29uc3Qgbj1JZShlLHQpO2lmKCJvYmplY3QiIT10eXBlb2Ygbnx8bnVsbD09PW58fEFycmF5LmlzQXJyYXkobikpcmV0dXJuIG51bGw7cmV0dXJuIE9iamVjdC5rZXlzKG4pLm1hcChlPT4oe2s6ZSx2Om5bZV19KSl9KHQsbik7Y2FzZSIkYXJyYXlUb09iamVjdCI6cmV0dXJuIGZ1bmN0aW9uKGUsdCl7Y29uc3Qgbj1JZShlLHQpO2lmKCFBcnJheS5pc0FycmF5KG4pKXJldHVybiBudWxsO2NvbnN0IHI9e307Zm9yKGNvbnN0IGkgb2YgbilBcnJheS5pc0FycmF5KGkpJiYyPT09aS5sZW5ndGg/cltpWzBdXT1pWzFdOiJvYmplY3QiPT10eXBlb2YgaSYmdm9pZCAwIT09aS5rJiZ2b2lkIDAhPT1pLnYmJihyW2kua109aS52KTtyZXR1cm4gcn0odCxuKTtjYXNlIiRtZXJnZU9iamVjdHMiOnJldHVybiBmdW5jdGlvbihlLHQpe2lmKCFBcnJheS5pc0FycmF5KGUpKXJldHVybiBJZShlLHQpO2NvbnN0IG49e307Zm9yKGNvbnN0IHIgb2YgZSl7Y29uc3QgZT1JZShyLHQpOyJvYmplY3QiIT10eXBlb2YgZXx8bnVsbD09PWV8fEFycmF5LmlzQXJyYXkoZSl8fE9iamVjdC5hc3NpZ24obixlKX1yZXR1cm4gbn0odCxuKTtjYXNlIiRsaXRlcmFsIjpyZXR1cm4gdDtkZWZhdWx0OnRocm93IG5ldyBFcnJvcihgVW5zdXBwb3J0ZWQgYWdncmVnYXRpb24gb3BlcmF0b3I6ICR7ZX1gKX19KHIsZVtyXSx0KX17Y29uc3Qgcj17fTtmb3IoY29uc3QgaSBvZiBuKXJbaV09SWUoZVtpXSx0KTtyZXR1cm4gcn19cmV0dXJuIGV9ZnVuY3Rpb24gTmUoZSl7cmV0dXJuIGUucmVwbGFjZSgvWy4qKz9eJHt9KCl8W1xdXFxdL2csIlxcJCYiKX1jb25zdCBTZT17MToiZG91YmxlIiwyOiJzdHJpbmciLDM6Im9iamVjdCIsNDoiYXJyYXkiLDU6ImJpbkRhdGEiLDY6InVuZGVmaW5lZCIsNzoib2JqZWN0SWQiLDg6ImJvb2wiLDk6ImRhdGUiLDEwOiJudWxsIiwxMToicmVnZXgiLDEzOiJqYXZhc2NyaXB0IiwxNToiamF2YXNjcmlwdFdpdGhTY29wZSIsMTY6ImludCIsMTc6InRpbWVzdGFtcCIsMTg6ImxvbmciLDE5OiJkZWNpbWFsIiwxMjc6Im1heEtleSIsIi0xIjoibWluS2V5In0sT2U9T2JqZWN0LmVudHJpZXMoU2UpLnJlZHVjZSgoZSxbdCxuXSk9PihlW25dPXBhcnNlSW50KHQpLGUpLHt9KTtmdW5jdGlvbiBBZShlLHQpe2lmKE4odCkpe2ZvcihsZXQgbj0wO248dC5sZW5ndGg7bisrKWlmKEFlKGUsdFtuXSkpcmV0dXJuITA7cmV0dXJuITF9Y29uc3Qgbj0ibnVtYmVyIj09dHlwZW9mIHQ/dDpPZVt0XSxyPVNlW25dfHx0O3JldHVybiBudWxsPT09ZT8ibnVsbCI9PT1yfHwxMD09PW46dm9pZCAwPT09ZT8idW5kZWZpbmVkIj09PXJ8fDY9PT1uOiJudW1iZXIiPT10eXBlb2YgZT9OdW1iZXIuaXNJbnRlZ2VyKGUpPyJpbnQiPT09cnx8MTY9PT1uOiJkb3VibGUiPT09cnx8MT09PW46InN0cmluZyI9PXR5cGVvZiBlPyJzdHJpbmciPT09cnx8Mj09PW46ImJvb2xlYW4iPT10eXBlb2YgZT8iYm9vbCI9PT1yfHw4PT09bjplIGluc3RhbmNlb2YgRGF0ZT8iZGF0ZSI9PT1yfHw5PT09bjplIGluc3RhbmNlb2YgZz8ib2JqZWN0SWQiPT09cnx8Nz09PW46ZSBpbnN0YW5jZW9mIFJlZ0V4cD8icmVnZXgiPT09cnx8MTE9PT1uOk4oZSk/ImFycmF5Ij09PXJ8fDQ9PT1uOiJvYmplY3QiPT10eXBlb2YgZT8ib2JqZWN0Ij09PXJ8fDM9PT1uOnR5cGVvZiBlPT09dH1mdW5jdGlvbiBDZShlKXtpZihOKGUpKXtsZXQgdD0wO2ZvcihsZXQgbj0wO248ZS5sZW5ndGg7bisrKXR8PTE8PGVbbl07cmV0dXJuIHR9cmV0dXJuIm51bWJlciI9PXR5cGVvZiBlP2U6MH1mdW5jdGlvbiBFZShlLHQpe2lmKCJudW1iZXIiIT10eXBlb2YgZSlyZXR1cm4hMTtjb25zdCBuPUNlKHQpO3JldHVybihlJm4pPT09bn1mdW5jdGlvbiBqZShlLHQpe2lmKCJudW1iZXIiIT10eXBlb2YgZSlyZXR1cm4hMTtyZXR1cm4gMD09PShlJkNlKHQpKX1mdW5jdGlvbiBEZShlLHQpe2lmKCJudW1iZXIiIT10eXBlb2YgZSlyZXR1cm4hMTtyZXR1cm4gMCE9PShlJkNlKHQpKX1mdW5jdGlvbiBrZShlLHQpe2lmKCJudW1iZXIiIT10eXBlb2YgZSlyZXR1cm4hMTtjb25zdCBuPUNlKHQpO3JldHVybihlJm4pIT09bn1mdW5jdGlvbiBQZShlLHQpe2lmKHQudHlwZSl7Y29uc3Qgbj1OKGUpPyJhcnJheSI6bnVsbD09PWU/Im51bGwiOnR5cGVvZiBlO2lmKHQudHlwZSE9PW4pcmV0dXJuITF9aWYodC5yZXF1aXJlZCYmTih0LnJlcXVpcmVkKSlmb3IobGV0IG49MDtuPHQucmVxdWlyZWQubGVuZ3RoO24rKylpZighKHQucmVxdWlyZWRbbl1pbiBlKSlyZXR1cm4hMTtpZih0LnByb3BlcnRpZXMpZm9yKGNvbnN0IG4gaW4gdC5wcm9wZXJ0aWVzKXtpZighKG4gaW4gZSkpcmV0dXJuITE7Y29uc3Qgcj10LnByb3BlcnRpZXNbbl07aWYoIVBlKGVbbl0scikpcmV0dXJuITF9aWYodm9pZCAwIT09dC5taW5pbXVtJiYibnVtYmVyIj09dHlwZW9mIGUmJmU8dC5taW5pbXVtKXJldHVybiExO2lmKHZvaWQgMCE9PXQubWF4aW11bSYmIm51bWJlciI9PXR5cGVvZiBlJiZlPnQubWF4aW11bSlyZXR1cm4hMTtpZih2b2lkIDAhPT10Lm1pbkxlbmd0aCYmInN0cmluZyI9PXR5cGVvZiBlJiZlLmxlbmd0aDx0Lm1pbkxlbmd0aClyZXR1cm4hMTtpZih2b2lkIDAhPT10Lm1heExlbmd0aCYmInN0cmluZyI9PXR5cGVvZiBlJiZlLmxlbmd0aD50Lm1heExlbmd0aClyZXR1cm4hMTtpZih0LnBhdHRlcm4mJiJzdHJpbmciPT10eXBlb2YgZSl7aWYoIW5ldyBSZWdFeHAodC5wYXR0ZXJuKS50ZXN0KGUpKXJldHVybiExfXJldHVybiEodC5lbnVtJiZOKHQuZW51bSkmJiF0LmVudW0uaW5jbHVkZXMoZSkpfWZ1bmN0aW9uIE1lKGUsdCl7cmV0dXJuIGUgaW5zdGFuY2VvZiBnJiZ0IGluc3RhbmNlb2YgZz9lLmVxdWFscyh0KTplPT10fWZ1bmN0aW9uIExlKGUsdCxuKXtsZXQgcj1lLGk9dDtzd2l0Y2goZSBpbnN0YW5jZW9mIGcmJihyPWUudG9TdHJpbmcoKSksdCBpbnN0YW5jZW9mIGcmJihpPXQudG9TdHJpbmcoKSksbil7Y2FzZSI+IjpyZXR1cm4gcj5pO2Nhc2UiPj0iOnJldHVybiByPj1pO2Nhc2UiPCI6cmV0dXJuIHI8aTtjYXNlIjw9IjpyZXR1cm4gcjw9aTtkZWZhdWx0OnJldHVybiExfX1mdW5jdGlvbiBUZShlLHQpe2lmKHZvaWQgMD09PWUpcmV0dXJuITE7aWYobnVsbD09PWUpcmV0dXJuIHQoZSk7aWYoTihlKSl7Zm9yKHZhciBuPTA7bjxlLmxlbmd0aDtuKyspaWYodChlW25dKSlyZXR1cm4hMDtyZXR1cm4hMX1yZXR1cm4gdChlKX1mdW5jdGlvbiBGZShlKXtpZigic3RyaW5nIiE9dHlwZW9mIGUpcmV0dXJuW107cmV0dXJuIHZlKGUpLm1hcChlPT53ZShlKSl9ZnVuY3Rpb24gQmUoZSx0KXtpZigic3RyaW5nIiE9dHlwZW9mIGUpcmV0dXJuITE7Y29uc3Qgbj1uZXcgU2V0KEZlKGUpKTtyZXR1cm4gRmUodCkuc29tZShlPT5uLmhhcyhlKSl9ZnVuY3Rpb24gemUoZSx0KXt0cnl7aWYoIUFycmF5LmlzQXJyYXkodCl8fDIhPT10Lmxlbmd0aClyZXR1cm4hMTtjb25zdCBuPXRbMF1bMF0scj10WzBdWzFdLGk9dFsxXVswXTtyZXR1cm4gVWUoZSxuLGksdFsxXVsxXSxyKX1jYXRjaChuKXtyZXR1cm4hMX19ZnVuY3Rpb24gVWUoZSx0LG4scixpKXtpZighZSlyZXR1cm4hMTtpZigiRmVhdHVyZUNvbGxlY3Rpb24iPT09ZS50eXBlJiZlLmZlYXR1cmVzJiZlLmZlYXR1cmVzLmxlbmd0aD4wKXtmb3IoY29uc3QgcyBvZiBlLmZlYXR1cmVzKWlmKHMuZ2VvbWV0cnkmJiFVZShzLmdlb21ldHJ5LHQsbixyLGkpKXJldHVybiExO3JldHVybiEwfWlmKCJGZWF0dXJlIj09PWUudHlwZSYmZS5nZW9tZXRyeSlyZXR1cm4gVWUoZS5nZW9tZXRyeSx0LG4scixpKTtpZigiUG9pbnQiPT09ZS50eXBlJiZlLmNvb3JkaW5hdGVzKXtjb25zdFtzLG9dPWUuY29vcmRpbmF0ZXM7aWYoIm51bWJlciI9PXR5cGVvZiBzJiYibnVtYmVyIj09dHlwZW9mIG8pcmV0dXJuIHM+PXQmJnM8PW4mJm8+PXImJm88PWl9aWYoIlBvbHlnb24iPT09ZS50eXBlJiZlLmNvb3JkaW5hdGVzJiZlLmNvb3JkaW5hdGVzLmxlbmd0aD4wKXtmb3IoY29uc3QgcyBvZiBlLmNvb3JkaW5hdGVzKWZvcihjb25zdCBlIG9mIHMpe2NvbnN0IHM9ZVswXSxvPWVbMV07aWYoczx0fHxzPm58fG88cnx8bz5pKXJldHVybiExfXJldHVybiEwfXJldHVybiExfWZ1bmN0aW9uIFJlKGUpe2lmKCFlKXJldHVybiBudWxsO2lmKCJGZWF0dXJlQ29sbGVjdGlvbiI9PT1lLnR5cGUmJmUuZmVhdHVyZXMmJmUuZmVhdHVyZXMubGVuZ3RoPjApe2NvbnN0IHQ9ZS5mZWF0dXJlc1swXTtpZih0Lmdlb21ldHJ5KXJldHVybiBSZSh0Lmdlb21ldHJ5KX1pZigiRmVhdHVyZSI9PT1lLnR5cGUmJmUuZ2VvbWV0cnkpcmV0dXJuIFJlKGUuZ2VvbWV0cnkpO2lmKCJQb2ludCI9PT1lLnR5cGUmJmUuY29vcmRpbmF0ZXMpe2NvbnN0W3Qsbl09ZS5jb29yZGluYXRlcztpZigibnVtYmVyIj09dHlwZW9mIHQmJiJudW1iZXIiPT10eXBlb2YgbilyZXR1cm57bGF0Om4sbG5nOnR9fWlmKCJQb2x5Z29uIj09PWUudHlwZSYmZS5jb29yZGluYXRlcyYmZS5jb29yZGluYXRlcy5sZW5ndGg+MCl7Y29uc3QgdD1lLmNvb3JkaW5hdGVzWzBdO2lmKHQubGVuZ3RoPjApe2xldCBlPTAsbj0wO2Zvcihjb25zdCByIG9mIHQpbis9clswXSxlKz1yWzFdO3JldHVybntsYXQ6ZS90Lmxlbmd0aCxsbmc6bi90Lmxlbmd0aH19fXJldHVybiBudWxsfWZ1bmN0aW9uIHFlKGUsdCxuLHIpe2NvbnN0IGk9KG4tZSkqTWF0aC5QSS8xODAscz0oci10KSpNYXRoLlBJLzE4MCxvPU1hdGguc2luKGkvMikqTWF0aC5zaW4oaS8yKStNYXRoLmNvcyhlKk1hdGguUEkvMTgwKSpNYXRoLmNvcyhuKk1hdGguUEkvMTgwKSpNYXRoLnNpbihzLzIpKk1hdGguc2luKHMvMik7cmV0dXJuIDYzNzEqKDIqTWF0aC5hdGFuMihNYXRoLnNxcnQobyksTWF0aC5zcXJ0KDEtbykpKX1mdW5jdGlvbiBWZShlLHQsbixyKXtjb25zdCBpPVJlKGUpO2lmKCFpKXJldHVybiExO3JldHVybiAxZTMqcWUoaS5sYXQsaS5sbmcsbix0KTw9cn1mdW5jdGlvbiBIZShlLHQpe2lmKCFlfHwhdClyZXR1cm4hMTtjb25zdCBuPVJlKHQpO2lmKCFuKXJldHVybiExO2NvbnN0IHI9UmUoZSk7aWYoIXIpcmV0dXJuITE7aWYoIlBvbHlnb24iPT09dC50eXBlJiYiUG9pbnQiPT09ZS50eXBlKXJldHVybiBXZShyLmxuZyxyLmxhdCx0LmNvb3JkaW5hdGVzWzBdKTtpZigiUG9seWdvbiI9PT1lLnR5cGUmJiJQb2ludCI9PT10LnR5cGUpe2NvbnN0IG49dC5jb29yZGluYXRlcztyZXR1cm4gV2UoblswXSxuWzFdLGUuY29vcmRpbmF0ZXNbMF0pfWlmKCJQb2ludCI9PT1lLnR5cGUmJiJQb2ludCI9PT10LnR5cGUpe3JldHVybiBxZShyLmxhdCxyLmxuZyxuLmxhdCxuLmxuZyk8LjAwMX1yZXR1cm4hMX1mdW5jdGlvbiBXZShlLHQsbil7bGV0IHI9ITE7Zm9yKGxldCBpPTAscz1uLmxlbmd0aC0xO2k8bi5sZW5ndGg7cz1pKyspe2NvbnN0IG89bltpXVswXSxhPW5baV1bMV0sYz1uW3NdWzBdLGw9bltzXVsxXTthPnQhPWw+dCYmZTwoYy1vKSoodC1hKS8obC1hKStvJiYocj0hcil9cmV0dXJuIHJ9ZnVuY3Rpb24gUWUoZSx0KXtpZigiZnVuY3Rpb24iPT10eXBlb2YgdCl0cnl7cmV0dXJuIHQuY2FsbChlKX1jYXRjaChuKXtyZXR1cm4hMX1lbHNlIGlmKCJzdHJpbmciPT10eXBlb2YgdCl0cnl7cmV0dXJuIG5ldyBGdW5jdGlvbigicmV0dXJuICIrdCkuY2FsbChlKX1jYXRjaChuKXtyZXR1cm4hMX1yZXR1cm4hMX1mdW5jdGlvbiBKZShlLHQpe3ZhciBuPU9iamVjdC5rZXlzKHQpWzBdLHI9dFtuXTtpZigiJCIhPW4uY2hhckF0KDApKXJldHVybiBLZShlLG4scik7aWYoIiRhbmQiPT1uKXJldHVybiBHZShlLHIpO2lmKCIkb3IiPT1uKXJldHVybiBmdW5jdGlvbihlLHQpe2Zvcih2YXIgbj0wO248dC5sZW5ndGg7bisrKWlmKEplKGUsdFtuXSkpcmV0dXJuITA7cmV0dXJuITF9KGUscik7aWYoIiRub3QiPT1uKXJldHVybiBmdW5jdGlvbihlLHQpe3JldHVybiFKZShlLHQpfShlLHIpO2lmKCIkbm9yIj09bilyZXR1cm4gZnVuY3Rpb24oZSx0KXtmb3IodmFyIG49MDtuPHQubGVuZ3RoO24rKylpZihKZShlLHRbbl0pKXJldHVybiExO3JldHVybiEwfShlLHIpO2lmKCIkd2hlcmUiPT1uKXJldHVybiBRZShlLHIpO2lmKCIkY29tbWVudCI9PW4pcmV0dXJuITA7aWYoIiRqc29uU2NoZW1hIj09bilyZXR1cm4gUGUoZSxyKTtpZigiJHRleHQiPT1uKXtyZXR1cm4gZnVuY3Rpb24oZSx0KXtyZXR1cm4hKCFlfHwib2JqZWN0IiE9dHlwZW9mIGUpJiZmdW5jdGlvbiBlKG4pe2lmKCJzdHJpbmciPT10eXBlb2YgbilyZXR1cm4gQmUobix0KTtpZigib2JqZWN0IiE9dHlwZW9mIG58fG51bGw9PT1uKXJldHVybiExO2lmKE4obikpe2ZvcihsZXQgdD0wO3Q8bi5sZW5ndGg7dCsrKWlmKGUoblt0XSkpcmV0dXJuITA7cmV0dXJuITF9Zm9yKGNvbnN0IHQgaW4gbilpZihuLmhhc093blByb3BlcnR5KHQpJiZlKG5bdF0pKXJldHVybiEwO3JldHVybiExfShlKX0oZSxyLiRzZWFyY2h8fHIpfWlmKCIkZXhwciIhPW4pdGhyb3d7JGVycjoiQ2FuJ3QgY2Fub25pY2FsaXplIHF1ZXJ5OiBCYWRWYWx1ZSB1bmtub3duIHRvcCBsZXZlbCBvcGVyYXRvcjogIituLGNvZGU6MTcyODd9O3RyeXtyZXR1cm4gSWUocixlKX1jYXRjaChpKXtyZXR1cm4hMX19ZnVuY3Rpb24gS2UoZSx0LG4pe3ZhciByPSQoZSx0KTtpZigic3RyaW5nIj09dHlwZW9mIG4pcmV0dXJuIFRlKHIsZnVuY3Rpb24oZSl7cmV0dXJuIE1lKGUsbil9KTtpZigibnVtYmVyIj09dHlwZW9mIG4pcmV0dXJuIFRlKHIsZnVuY3Rpb24oZSl7cmV0dXJuIE1lKGUsbil9KTtpZigiYm9vbGVhbiI9PXR5cGVvZiBuKXJldHVybiBUZShyLGZ1bmN0aW9uKGUpe3JldHVybiBNZShlLG4pfSk7aWYobiBpbnN0YW5jZW9mIGcpcmV0dXJuIFRlKHIsZnVuY3Rpb24oZSl7cmV0dXJuIE1lKGUsbil9KTtpZigib2JqZWN0Ij09dHlwZW9mIG4pe2lmKG4gaW5zdGFuY2VvZiBSZWdFeHApcmV0dXJuIG51bGwhPXImJlRlKHIsZnVuY3Rpb24oZSl7cmV0dXJuIGUmJmUubWF0Y2gobil9KTtpZihOKG4pKXJldHVybiBudWxsIT1yJiZUZShyLGZ1bmN0aW9uKGUpe3JldHVybiBlJiZBKGUsbil9KTt2YXIgaT1PYmplY3Qua2V5cyhuKTtpZigiJCI9PWlbMF0uY2hhckF0KDApKXtmb3IodmFyIHM9MDtzPGkubGVuZ3RoO3MrKyl7dmFyIG89T2JqZWN0LmtleXMobilbc10sYT1uW29dO2lmKCIkZXEiPT1vKXtpZighVGUocixmdW5jdGlvbihlKXtyZXR1cm4gTWUoZSxhKX0pKXJldHVybiExfWVsc2UgaWYoIiRndCI9PW8pe2lmKCFUZShyLGZ1bmN0aW9uKGUpe3JldHVybiBMZShlLGEsIj4iKX0pKXJldHVybiExfWVsc2UgaWYoIiRndGUiPT1vKXtpZighVGUocixmdW5jdGlvbihlKXtyZXR1cm4gTGUoZSxhLCI+PSIpfSkpcmV0dXJuITF9ZWxzZSBpZigiJGx0Ij09byl7aWYoIVRlKHIsZnVuY3Rpb24oZSl7cmV0dXJuIExlKGUsYSwiPCIpfSkpcmV0dXJuITF9ZWxzZSBpZigiJGx0ZSI9PW8pe2lmKCFUZShyLGZ1bmN0aW9uKGUpe3JldHVybiBMZShlLGEsIjw9Iil9KSlyZXR1cm4hMX1lbHNlIGlmKCIkbmUiPT1vKXtpZighVGUocixmdW5jdGlvbihlKXtyZXR1cm4hTWUoZSxhKX0pKXJldHVybiExfWVsc2UgaWYoIiRpbiI9PW8pe2lmKCFUZShyLGZ1bmN0aW9uKGUpe3JldHVybiBPKGUsYSl9KSlyZXR1cm4hMX1lbHNlIGlmKCIkbmluIj09byl7aWYoVGUocixmdW5jdGlvbihlKXtyZXR1cm4gTyhlLGEpfSkpcmV0dXJuITF9ZWxzZSBpZigiJGV4aXN0cyI9PW8pe3ZhciBjPXYoZSx0KTtpZihhP251bGw9PWM6bnVsbCE9YylyZXR1cm4hMX1lbHNlIGlmKCIkdHlwZSI9PW8pe2lmKHZvaWQgMD09PXIpe2lmKDYhPT0oIm51bWJlciI9PXR5cGVvZiBhP2E6T2VbYV0pKXJldHVybiExfWVsc2UgaWYoIUFlKHIsYSkpcmV0dXJuITF9ZWxzZSBpZigiJG1vZCI9PW8pe2lmKDIhPWEubGVuZ3RoKXRocm93eyRlcnI6IkNhbid0IGNhbm9uaWNhbGl6ZSBxdWVyeTogQmFkVmFsdWUgbWFsZm9ybWVkIG1vZCwgbm90IGVub3VnaCBlbGVtZW50cyIsY29kZToxNzI4N307aWYoIVRlKHIsZnVuY3Rpb24oZSl7cmV0dXJuIG51bGwhPWUmJmUlYVswXT09YVsxXX0pKXJldHVybiExfWVsc2UgaWYoIiRyZWdleCI9PW8pe3ZhciBsPWEsdT1uLiRvcHRpb25zfHwiIixoPSJzdHJpbmciPT10eXBlb2YgbD9uZXcgUmVnRXhwKGwsdSk6bDtpZighVGUocixmdW5jdGlvbihlKXtyZXR1cm4gbnVsbCE9ZSYmaC50ZXN0KGUpfSkpcmV0dXJuITF9ZWxzZXtpZigiJG9wdGlvbnMiPT1vKWNvbnRpbnVlO2lmKCIkdGV4dCI9PW8pe2lmKCFUZShyLGZ1bmN0aW9uKGUpe3JldHVybiBudWxsIT1lJiZCZShlLGEpfSkpcmV0dXJuITF9ZWxzZSBpZigiJGV4cHIiPT1vKXRyeXtpZighSWUoYSxlKSlyZXR1cm4hMX1jYXRjaChTKXtyZXR1cm4hMX1lbHNlIGlmKCIkZ2VvV2l0aGluIj09byl7aWYoIVRlKHIsZnVuY3Rpb24oZSl7cmV0dXJuIG51bGwhPWUmJnplKGUsYSl9KSlyZXR1cm4hMX1lbHNlIGlmKCIkbmVhciI9PW98fCIkbmVhclNwaGVyZSI9PW8pe2xldCBlO2lmKGEuJGdlb21ldHJ5P2U9YS4kZ2VvbWV0cnkuY29vcmRpbmF0ZXM6YS5jb29yZGluYXRlcz9lPWEuY29vcmRpbmF0ZXM6QXJyYXkuaXNBcnJheShhKSYmKGU9YSksIShlJiZlLmxlbmd0aD49MikpcmV0dXJuITE7e2NvbnN0W3Qsbl09ZSxpPWEuJG1heERpc3RhbmNlfHwxZTY7aWYoIVRlKHIsZnVuY3Rpb24oZSl7cmV0dXJuIG51bGwhPWUmJlZlKGUsdCxuLGkpfSkpcmV0dXJuITF9fWVsc2UgaWYoIiRnZW9JbnRlcnNlY3RzIj09byl7Y29uc3QgZT1hLiRnZW9tZXRyeXx8YTtpZighVGUocixmdW5jdGlvbih0KXtyZXR1cm4gbnVsbCE9dCYmSGUodCxlKX0pKXJldHVybiExfWVsc2UgaWYoIiRub3QiPT1vKXtpZihLZShlLHQsYSkpcmV0dXJuITF9ZWxzZSBpZigiJGFsbCI9PW8pe2lmKG51bGw9PShkPXYoZSx0KSl8fCFOKGQpKXJldHVybiExO2Zvcih2YXIgZj0wO2Y8YS5sZW5ndGg7ZisrKWlmKCFPKGFbZl0sZCkpcmV0dXJuITF9ZWxzZSBpZigiJGVsZW1NYXRjaCI9PW8pe3ZhciBkO2lmKG51bGw9PShkPXYoZSx0KSl8fCFOKGQpKXJldHVybiExO3ZhciBwPSExO2ZvcihmPTA7ZjxkLmxlbmd0aDtmKyspe3ZhciBtPWRbZl07aWYoIm9iamVjdCIhPXR5cGVvZiBtfHxOKG0pKXtmb3IodmFyIHk9ITAsdz1PYmplY3Qua2V5cyhhKSxiPTA7Yjx3Lmxlbmd0aDtiKyspe3ZhciB4PXdbYl0sXz1hW3hdOygiJGd0ZSIhPXh8fG0+PV8pJiYoIiRndCIhPXh8fG0+XykmJigiJGx0ZSIhPXh8fG08PV8pJiYoIiRsdCIhPXh8fG08Xyk/IiRlcSI9PXgmJm0hPV98fCIkbmUiPT14JiZtPT1fP3k9ITE6IiRpbiIhPXh8fE8obSxfKT8iJG5pbiI9PXgmJk8obSxfKSYmKHk9ITEpOnk9ITE6eT0hMX1pZih5KXtwPSEwO2JyZWFrfX1lbHNlIGlmKFllKG0sYSkpe3A9ITA7YnJlYWt9fWlmKCFwKXJldHVybiExfWVsc2UgaWYoIiRzaXplIj09byl7dmFyIEk9dihlLHQpO2lmKG51bGw9PUl8fCFOKEkpKXJldHVybiExO2lmKEkubGVuZ3RoIT1hKXJldHVybiExfWVsc2UgaWYoIiRiaXRzQWxsU2V0Ij09byl7aWYoIVRlKHIsZnVuY3Rpb24oZSl7cmV0dXJuIEVlKGUsYSl9KSlyZXR1cm4hMX1lbHNlIGlmKCIkYml0c0FsbENsZWFyIj09byl7aWYoIVRlKHIsZnVuY3Rpb24oZSl7cmV0dXJuIGplKGUsYSl9KSlyZXR1cm4hMX1lbHNlIGlmKCIkYml0c0FueVNldCI9PW8pe2lmKCFUZShyLGZ1bmN0aW9uKGUpe3JldHVybiBEZShlLGEpfSkpcmV0dXJuITF9ZWxzZXtpZigiJGJpdHNBbnlDbGVhciIhPW8pdGhyb3d7JGVycjoiQ2FuJ3QgY2Fub25pY2FsaXplIHF1ZXJ5OiBCYWRWYWx1ZSB1bmtub3duIG9wZXJhdG9yOiAiK28sY29kZToxNzI4N307aWYoIVRlKHIsZnVuY3Rpb24oZSl7cmV0dXJuIGtlKGUsYSl9KSlyZXR1cm4hMX19fXJldHVybiEwfXJldHVybiB2KGUsdCkmJkModihlLHQpLG4pfX1mdW5jdGlvbiBHZShlLHQpe2Zvcih2YXIgbj0wO248dC5sZW5ndGg7bisrKWlmKCFKZShlLHRbbl0pKXJldHVybiExO3JldHVybiEwfWZ1bmN0aW9uIFllKGUsdCl7cmV0dXJuIEdlKGUsUyh0KSl9ZnVuY3Rpb24gWGUoZSx0KXtjb25zdCBuPXt9O3JldHVybnttYXRjaGVkOlplKGUsUyh0KSxuKSxhcnJheUZpbHRlcnM6bn19ZnVuY3Rpb24gWmUoZSx0LG4pe2Zvcih2YXIgcj0wO3I8dC5sZW5ndGg7cisrKWlmKCFldChlLHRbcl0sbikpcmV0dXJuITE7cmV0dXJuITB9ZnVuY3Rpb24gZXQoZSx0LG4pe3ZhciByPU9iamVjdC5rZXlzKHQpWzBdLGk9dFtyXTtpZigiJCIhPXIuY2hhckF0KDApKXJldHVybiBmdW5jdGlvbihlLHQsbixyKXtjb25zdCBpPXQuc3BsaXQoIi4iKVswXSxzPSQoZSx0KSxvPShuLHMpPT57aWYodm9pZCAwPT09bilyZXR1cm4hMTtpZihudWxsPT09bilyZXR1cm4gcyhuKTtpZihOKG4pKXtpZihOKHYoZSxpKSkpe2Zvcih2YXIgbz0wO288bi5sZW5ndGg7bysrKWlmKHMobltvXSkpcmV0dXJuIHJbdF09bywhMDtyZXR1cm4hMX19cmV0dXJuIFRlKG4scyl9O2lmKCJzdHJpbmciPT10eXBlb2YgbilyZXR1cm4gbyhzLGZ1bmN0aW9uKGUpe3JldHVybiBNZShlLG4pfSk7aWYoIm51bWJlciI9PXR5cGVvZiBuKXJldHVybiBvKHMsZnVuY3Rpb24oZSl7cmV0dXJuIE1lKGUsbil9KTtpZigiYm9vbGVhbiI9PXR5cGVvZiBuKXJldHVybiBvKHMsZnVuY3Rpb24oZSl7cmV0dXJuIE1lKGUsbil9KTtpZihuIGluc3RhbmNlb2YgZylyZXR1cm4gbyhzLGZ1bmN0aW9uKGUpe3JldHVybiBNZShlLG4pfSk7aWYoIm9iamVjdCI9PXR5cGVvZiBuKXtpZihuIGluc3RhbmNlb2YgUmVnRXhwKXJldHVybiBudWxsIT1zJiZvKHMsZnVuY3Rpb24oZSl7cmV0dXJuIGUmJmUubWF0Y2gobil9KTtpZihOKG4pKXJldHVybiBudWxsIT1zJiZvKHMsZnVuY3Rpb24oZSl7cmV0dXJuIGUmJkEoZSxuKX0pO3ZhciBhPU9iamVjdC5rZXlzKG4pO2lmKCIkIj09YVswXS5jaGFyQXQoMCkpe2Zvcih2YXIgYz0wO2M8YS5sZW5ndGg7YysrKXt2YXIgbD1hW2NdLHU9bltsXTtpZigiJGVxIj09bCl7aWYoIW8ocyxmdW5jdGlvbihlKXtyZXR1cm4gTWUoZSx1KX0pKXJldHVybiExfWVsc2UgaWYoIiRndCI9PWwpe2lmKCFvKHMsZnVuY3Rpb24oZSl7cmV0dXJuIExlKGUsdSwiPiIpfSkpcmV0dXJuITF9ZWxzZSBpZigiJGd0ZSI9PWwpe2lmKCFvKHMsZnVuY3Rpb24oZSl7cmV0dXJuIExlKGUsdSwiPj0iKX0pKXJldHVybiExfWVsc2UgaWYoIiRsdCI9PWwpe2lmKCFvKHMsZnVuY3Rpb24oZSl7cmV0dXJuIExlKGUsdSwiPCIpfSkpcmV0dXJuITF9ZWxzZSBpZigiJGx0ZSI9PWwpe2lmKCFvKHMsZnVuY3Rpb24oZSl7cmV0dXJuIExlKGUsdSwiPD0iKX0pKXJldHVybiExfWVsc2UgaWYoIiRuZSI9PWwpe2lmKCFvKHMsZnVuY3Rpb24oZSl7cmV0dXJuIU1lKGUsdSl9KSlyZXR1cm4hMX1lbHNlIGlmKCIkaW4iPT1sKXtpZighbyhzLGZ1bmN0aW9uKGUpe3JldHVybiBPKGUsdSl9KSlyZXR1cm4hMX1lbHNlIGlmKCIkbmluIj09bCl7aWYobyhzLGZ1bmN0aW9uKGUpe3JldHVybiBPKGUsdSl9KSlyZXR1cm4hMX1lbHNle2lmKCIkZWxlbU1hdGNoIj09bCl7dmFyIGg9dihlLHQpO2lmKG51bGw9PWh8fCFOKGgpKXJldHVybiExO2Zvcih2YXIgZj0wO2Y8aC5sZW5ndGg7ZisrKXt2YXIgZD1oW2ZdO2lmKCJvYmplY3QiIT10eXBlb2YgZHx8TihkKSl7Zm9yKHZhciBwPSEwLG09T2JqZWN0LmtleXModSkseT0wO3k8bS5sZW5ndGg7eSsrKXt2YXIgdz1tW3ldLGI9dVt3XTsoIiRndGUiIT13fHxkPj1iKSYmKCIkZ3QiIT13fHxkPmIpJiYoIiRsdGUiIT13fHxkPD1iKSYmKCIkbHQiIT13fHxkPGIpPygiJGVxIj09dyYmZCE9Ynx8IiRuZSI9PXcmJmQ9PWIpJiYocD0hMSk6cD0hMX1pZihwKXJldHVybiByW3RdPWYsITB9ZWxzZSBpZihZZShkLHUpKXJldHVybiByW3RdPWYsITB9cmV0dXJuITF9aWYoIUtlKGUsdCxuKSlyZXR1cm4hMX19cmV0dXJuITB9cmV0dXJuIG51bGwhPXMmJm8ocyxmdW5jdGlvbihlKXtyZXR1cm4gQyhlLG4pfSl9cmV0dXJuITF9KGUscixpLG4pO2lmKCIkYW5kIj09cilyZXR1cm4gWmUoZSxpLG4pO2lmKCIkb3IiPT1yKXJldHVybiBmdW5jdGlvbihlLHQsbil7Zm9yKHZhciByPTA7cjx0Lmxlbmd0aDtyKyspaWYoZXQoZSx0W3JdLG4pKXJldHVybiEwO3JldHVybiExfShlLGksbik7aWYoIiRub3QiPT1yKXJldHVybiFKZShlLGkpO2lmKCIkbm9yIj09cilyZXR1cm4gZnVuY3Rpb24oZSx0LG4pe2Zvcih2YXIgcj0wO3I8dC5sZW5ndGg7cisrKWlmKGV0KGUsdFtyXSxuKSlyZXR1cm4hMTtyZXR1cm4hMH0oZSxpLG4pO2lmKCIkd2hlcmUiPT1yKXJldHVybiBRZShlLGkpO2lmKCIkY29tbWVudCI9PXIpcmV0dXJuITA7aWYoIiRqc29uU2NoZW1hIj09cilyZXR1cm4gUGUoZSxpKTtpZigiJGV4cHIiIT1yKXRocm93eyRlcnI6IkNhbid0IGNhbm9uaWNhbGl6ZSBxdWVyeTogQmFkVmFsdWUgdW5rbm93biB0b3AgbGV2ZWwgb3BlcmF0b3I6ICIrcixjb2RlOjE3Mjg3fTt0cnl7cmV0dXJuIEllKGksZSl9Y2F0Y2gocyl7cmV0dXJuITF9fWZ1bmN0aW9uIHR0KGUpe3JldHVybiBlLnNwbGl0KCIuIikubWFwKGU9Pntjb25zdCB0PWZ1bmN0aW9uKGUpe2NvbnN0IHQ9ZS5tYXRjaCgvXlwkXFsoW15cXV0rKVxdJC8pO3JldHVybiB0P3RbMV06bnVsbH0oZSk7cmV0dXJue3NlZ21lbnQ6ZSxpc0ZpbHRlcmVkUG9zaXRpb25hbDpudWxsIT09dCxpZGVudGlmaWVyOnR9fSl9ZnVuY3Rpb24gbnQoZSx0LG4scixpKXshZnVuY3Rpb24gZShzLG8sYSl7aWYobz49dC5sZW5ndGgpcmV0dXJuO2NvbnN0IGM9dFtvXSxsPW89PT10Lmxlbmd0aC0xO2lmKGMuaXNGaWx0ZXJlZFBvc2l0aW9uYWwpe2NvbnN0IGE9Yy5pZGVudGlmaWVyLHU9aT9pLmZpbmQoZT0+T2JqZWN0LmtleXMoZSkuc29tZShlPT5lLnN0YXJ0c1dpdGgoYSsiLiIpfHxlPT09YSkpOm51bGw7aWYoIWkpe2lmKCFzW2Muc2VnbWVudF0pe2NvbnN0IGU9dFtvKzFdO2UmJmUuaXNGaWx0ZXJlZFBvc2l0aW9uYWw/c1tjLnNlZ21lbnRdPVtdOnNbYy5zZWdtZW50XT17fX1yZXR1cm4gdm9pZChsP3J0KHMsYy5zZWdtZW50LG4scik6ZShzW2Muc2VnbWVudF0sbysxKSl9aWYoIU4ocykpcmV0dXJuIHNbYy5zZWdtZW50XXx8KHNbYy5zZWdtZW50XT17fSksdm9pZChsP3J0KHMsYy5zZWdtZW50LG4scik6ZShzW2Muc2VnbWVudF0sbysxKSk7Zm9yKGxldCB0PTA7dDxzLmxlbmd0aDt0Kyspe2NvbnN0IGk9c1t0XTtsZXQgYz0hMDtpZih1KXtsZXQgZT17fSx0PSExO2lmKE9iamVjdC5rZXlzKHUpLmZvckVhY2gobj0+e2lmKG4uc3RhcnRzV2l0aChhKyIuIikpe2NvbnN0IHQ9bi5zdWJzdHJpbmcoYS5sZW5ndGgrMSk7ZVt0XT11W25dfWVsc2Ugbj09PWEmJihlPXVbbl0sdD0hMCl9KSx0KXtjPVllKHt2YWx1ZTppfSx7dmFsdWU6ZX0pfWVsc2UgYz1ZZShpLGUpfWMmJihsP3J0KHMsdCxuLHIpOm51bGwhPWkmJmUoc1t0XSxvKzEpKX19ZWxzZXtpZigodm9pZCAwPT09c1tjLnNlZ21lbnRdfHxudWxsPT09c1tjLnNlZ21lbnRdKSYmIWwpe2NvbnN0IGU9dFtvKzFdO2UmJmUuaXNGaWx0ZXJlZFBvc2l0aW9uYWw/c1tjLnNlZ21lbnRdPVtdOnNbYy5zZWdtZW50XT17fX1sP3J0KHMsYy5zZWdtZW50LG4scik6dm9pZCAwIT09c1tjLnNlZ21lbnRdJiZudWxsIT09c1tjLnNlZ21lbnRdJiZlKHNbYy5zZWdtZW50XSxvKzEpfX0oZSwwKX1mdW5jdGlvbiBydChlLHQsbixyKXtzd2l0Y2gocil7Y2FzZSIkc2V0IjpkZWZhdWx0OmVbdF09bjticmVhaztjYXNlIiRpbmMiOnZvaWQgMD09PWVbdF0mJihlW3RdPTApLGVbdF0rPW47YnJlYWs7Y2FzZSIkbXVsIjplW3RdPWVbdF0qbjticmVhaztjYXNlIiRtaW4iOmVbdF09TWF0aC5taW4oZVt0XSxuKTticmVhaztjYXNlIiRtYXgiOmVbdF09TWF0aC5tYXgoZVt0XSxuKTticmVhaztjYXNlIiR1bnNldCI6ZGVsZXRlIGVbdF19fWZ1bmN0aW9uIGl0KGUpe3JldHVybi9cJFxbW15cXV0rXF0vLnRlc3QoZSl9ZnVuY3Rpb24gc3QoZSl7cmV0dXJuLTEhPT1lLmluZGV4T2YoIiRbXSIpfWZ1bmN0aW9uIG90KGUsdCxuKXtmb3IodmFyIHI9dC5zcGxpdCgiLiIpLGk9ZSxzPTA7czxyLmxlbmd0aDtzKyspe3ZhciBvPXJbc107aWYoIiRbXSI9PT1vKXtpZighQXJyYXkuaXNBcnJheShpKSlyZXR1cm47Zm9yKHZhciBhPXIuc2xpY2UocysxKS5qb2luKCIuIiksYz0wO2M8aS5sZW5ndGg7YysrKWlmKGEpaWYoLTEhPT1hLmluZGV4T2YoIiRbXSIpKW90KGlbY10sYSxuKTtlbHNle3ZhciBsPW4odihpW2NdLGEpKTtJKGlbY10sYSxsKX1lbHNlIGlbY109bihpW2NdKTtyZXR1cm59aWYobnVsbD09aXx8bnVsbD09aSlyZXR1cm47aT1pW29dfX1mdW5jdGlvbiBhdChlLHQpe2lmKCF0fHwhZS5pbmNsdWRlcygiJCIpKXJldHVybiBlO2NvbnN0IG49ZS5zcGxpdCgiLiIpLHI9bi5pbmRleE9mKCIkIik7aWYoLTE9PT1yKXJldHVybiBlO2NvbnN0IGk9bi5zbGljZSgwLHIpLmpvaW4oIi4iKTtsZXQgcz1udWxsO2Zvcihjb25zdCBvIGluIHQpaWYobz09PWl8fG8uc3RhcnRzV2l0aChpKyIuIikpe3M9dFtvXTticmVha31yZXR1cm4gbnVsbCE9cz8obltyXT1zLnRvU3RyaW5nKCksbi5qb2luKCIuIikpOmV9ZnVuY3Rpb24gY3QoZSx0LG4scixpKXtmb3IodmFyIHM9T2JqZWN0LmtleXMoZSksbz0wO288cy5sZW5ndGg7bysrKXt2YXIgYT1zW29dLGM9ZVthXTtpZigiJGluYyI9PWEpZm9yKHZhciBsPU9iamVjdC5rZXlzKGMpLHU9MDt1PGwubGVuZ3RoO3UrKyl7dmFyIGg9YXQobFt1XSxyKSxmPWNbbFt1XV07aWYoaXQoaCkpe2lmKCFpKXRocm93IG5ldyBFcnJvcigiYXJyYXlGaWx0ZXJzIG9wdGlvbiBpcyByZXF1aXJlZCB3aGVuIHVzaW5nIGZpbHRlcmVkIHBvc2l0aW9uYWwgb3BlcmF0b3IgJFs8aWRlbnRpZmllcj5dIik7bnQodCx0dChoKSxmLCIkaW5jIixpKX1lbHNlIGlmKHN0KGgpKW90KHQsaCxmdW5jdGlvbihlKXtyZXR1cm4odm9pZCAwPT09ZT8wOmUpK2Z9KTtlbHNle251bGw9PShkPXYodCxoKSkmJihkPTApLEkodCxoLGQrZil9fWVsc2UgaWYoIiRtdWwiPT1hKWZvcihsPU9iamVjdC5rZXlzKGMpLHU9MDt1PGwubGVuZ3RoO3UrKyl7aD1hdChsW3VdLHIpLGY9Y1tsW3VdXTtpZihpdChoKSl7aWYoIWkpdGhyb3cgbmV3IEVycm9yKCJhcnJheUZpbHRlcnMgb3B0aW9uIGlzIHJlcXVpcmVkIHdoZW4gdXNpbmcgZmlsdGVyZWQgcG9zaXRpb25hbCBvcGVyYXRvciAkWzxpZGVudGlmaWVyPl0iKTtudCh0LHR0KGgpLGYsIiRtdWwiLGkpfWVsc2UgaWYoc3QoaCkpb3QodCxoLGZ1bmN0aW9uKGUpe3JldHVybiBlKmZ9KTtlbHNle251bGw9PShkPXYodCxoKSkmJihkPTApLEkodCxoLGQqZil9fWVsc2UgaWYoIiRyZW5hbWUiPT1hKWZvcihsPU9iamVjdC5rZXlzKGMpLHU9MDt1PGwubGVuZ3RoO3UrKyl7aD1hdChsW3VdLHIpO3RbYXQoY1tsW3VdXSxyKV09dFtoXSxkZWxldGUgdFtoXX1lbHNlIGlmKCIkc2V0T25JbnNlcnQiPT1hJiZuKWZvcihsPU9iamVjdC5rZXlzKGMpLHU9MDt1PGwubGVuZ3RoO3UrKyl7dFtoPWF0KGxbdV0scildPWNbbFt1XV19ZWxzZSBpZigiJHNldCI9PWEpZm9yKGw9T2JqZWN0LmtleXMoYyksdT0wO3U8bC5sZW5ndGg7dSsrKXtpZihpdChoPWF0KGxbdV0scikpKXtpZighaSl0aHJvdyBuZXcgRXJyb3IoImFycmF5RmlsdGVycyBvcHRpb24gaXMgcmVxdWlyZWQgd2hlbiB1c2luZyBmaWx0ZXJlZCBwb3NpdGlvbmFsIG9wZXJhdG9yICRbPGlkZW50aWZpZXI+XSIpO250KHQsdHQoaCksY1tsW3VdXSwiJHNldCIsaSl9ZWxzZSBJKHQsaCxjW2xbdV1dKX1lbHNlIGlmKCIkdW5zZXQiPT1hKWZvcihsPU9iamVjdC5rZXlzKGMpLHU9MDt1PGwubGVuZ3RoO3UrKyl7ZGVsZXRlIHRbaD1hdChsW3VdLHIpXX1lbHNlIGlmKCIkbWluIj09YSlmb3IobD1PYmplY3Qua2V5cyhjKSx1PTA7dTxsLmxlbmd0aDt1Kyspe2g9YXQobFt1XSxyKSxmPWNbbFt1XV07aWYoaXQoaCkpe2lmKCFpKXRocm93IG5ldyBFcnJvcigiYXJyYXlGaWx0ZXJzIG9wdGlvbiBpcyByZXF1aXJlZCB3aGVuIHVzaW5nIGZpbHRlcmVkIHBvc2l0aW9uYWwgb3BlcmF0b3IgJFs8aWRlbnRpZmllcj5dIik7bnQodCx0dChoKSxmLCIkbWluIixpKX1lbHNlIGlmKHN0KGgpKW90KHQsaCxmdW5jdGlvbihlKXtyZXR1cm4gTWF0aC5taW4oZSxmKX0pO2Vsc2V7dmFyIGQ9dih0LGgpO0kodCxoLE1hdGgubWluKGQsZikpfX1lbHNlIGlmKCIkbWF4Ij09YSlmb3IobD1PYmplY3Qua2V5cyhjKSx1PTA7dTxsLmxlbmd0aDt1Kyspe2g9YXQobFt1XSxyKSxmPWNbbFt1XV07aWYoaXQoaCkpe2lmKCFpKXRocm93IG5ldyBFcnJvcigiYXJyYXlGaWx0ZXJzIG9wdGlvbiBpcyByZXF1aXJlZCB3aGVuIHVzaW5nIGZpbHRlcmVkIHBvc2l0aW9uYWwgb3BlcmF0b3IgJFs8aWRlbnRpZmllcj5dIik7bnQodCx0dChoKSxmLCIkbWF4IixpKX1lbHNlIGlmKHN0KGgpKW90KHQsaCxmdW5jdGlvbihlKXtyZXR1cm4gTWF0aC5tYXgoZSxmKX0pO2Vsc2V7ZD12KHQsaCk7SSh0LGgsTWF0aC5tYXgoZCxmKSl9fWVsc2UgaWYoIiRjdXJyZW50RGF0ZSI9PWEpZm9yKGw9T2JqZWN0LmtleXMoYyksdT0wO3U8bC5sZW5ndGg7dSsrKXtoPWF0KGxbdV0scik7dmFyIHA9Y1tsW3VdXTshMD09PXB8fCJvYmplY3QiPT10eXBlb2YgcCYmcC4kdHlwZSxJKHQsaCwvKiBAX19QVVJFX18gKi9uZXcgRGF0ZSl9ZWxzZSBpZigiJGFkZFRvU2V0Ij09YSlmb3IobD1PYmplY3Qua2V5cyhjKSx1PTA7dTxsLmxlbmd0aDt1Kyspe2g9YXQobFt1XSxyKTt2YXIgZz1jW2xbdV1dOyhQPXYodCxoKSkmJkFycmF5LmlzQXJyYXkoUCkmJlAucHVzaChnKX1lbHNlIGlmKCIkcG9wIj09YSlmb3IobD1PYmplY3Qua2V5cyhjKSx1PTA7dTxsLmxlbmd0aDt1Kyspe2g9YXQobFt1XSxyKTt2YXIgbT1jW2xbdV1dOyhQPXYodCxoKSkmJkFycmF5LmlzQXJyYXkoUCkmJigxPT1tP1AucG9wKCk6LTE9PW0mJlAuc2hpZnQoKSl9ZWxzZSBpZigiJHB1bGwiPT1hKWZvcihsPU9iamVjdC5rZXlzKGMpLHU9MDt1PGwubGVuZ3RoO3UrKyl7aD1hdChsW3VdLHIpO3ZhciB5PWNbbFt1XV07aWYobnVsbCE9KCQ9dih0LGgpKSYmQXJyYXkuaXNBcnJheSgkKSl7Zm9yKHZhciB3PVtdLGI9MDtiPCQubGVuZ3RoO2IrKyl7dmFyIHg9JFtiXSxfPSExO2lmKCJvYmplY3QiIT10eXBlb2YgeXx8bnVsbD09PXl8fEFycmF5LmlzQXJyYXkoeSkpXz14PT15O2Vsc2UgaWYoIm9iamVjdCIhPXR5cGVvZiB4fHxudWxsPT09eHx8QXJyYXkuaXNBcnJheSh4KSlfPUtlKHtfX3RlbXA6eH0sIl9fdGVtcCIseSk7ZWxzZSBfPVllKHgseSk7X3x8dy5wdXNoKHgpfUkodCxoLHcpfX1lbHNlIGlmKCIkcHVsbEFsbCI9PWEpZm9yKGw9T2JqZWN0LmtleXMoYyksdT0wO3U8bC5sZW5ndGg7dSsrKXt2YXIgJD12KHQsaD1hdChsW3VdLHIpKSxOPWNbbFt1XV07Zm9yKHc9W10sYj0wO2I8JC5sZW5ndGg7YisrKXtmb3IodmFyIFM9ITEsTz0wO088Ti5sZW5ndGg7TysrKWlmKCRbYl09PU5bT10pe1M9ITA7YnJlYWt9U3x8dy5wdXNoKCRbYl0pfUkodCxoLHcpfWVsc2UgaWYoIiRwdXNoQWxsIj09YSlmb3IobD1PYmplY3Qua2V5cyhjKSx1PTA7dTxsLmxlbmd0aDt1Kyspe2g9YXQobFt1XSxyKTt2YXIgQT1jW2xbdV1dO2lmKChQPXYodCxoKSkmJkFycmF5LmlzQXJyYXkoUCkpZm9yKGI9MDtiPEEubGVuZ3RoO2IrKylQLnB1c2goQVtiXSl9ZWxzZSBpZigiJHB1c2giPT1hKWZvcihsPU9iamVjdC5rZXlzKGMpLHU9MDt1PGwubGVuZ3RoO3UrKyl7aD1hdChsW3VdLHIpO3ZhciBDPWNbbFt1XV07aWYobnVsbCE9PUMmJiJvYmplY3QiPT10eXBlb2YgQyYmKHZvaWQgMCE9PUMuJGVhY2h8fHZvaWQgMCE9PUMuJHBvc2l0aW9ufHx2b2lkIDAhPT1DLiRzbGljZXx8dm9pZCAwIT09Qy4kc29ydCkpeyhQPXYodCxoKSl8fEkodCxoLFA9W10pO3ZhciBFPXZvaWQgMCE9PUMuJGVhY2g/Qy4kZWFjaDpbQ10saj12b2lkIDAhPT1DLiRwb3NpdGlvbj9DLiRwb3NpdGlvbjpQLmxlbmd0aDtpZihqPDAmJihqPU1hdGgubWF4KDAsUC5sZW5ndGgraikpLFAuc3BsaWNlKGosMCwuLi5FKSx2b2lkIDAhPT1DLiRzb3J0KXt2YXIgRD1DLiRzb3J0OyJudW1iZXIiPT10eXBlb2YgRD9QLnNvcnQoZnVuY3Rpb24oZSx0KXtyZXR1cm4gZTx0P0Q+MD8tMToxOmU+dD9EPjA/MTotMTowfSk6Im9iamVjdCI9PXR5cGVvZiBEJiZQLnNvcnQoZnVuY3Rpb24oZSx0KXtmb3IodmFyIG49T2JqZWN0LmtleXMoRCkscj0wO3I8bi5sZW5ndGg7cisrKXt2YXIgaT1uW3JdLHM9RFtpXSxvPXYoZSxpKSxhPXYodCxpKTtpZihvPGEpcmV0dXJuIHM+MD8tMToxO2lmKG8+YSlyZXR1cm4gcz4wPzE6LTF9cmV0dXJuIDB9KX1pZih2b2lkIDAhPT1DLiRzbGljZSl7dmFyIGs9Qy4kc2xpY2U7aWYoazwwKUkodCxoLFAuc2xpY2UoaykpO2Vsc2UgaWYoMD09PWspSSh0LGgsW10pO2Vsc2V7SSh0LGgsUC5zbGljZSgwLGspKX19fWVsc2V7dmFyIFA7KFA9dih0LGgpKSYmQXJyYXkuaXNBcnJheShQKSYmUC5wdXNoKEMpfX1lbHNle2lmKCIkYml0IiE9YSl0aHJvdyJ1bmtub3duIHVwZGF0ZSBvcGVyYXRvcjogIithO2g9YXQoKGw9T2JqZWN0LmtleXMoYykpWzBdLHIpO3ZhciBNPWNbbFswXV0sTD1PYmplY3Qua2V5cyhNKVswXSxUPU1bTF07ZD12KHQsaCk7aWYoImFuZCI9PUwpSSh0LGgsZCZUKTtlbHNlIGlmKCJvciI9PUwpSSh0LGgsZHxUKTtlbHNle2lmKCJ4b3IiIT1MKXRocm93InVua25vd24gJGJpdCBvcGVyYXRvcjogIitMO0kodCxoLGReVCl9fX19ZnVuY3Rpb24gbHQoZSx0LG4pe2Zvcih2YXIgcj17X2lkOm59LGk9ITAscz1PYmplY3Qua2V5cyh0KSxvPTA7bzxzLmxlbmd0aDtvKyspaWYoIiQiPT1zW29dLmNoYXJBdCgwKSl7aT0hMTticmVha31pZihpKWZvcihvPTA7bzxzLmxlbmd0aDtvKyspcltzW29dXT10W3Nbb11dO2Vsc2V7dmFyIGE9T2JqZWN0LmtleXMoZSk7Zm9yKG89MDtvPGEubGVuZ3RoO28rKylyW2Fbb11dPWVbYVtvXV07Y3QodCxyLCEwKX1yZXR1cm4gcn1jbGFzcyB1dHtjb25zdHJ1Y3RvcihlLHQsbixyPXt9KXt0aGlzLm5hbWU9ZSx0aGlzLmtleXM9dCx0aGlzLnN0b3JhZ2U9bix0aGlzLm9wdGlvbnM9cn1hZGQoZSl7dGhyb3cgbmV3IEVycm9yKCJhZGQoKSBtdXN0IGJlIGltcGxlbWVudGVkIGJ5IHN1YmNsYXNzIil9cmVtb3ZlKGUpe3Rocm93IG5ldyBFcnJvcigicmVtb3ZlKCkgbXVzdCBiZSBpbXBsZW1lbnRlZCBieSBzdWJjbGFzcyIpfXVwZGF0ZShlLHQpe3RoaXMucmVtb3ZlKGUpLHRoaXMuYWRkKHQpfXF1ZXJ5KGUpe3Rocm93IG5ldyBFcnJvcigicXVlcnkoKSBtdXN0IGJlIGltcGxlbWVudGVkIGJ5IHN1YmNsYXNzIil9Y2xlYXIoKXt0aHJvdyBuZXcgRXJyb3IoImNsZWFyKCkgbXVzdCBiZSBpbXBsZW1lbnRlZCBieSBzdWJjbGFzcyIpfWdldFNwZWMoKXtyZXR1cm57bmFtZTp0aGlzLm5hbWUsa2V5OnRoaXMua2V5c319fWNvbnN0IGh0PSIudmVyc2lvbi5qc29uIixmdD0xNjM4NDtmdW5jdGlvbiBkdChlLHQpe2NvbnN0IG49TnVtYmVyKHQpO2lmKCFOdW1iZXIuaXNGaW5pdGUobikpdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIHZlcnNpb24gdmFsdWU6ICR7dH1gKTtpZihuPDApdGhyb3cgbmV3IEVycm9yKGBWZXJzaW9uIG11c3QgYmUgbm9uLW5lZ2F0aXZlOiAke259YCk7cmV0dXJuIDA9PT1uP2U6YCR7ZX0udiR7bn1gfWZ1bmN0aW9uIHB0KGUpe2NvbnN0IHQ9e2N1cnJlbnRWZXJzaW9uOjAscmVmQ291bnRzOnt9fTtpZighZXx8Im9iamVjdCIhPXR5cGVvZiBlKXJldHVybiB0O2NvbnN0IG49TnVtYmVyKGUuY3VycmVudFZlcnNpb24pO2lmKHQuY3VycmVudFZlcnNpb249TnVtYmVyLmlzRmluaXRlKG4pP246MCxlLnJlZkNvdW50cyYmIm9iamVjdCI9PXR5cGVvZiBlLnJlZkNvdW50cylmb3IoY29uc3RbcixpXW9mIE9iamVjdC5lbnRyaWVzKGUucmVmQ291bnRzKSl7Y29uc3QgZT1OdW1iZXIoaSk7TnVtYmVyLmlzRmluaXRlKGUpJiZlPjA/dC5yZWZDb3VudHNbU3RyaW5nKHIpXT1lOighTnVtYmVyLmlzRmluaXRlKGUpfHxlPDApJiZjb25zb2xlLndhcm4oYElnbm9yaW5nIGludmFsaWQgcmVmIGNvdW50IGZvciB2ZXJzaW9uICR7cn06ICR7aX1gKX1yZXR1cm4gdH1mdW5jdGlvbiBndChlKXtjb25zdCB0PWUuc3BsaXQoIi8iKS5maWx0ZXIoQm9vbGVhbiksbj10LnBvcCgpO2lmKCFuKXRocm93IG5ldyBFcnJvcihgSW52YWxpZCBzdG9yYWdlIHBhdGg6ICR7ZX1gKTtyZXR1cm57cGFydHM6dCxmaWxlbmFtZTpufX1hc3luYyBmdW5jdGlvbiBtdChlLHQpe2xldCBuPWF3YWl0IGdsb2JhbFRoaXMubmF2aWdhdG9yLnN0b3JhZ2UuZ2V0RGlyZWN0b3J5KCk7Zm9yKGNvbnN0IHIgb2YgZSluPWF3YWl0IG4uZ2V0RGlyZWN0b3J5SGFuZGxlKHIse2NyZWF0ZTp0fSk7cmV0dXJuIG59YXN5bmMgZnVuY3Rpb24geXQoZSl7Y29uc3R7cGFydHM6dH09Z3QoZSk7MCE9PXQubGVuZ3RoJiZhd2FpdCBtdCh0LCEwKX1hc3luYyBmdW5jdGlvbiB3dChlLHtjcmVhdGU6dH09e30pe2NvbnN0e3BhcnRzOm4sZmlsZW5hbWU6cn09Z3QoZSk7cmV0dXJuKGF3YWl0IG10KG4sISF0KSkuZ2V0RmlsZUhhbmRsZShyLHtjcmVhdGU6dH0pfWFzeW5jIGZ1bmN0aW9uIGJ0KGUpe2NvbnN0IHQ9YCR7ZX0ke2h0fWA7dHJ5e2NvbnN0IGU9YXdhaXQgd3QodCx7Y3JlYXRlOiExfSksbj1hd2FpdCBlLmdldEZpbGUoKSxyPWF3YWl0IG4udGV4dCgpO3JldHVybiByJiYiIiE9PXIudHJpbSgpP3B0KEpTT04ucGFyc2UocikpOnB0KCl9Y2F0Y2gobil7aWYoIk5vdEZvdW5kRXJyb3IiPT09bj8ubmFtZXx8IkVOT0VOVCI9PT1uPy5jb2RlKXJldHVybiBwdCgpO3Rocm93IG59fWFzeW5jIGZ1bmN0aW9uIHh0KGUsdCl7Y29uc3Qgbj1gJHtlfSR7aHR9YDthd2FpdCB5dChuKTtjb25zdCByPWF3YWl0IHd0KG4se2NyZWF0ZTohMH0pLGk9YXdhaXQgci5jcmVhdGVXcml0YWJsZSgpO2F3YWl0IGkud3JpdGUoSlNPTi5zdHJpbmdpZnkodCkpLGF3YWl0IGkuY2xvc2UoKX1hc3luYyBmdW5jdGlvbiBfdChlLHQsbixyKXtpZih0PT09bi5jdXJyZW50VmVyc2lvbilyZXR1cm47Y29uc3QgaT1TdHJpbmcodCk7bi5yZWZDb3VudHNbaV18fGF3YWl0IGFzeW5jIGZ1bmN0aW9uKGUsdCxuKXtjb25zdCByPWR0KGUsdCk7Zm9yKGNvbnN0IGkgb2Ygbil7Y29uc3QgZT1pP2Ake3J9JHtpfWA6cjthd2FpdCBTdChlKX19KGUsdCxyKX1hc3luYyBmdW5jdGlvbiB2dChlKXtjb25zdCB0PWF3YWl0IGJ0KGUpLG49dC5jdXJyZW50VmVyc2lvbixyPVN0cmluZyhuKTtyZXR1cm4gdC5yZWZDb3VudHNbcl09KHQucmVmQ291bnRzW3JdfHwwKSsxLGF3YWl0IHh0KGUsdCkse3ZlcnNpb246bixwYXRoOmR0KGUsbil9fWFzeW5jIGZ1bmN0aW9uICR0KGUsdCx7c3VmZml4ZXM6bj1bIiJdfT17fSl7Y29uc3Qgcj1hd2FpdCBidChlKSxpPVN0cmluZyh0KTtyLnJlZkNvdW50c1tpXSYmKHIucmVmQ291bnRzW2ldLT0xLHIucmVmQ291bnRzW2ldPD0wJiZkZWxldGUgci5yZWZDb3VudHNbaV0pLGF3YWl0IF90KGUsdCxyLG4pLGF3YWl0IHh0KGUscil9YXN5bmMgZnVuY3Rpb24gSXQoZSx0LG4se3N1ZmZpeGVzOnI9WyIiXX09e30pe2NvbnN0IGk9YXdhaXQgYnQoZSkscz1OdW1iZXIodCk7aS5jdXJyZW50VmVyc2lvbj1OdW1iZXIuaXNGaW5pdGUocyk/czppLmN1cnJlbnRWZXJzaW9uO2NvbnN0IG89U3RyaW5nKGkuY3VycmVudFZlcnNpb24pO2kucmVmQ291bnRzW29dfHwoaS5yZWZDb3VudHNbb109MCksYXdhaXQgX3QoZSxuLGksciksYXdhaXQgeHQoZSxpKX1hc3luYyBmdW5jdGlvbiBOdChlKXtyZXR1cm4oYXdhaXQgYnQoZSkpLmN1cnJlbnRWZXJzaW9ufWFzeW5jIGZ1bmN0aW9uIFN0KGUpe3RyeXtjb25zdHtwYXJ0czp0LGZpbGVuYW1lOm59PWd0KGUpLHI9YXdhaXQgbXQodCwhMSk7YXdhaXQgci5yZW1vdmVFbnRyeShuKX1jYXRjaCh0KXtpZigiTm90Rm91bmRFcnJvciI9PT10Py5uYW1lfHwiRU5PRU5UIj09PXQ/LmNvZGUpcmV0dXJuO3Rocm93IHR9fWFzeW5jIGZ1bmN0aW9uIE90KGUse3Jlc2V0OnQ9ITF9PXt9KXt0JiZhd2FpdCBTdChlKSxhd2FpdCB5dChlKTtyZXR1cm4oYXdhaXQgd3QoZSx7Y3JlYXRlOiEwfSkpLmNyZWF0ZVN5bmNBY2Nlc3NIYW5kbGUoKX1jbGFzcyBBdCBleHRlbmRzIHV0e2NvbnN0cnVjdG9yKGUsdCxuLHI9e30pe3N1cGVyKGUsdCxuLHIpLHRoaXMuc3RvcmFnZUZpbGVQYXRoPW4sdGhpcy5zdG9yYWdlVmVyc2lvbmVkUGF0aD1udWxsLHRoaXMuc3RvcmFnZVZlcnNpb249MCx0aGlzLl9yZWxlYXNlU3RvcmFnZT1udWxsLHRoaXMuZGF0YT1udWxsLHRoaXMuc3luY0hhbmRsZT1udWxsLHRoaXMuaXNPcGVuPSExfWFzeW5jIG9wZW4oKXtpZighdGhpcy5pc09wZW4pdHJ5e2NvbnN0e3ZlcnNpb246ZSxwYXRoOnR9PWF3YWl0IHZ0KHRoaXMuc3RvcmFnZUZpbGVQYXRoKTt0aGlzLnN0b3JhZ2VWZXJzaW9uPWUsdGhpcy5zdG9yYWdlVmVyc2lvbmVkUGF0aD10LHRoaXMuX3JlbGVhc2VTdG9yYWdlPSgpPT4kdCh0aGlzLnN0b3JhZ2VGaWxlUGF0aCxlKTtjb25zdCBuPXRoaXMuc3RvcmFnZVZlcnNpb25lZFBhdGguc3BsaXQoIi8iKS5maWx0ZXIoQm9vbGVhbikscj1uLnBvcCgpO2lmKCFyKXRocm93IG5ldyBFcnJvcihgSW52YWxpZCBzdG9yYWdlIHBhdGg6ICR7dGhpcy5zdG9yYWdlVmVyc2lvbmVkUGF0aH1gKTtsZXQgaT1hd2FpdCBnbG9iYWxUaGlzLm5hdmlnYXRvci5zdG9yYWdlLmdldERpcmVjdG9yeSgpO2Zvcihjb25zdCBvIG9mIG4paT1hd2FpdCBpLmdldERpcmVjdG9yeUhhbmRsZShvLHtjcmVhdGU6ITB9KTtjb25zdCBzPWF3YWl0IGkuZ2V0RmlsZUhhbmRsZShyLHtjcmVhdGU6ITB9KTt0aGlzLnN5bmNIYW5kbGU9YXdhaXQgcy5jcmVhdGVTeW5jQWNjZXNzSGFuZGxlKCksdGhpcy5kYXRhPW5ldyB4ZSh0aGlzLnN5bmNIYW5kbGUsNTApLGF3YWl0IHRoaXMuZGF0YS5vcGVuKCksdGhpcy5pc09wZW49ITB9Y2F0Y2goZSl7aWYoIWUubWVzc2FnZXx8IShlLm1lc3NhZ2UuaW5jbHVkZXMoIlVua25vd24gdHlwZSBieXRlIil8fGUubWVzc2FnZS5pbmNsdWRlcygiRmFpbGVkIHRvIHJlYWQgbWV0YWRhdGEiKXx8ZS5tZXNzYWdlLmluY2x1ZGVzKCJJbnZhbGlkIHRyZWUgZmlsZSIpKSl0aHJvdyBlO3tpZih0aGlzLnN5bmNIYW5kbGUpe3RyeXthd2FpdCB0aGlzLnN5bmNIYW5kbGUuY2xvc2UoKX1jYXRjaCh0KXt9dGhpcy5zeW5jSGFuZGxlPW51bGx9Y29uc3QgZT10aGlzLnN0b3JhZ2VWZXJzaW9uZWRQYXRoLnNwbGl0KCIvIikuZmlsdGVyKEJvb2xlYW4pLG49ZS5wb3AoKTtpZighbil0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgc3RvcmFnZSBwYXRoOiAke3RoaXMuc3RvcmFnZVZlcnNpb25lZFBhdGh9YCk7bGV0IHI9YXdhaXQgZ2xvYmFsVGhpcy5uYXZpZ2F0b3Iuc3RvcmFnZS5nZXREaXJlY3RvcnkoKTtmb3IoY29uc3QgdCBvZiBlKXI9YXdhaXQgci5nZXREaXJlY3RvcnlIYW5kbGUodCx7Y3JlYXRlOiEwfSk7dHJ5e2F3YWl0IHIucmVtb3ZlRW50cnkobil9Y2F0Y2godCl7fWNvbnN0IGk9YXdhaXQgci5nZXRGaWxlSGFuZGxlKG4se2NyZWF0ZTohMH0pO3RoaXMuc3luY0hhbmRsZT1hd2FpdCBpLmNyZWF0ZVN5bmNBY2Nlc3NIYW5kbGUoKSx0aGlzLmRhdGE9bmV3IHhlKHRoaXMuc3luY0hhbmRsZSw1MCksYXdhaXQgdGhpcy5kYXRhLm9wZW4oKSx0aGlzLmlzT3Blbj0hMH19fWFzeW5jIGNsb3NlKCl7aWYodGhpcy5pc09wZW4pe3RyeXthd2FpdCB0aGlzLl9tYXliZUNvbXBhY3QoKSxhd2FpdCB0aGlzLmRhdGEuY2xvc2UoKX1jYXRjaChlKXtpZighZS5tZXNzYWdlfHwhZS5tZXNzYWdlLmluY2x1ZGVzKCJGaWxlIGlzIG5vdCBvcGVuIikpdGhyb3cgZX10aGlzLmlzT3Blbj0hMSx0aGlzLl9yZWxlYXNlU3RvcmFnZSYmKGF3YWl0IHRoaXMuX3JlbGVhc2VTdG9yYWdlKCksdGhpcy5fcmVsZWFzZVN0b3JhZ2U9bnVsbCl9ZWxzZSB0aGlzLl9yZWxlYXNlU3RvcmFnZSYmKGF3YWl0IHRoaXMuX3JlbGVhc2VTdG9yYWdlKCksdGhpcy5fcmVsZWFzZVN0b3JhZ2U9bnVsbCl9YXN5bmMgX21heWJlQ29tcGFjdCgpe2lmKCF0aGlzLmRhdGF8fCF0aGlzLmRhdGEuZmlsZSlyZXR1cm47Y29uc3QgZT1hd2FpdCBOdCh0aGlzLnN0b3JhZ2VGaWxlUGF0aCk7aWYoZSE9PXRoaXMuc3RvcmFnZVZlcnNpb24pcmV0dXJuO2NvbnN0IHQ9dGhpcy5kYXRhLmZpbGUuZ2V0RmlsZVNpemUoKTtpZighdHx8dDxmdClyZXR1cm47Y29uc3Qgbj1lKzEscj1kdCh0aGlzLnN0b3JhZ2VGaWxlUGF0aCxuKSxpPWF3YWl0IE90KHIse3Jlc2V0OiEwfSk7YXdhaXQgdGhpcy5kYXRhLmNvbXBhY3QoaSksYXdhaXQgSXQodGhpcy5zdG9yYWdlRmlsZVBhdGgsbixlKX1leHRyYWN0SW5kZXhLZXkoZSl7Y29uc3QgdD1PYmplY3Qua2V5cyh0aGlzLmtleXMpO2lmKDA9PT10Lmxlbmd0aClyZXR1cm4gbnVsbDtpZigxPT09dC5sZW5ndGgpe2NvbnN0IG49dihlLHRbMF0pO3JldHVybiB2b2lkIDA9PT1uP251bGw6bn1jb25zdCBuPVtdO2ZvcihsZXQgcj0wO3I8dC5sZW5ndGg7cisrKXtjb25zdCBpPXYoZSx0W3JdKTtpZih2b2lkIDA9PT1pKXJldHVybiBudWxsO24ucHVzaChpKX1yZXR1cm4gbi5qb2luKCJcMCIpfWFzeW5jIGFkZChlKXt0aGlzLmlzT3Blbnx8YXdhaXQgdGhpcy5vcGVuKCk7Y29uc3QgdD10aGlzLmV4dHJhY3RJbmRleEtleShlKTtpZihudWxsIT09dCl7Y29uc3Qgbj1lLl9pZC50b1N0cmluZygpLHI9YXdhaXQgdGhpcy5kYXRhLnNlYXJjaCh0KTtsZXQgaTtpZihBcnJheS5pc0FycmF5KHIpKXtpZihyLmluY2x1ZGVzKG4pKXJldHVybjtpPVsuLi5yLG5dfWVsc2UgaT1yP3I9PT1uP1tyXTpbcixuXTpbbl07YXdhaXQgdGhpcy5kYXRhLmFkZCh0LGkpfX1hc3luYyByZW1vdmUoZSl7dGhpcy5pc09wZW58fGF3YWl0IHRoaXMub3BlbigpO2NvbnN0IHQ9dGhpcy5leHRyYWN0SW5kZXhLZXkoZSk7aWYobnVsbCE9PXQpe2NvbnN0IG49ZS5faWQudG9TdHJpbmcoKSxyPWF3YWl0IHRoaXMuZGF0YS5zZWFyY2godCk7aWYoQXJyYXkuaXNBcnJheShyKSl7Y29uc3QgZT1yLmZpbHRlcihlPT5lIT09bik7ZS5sZW5ndGg+MD9hd2FpdCB0aGlzLmRhdGEuYWRkKHQsZSk6YXdhaXQgdGhpcy5kYXRhLmRlbGV0ZSh0KX1lbHNlIHI9PT1uJiZhd2FpdCB0aGlzLmRhdGEuZGVsZXRlKHQpfX1hc3luYyBxdWVyeShlKXtjb25zdCB0PU9iamVjdC5rZXlzKGUpLG49T2JqZWN0LmtleXModGhpcy5rZXlzKTtpZigxIT09bi5sZW5ndGgpcmV0dXJuIG51bGw7Y29uc3Qgcj1uWzBdO2lmKC0xPT09dC5pbmRleE9mKHIpKXJldHVybiBudWxsO2NvbnN0IGk9ZVtyXTtpZigib2JqZWN0IiE9dHlwZW9mIGl8fG51bGw9PT1pKXtjb25zdCBlPWk7cmV0dXJuIGF3YWl0IHRoaXMuZGF0YS5zZWFyY2goZSl8fFtdfXJldHVybiJvYmplY3QiIT10eXBlb2YgaXx8QXJyYXkuaXNBcnJheShpKT9udWxsOmF3YWl0IHRoaXMuX3F1ZXJ5V2l0aE9wZXJhdG9ycyhyLGkpfWFzeW5jIF9xdWVyeVdpdGhPcGVyYXRvcnMoZSx0KXtjb25zdCBuPU9iamVjdC5rZXlzKHQpLHI9LyogQF9fUFVSRV9fICovbmV3IFNldDtpZihuLnNvbWUoZT0+WyIkZ3QiLCIkZ3RlIiwiJGx0IiwiJGx0ZSJdLmluY2x1ZGVzKGUpKSl7Y29uc3QgZT1uLmluY2x1ZGVzKCIkZ3QiKXx8bi5pbmNsdWRlcygiJGd0ZSIpLGk9bi5pbmNsdWRlcygiJGx0Iil8fG4uaW5jbHVkZXMoIiRsdGUiKTtpZihlJiZpKXtjb25zdCBlPW4uaW5jbHVkZXMoIiRndGUiKT90LiRndGU6bi5pbmNsdWRlcygiJGd0Iik/dC4kZ3Q6LTEvMCxpPW4uaW5jbHVkZXMoIiRsdGUiKT90LiRsdGU6bi5pbmNsdWRlcygiJGx0Iik/dC4kbHQ6MS8wLHM9YXdhaXQgdGhpcy5kYXRhLnJhbmdlU2VhcmNoKGUsaSk7Zm9yKGNvbnN0IG8gb2Ygcyl7Y29uc3QgZT1vLmtleSxpPW8udmFsdWU7bGV0IHM9ITA7IW4uaW5jbHVkZXMoIiRndCIpfHxlPnQuJGd0fHwocz0hMSksIW4uaW5jbHVkZXMoIiRndGUiKXx8ZT49dC4kZ3RlfHwocz0hMSksIW4uaW5jbHVkZXMoIiRsdCIpfHxlPHQuJGx0fHwocz0hMSksIW4uaW5jbHVkZXMoIiRsdGUiKXx8ZTw9dC4kbHRlfHwocz0hMSkscyYmaSYmKEFycmF5LmlzQXJyYXkoaSk/aS5mb3JFYWNoKGU9PnIuYWRkKGUpKTpyLmFkZChpKSl9cmV0dXJuIEFycmF5LmZyb20ocil9e2NvbnN0IGU9YXdhaXQgdGhpcy5kYXRhLnRvQXJyYXkoKTtmb3IoY29uc3QgaSBvZiBlKXtjb25zdCBlPWkua2V5LHM9aS52YWx1ZTtsZXQgbz0hMDtmb3IoY29uc3QgciBvZiBuKXtjb25zdCBuPXRbcl07KCIkZ3QiIT09cnx8ZT5uKSYmKCIkZ3RlIiE9PXJ8fGU+PW4pJiYoIiRsdCIhPT1yfHxlPG4pJiYoIiRsdGUiIT09cnx8ZTw9bik/KCIkZXEiPT09ciYmZSE9PW58fCIkbmUiPT09ciYmZT09PW4pJiYobz0hMSk6bz0hMX1vJiZzJiYoQXJyYXkuaXNBcnJheShzKT9zLmZvckVhY2goZT0+ci5hZGQoZSkpOnIuYWRkKHMpKX1yZXR1cm4gQXJyYXkuZnJvbShyKX19aWYobi5pbmNsdWRlcygiJGluIikpe2NvbnN0IGU9dC4kaW47aWYoQXJyYXkuaXNBcnJheShlKSl7Zm9yKGNvbnN0IHQgb2YgZSl7Y29uc3QgZT1hd2FpdCB0aGlzLmRhdGEuc2VhcmNoKHQpO2UmJihBcnJheS5pc0FycmF5KGUpP2UuZm9yRWFjaChlPT5yLmFkZChlKSk6ci5hZGQoZSkpfXJldHVybiBBcnJheS5mcm9tKHIpfX1pZihuLmluY2x1ZGVzKCIkZXEiKSl7Y29uc3QgZT10LiRlcSxuPWF3YWl0IHRoaXMuZGF0YS5zZWFyY2goZSk7cmV0dXJuIG4/QXJyYXkuaXNBcnJheShuKT9uOltuXTpbXX1pZihuLmluY2x1ZGVzKCIkbmUiKSl7Y29uc3QgZT10LiRuZSxuPWF3YWl0IHRoaXMuZGF0YS50b0FycmF5KCk7Zm9yKGNvbnN0IHQgb2Ygbil0LmtleSE9PWUmJnQudmFsdWUmJihBcnJheS5pc0FycmF5KHQudmFsdWUpP3QudmFsdWUuZm9yRWFjaChlPT5yLmFkZChlKSk6ci5hZGQodC52YWx1ZSkpO3JldHVybiBBcnJheS5mcm9tKHIpfXJldHVybiBudWxsfWFzeW5jIGNsZWFyKCl7dGhpcy5pc09wZW4mJmF3YWl0IHRoaXMuY2xvc2UoKTtjb25zdCBlPWF3YWl0IE50KHRoaXMuc3RvcmFnZUZpbGVQYXRoKSx0PWR0KHRoaXMuc3RvcmFnZUZpbGVQYXRoLGUpLnNwbGl0KCIvIikuZmlsdGVyKEJvb2xlYW4pLG49dC5wb3AoKTtsZXQgcj1hd2FpdCBnbG9iYWxUaGlzLm5hdmlnYXRvci5zdG9yYWdlLmdldERpcmVjdG9yeSgpO2Zvcihjb25zdCBzIG9mIHQpcj1hd2FpdCByLmdldERpcmVjdG9yeUhhbmRsZShzLHtjcmVhdGU6ITB9KTt0cnl7YXdhaXQgci5yZW1vdmVFbnRyeShuKX1jYXRjaChpKXt9YXdhaXQgdGhpcy5vcGVuKCl9fWNvbnN0IEN0PVsiLXRlcm1zLmJqc29uIiwiLWRvY3VtZW50cy5ianNvbiIsIi1sZW5ndGhzLmJqc29uIl07Y2xhc3MgRXQgZXh0ZW5kcyB1dHtjb25zdHJ1Y3RvcihlLHQsbixyPXt9KXtzdXBlcihlLHQsbiksdGhpcy5zdG9yYWdlQmFzZVBhdGg9bix0aGlzLnN0b3JhZ2VWZXJzaW9uPTAsdGhpcy52ZXJzaW9uZWRCYXNlUGF0aD1udWxsLHRoaXMuX3JlbGVhc2VTdG9yYWdlPW51bGwsdGhpcy50ZXh0SW5kZXg9bnVsbCx0aGlzLnN5bmNIYW5kbGVzPVtdLHRoaXMuaXNPcGVuPSExLHRoaXMuaW5kZXhlZEZpZWxkcz1bXTtmb3IoY29uc3QgaSBpbiB0KSJ0ZXh0Ij09PXRbaV0mJnRoaXMuaW5kZXhlZEZpZWxkcy5wdXNoKGkpO2lmKDA9PT10aGlzLmluZGV4ZWRGaWVsZHMubGVuZ3RoKXRocm93IG5ldyBFcnJvcignVGV4dCBpbmRleCBtdXN0IGhhdmUgYXQgbGVhc3Qgb25lIGZpZWxkIHdpdGggdHlwZSAidGV4dCInKX1hc3luYyBvcGVuKCl7aWYoIXRoaXMuaXNPcGVuKXRyeXtjb25zdHt2ZXJzaW9uOmUscGF0aDp0fT1hd2FpdCB2dCh0aGlzLnN0b3JhZ2VCYXNlUGF0aCk7dGhpcy5zdG9yYWdlVmVyc2lvbj1lLHRoaXMudmVyc2lvbmVkQmFzZVBhdGg9dCx0aGlzLl9yZWxlYXNlU3RvcmFnZT0oKT0+JHQodGhpcy5zdG9yYWdlQmFzZVBhdGgsZSx7c3VmZml4ZXM6Q3R9KTtjb25zdCBuPWF3YWl0IHRoaXMuX2NyZWF0ZUJQbHVzVHJlZSh0aGlzLl9nZXRBY3RpdmVCYXNlUGF0aCgpKyItdGVybXMuYmpzb24iKSxyPWF3YWl0IHRoaXMuX2NyZWF0ZUJQbHVzVHJlZSh0aGlzLl9nZXRBY3RpdmVCYXNlUGF0aCgpKyItZG9jdW1lbnRzLmJqc29uIiksaT1hd2FpdCB0aGlzLl9jcmVhdGVCUGx1c1RyZWUodGhpcy5fZ2V0QWN0aXZlQmFzZVBhdGgoKSsiLWxlbmd0aHMuYmpzb24iKTt0aGlzLnRleHRJbmRleD1uZXcgJGUoe29yZGVyOjE2LHRyZWVzOntpbmRleDpuLGRvY3VtZW50VGVybXM6cixkb2N1bWVudExlbmd0aHM6aX19KSxhd2FpdCB0aGlzLnRleHRJbmRleC5vcGVuKCksdGhpcy5pc09wZW49ITB9Y2F0Y2goZSl7aWYoISgiRU5PRU5UIj09PWUuY29kZXx8ZS5tZXNzYWdlJiYoZS5tZXNzYWdlLmluY2x1ZGVzKCJGYWlsZWQgdG8gcmVhZCBtZXRhZGF0YSIpfHxlLm1lc3NhZ2UuaW5jbHVkZXMoIm1pc3NpbmcgcmVxdWlyZWQgZmllbGRzIil8fGUubWVzc2FnZS5pbmNsdWRlcygiVW5rbm93biB0eXBlIGJ5dGUiKXx8ZS5tZXNzYWdlLmluY2x1ZGVzKCJJbnZhbGlkIil8fGUubWVzc2FnZS5pbmNsdWRlcygiZmlsZSB0b28gc21hbGwiKSkpKXRocm93IGU7e2F3YWl0IHRoaXMuX2Nsb3NlU3luY0hhbmRsZXMoKSxhd2FpdCB0aGlzLl9kZWxldGVJbmRleEZpbGVzKCksYXdhaXQgdGhpcy5fZW5zdXJlRGlyZWN0b3J5Rm9yRmlsZSh0aGlzLl9nZXRBY3RpdmVCYXNlUGF0aCgpKyItdGVybXMuYmpzb24iKTtjb25zdCBlPWF3YWl0IHRoaXMuX2NyZWF0ZUJQbHVzVHJlZSh0aGlzLl9nZXRBY3RpdmVCYXNlUGF0aCgpKyItdGVybXMuYmpzb24iKSx0PWF3YWl0IHRoaXMuX2NyZWF0ZUJQbHVzVHJlZSh0aGlzLl9nZXRBY3RpdmVCYXNlUGF0aCgpKyItZG9jdW1lbnRzLmJqc29uIiksbj1hd2FpdCB0aGlzLl9jcmVhdGVCUGx1c1RyZWUodGhpcy5fZ2V0QWN0aXZlQmFzZVBhdGgoKSsiLWxlbmd0aHMuYmpzb24iKTt0aGlzLnRleHRJbmRleD1uZXcgJGUoe29yZGVyOjE2LHRyZWVzOntpbmRleDplLGRvY3VtZW50VGVybXM6dCxkb2N1bWVudExlbmd0aHM6bn19KSxhd2FpdCB0aGlzLnRleHRJbmRleC5vcGVuKCksdGhpcy5pc09wZW49ITB9fX1hc3luYyBfY3JlYXRlQlBsdXNUcmVlKGUpe2NvbnN0IHQ9ZS5zcGxpdCgiLyIpLmZpbHRlcihCb29sZWFuKSxuPXQucG9wKCk7aWYoIW4pdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIHN0b3JhZ2UgcGF0aDogJHtlfWApO2xldCByPWF3YWl0IGdsb2JhbFRoaXMubmF2aWdhdG9yLnN0b3JhZ2UuZ2V0RGlyZWN0b3J5KCk7Zm9yKGNvbnN0IG8gb2YgdClyPWF3YWl0IHIuZ2V0RGlyZWN0b3J5SGFuZGxlKG8se2NyZWF0ZTohMH0pO2NvbnN0IGk9YXdhaXQgci5nZXRGaWxlSGFuZGxlKG4se2NyZWF0ZTohMH0pLHM9YXdhaXQgaS5jcmVhdGVTeW5jQWNjZXNzSGFuZGxlKCk7cmV0dXJuIHRoaXMuc3luY0hhbmRsZXMucHVzaChzKSxuZXcgeGUocywxNil9YXN5bmMgX2Nsb3NlU3luY0hhbmRsZXMoKXtmb3IoY29uc3QgdCBvZiB0aGlzLnN5bmNIYW5kbGVzKXRyeXthd2FpdCB0LmNsb3NlKCl9Y2F0Y2goZSl7fXRoaXMuc3luY0hhbmRsZXM9W119X2dldEFjdGl2ZUJhc2VQYXRoKCl7cmV0dXJuIHRoaXMudmVyc2lvbmVkQmFzZVBhdGh8fHRoaXMuc3RvcmFnZUJhc2VQYXRofWFzeW5jIF9kZWxldGVJbmRleEZpbGVzKGU9dGhpcy5fZ2V0QWN0aXZlQmFzZVBhdGgoKSl7Zm9yKGNvbnN0IHQgb2YgQ3QpYXdhaXQgdGhpcy5fZGVsZXRlRmlsZShlK3QpfWFzeW5jIF9kZWxldGVGaWxlKGUpe2lmKGUpdHJ5e2NvbnN0IHQ9ZS5zcGxpdCgiLyIpLmZpbHRlcihCb29sZWFuKSxuPXQucG9wKCk7aWYoIW4pdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIHN0b3JhZ2UgcGF0aDogJHtlfWApO2xldCByPWF3YWl0IGdsb2JhbFRoaXMubmF2aWdhdG9yLnN0b3JhZ2UuZ2V0RGlyZWN0b3J5KCk7Zm9yKGNvbnN0IGUgb2YgdClyPWF3YWl0IHIuZ2V0RGlyZWN0b3J5SGFuZGxlKGUse2NyZWF0ZTohMX0pO2F3YWl0IHIucmVtb3ZlRW50cnkobil9Y2F0Y2godCl7fX1hc3luYyBfZW5zdXJlRGlyZWN0b3J5Rm9yRmlsZShlKXtpZighZSlyZXR1cm47Y29uc3QgdD1lLnNwbGl0KCIvIikuZmlsdGVyKEJvb2xlYW4pO2lmKHQucG9wKCksMCE9PXQubGVuZ3RoKXRyeXtsZXQgZT1hd2FpdCBnbG9iYWxUaGlzLm5hdmlnYXRvci5zdG9yYWdlLmdldERpcmVjdG9yeSgpO2Zvcihjb25zdCBuIG9mIHQpZT1hd2FpdCBlLmdldERpcmVjdG9yeUhhbmRsZShuLHtjcmVhdGU6ITB9KX1jYXRjaChuKXtpZigiRUVYSVNUIiE9PW4uY29kZSl0aHJvdyBufX1hc3luYyBjbG9zZSgpe2lmKHRoaXMuaXNPcGVuKXtpZihhd2FpdCB0aGlzLl9tYXliZUNvbXBhY3QoKSx0aGlzLnRleHRJbmRleD8uaXNPcGVuKXRyeXthd2FpdCB0aGlzLnRleHRJbmRleC5jbG9zZSgpfWNhdGNoKGUpe2lmKCFlLm1lc3NhZ2V8fCFlLm1lc3NhZ2UuaW5jbHVkZXMoIkZpbGUgaXMgbm90IG9wZW4iKSl0aHJvdyBlfXRoaXMuaXNPcGVuPSExfXRoaXMuX3JlbGVhc2VTdG9yYWdlJiYoYXdhaXQgdGhpcy5fcmVsZWFzZVN0b3JhZ2UoKSx0aGlzLl9yZWxlYXNlU3RvcmFnZT1udWxsKX1hc3luYyBfbWF5YmVDb21wYWN0KCl7aWYoIXRoaXMudGV4dEluZGV4Py5pbmRleD8uZmlsZXx8IXRoaXMudGV4dEluZGV4Py5kb2N1bWVudFRlcm1zPy5maWxlfHwhdGhpcy50ZXh0SW5kZXg/LmRvY3VtZW50TGVuZ3Rocz8uZmlsZSlyZXR1cm4hMTtjb25zdCBlPWF3YWl0IE50KHRoaXMuc3RvcmFnZUJhc2VQYXRoKTtpZihlIT09dGhpcy5zdG9yYWdlVmVyc2lvbilyZXR1cm4hMTtjb25zdCB0PXRoaXMudGV4dEluZGV4LmluZGV4LmZpbGUuZ2V0RmlsZVNpemUoKSt0aGlzLnRleHRJbmRleC5kb2N1bWVudFRlcm1zLmZpbGUuZ2V0RmlsZVNpemUoKSt0aGlzLnRleHRJbmRleC5kb2N1bWVudExlbmd0aHMuZmlsZS5nZXRGaWxlU2l6ZSgpO2lmKCF0fHx0PGZ0KXJldHVybiExO2NvbnN0IG49ZSsxLHI9ZHQodGhpcy5zdG9yYWdlQmFzZVBhdGgsbiksaT1hd2FpdCBPdChgJHtyfS10ZXJtcy5ianNvbmAse3Jlc2V0OiEwfSkscz1hd2FpdCBPdChgJHtyfS1kb2N1bWVudHMuYmpzb25gLHtyZXNldDohMH0pLG89YXdhaXQgT3QoYCR7cn0tbGVuZ3Rocy5ianNvbmAse3Jlc2V0OiEwfSksYT1uZXcgeGUoaSwxNiksYz1uZXcgeGUocywxNiksbD1uZXcgeGUobywxNik7cmV0dXJuIGF3YWl0IHRoaXMudGV4dEluZGV4LmNvbXBhY3Qoe2luZGV4OmEsZG9jdW1lbnRUZXJtczpjLGRvY3VtZW50TGVuZ3RoczpsfSksYXdhaXQgSXQodGhpcy5zdG9yYWdlQmFzZVBhdGgsbixlLHtzdWZmaXhlczpDdH0pLGF3YWl0IHRoaXMuX2Nsb3NlU3luY0hhbmRsZXMoKSwhMH1fZXh0cmFjdFRleHQoZSl7Y29uc3QgdD1bXTtmb3IoY29uc3QgbiBvZiB0aGlzLmluZGV4ZWRGaWVsZHMpe2NvbnN0IHI9dihlLG4pO251bGwhPXImJnQucHVzaChTdHJpbmcocikpfXJldHVybiB0LmpvaW4oIiAiKX1hc3luYyBhZGQoZSl7aWYoIWUuX2lkKXRocm93IG5ldyBFcnJvcigiRG9jdW1lbnQgbXVzdCBoYXZlIGFuIF9pZCBmaWVsZCIpO2NvbnN0IHQ9dGhpcy5fZXh0cmFjdFRleHQoZSk7dCYmYXdhaXQgdGhpcy50ZXh0SW5kZXguYWRkKFN0cmluZyhlLl9pZCksdCl9YXN5bmMgcmVtb3ZlKGUpe2UuX2lkJiZhd2FpdCB0aGlzLnRleHRJbmRleC5yZW1vdmUoU3RyaW5nKGUuX2lkKSl9cXVlcnkoZSl7cmV0dXJuIG51bGx9YXN5bmMgc2VhcmNoKGUsdD17fSl7cmV0dXJuIGF3YWl0IHRoaXMudGV4dEluZGV4LnF1ZXJ5KGUse3Njb3JlZDohMSwuLi50fSl9YXN5bmMgY2xlYXIoKXt0aGlzLmlzT3BlbiYmYXdhaXQgdGhpcy5jbG9zZSgpO2NvbnN0IGU9YXdhaXQgTnQodGhpcy5zdG9yYWdlQmFzZVBhdGgpLHQ9ZHQodGhpcy5zdG9yYWdlQmFzZVBhdGgsZSk7YXdhaXQgdGhpcy5fZGVsZXRlSW5kZXhGaWxlcyh0KSxhd2FpdCB0aGlzLm9wZW4oKX1nZXRTcGVjKCl7cmV0dXJue25hbWU6dGhpcy5uYW1lLGtleTp0aGlzLmtleXMsdGV4dEluZGV4VmVyc2lvbjozLHdlaWdodHM6dGhpcy5fZ2V0V2VpZ2h0cygpfX1fZ2V0V2VpZ2h0cygpe2NvbnN0IGU9e307Zm9yKGNvbnN0IHQgb2YgdGhpcy5pbmRleGVkRmllbGRzKWVbdF09MTtyZXR1cm4gZX19ZnVuY3Rpb24ganQoZSx0LG4scil7Y29uc3QgaT0obi1lKSpNYXRoLlBJLzE4MCxzPShyLXQpKk1hdGguUEkvMTgwLG89TWF0aC5zaW4oaS8yKSpNYXRoLnNpbihpLzIpK01hdGguY29zKGUqTWF0aC5QSS8xODApKk1hdGguY29zKG4qTWF0aC5QSS8xODApKk1hdGguc2luKHMvMikqTWF0aC5zaW4ocy8yKTtyZXR1cm4gNjM3MSooMipNYXRoLmF0YW4yKE1hdGguc3FydChvKSxNYXRoLnNxcnQoMS1vKSkpfWZ1bmN0aW9uIER0KGUsdCl7cmV0dXJuIShlLm1heExhdDx0Lm1pbkxhdHx8ZS5taW5MYXQ+dC5tYXhMYXR8fGUubWF4TG5nPHQubWluTG5nfHxlLm1pbkxuZz50Lm1heExuZyl9ZnVuY3Rpb24ga3QoZSl7cmV0dXJuKGUubWF4TGF0LWUubWluTGF0KSooZS5tYXhMbmctZS5taW5MbmcpfWZ1bmN0aW9uIFB0KGUsdCl7cmV0dXJue21pbkxhdDpNYXRoLm1pbihlLm1pbkxhdCx0Lm1pbkxhdCksbWF4TGF0Ok1hdGgubWF4KGUubWF4TGF0LHQubWF4TGF0KSxtaW5Mbmc6TWF0aC5taW4oZS5taW5MbmcsdC5taW5MbmcpLG1heExuZzpNYXRoLm1heChlLm1heExuZyx0Lm1heExuZyl9fWZ1bmN0aW9uIE10KGUsdCl7cmV0dXJuIGt0KFB0KGUsdCkpLWt0KGUpfWNsYXNzIEx0e2NvbnN0cnVjdG9yKGUsdCl7dGhpcy5ydHJlZT1lLHRoaXMuaWQ9dC5pZCx0aGlzLmlzTGVhZj10LmlzTGVhZix0aGlzLmNoaWxkcmVuPXQuY2hpbGRyZW58fFtdLHRoaXMuYmJveD10LmJib3h9dXBkYXRlQkJveCgpe2lmKDA9PT10aGlzLmNoaWxkcmVuLmxlbmd0aClyZXR1cm4gdm9pZCh0aGlzLmJib3g9bnVsbCk7bGV0IGU9MS8wLHQ9LTEvMCxuPTEvMCxyPS0xLzA7Zm9yKGNvbnN0IGkgb2YgdGhpcy5jaGlsZHJlbil7bGV0IHM7aWYodGhpcy5pc0xlYWYpcz1pLmJib3g7ZWxzZXtzPXRoaXMucnRyZWUuX2xvYWROb2RlKGkpLmJib3h9cyYmKGU9TWF0aC5taW4oZSxzLm1pbkxhdCksdD1NYXRoLm1heCh0LHMubWF4TGF0KSxuPU1hdGgubWluKG4scy5taW5MbmcpLHI9TWF0aC5tYXgocixzLm1heExuZykpfXRoaXMuYmJveD17bWluTGF0OmUsbWF4TGF0OnQsbWluTG5nOm4sbWF4TG5nOnJ9LHRoaXMucnRyZWUuX3NhdmVOb2RlKHRoaXMpfXRvSlNPTigpe3JldHVybntpZDp0aGlzLmlkLGlzTGVhZjp0aGlzLmlzTGVhZixjaGlsZHJlbjp0aGlzLmNoaWxkcmVuLGJib3g6dGhpcy5iYm94fX19Y2xhc3MgVHR7Y29uc3RydWN0b3IoZSx0PTkpe3RoaXMuZmlsZT1uZXcgYihlKSx0aGlzLm1heEVudHJpZXM9dCx0aGlzLm1pbkVudHJpZXM9TWF0aC5tYXgoMixNYXRoLmNlaWwodC8yKSksdGhpcy5yb290UG9pbnRlcj1udWxsLHRoaXMubmV4dElkPTEsdGhpcy5fc2l6ZT0wLHRoaXMuaXNPcGVuPSExfWFzeW5jIG9wZW4oKXtpZih0aGlzLmlzT3Blbil0aHJvdyBuZXcgRXJyb3IoIlItdHJlZSBpcyBhbHJlYWR5IG9wZW4iKTt0aGlzLmZpbGUuZ2V0RmlsZVNpemUoKT4wP3RoaXMuX2xvYWRGcm9tRmlsZSgpOnRoaXMuX2luaXRpYWxpemVOZXdUcmVlKCksdGhpcy5pc09wZW49ITB9YXN5bmMgY2xvc2UoKXt0aGlzLmlzT3BlbiYmKHRoaXMuX3dyaXRlTWV0YWRhdGEoKSx0aGlzLmZpbGUmJnRoaXMuZmlsZS5zeW5jQWNjZXNzSGFuZGxlJiYodGhpcy5maWxlLmZsdXNoKCksYXdhaXQgdGhpcy5maWxlLnN5bmNBY2Nlc3NIYW5kbGUuY2xvc2UoKSksdGhpcy5pc09wZW49ITEpfV9pbml0aWFsaXplTmV3VHJlZSgpe2NvbnN0IGU9bmV3IEx0KHRoaXMse2lkOjAsaXNMZWFmOiEwLGNoaWxkcmVuOltdLGJib3g6bnVsbH0pO3RoaXMubmV4dElkPTEsdGhpcy5fc2l6ZT0wLHRoaXMucm9vdFBvaW50ZXI9dGhpcy5fc2F2ZU5vZGUoZSksdGhpcy5fd3JpdGVNZXRhZGF0YSgpfV93cml0ZU1ldGFkYXRhKCl7Y29uc3QgZT17dmVyc2lvbjoxLG1heEVudHJpZXM6dGhpcy5tYXhFbnRyaWVzLG1pbkVudHJpZXM6dGhpcy5taW5FbnRyaWVzLHNpemU6dGhpcy5fc2l6ZSxyb290UG9pbnRlcjp0aGlzLnJvb3RQb2ludGVyLG5leHRJZDp0aGlzLm5leHRJZH07dGhpcy5maWxlLmFwcGVuZChlKX1fbG9hZEZyb21GaWxlKCl7Y29uc3QgZT10aGlzLmZpbGUuZ2V0RmlsZVNpemUoKTtpZihlPDEzNSl0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgUi10cmVlIGZpbGUgZm9ybWF0OiBmaWxlIHRvbyBzbWFsbCBmb3IgbWV0YWRhdGEiKTtjb25zdCB0PWUtMTM1LG49dGhpcy5maWxlLnJlYWQodCk7dGhpcy5tYXhFbnRyaWVzPW4ubWF4RW50cmllcyx0aGlzLm1pbkVudHJpZXM9bi5taW5FbnRyaWVzLHRoaXMuX3NpemU9bi5zaXplLHRoaXMucm9vdFBvaW50ZXI9bi5yb290UG9pbnRlcix0aGlzLm5leHRJZD1uLm5leHRJZH1fc2F2ZU5vZGUoZSl7Y29uc3QgdD1lLnRvSlNPTigpLG49dGhpcy5maWxlLmdldEZpbGVTaXplKCk7cmV0dXJuIHRoaXMuZmlsZS5hcHBlbmQodCksbmV3IG0obil9X2xvYWROb2RlKGUpe2lmKCEoZSBpbnN0YW5jZW9mIG0pKXRocm93IG5ldyBFcnJvcigiRXhwZWN0ZWQgUG9pbnRlciBvYmplY3QiKTtjb25zdCB0PWUudmFsdWVPZigpLG49dGhpcy5maWxlLnJlYWQodCk7cmV0dXJuIG5ldyBMdCh0aGlzLG4pfV9sb2FkUm9vdCgpe3JldHVybiB0aGlzLl9sb2FkTm9kZSh0aGlzLnJvb3RQb2ludGVyKX1pbnNlcnQoZSx0LG4pe2lmKCF0aGlzLmlzT3Blbil0aHJvdyBuZXcgRXJyb3IoIlItdHJlZSBmaWxlIG11c3QgYmUgb3BlbmVkIGJlZm9yZSB1c2UiKTtpZighKG4gaW5zdGFuY2VvZiBnKSl0aHJvdyBuZXcgRXJyb3IoIm9iamVjdElkIG11c3QgYmUgYW4gaW5zdGFuY2Ugb2YgT2JqZWN0SWQgdG8gaW5zZXJ0IGludG8gcnRyZWUiKTtjb25zdCByPXtiYm94OnttaW5MYXQ6ZSxtYXhMYXQ6ZSxtaW5Mbmc6dCxtYXhMbmc6dH0sbGF0OmUsbG5nOnQsb2JqZWN0SWQ6bn0saT10aGlzLl9sb2FkUm9vdCgpLHM9dGhpcy5faW5zZXJ0KHIsaSwxKTtpZihzLnNwbGl0KXtjb25zdCBlPW5ldyBMdCh0aGlzLHtpZDp0aGlzLm5leHRJZCsrLGlzTGVhZjohMSxjaGlsZHJlbjpzLnBvaW50ZXJzLGJib3g6bnVsbH0pO2UudXBkYXRlQkJveCgpLHRoaXMucm9vdFBvaW50ZXI9dGhpcy5fc2F2ZU5vZGUoZSl9ZWxzZSB0aGlzLnJvb3RQb2ludGVyPXMucG9pbnRlcjt0aGlzLl9zaXplKyssdGhpcy5fd3JpdGVNZXRhZGF0YSgpfV9pbnNlcnQoZSx0LG4pe2lmKHQuaXNMZWFmKXtpZih0LmNoaWxkcmVuLnB1c2goZSksdC51cGRhdGVCQm94KCksdC5jaGlsZHJlbi5sZW5ndGg+dGhpcy5tYXhFbnRyaWVzKXtjb25zdFtlLG5dPXRoaXMuX3NwbGl0KHQpO3JldHVybntzcGxpdDohMCxwb2ludGVyczpbZSxuXX19cmV0dXJue3NwbGl0OiExLHBvaW50ZXI6dGhpcy5fc2F2ZU5vZGUodCl9fXtjb25zdCByPXRoaXMuX2Nob29zZVN1YnRyZWUoZS5iYm94LHQpLGk9dGhpcy5fbG9hZE5vZGUocikscz10aGlzLl9pbnNlcnQoZSxpLG4rMSk7aWYocy5zcGxpdCl7bGV0IGU9LTE7Zm9yKGxldCBuPTA7bjx0LmNoaWxkcmVuLmxlbmd0aDtuKyspaWYodC5jaGlsZHJlbltuXS52YWx1ZU9mKCk9PT1yLnZhbHVlT2YoKSl7ZT1uO2JyZWFrfWlmKC0xIT09ZT8odC5jaGlsZHJlbltlXT1zLnBvaW50ZXJzWzBdLHQuY2hpbGRyZW4ucHVzaChzLnBvaW50ZXJzWzFdKSk6KHQuY2hpbGRyZW4ucHVzaChzLnBvaW50ZXJzWzBdKSx0LmNoaWxkcmVuLnB1c2gocy5wb2ludGVyc1sxXSkpLHQudXBkYXRlQkJveCgpLHQuY2hpbGRyZW4ubGVuZ3RoPnRoaXMubWF4RW50cmllcyl7Y29uc3RbZSxuXT10aGlzLl9zcGxpdCh0KTtyZXR1cm57c3BsaXQ6ITAscG9pbnRlcnM6W2Usbl19fX1lbHNle2xldCBlPS0xO2ZvcihsZXQgbj0wO248dC5jaGlsZHJlbi5sZW5ndGg7bisrKWlmKHQuY2hpbGRyZW5bbl0udmFsdWVPZigpPT09ci52YWx1ZU9mKCkpe2U9bjticmVha30tMSE9PWUmJih0LmNoaWxkcmVuW2VdPXMucG9pbnRlciksdC51cGRhdGVCQm94KCl9cmV0dXJue3NwbGl0OiExLHBvaW50ZXI6dGhpcy5fc2F2ZU5vZGUodCl9fX1fY2hvb3NlU3VidHJlZShlLHQpe2xldCBuPTEvMCxyPTEvMCxpPW51bGw7Zm9yKGNvbnN0IHMgb2YgdC5jaGlsZHJlbil7aWYoIShzIGluc3RhbmNlb2YgbSkpdGhyb3cgbmV3IEVycm9yKCJFeHBlY3RlZCBQb2ludGVyIGluIF9jaG9vc2VTdWJ0cmVlLCBnb3Q6ICIrdHlwZW9mIHMpO2NvbnN0IHQ9dGhpcy5fbG9hZE5vZGUocyksbz1NdCh0LmJib3gsZSksYT1rdCh0LmJib3gpOyhvPG58fG89PT1uJiZhPHIpJiYobj1vLHI9YSxpPXMpfXJldHVybiBpfV9zcGxpdChlKXtjb25zdCB0PWUuY2hpbGRyZW4sbj1lLmlzTGVhZjtsZXQgcj0tMS8wLGk9MCxzPTE7Zm9yKGxldCBjPTA7Yzx0Lmxlbmd0aDtjKyspZm9yKGxldCBlPWMrMTtlPHQubGVuZ3RoO2UrKyl7bGV0IG8sYTtpZihuKW89dFtjXS5iYm94LGE9dFtlXS5iYm94O2Vsc2V7Y29uc3Qgbj10aGlzLl9sb2FkTm9kZSh0W2NdKSxyPXRoaXMuX2xvYWROb2RlKHRbZV0pO289bi5iYm94LGE9ci5iYm94fWNvbnN0IGw9a3QoUHQobyxhKSk7bD5yJiYocj1sLGk9YyxzPWUpfWNvbnN0IG89bmV3IEx0KHRoaXMse2lkOnRoaXMubmV4dElkKyssaXNMZWFmOm4sY2hpbGRyZW46W3RbaV1dLGJib3g6bnVsbH0pLGE9bmV3IEx0KHRoaXMse2lkOnRoaXMubmV4dElkKyssaXNMZWFmOm4sY2hpbGRyZW46W3Rbc11dLGJib3g6bnVsbH0pO2ZvcihsZXQgYz0wO2M8dC5sZW5ndGg7YysrKXtpZihjPT09aXx8Yz09PXMpY29udGludWU7Y29uc3QgZT10W2NdO2xldCByO2lmKG4pcj1lLmJib3g7ZWxzZXtyPXRoaXMuX2xvYWROb2RlKGUpLmJib3h9by51cGRhdGVCQm94KCksYS51cGRhdGVCQm94KCk7Y29uc3QgbD1vLmJib3g/TXQoby5iYm94LHIpOjAsdT1hLmJib3g/TXQoYS5iYm94LHIpOjA7bDx1P28uY2hpbGRyZW4ucHVzaChlKTp1PGw/YS5jaGlsZHJlbi5wdXNoKGUpOm8uY2hpbGRyZW4ubGVuZ3RoPD1hLmNoaWxkcmVuLmxlbmd0aD9vLmNoaWxkcmVuLnB1c2goZSk6YS5jaGlsZHJlbi5wdXNoKGUpfW8udXBkYXRlQkJveCgpLGEudXBkYXRlQkJveCgpO3JldHVyblt0aGlzLl9zYXZlTm9kZShvKSx0aGlzLl9zYXZlTm9kZShhKV19c2VhcmNoQkJveChlKXtpZighdGhpcy5pc09wZW4pdGhyb3cgbmV3IEVycm9yKCJSLXRyZWUgZmlsZSBtdXN0IGJlIG9wZW5lZCBiZWZvcmUgdXNlIik7Y29uc3QgdD1bXSxuPXRoaXMuX2xvYWRSb290KCk7cmV0dXJuIHRoaXMuX3NlYXJjaEJCb3goZSxuLHQpLHR9X3NlYXJjaEJCb3goZSx0LG4pe2lmKHQuYmJveCYmRHQoZSx0LmJib3gpKWlmKHQuaXNMZWFmKWZvcihjb25zdCByIG9mIHQuY2hpbGRyZW4pRHQoZSxyLmJib3gpJiZuLnB1c2goe29iamVjdElkOnIub2JqZWN0SWQsbGF0OnIubGF0LGxuZzpyLmxuZ30pO2Vsc2UgZm9yKGNvbnN0IHIgb2YgdC5jaGlsZHJlbil7Y29uc3QgdD10aGlzLl9sb2FkTm9kZShyKTt0aGlzLl9zZWFyY2hCQm94KGUsdCxuKX19c2VhcmNoUmFkaXVzKGUsdCxuKXtjb25zdCByPWZ1bmN0aW9uKGUsdCxuKXtjb25zdCByPW4vMTExLGk9bi8oMTExKk1hdGguY29zKGUqTWF0aC5QSS8xODApKTtyZXR1cm57bWluTGF0OmUtcixtYXhMYXQ6ZStyLG1pbkxuZzp0LWksbWF4TG5nOnQraX19KGUsdCxuKSxpPXRoaXMuX2xvYWRSb290KCkscz1bXTt0aGlzLl9zZWFyY2hCQm94RW50cmllcyhyLGkscyk7Y29uc3Qgbz1bXTtmb3IoY29uc3QgYSBvZiBzKXtjb25zdCByPWp0KGUsdCxhLmxhdCxhLmxuZyk7cjw9biYmby5wdXNoKHtvYmplY3RJZDphLm9iamVjdElkLGxhdDphLmxhdCxsbmc6YS5sbmcsZGlzdGFuY2U6cn0pfXJldHVybiBvfV9zZWFyY2hCQm94RW50cmllcyhlLHQsbil7aWYodC5iYm94JiZEdChlLHQuYmJveCkpaWYodC5pc0xlYWYpZm9yKGNvbnN0IHIgb2YgdC5jaGlsZHJlbilEdChlLHIuYmJveCkmJm4ucHVzaChyKTtlbHNlIGZvcihjb25zdCByIG9mIHQuY2hpbGRyZW4pe2NvbnN0IHQ9dGhpcy5fbG9hZE5vZGUocik7dGhpcy5fc2VhcmNoQkJveEVudHJpZXMoZSx0LG4pfX1yZW1vdmUoZSl7aWYoIXRoaXMuaXNPcGVuKXRocm93IG5ldyBFcnJvcigiUi10cmVlIGZpbGUgbXVzdCBiZSBvcGVuZWQgYmVmb3JlIHVzZSIpO2lmKCEoZSBpbnN0YW5jZW9mIGcpKXRocm93IG5ldyBFcnJvcigib2JqZWN0SWQgbXVzdCBiZSBhbiBpbnN0YW5jZSBvZiBPYmplY3RJZCB0byByZW1vdmUgZnJvbSBydHJlZSIpO2NvbnN0IHQ9dGhpcy5fbG9hZFJvb3QoKSxuPXRoaXMuX3JlbW92ZShlLHQpO2lmKCFuLmZvdW5kKXJldHVybiExO2lmKG4udW5kZXJmbG93JiZuLmNoaWxkcmVuKWlmKDA9PT1uLmNoaWxkcmVuLmxlbmd0aCl7Y29uc3QgZT1uZXcgTHQodGhpcyx7aWQ6dGhpcy5uZXh0SWQrKyxpc0xlYWY6ITAsY2hpbGRyZW46W10sYmJveDpudWxsfSk7dGhpcy5yb290UG9pbnRlcj10aGlzLl9zYXZlTm9kZShlKX1lbHNlIGlmKDEhPT1uLmNoaWxkcmVuLmxlbmd0aHx8bi5pc0xlYWYpe2NvbnN0IGU9bmV3IEx0KHRoaXMse2lkOnQuaWQsaXNMZWFmOm4uaXNMZWFmLGNoaWxkcmVuOm4uY2hpbGRyZW4sYmJveDpudWxsfSk7ZS51cGRhdGVCQm94KCksdGhpcy5yb290UG9pbnRlcj10aGlzLl9zYXZlTm9kZShlKX1lbHNlIHRoaXMucm9vdFBvaW50ZXI9bi5jaGlsZHJlblswXTtlbHNlIG4ucG9pbnRlciYmKHRoaXMucm9vdFBvaW50ZXI9bi5wb2ludGVyKTtyZXR1cm4gdGhpcy5fc2l6ZS0tLHRoaXMuX3dyaXRlTWV0YWRhdGEoKSwhMH1fcmVtb3ZlKGUsdCl7aWYodC5pc0xlYWYpe2NvbnN0IG49dC5jaGlsZHJlbi5sZW5ndGg7aWYodC5jaGlsZHJlbj10LmNoaWxkcmVuLmZpbHRlcih0PT4hdC5vYmplY3RJZC5lcXVhbHMoZSkpLHQuY2hpbGRyZW4ubGVuZ3RoPT09bilyZXR1cm57Zm91bmQ6ITF9O3QudXBkYXRlQkJveCgpO2NvbnN0IHI9dGhpcy5fc2F2ZU5vZGUodCk7cmV0dXJue2ZvdW5kOiEwLHVuZGVyZmxvdzp0LmNoaWxkcmVuLmxlbmd0aDx0aGlzLm1pbkVudHJpZXMmJnQuY2hpbGRyZW4ubGVuZ3RoPjAscG9pbnRlcjpyLGNoaWxkcmVuOnQuY2hpbGRyZW4saXNMZWFmOiEwfX17bGV0IG49Wy4uLnQuY2hpbGRyZW5dO2ZvcihsZXQgcj0wO3I8bi5sZW5ndGg7cisrKXtjb25zdCBpPW5bcl0scz10aGlzLl9sb2FkTm9kZShpKSxvPXRoaXMuX3JlbW92ZShlLHMpO2lmKG8uZm91bmQpe2lmKG8udW5kZXJmbG93KXtjb25zdCBlPXRoaXMuX2hhbmRsZVVuZGVyZmxvdyh0LHIscyxvKTtlLm1lcmdlZD9uPWUuY2hpbGRyZW46bltyXT1vLnBvaW50ZXJ9ZWxzZSBuW3JdPW8ucG9pbnRlcjtjb25zdCBlPW5ldyBMdCh0aGlzLHtpZDp0LmlkLGlzTGVhZjohMSxjaGlsZHJlbjpuLGJib3g6bnVsbH0pO2UudXBkYXRlQkJveCgpO2NvbnN0IGk9dGhpcy5fc2F2ZU5vZGUoZSk7cmV0dXJue2ZvdW5kOiEwLHVuZGVyZmxvdzpuLmxlbmd0aDx0aGlzLm1pbkVudHJpZXMmJm4ubGVuZ3RoPjAscG9pbnRlcjppLGNoaWxkcmVuOm4saXNMZWFmOiExfX19cmV0dXJue2ZvdW5kOiExfX19X2hhbmRsZVVuZGVyZmxvdyhlLHQsbixyKXtjb25zdCBpPVtdO2lmKHQ+MCl7Y29uc3Qgbj1lLmNoaWxkcmVuW3QtMV0scj10aGlzLl9sb2FkTm9kZShuKTtpLnB1c2goe2luZGV4OnQtMSxub2RlOnIscG9pbnRlcjpufSl9aWYodDxlLmNoaWxkcmVuLmxlbmd0aC0xKXtjb25zdCBuPWUuY2hpbGRyZW5bdCsxXSxyPXRoaXMuX2xvYWROb2RlKG4pO2kucHVzaCh7aW5kZXg6dCsxLG5vZGU6cixwb2ludGVyOm59KX1mb3IoY29uc3QgcyBvZiBpKWlmKHMubm9kZS5jaGlsZHJlbi5sZW5ndGg+dGhpcy5taW5FbnRyaWVzKXtjb25zdCBpPVsuLi5yLmNoaWxkcmVuLC4uLnMubm9kZS5jaGlsZHJlbl0sbz1NYXRoLmNlaWwoaS5sZW5ndGgvMiksYT1pLnNsaWNlKDAsbyksYz1pLnNsaWNlKG8pLGw9bmV3IEx0KHRoaXMse2lkOm4uaWQsaXNMZWFmOnIuaXNMZWFmLGNoaWxkcmVuOmEsYmJveDpudWxsfSk7bC51cGRhdGVCQm94KCk7Y29uc3QgdT1uZXcgTHQodGhpcyx7aWQ6cy5ub2RlLmlkLGlzTGVhZjpzLm5vZGUuaXNMZWFmLGNoaWxkcmVuOmMsYmJveDpudWxsfSk7dS51cGRhdGVCQm94KCk7Y29uc3QgaD10aGlzLl9zYXZlTm9kZShsKSxmPXRoaXMuX3NhdmVOb2RlKHUpLGQ9Wy4uLmUuY2hpbGRyZW5dLHA9TWF0aC5taW4odCxzLmluZGV4KSxnPU1hdGgubWF4KHQscy5pbmRleCk7cmV0dXJuIGRbcF09aCxkW2ddPWYse21lcmdlZDohMCxjaGlsZHJlbjpkfX1pZihpLmxlbmd0aD4wKXtjb25zdCBuPWlbMF0scz1bLi4uci5jaGlsZHJlbiwuLi5uLm5vZGUuY2hpbGRyZW5dLG89bmV3IEx0KHRoaXMse2lkOnRoaXMubmV4dElkKyssaXNMZWFmOnIuaXNMZWFmLGNoaWxkcmVuOnMsYmJveDpudWxsfSk7by51cGRhdGVCQm94KCk7Y29uc3QgYT10aGlzLl9zYXZlTm9kZShvKSxjPWUuY2hpbGRyZW4uZmlsdGVyKChlLHIpPT5yIT09dCYmciE9PW4uaW5kZXgpO3JldHVybiBjLnB1c2goYSkse21lcmdlZDohMCxjaGlsZHJlbjpjfX1yZXR1cm57bWVyZ2VkOiExfX1zaXplKCl7cmV0dXJuIHRoaXMuX3NpemV9YXN5bmMgY2xlYXIoKXtjb25zdCBlPW5ldyBMdCh0aGlzLHtpZDp0aGlzLm5leHRJZCsrLGlzTGVhZjohMCxjaGlsZHJlbjpbXSxiYm94Om51bGx9KTt0aGlzLnJvb3RQb2ludGVyPXRoaXMuX3NhdmVOb2RlKGUpLHRoaXMuX3NpemU9MCx0aGlzLl93cml0ZU1ldGFkYXRhKCl9YXN5bmMgY29tcGFjdChlKXtpZighdGhpcy5pc09wZW4pdGhyb3cgbmV3IEVycm9yKCJSLXRyZWUgZmlsZSBtdXN0IGJlIG9wZW5lZCBiZWZvcmUgdXNlIik7aWYoIWUpdGhyb3cgbmV3IEVycm9yKCJEZXN0aW5hdGlvbiBzeW5jIGhhbmRsZSBpcyByZXF1aXJlZCBmb3IgY29tcGFjdGlvbiIpO3RoaXMuX3dyaXRlTWV0YWRhdGEoKTtjb25zdCB0PXRoaXMuZmlsZS5nZXRGaWxlU2l6ZSgpLG49bmV3IFR0KGUsdGhpcy5tYXhFbnRyaWVzKTthd2FpdCBuLm9wZW4oKSxuLm1pbkVudHJpZXM9dGhpcy5taW5FbnRyaWVzLG4ubmV4dElkPXRoaXMubmV4dElkLG4uX3NpemU9dGhpcy5fc2l6ZTtjb25zdCByPS8qIEBfX1BVUkVfXyAqL25ldyBNYXAsaT1lPT57Y29uc3QgdD1lLnZhbHVlT2YoKTtpZihyLmhhcyh0KSlyZXR1cm4gci5nZXQodCk7Y29uc3Qgcz10aGlzLl9sb2FkTm9kZShlKSxvPVtdO2lmKHMuaXNMZWFmKWZvcihjb25zdCBuIG9mIHMuY2hpbGRyZW4pby5wdXNoKG4pO2Vsc2UgZm9yKGNvbnN0IG4gb2Ygcy5jaGlsZHJlbil7Y29uc3QgZT1pKG4pO28ucHVzaChlKX1jb25zdCBhPW5ldyBMdChuLHtpZDpzLmlkLGlzTGVhZjpzLmlzTGVhZixjaGlsZHJlbjpvLGJib3g6cy5iYm94fSksYz1uLl9zYXZlTm9kZShhKTtyZXR1cm4gci5zZXQodCxjKSxjfSxzPWkodGhpcy5yb290UG9pbnRlcik7bi5yb290UG9pbnRlcj1zLG4uX3dyaXRlTWV0YWRhdGEoKTtjb25zdCBvPW4uZmlsZS5nZXRGaWxlU2l6ZSgpO3JldHVybiBhd2FpdCBuLmNsb3NlKCkse29sZFNpemU6dCxuZXdTaXplOm8sYnl0ZXNTYXZlZDpNYXRoLm1heCgwLHQtbyl9fX1jbGFzcyBGdCBleHRlbmRzIHV0e2NvbnN0cnVjdG9yKGUsdCxuLHI9e30pe3N1cGVyKGUsdCxuLHIpLHRoaXMuZ2VvRmllbGQ9T2JqZWN0LmtleXModClbMF0sdGhpcy5zdG9yYWdlRmlsZVBhdGg9bix0aGlzLnJ0cmVlPW51bGwsdGhpcy5zeW5jSGFuZGxlPW51bGwsdGhpcy5pc09wZW49ITF9YXN5bmMgb3Blbigpe2lmKCF0aGlzLmlzT3Blbil0cnl7Y29uc3QgZT10aGlzLnN0b3JhZ2VGaWxlUGF0aC5zcGxpdCgiLyIpLmZpbHRlcihCb29sZWFuKSx0PWUucG9wKCk7aWYoIXQpdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIHN0b3JhZ2UgcGF0aDogJHt0aGlzLnN0b3JhZ2VGaWxlUGF0aH1gKTtsZXQgbj1hd2FpdCBnbG9iYWxUaGlzLm5hdmlnYXRvci5zdG9yYWdlLmdldERpcmVjdG9yeSgpO2Zvcihjb25zdCBpIG9mIGUpbj1hd2FpdCBuLmdldERpcmVjdG9yeUhhbmRsZShpLHtjcmVhdGU6ITB9KTtjb25zdCByPWF3YWl0IG4uZ2V0RmlsZUhhbmRsZSh0LHtjcmVhdGU6ITB9KTt0aGlzLnN5bmNIYW5kbGU9YXdhaXQgci5jcmVhdGVTeW5jQWNjZXNzSGFuZGxlKCksdGhpcy5ydHJlZT1uZXcgVHQodGhpcy5zeW5jSGFuZGxlLDkpLGF3YWl0IHRoaXMucnRyZWUub3BlbigpLHRoaXMuaXNPcGVuPSEwfWNhdGNoKGUpe2lmKCEoIkVOT0VOVCI9PT1lLmNvZGV8fGUubWVzc2FnZSYmKGUubWVzc2FnZS5pbmNsdWRlcygiSW52YWxpZCBSLXRyZWUiKXx8ZS5tZXNzYWdlLmluY2x1ZGVzKCJmaWxlIHRvbyBzbWFsbCIpfHxlLm1lc3NhZ2UuaW5jbHVkZXMoIkZhaWxlZCB0byByZWFkIG1ldGFkYXRhIil8fGUubWVzc2FnZS5pbmNsdWRlcygiVW5rbm93biB0eXBlIGJ5dGUiKSkpKXRocm93IGU7e2lmKHRoaXMuc3luY0hhbmRsZSl7dHJ5e2F3YWl0IHRoaXMuc3luY0hhbmRsZS5jbG9zZSgpfWNhdGNoKHQpe310aGlzLnN5bmNIYW5kbGU9bnVsbH1jb25zdCBlPXRoaXMuc3RvcmFnZUZpbGVQYXRoLnNwbGl0KCIvIikuZmlsdGVyKEJvb2xlYW4pLG49ZS5wb3AoKTtpZighbil0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgc3RvcmFnZSBwYXRoOiAke3RoaXMuc3RvcmFnZUZpbGVQYXRofWApO2xldCByPWF3YWl0IGdsb2JhbFRoaXMubmF2aWdhdG9yLnN0b3JhZ2UuZ2V0RGlyZWN0b3J5KCk7Zm9yKGNvbnN0IHQgb2YgZSlyPWF3YWl0IHIuZ2V0RGlyZWN0b3J5SGFuZGxlKHQse2NyZWF0ZTohMH0pO3RyeXthd2FpdCByLnJlbW92ZUVudHJ5KG4pfWNhdGNoKHQpe31jb25zdCBpPWF3YWl0IHIuZ2V0RmlsZUhhbmRsZShuLHtjcmVhdGU6ITB9KTt0aGlzLnN5bmNIYW5kbGU9YXdhaXQgaS5jcmVhdGVTeW5jQWNjZXNzSGFuZGxlKCksdGhpcy5ydHJlZT1uZXcgVHQodGhpcy5zeW5jSGFuZGxlLDkpLGF3YWl0IHRoaXMucnRyZWUub3BlbigpLHRoaXMuaXNPcGVuPSEwfX19YXN5bmMgY2xvc2UoKXtpZih0aGlzLmlzT3Blbil7dHJ5e2F3YWl0IHRoaXMucnRyZWUuY2xvc2UoKX1jYXRjaChlKXtpZighZS5tZXNzYWdlfHwhZS5tZXNzYWdlLmluY2x1ZGVzKCJGaWxlIGlzIG5vdCBvcGVuIikpdGhyb3cgZX10aGlzLmlzT3Blbj0hMX19X2V4dHJhY3RDb29yZGluYXRlcyhlKXtpZighZSlyZXR1cm4gbnVsbDtpZigiRmVhdHVyZUNvbGxlY3Rpb24iPT09ZS50eXBlJiZlLmZlYXR1cmVzJiZlLmZlYXR1cmVzLmxlbmd0aD4wKXtjb25zdCB0PWUuZmVhdHVyZXNbMF07aWYodC5nZW9tZXRyeSlyZXR1cm4gdGhpcy5fZXh0cmFjdENvb3JkaW5hdGVzKHQuZ2VvbWV0cnkpfWlmKCJGZWF0dXJlIj09PWUudHlwZSYmZS5nZW9tZXRyeSlyZXR1cm4gdGhpcy5fZXh0cmFjdENvb3JkaW5hdGVzKGUuZ2VvbWV0cnkpO2lmKCJQb2ludCI9PT1lLnR5cGUmJmUuY29vcmRpbmF0ZXMpe2NvbnN0W3Qsbl09ZS5jb29yZGluYXRlcztpZigibnVtYmVyIj09dHlwZW9mIHQmJiJudW1iZXIiPT10eXBlb2YgbilyZXR1cm57bGF0Om4sbG5nOnR9fWlmKCJQb2x5Z29uIj09PWUudHlwZSYmZS5jb29yZGluYXRlcyYmZS5jb29yZGluYXRlcy5sZW5ndGg+MCl7Y29uc3QgdD1lLmNvb3JkaW5hdGVzWzBdO2lmKHQubGVuZ3RoPjApe2xldCBlPTAsbj0wO2Zvcihjb25zdCByIG9mIHQpbis9clswXSxlKz1yWzFdO3JldHVybntsYXQ6ZS90Lmxlbmd0aCxsbmc6bi90Lmxlbmd0aH19fXJldHVybiBudWxsfWFzeW5jIGFkZChlKXtpZighZS5faWQpdGhyb3cgbmV3IEVycm9yKCJEb2N1bWVudCBtdXN0IGhhdmUgYW4gX2lkIGZpZWxkIik7Y29uc3QgdD12KGUsdGhpcy5nZW9GaWVsZCksbj10aGlzLl9leHRyYWN0Q29vcmRpbmF0ZXModCk7biYmYXdhaXQgdGhpcy5ydHJlZS5pbnNlcnQobi5sYXQsbi5sbmcsZS5faWQpfWFzeW5jIHJlbW92ZShlKXtpZihlLl9pZCl7aWYoIShlLl9pZCBpbnN0YW5jZW9mIGcpKXRocm93IGNvbnNvbGUuZXJyb3IoZSksbmV3IEVycm9yKCJEb2N1bWVudCBfaWQgbXVzdCBiZSBhbiBPYmplY3RJZCB0byByZW1vdmUgZnJvbSBnZW9zcGF0aWFsIGluZGV4Iik7YXdhaXQgdGhpcy5ydHJlZS5yZW1vdmUoZS5faWQpfX1hc3luYyBxdWVyeShlKXtpZih0aGlzLmlzT3Blbnx8YXdhaXQgdGhpcy5vcGVuKCksIWVbdGhpcy5nZW9GaWVsZF0pcmV0dXJuIG51bGw7Y29uc3QgdD1lW3RoaXMuZ2VvRmllbGRdO2lmKHQuJGdlb1dpdGhpbil7Y29uc3QgZT10LiRnZW9XaXRoaW47aWYoQXJyYXkuaXNBcnJheShlKSYmMj09PWUubGVuZ3RoKXtjb25zdCB0PWVbMF1bMF0sbj1lWzBdWzFdLHI9ZVsxXVswXSxpPWVbMV1bMV07cmV0dXJuKGF3YWl0IHRoaXMucnRyZWUuc2VhcmNoQkJveCh7bWluTGF0OmksbWF4TGF0Om4sbWluTG5nOnQsbWF4TG5nOnJ9KSkubWFwKGU9PmUub2JqZWN0SWQudG9TdHJpbmcoKSl9fWlmKHQuJG5lYXIpe2NvbnN0IGU9dC4kbmVhcjtsZXQgbjtpZihlLiRnZW9tZXRyeSluPWUuJGdlb21ldHJ5LmNvb3JkaW5hdGVzO2Vsc2UgaWYoZS5jb29yZGluYXRlcyluPWUuY29vcmRpbmF0ZXM7ZWxzZXtpZighQXJyYXkuaXNBcnJheShlKSlyZXR1cm4gbnVsbDtuPWV9aWYoIW58fG4ubGVuZ3RoPDIpcmV0dXJuIG51bGw7Y29uc3RbcixpXT1uLHM9KGUuJG1heERpc3RhbmNlfHwxZTYpLzFlMyxvPWF3YWl0IHRoaXMucnRyZWUuc2VhcmNoUmFkaXVzKGkscixzKTtyZXR1cm4gby5zb3J0KChlLHQpPT5lLmRpc3RhbmNlLXQuZGlzdGFuY2UpLG8ubWFwKGU9PmUub2JqZWN0SWQudG9TdHJpbmcoKSl9aWYodC4kbmVhclNwaGVyZSl7Y29uc3QgZT10LiRuZWFyU3BoZXJlO2xldCBuO2lmKGUuJGdlb21ldHJ5KW49ZS4kZ2VvbWV0cnkuY29vcmRpbmF0ZXM7ZWxzZSBpZihlLmNvb3JkaW5hdGVzKW49ZS5jb29yZGluYXRlcztlbHNle2lmKCFBcnJheS5pc0FycmF5KGUpKXJldHVybiBudWxsO249ZX1pZighbnx8bi5sZW5ndGg8MilyZXR1cm4gbnVsbDtjb25zdFtyLGldPW4scz0oZS4kbWF4RGlzdGFuY2V8fDFlNikvMWUzLG89YXdhaXQgdGhpcy5ydHJlZS5zZWFyY2hSYWRpdXMoaSxyLHMpO3JldHVybiBvLnNvcnQoKGUsdCk9PmUuZGlzdGFuY2UtdC5kaXN0YW5jZSksby5tYXAoZT0+ZS5vYmplY3RJZC50b1N0cmluZygpKX1pZih0LiRnZW9JbnRlcnNlY3RzKXtjb25zdCBlPXQuJGdlb0ludGVyc2VjdHM7bGV0IG47aWYoIWUuJGdlb21ldHJ5KXJldHVybiBudWxsO2lmKG49ZS4kZ2VvbWV0cnksIW58fCFuLnR5cGUpcmV0dXJuIG51bGw7aWYoIlBvaW50Ij09PW4udHlwZSl7Y29uc3RbZSx0XT1uLmNvb3JkaW5hdGVzLHI9MWUtNDtyZXR1cm4oYXdhaXQgdGhpcy5ydHJlZS5zZWFyY2hCQm94KHttaW5MYXQ6dC1yLG1heExhdDp0K3IsbWluTG5nOmUtcixtYXhMbmc6ZStyfSkpLm1hcChlPT5lLm9iamVjdElkLnRvU3RyaW5nKCkpfWlmKCJQb2x5Z29uIj09PW4udHlwZSl7Y29uc3QgZT1uLmNvb3JkaW5hdGVzO2lmKCFlfHwwPT09ZS5sZW5ndGgpcmV0dXJuIG51bGw7Y29uc3QgdD1lWzBdO2lmKCF0fHx0Lmxlbmd0aDwzKXJldHVybiBudWxsO2xldCByPTEvMCxpPS0xLzAscz0xLzAsbz0tMS8wO2Zvcihjb25zdCBuIG9mIHQpe2NvbnN0W2UsdF09bjtyPU1hdGgubWluKHIsdCksaT1NYXRoLm1heChpLHQpLHM9TWF0aC5taW4ocyxlKSxvPU1hdGgubWF4KG8sZSl9cmV0dXJuKGF3YWl0IHRoaXMucnRyZWUuc2VhcmNoQkJveCh7bWluTGF0OnIsbWF4TGF0OmksbWluTG5nOnMsbWF4TG5nOm99KSkuZmlsdGVyKGU9PnRoaXMuX3BvaW50SW5Qb2x5Z29uKGUubGF0LGUubG5nLHQpKS5tYXAoZT0+ZS5vYmplY3RJZC50b1N0cmluZygpKX1yZXR1cm4gbnVsbH1yZXR1cm4gbnVsbH1fcG9pbnRJblBvbHlnb24oZSx0LG4pe2xldCByPSExO2ZvcihsZXQgaT0wLHM9bi5sZW5ndGgtMTtpPG4ubGVuZ3RoO3M9aSsrKXtjb25zdFtvLGFdPW5baV0sW2MsbF09bltzXTthPmUhPWw+ZSYmdDwoYy1vKSooZS1hKS8obC1hKStvJiYocj0hcil9cmV0dXJuIHJ9YXN5bmMgY2xlYXIoKXthd2FpdCB0aGlzLmNsb3NlKCk7dHJ5e2NvbnN0IGU9dGhpcy5zdG9yYWdlRmlsZVBhdGguc3BsaXQoIi8iKS5maWx0ZXIoQm9vbGVhbiksdD1lLnBvcCgpO2xldCBuPWF3YWl0IGdsb2JhbFRoaXMubmF2aWdhdG9yLnN0b3JhZ2UuZ2V0RGlyZWN0b3J5KCk7Zm9yKGNvbnN0IHIgb2YgZSluPWF3YWl0IG4uZ2V0RGlyZWN0b3J5SGFuZGxlKHIse2NyZWF0ZTohMX0pO2F3YWl0IG4ucmVtb3ZlRW50cnkodCl9Y2F0Y2goZSl7aWYoIWV8fCJOb3RGb3VuZEVycm9yIiE9PWUubmFtZSl0aHJvdyBlfWF3YWl0IHRoaXMub3BlbigpfWdldFNwZWMoKXtyZXR1cm57bmFtZTp0aGlzLm5hbWUsa2V5OnRoaXMua2V5cywiMmRzcGhlcmVJbmRleFZlcnNpb24iOjN9fX1jbGFzcyBCdHtjb25zdHJ1Y3Rvcigpe3RoaXMudHlwZT0iZnVsbF9zY2FuIix0aGlzLmluZGV4ZXM9W10sdGhpcy5pbmRleFNjYW5zPVtdLHRoaXMuZXN0aW1hdGVkQ29zdD0xLzAsdGhpcy5pbmRleE9ubHk9ITF9fWNsYXNzIHp0e2NvbnN0cnVjdG9yKGUpe3RoaXMuaW5kZXhlcz1lfXBsYW4oZSl7Y29uc3QgdD1uZXcgQnQ7aWYoIWV8fDA9PT1PYmplY3Qua2V5cyhlKS5sZW5ndGgpcmV0dXJuIHQ7Y29uc3Qgbj10aGlzLl9hbmFseXplUXVlcnkoZSk7aWYobi5oYXNUZXh0U2VhcmNoKXtjb25zdCB0PXRoaXMuX3BsYW5UZXh0U2VhcmNoKGUsbik7aWYodClyZXR1cm4gdH1pZihuLmhhc0dlb1F1ZXJ5KXtjb25zdCB0PXRoaXMuX3BsYW5HZW9RdWVyeShlLG4pO2lmKHQpcmV0dXJuIHR9aWYoImFuZCI9PT1uLnR5cGUpe2NvbnN0IHQ9dGhpcy5fcGxhbkFuZFF1ZXJ5KGUsbik7aWYoImZ1bGxfc2NhbiIhPT10LnR5cGUpcmV0dXJuIHR9aWYoIm9yIj09PW4udHlwZSl7Y29uc3QgdD10aGlzLl9wbGFuT3JRdWVyeShlLG4pO2lmKCJmdWxsX3NjYW4iIT09dC50eXBlKXJldHVybiB0fWNvbnN0IHI9dGhpcy5fcGxhblNpbXBsZVF1ZXJ5KGUpO3JldHVybiJmdWxsX3NjYW4iIT09ci50eXBlP3I6dH1fYW5hbHl6ZVF1ZXJ5KGUpe2NvbnN0IHQ9e3R5cGU6InNpbXBsZSIsZmllbGRzOltdLG9wZXJhdG9yczp7fSxoYXNUZXh0U2VhcmNoOiExLGhhc0dlb1F1ZXJ5OiExLGNvbmRpdGlvbnM6W119LG49T2JqZWN0LmtleXMoZSk7aWYoMT09PW4ubGVuZ3RoKXtjb25zdCByPW5bMF07aWYoIiRhbmQiPT09cil7dC50eXBlPSJhbmQiLHQuY29uZGl0aW9ucz1lLiRhbmQ7Zm9yKGNvbnN0IGUgb2YgdC5jb25kaXRpb25zKXtjb25zdCBuPXRoaXMuX2FuYWx5emVRdWVyeShlKTt0LmZpZWxkcy5wdXNoKC4uLm4uZmllbGRzKSxuLmhhc1RleHRTZWFyY2gmJih0Lmhhc1RleHRTZWFyY2g9ITApLG4uaGFzR2VvUXVlcnkmJih0Lmhhc0dlb1F1ZXJ5PSEwKX1yZXR1cm4gdH1pZigiJG9yIj09PXIpe3QudHlwZT0ib3IiLHQuY29uZGl0aW9ucz1lLiRvcjtmb3IoY29uc3QgZSBvZiB0LmNvbmRpdGlvbnMpe2NvbnN0IG49dGhpcy5fYW5hbHl6ZVF1ZXJ5KGUpO3QuZmllbGRzLnB1c2goLi4ubi5maWVsZHMpLG4uaGFzVGV4dFNlYXJjaCYmKHQuaGFzVGV4dFNlYXJjaD0hMCksbi5oYXNHZW9RdWVyeSYmKHQuaGFzR2VvUXVlcnk9ITApfXJldHVybiB0fX1mb3IoY29uc3QgciBvZiBuKXtpZihyLnN0YXJ0c1dpdGgoIiQiKSljb250aW51ZTt0LmZpZWxkcy5wdXNoKHIpO2NvbnN0IG49ZVtyXTtpZigib2JqZWN0Ij09dHlwZW9mIG4mJm51bGwhPT1uJiYhQXJyYXkuaXNBcnJheShuKSl7Y29uc3QgZT1PYmplY3Qua2V5cyhuKTt0Lm9wZXJhdG9yc1tyXT1lLGUuaW5jbHVkZXMoIiR0ZXh0IikmJih0Lmhhc1RleHRTZWFyY2g9ITApLGUuc29tZShlPT5bIiRnZW9XaXRoaW4iLCIkZ2VvSW50ZXJzZWN0cyIsIiRuZWFyIiwiJG5lYXJTcGhlcmUiXS5pbmNsdWRlcyhlKSkmJih0Lmhhc0dlb1F1ZXJ5PSEwKX19cmV0dXJuIG4ubGVuZ3RoPjEmJih0LnR5cGU9ImFuZCIpLHR9X3BsYW5UZXh0U2VhcmNoKGUsdCl7Zm9yKGNvbnN0W24scl1vZiB0aGlzLmluZGV4ZXMpaWYociBpbnN0YW5jZW9mIEV0KXtjb25zdCB0PXRoaXMuX2V4dHJhY3RUZXh0UXVlcnkoZSk7aWYodCl7Y29uc3QgZT1uZXcgQnQ7cmV0dXJuIGUudHlwZT0iaW5kZXhfc2NhbiIsZS5pbmRleGVzPVtuXSxlLmluZGV4U2NhbnM9W3tpbmRleE5hbWU6bixpbmRleDpyLHRleHRRdWVyeTp0fV0sZS5lc3RpbWF0ZWRDb3N0PTEwMCxlLmluZGV4T25seT0hMCxlfX1yZXR1cm4gbnVsbH1fZXh0cmFjdFRleHRRdWVyeShlKXtmb3IoY29uc3QgdCBpbiBlKXtjb25zdCBuPWVbdF07aWYoIm9iamVjdCI9PXR5cGVvZiBuJiZudWxsIT09biYmbi4kdGV4dClyZXR1cm4ic3RyaW5nIj09dHlwZW9mIG4uJHRleHQ/bi4kdGV4dDpuLiR0ZXh0LiRzZWFyY2h9cmV0dXJuIG51bGx9X3BsYW5HZW9RdWVyeShlLHQpe2Zvcihjb25zdFtuLHJdb2YgdGhpcy5pbmRleGVzKWlmKHIgaW5zdGFuY2VvZiBGdCl7Y29uc3QgdD1uZXcgQnQ7cmV0dXJuIHQudHlwZT0iaW5kZXhfc2NhbiIsdC5pbmRleGVzPVtuXSx0LmluZGV4U2NhbnM9W3tpbmRleE5hbWU6bixpbmRleDpyLHF1ZXJ5OmV9XSx0LmVzdGltYXRlZENvc3Q9MTAwLHQuaW5kZXhPbmx5PSEwLHR9cmV0dXJuIG51bGx9X3BsYW5BbmRRdWVyeShlLHQpe2NvbnN0IG49bmV3IEJ0O2xldCByO3I9ZS4kYW5kP2UuJGFuZDpPYmplY3Qua2V5cyhlKS5tYXAodD0+KHtbdF06ZVt0XX0pKTtjb25zdCBpPVtdO2Zvcihjb25zdCBzIG9mIHIpe2NvbnN0IGU9dGhpcy5fcGxhblNpbXBsZVF1ZXJ5KHMpOyJpbmRleF9zY2FuIj09PWUudHlwZSYmaS5wdXNoKGUuaW5kZXhTY2Fuc1swXSl9cmV0dXJuIGkubGVuZ3RoPjE/KG4udHlwZT0iaW5kZXhfaW50ZXJzZWN0aW9uIixuLmluZGV4U2NhbnM9aSxuLmluZGV4ZXM9aS5tYXAoZT0+ZS5pbmRleE5hbWUpLG4uZXN0aW1hdGVkQ29zdD01MCxuKToxPT09aS5sZW5ndGg/KG4udHlwZT0iaW5kZXhfc2NhbiIsbi5pbmRleFNjYW5zPVtpWzBdXSxuLmluZGV4ZXM9W2lbMF0uaW5kZXhOYW1lXSxuLmVzdGltYXRlZENvc3Q9NTAsbik6bn1fcGxhbk9yUXVlcnkoZSx0KXtjb25zdCBuPW5ldyBCdDtpZighZS4kb3IpcmV0dXJuIG47Y29uc3Qgcj1lLiRvcixpPVtdO2Zvcihjb25zdCBzIG9mIHIpe2NvbnN0IGU9dGhpcy5fcGxhblNpbXBsZVF1ZXJ5KHMpOyJpbmRleF9zY2FuIj09PWUudHlwZSYmaS5wdXNoKGUuaW5kZXhTY2Fuc1swXSl9cmV0dXJuIGkubGVuZ3RoPjA/KG4udHlwZT0iaW5kZXhfdW5pb24iLG4uaW5kZXhTY2Fucz1pLG4uaW5kZXhlcz1pLm1hcChlPT5lLmluZGV4TmFtZSksbi5lc3RpbWF0ZWRDb3N0PTEwMCppLmxlbmd0aCxuKTpufV9wbGFuU2ltcGxlUXVlcnkoZSl7Y29uc3QgdD1uZXcgQnQ7aWYoMD09PU9iamVjdC5rZXlzKGUpLmxlbmd0aClyZXR1cm4gdDtmb3IoY29uc3RbbixyXW9mIHRoaXMuaW5kZXhlcylpZighKHIgaW5zdGFuY2VvZiBFdHx8ciBpbnN0YW5jZW9mIEZ0KSYmdGhpcy5fY2FuSW5kZXhIYW5kbGVRdWVyeShyLGUpKXJldHVybiB0LnR5cGU9ImluZGV4X3NjYW4iLHQuaW5kZXhlcz1bbl0sdC5pbmRleFNjYW5zPVt7aW5kZXhOYW1lOm4saW5kZXg6cixxdWVyeTplfV0sdC5lc3RpbWF0ZWRDb3N0PTUwLHQ7cmV0dXJuIHR9YXN5bmMgX2V4ZWN1dGVJbmRleFNjYW4oZSl7Y29uc3R7aW5kZXg6dCxxdWVyeTpuLHRleHRRdWVyeTpyfT1lO2lmKCJmdW5jdGlvbiIhPXR5cGVvZiB0Lm9wZW58fHZvaWQgMD09PXQuaXNPcGVufHx0LmlzT3Blbnx8YXdhaXQgdC5vcGVuKCksdm9pZCAwIT09cilyZXR1cm4gYXdhaXQgdC5zZWFyY2gocik7aWYodm9pZCAwIT09bil7Y29uc3QgZT1hd2FpdCB0LnF1ZXJ5KG4pO3JldHVybiBudWxsIT09ZT9lOltdfXJldHVybiB2b2lkIDAhPT1lLmRvY0lkcz9lLmRvY0lkczpbXX1fY2FuSW5kZXhIYW5kbGVRdWVyeShlLHQpe2NvbnN0IG49T2JqZWN0LmtleXModCkscj1PYmplY3Qua2V5cyhlLmtleXMpO2lmKDEhPT1yLmxlbmd0aClyZXR1cm4hMTtjb25zdCBpPXJbMF07cmV0dXJuLTEhPT1uLmluZGV4T2YoaSl9YXN5bmMgZXhlY3V0ZShlKXtpZigiZnVsbF9zY2FuIj09PWUudHlwZSlyZXR1cm4gbnVsbDtpZigiaW5kZXhfc2NhbiI9PT1lLnR5cGUpe2NvbnN0IHQ9ZS5pbmRleFNjYW5zWzBdO3JldHVybiBhd2FpdCB0aGlzLl9leGVjdXRlSW5kZXhTY2FuKHQpfWlmKCJpbmRleF9pbnRlcnNlY3Rpb24iPT09ZS50eXBlKXtpZigwPT09ZS5pbmRleFNjYW5zLmxlbmd0aClyZXR1cm4gbnVsbDtjb25zdCB0PVtdO2Zvcihjb25zdCBpIG9mIGUuaW5kZXhTY2Fucyl0LnB1c2goe2RvY0lkczphd2FpdCB0aGlzLl9leGVjdXRlSW5kZXhTY2FuKGkpLGluZGV4TmFtZTppLmluZGV4TmFtZX0pO2NvbnN0IG49dC5zbGljZSgpLnNvcnQoKGUsdCk9PmUuZG9jSWRzLmxlbmd0aC10LmRvY0lkcy5sZW5ndGgpO2xldCByPW5ldyBTZXQoblswXS5kb2NJZHMpO2ZvcihsZXQgZT0xO2U8bi5sZW5ndGg7ZSsrKXtjb25zdCB0PW5ldyBTZXQobltlXS5kb2NJZHMpO2lmKHI9bmV3IFNldChbLi4ucl0uZmlsdGVyKGU9PnQuaGFzKGUpKSksMD09PXIuc2l6ZSlicmVha31yZXR1cm4gQXJyYXkuZnJvbShyKX1pZigiaW5kZXhfdW5pb24iPT09ZS50eXBlKXtjb25zdCB0PS8qIEBfX1BVUkVfXyAqL25ldyBTZXQ7Zm9yKGNvbnN0IG4gb2YgZS5pbmRleFNjYW5zKXsoYXdhaXQgdGhpcy5fZXhlY3V0ZUluZGV4U2NhbihuKSkuZm9yRWFjaChlPT50LmFkZChlKSl9cmV0dXJuIEFycmF5LmZyb20odCl9cmV0dXJuIG51bGx9fWNsYXNzIFV0IGV4dGVuZHMgbi5FdmVudEVtaXR0ZXJ7Y29uc3RydWN0b3IoZSx0PVtdLG49e30pe3N1cGVyKCksdGhpcy50YXJnZXQ9ZSx0aGlzLnBpcGVsaW5lPXQsdGhpcy5vcHRpb25zPW4sdGhpcy5jbG9zZWQ9ITEsdGhpcy5fbGlzdGVuZXJzPS8qIEBfX1BVUkVfXyAqL25ldyBNYXAsdGhpcy5fY2hhbmdlQ291bnRlcj0wLHRoaXMuX3N0YXJ0V2F0Y2hpbmcoKX1faXNEQihlKXtyZXR1cm4gZSYmInN0cmluZyI9PXR5cGVvZiBlLmRiTmFtZSYmImZ1bmN0aW9uIj09dHlwZW9mIGUuZ2V0Q29sbGVjdGlvbk5hbWVzJiZlLmNvbGxlY3Rpb25zIGluc3RhbmNlb2YgTWFwfV9pc1NlcnZlcihlKXtyZXR1cm4gZSYmZS5kYXRhYmFzZXMgaW5zdGFuY2VvZiBNYXAmJiJmdW5jdGlvbiI9PXR5cGVvZiBlLl9nZXREQn1faXNNb25nb0NsaWVudChlKXtyZXR1cm4gZSYmImZ1bmN0aW9uIj09dHlwZW9mIGUuY29ubmVjdCYmImZ1bmN0aW9uIj09dHlwZW9mIGUuZGImJiJNb25nb0NsaWVudCI9PT1lLmNvbnN0cnVjdG9yLm5hbWV9X3N0YXJ0V2F0Y2hpbmcoKXtpZih0aGlzLmNsb3NlZClyZXR1cm47Y29uc3QgZT10aGlzLl9nZXRDb2xsZWN0aW9uc1RvV2F0Y2goKTtmb3IoY29uc3QgdCBvZiBlKXRoaXMuX3dhdGNoQ29sbGVjdGlvbih0KTt0aGlzLl9pc1NlcnZlcih0aGlzLnRhcmdldCkmJnRoaXMuX2ludGVyY2VwdFNlcnZlckRCQ3JlYXRpb24oKSx0aGlzLl9pc0RCKHRoaXMudGFyZ2V0KSYmdGhpcy5faW50ZXJjZXB0REJDb2xsZWN0aW9uQ3JlYXRpb24oKSx0aGlzLl9pc01vbmdvQ2xpZW50KHRoaXMudGFyZ2V0KSYmdGhpcy5faW50ZXJjZXB0Q2xpZW50REJDcmVhdGlvbigpfV9nZXRDb2xsZWN0aW9uc1RvV2F0Y2goKXtjb25zdCBlPVtdO2lmKHRoaXMuX2lzU2VydmVyKHRoaXMudGFyZ2V0KSl7Zm9yKGNvbnN0W3Qsbl1vZiB0aGlzLnRhcmdldC5kYXRhYmFzZXMpe2NvbnN0IHQ9bi5nZXRDb2xsZWN0aW9uTmFtZXMoKTtmb3IoY29uc3QgciBvZiB0KXtjb25zdCB0PW5bcl07dCYmdC5pc0NvbGxlY3Rpb24mJmUucHVzaCh0KX19cmV0dXJuIGV9aWYodGhpcy5faXNNb25nb0NsaWVudCh0aGlzLnRhcmdldCkpcmV0dXJuIHRoaXMuX21vbml0b3JDbGllbnQoKSxlO2lmKHRoaXMuX2lzREIodGhpcy50YXJnZXQpKXtjb25zdCB0PXRoaXMudGFyZ2V0LmdldENvbGxlY3Rpb25OYW1lcygpO2Zvcihjb25zdCBuIG9mIHQpe2NvbnN0IHQ9dGhpcy50YXJnZXRbbl07dCYmdC5pc0NvbGxlY3Rpb24mJmUucHVzaCh0KX10aGlzLl9tb25pdG9yREIoKX1yZXR1cm4gdGhpcy50YXJnZXQuaXNDb2xsZWN0aW9uJiZlLnB1c2godGhpcy50YXJnZXQpLGV9X3dhdGNoQ29sbGVjdGlvbihlKXtpZih0aGlzLmNsb3NlZClyZXR1cm47aWYoIWUpcmV0dXJuO2lmKCJmdW5jdGlvbiIhPXR5cGVvZiBlLm9uKXJldHVybjtpZighZS5pc0NvbGxlY3Rpb24pcmV0dXJuO2lmKHRoaXMuX2xpc3RlbmVycy5oYXMoZSkpcmV0dXJuO2NvbnN0IHQ9e2luc2VydDp0PT50aGlzLl9lbWl0Q2hhbmdlKCJpbnNlcnQiLGUsdCksdXBkYXRlOih0LG4pPT50aGlzLl9lbWl0Q2hhbmdlKCJ1cGRhdGUiLGUsdCxuKSxyZXBsYWNlOnQ9PnRoaXMuX2VtaXRDaGFuZ2UoInJlcGxhY2UiLGUsdCksZGVsZXRlOnQ9PnRoaXMuX2VtaXRDaGFuZ2UoImRlbGV0ZSIsZSx0KX07dGhpcy5fbGlzdGVuZXJzLnNldChlLHQpLGUub24oImluc2VydCIsdC5pbnNlcnQpLGUub24oInVwZGF0ZSIsdC51cGRhdGUpLGUub24oInJlcGxhY2UiLHQucmVwbGFjZSksZS5vbigiZGVsZXRlIix0LmRlbGV0ZSl9X2VtaXRDaGFuZ2UoZSx0LG4scj1udWxsKXtpZih0aGlzLmNsb3NlZClyZXR1cm47Y29uc3QgaT10aGlzLl9jcmVhdGVDaGFuZ2VFdmVudChlLHQsbixyKTt0aGlzLl9tYXRjaGVzUGlwZWxpbmUoaSkmJnRoaXMuZW1pdCgiY2hhbmdlIixpKX1fY3JlYXRlQ2hhbmdlRXZlbnQoZSx0LG4scil7Y29uc3QgaT17X2lkOntfZGF0YTpidG9hKFN0cmluZygrK3RoaXMuX2NoYW5nZUNvdW50ZXIpKX0sb3BlcmF0aW9uVHlwZTplLGNsdXN0ZXJUaW1lOi8qIEBfX1BVUkVfXyAqL25ldyBEYXRlLG5zOntkYjp0LmRiLmRiTmFtZSxjb2xsOnQubmFtZX0sZG9jdW1lbnRLZXk6e19pZDpuLl9pZH19O3N3aXRjaChlKXtjYXNlImluc2VydCI6Y2FzZSJyZXBsYWNlIjppLmZ1bGxEb2N1bWVudD1uO2JyZWFrO2Nhc2UidXBkYXRlIjppLnVwZGF0ZURlc2NyaXB0aW9uPXJ8fHt1cGRhdGVkRmllbGRzOnt9LHJlbW92ZWRGaWVsZHM6W10sdHJ1bmNhdGVkQXJyYXlzOltdfSwidXBkYXRlTG9va3VwIj09PXRoaXMub3B0aW9ucy5mdWxsRG9jdW1lbnQmJihpLmZ1bGxEb2N1bWVudD1uKX1yZXR1cm4gaX1fbWF0Y2hlc1BpcGVsaW5lKGUpe2lmKCF0aGlzLnBpcGVsaW5lfHwwPT09dGhpcy5waXBlbGluZS5sZW5ndGgpcmV0dXJuITA7Zm9yKGNvbnN0IHQgb2YgdGhpcy5waXBlbGluZSlpZih0LiRtYXRjaCYmIVllKGUsdC4kbWF0Y2gpKXJldHVybiExO3JldHVybiEwfV9nZXROZXN0ZWRWYWx1ZShlLHQpe3JldHVybiB0LnNwbGl0KCIuIikucmVkdWNlKChlLHQpPT5lPy5bdF0sZSl9X21vbml0b3JDbGllbnQoKXt9X2ludGVyY2VwdENsaWVudERCQ3JlYXRpb24oKXtjb25zdCBlPXRoaXMudGFyZ2V0LHQ9ZS5kYi5iaW5kKGUpLG49dGhpczt0aGlzLl93YXRjaGVkREJzPS8qIEBfX1BVUkVfXyAqL25ldyBNYXAsZS5kYj1mdW5jdGlvbihlLHIpe2NvbnN0IGk9dChlLHIpLHM9aS5kYk5hbWU7aWYoIW4uX3dhdGNoZWREQnMuaGFzKHMpKXtuLl93YXRjaGVkREJzLnNldChzLGkpO2NvbnN0IGU9aS5nZXRDb2xsZWN0aW9uTmFtZXMoKTtmb3IoY29uc3QgdCBvZiBlKXtjb25zdCBlPWlbdF07ZSYmZS5pc0NvbGxlY3Rpb24mJiFuLl9saXN0ZW5lcnMuaGFzKGUpJiZuLl93YXRjaENvbGxlY3Rpb24oZSl9bi5faW50ZXJjZXB0REJDb2xsZWN0aW9uQ3JlYXRpb25Gb3JDbGllbnQoaSl9cmV0dXJuIGl9LHRoaXMuX29yaWdpbmFsQ2xpZW50TWV0aG9kcz17ZGI6dH19X2ludGVyY2VwdFNlcnZlckRCQ3JlYXRpb24oKXtjb25zdCBlPXRoaXMudGFyZ2V0LHQ9ZS5fZ2V0REIuYmluZChlKSxuPXRoaXM7dGhpcy5fd2F0Y2hlZERCcz0vKiBAX19QVVJFX18gKi9uZXcgTWFwLGUuX2dldERCPWZ1bmN0aW9uKGUpe2NvbnN0IHI9dChlKTtpZighbi5fd2F0Y2hlZERCcy5oYXMoZSkpe24uX3dhdGNoZWREQnMuc2V0KGUscik7Y29uc3QgdD1yLmdldENvbGxlY3Rpb25OYW1lcygpO2Zvcihjb25zdCBlIG9mIHQpe2NvbnN0IHQ9cltlXTt0JiZ0LmlzQ29sbGVjdGlvbiYmIW4uX2xpc3RlbmVycy5oYXModCkmJm4uX3dhdGNoQ29sbGVjdGlvbih0KX1uLl9pbnRlcmNlcHREQkNvbGxlY3Rpb25DcmVhdGlvbkZvclNlcnZlcihyKX1yZXR1cm4gcn0sdGhpcy5fb3JpZ2luYWxTZXJ2ZXJNZXRob2RzPXtfZ2V0REI6dH19X2ludGVyY2VwdERCQ29sbGVjdGlvbkNyZWF0aW9uRm9yU2VydmVyKGUpe2NvbnN0IHQ9ZS5jb2xsZWN0aW9uLmJpbmQoZSksbj1lLmNyZWF0ZUNvbGxlY3Rpb24uYmluZChlKSxyPXRoaXM7ZS5jb2xsZWN0aW9uPWZ1bmN0aW9uKGUpe2NvbnN0IG49dChlKTtyZXR1cm4gbiYmbi5pc0NvbGxlY3Rpb24mJiFyLl9saXN0ZW5lcnMuaGFzKG4pJiZyLl93YXRjaENvbGxlY3Rpb24obiksbn0sZS5jcmVhdGVDb2xsZWN0aW9uPWZ1bmN0aW9uKHQpe24odCk7Y29uc3QgaT1lW3RdO2kmJmkuaXNDb2xsZWN0aW9uJiYhci5fbGlzdGVuZXJzLmhhcyhpKSYmci5fd2F0Y2hDb2xsZWN0aW9uKGkpfX1faW50ZXJjZXB0REJDb2xsZWN0aW9uQ3JlYXRpb25Gb3JDbGllbnQoZSl7Y29uc3QgdD1lLmNvbGxlY3Rpb24uYmluZChlKSxuPWUuY3JlYXRlQ29sbGVjdGlvbi5iaW5kKGUpLHI9dGhpcztlLmNvbGxlY3Rpb249ZnVuY3Rpb24oZSl7Y29uc3Qgbj10KGUpO3JldHVybiBuJiZuLmlzQ29sbGVjdGlvbiYmIXIuX2xpc3RlbmVycy5oYXMobikmJnIuX3dhdGNoQ29sbGVjdGlvbihuKSxufSxlLmNyZWF0ZUNvbGxlY3Rpb249ZnVuY3Rpb24odCl7bih0KTtjb25zdCBpPWVbdF07aSYmaS5pc0NvbGxlY3Rpb24mJiFyLl9saXN0ZW5lcnMuaGFzKGkpJiZyLl93YXRjaENvbGxlY3Rpb24oaSl9fV9tb25pdG9yREIoKXt9X2ludGVyY2VwdERCQ29sbGVjdGlvbkNyZWF0aW9uKCl7Y29uc3QgZT10aGlzLnRhcmdldCx0PWUuZ2V0Q29sbGVjdGlvbi5iaW5kKGUpLG49ZS5jcmVhdGVDb2xsZWN0aW9uP2UuY3JlYXRlQ29sbGVjdGlvbi5iaW5kKGUpOm51bGwscj10aGlzO2UuZ2V0Q29sbGVjdGlvbj1mdW5jdGlvbihlKXtjb25zdCBuPXQoZSk7cmV0dXJuIG4mJm4uaXNDb2xsZWN0aW9uJiYhci5fbGlzdGVuZXJzLmhhcyhuKSYmci5fd2F0Y2hDb2xsZWN0aW9uKG4pLG59LG4mJihlLmNyZWF0ZUNvbGxlY3Rpb249ZnVuY3Rpb24odCl7bih0KTtjb25zdCBpPWVbdF07aSYmaS5pc0NvbGxlY3Rpb24mJiFyLl9saXN0ZW5lcnMuaGFzKGkpJiZyLl93YXRjaENvbGxlY3Rpb24oaSl9KSx0aGlzLl9vcmlnaW5hbERCTWV0aG9kcz17Z2V0Q29sbGVjdGlvbjp0LGNyZWF0ZUNvbGxlY3Rpb246bn19Y2xvc2UoKXtpZighdGhpcy5jbG9zZWQpe3RoaXMuY2xvc2VkPSEwO2Zvcihjb25zdFtlLHRdb2YgdGhpcy5fbGlzdGVuZXJzKWUub2ZmKCJpbnNlcnQiLHQuaW5zZXJ0KSxlLm9mZigidXBkYXRlIix0LnVwZGF0ZSksZS5vZmYoInJlcGxhY2UiLHQucmVwbGFjZSksZS5vZmYoImRlbGV0ZSIsdC5kZWxldGUpO3RoaXMuX2xpc3RlbmVycy5jbGVhcigpLHRoaXMuX29yaWdpbmFsU2VydmVyTWV0aG9kcyYmIlNlcnZlciI9PT10aGlzLnRhcmdldC5jb25zdHJ1Y3Rvci5uYW1lJiYodGhpcy50YXJnZXQuX2dldERCPXRoaXMuX29yaWdpbmFsU2VydmVyTWV0aG9kcy5fZ2V0REIpLHRoaXMuX29yaWdpbmFsREJNZXRob2RzJiYiREIiPT09dGhpcy50YXJnZXQuY29uc3RydWN0b3IubmFtZSYmKHRoaXMudGFyZ2V0LmNvbGxlY3Rpb249dGhpcy5fb3JpZ2luYWxEQk1ldGhvZHMuY29sbGVjdGlvbix0aGlzLnRhcmdldC5jcmVhdGVDb2xsZWN0aW9uPXRoaXMuX29yaWdpbmFsREJNZXRob2RzLmNyZWF0ZUNvbGxlY3Rpb24pLHRoaXMuX29yaWdpbmFsQ2xpZW50TWV0aG9kcyYmIk1vbmdvQ2xpZW50Ij09PXRoaXMudGFyZ2V0LmNvbnN0cnVjdG9yLm5hbWUmJih0aGlzLnRhcmdldC5kYj10aGlzLl9vcmlnaW5hbENsaWVudE1ldGhvZHMuZGIpLHRoaXMuZW1pdCgiY2xvc2UiKSx0aGlzLnJlbW92ZUFsbExpc3RlbmVycygpfX1nZXQgaXNDbG9zZWQoKXtyZXR1cm4gdGhpcy5jbG9zZWR9YXN5bmMqW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSgpe2NvbnN0IGU9W107bGV0IHQ9bnVsbCxuPSExO2NvbnN0IHI9bj0+e3Q/KHQoe3ZhbHVlOm4sZG9uZTohMX0pLHQ9bnVsbCk6ZS5wdXNoKG4pfSxpPSgpPT57bj0hMCx0JiYodCh7ZG9uZTohMH0pLHQ9bnVsbCl9LHM9ZT0+e3QmJih0KFByb21pc2UucmVqZWN0KGUpKSx0PW51bGwpfTt0aGlzLm9uKCJjaGFuZ2UiLHIpLHRoaXMub24oImNsb3NlIixpKSx0aGlzLm9uKCJlcnJvciIscyk7dHJ5e2Zvcig7IW47KWlmKGUubGVuZ3RoPjApeWllbGQgZS5zaGlmdCgpO2Vsc2V7Y29uc3QgZT1hd2FpdCBuZXcgUHJvbWlzZShlPT57dD1lLG4mJmUoe2RvbmU6ITB9KX0pO2lmKGUuZG9uZSlicmVhazt5aWVsZCBlLnZhbHVlfX1maW5hbGx5e3RoaXMub2ZmKCJjaGFuZ2UiLHIpLHRoaXMub2ZmKCJjbG9zZSIsaSksdGhpcy5vZmYoImVycm9yIixzKX19YXN5bmMgbmV4dCgpe3JldHVybiBuZXcgUHJvbWlzZSgoZSx0KT0+e2NvbnN0IG49dD0+e3MoKSxlKHQpfSxyPSgpPT57cygpLGUobnVsbCl9LGk9ZT0+e3MoKSx0KGUpfSxzPSgpPT57dGhpcy5vZmYoImNoYW5nZSIsbiksdGhpcy5vZmYoImNsb3NlIixyKSx0aGlzLm9mZigiZXJyb3IiLGkpfTt0aGlzLmNsb3NlZD9lKG51bGwpOih0aGlzLm9uY2UoImNoYW5nZSIsbiksdGhpcy5vbmNlKCJjbG9zZSIsciksdGhpcy5vbmNlKCJlcnJvciIsaSkpfSl9fWNvbnN0IFJ0PW5ldyBjbGFzc3tjb25zdHJ1Y3RvcihlPSExKXt0aGlzLmVuYWJsZWQ9ZSx0aGlzLnRpbWluZ3M9W10sdGhpcy5uZXN0ZWRMZXZlbD0wfXNldEVuYWJsZWQoZSl7dGhpcy5lbmFibGVkPWV9c3RhcnQoZSx0LG49e30pe3JldHVybiB0aGlzLmVuYWJsZWQ/e2NhdGVnb3J5OmUsb3BlcmF0aW9uOnQsZGV0YWlsczpuLHN0YXJ0VGltZTpwZXJmb3JtYW5jZS5ub3coKSxuZXN0ZWRMZXZlbDp0aGlzLm5lc3RlZExldmVsKyt9Om51bGx9ZW5kKGUsdD17fSl7aWYoIXRoaXMuZW5hYmxlZHx8IWUpcmV0dXJuO3RoaXMubmVzdGVkTGV2ZWw+MCYmdGhpcy5uZXN0ZWRMZXZlbC0tO2NvbnN0IG49cGVyZm9ybWFuY2Uubm93KCktZS5zdGFydFRpbWU7dGhpcy50aW1pbmdzLnB1c2goe2NhdGVnb3J5OmUuY2F0ZWdvcnksb3BlcmF0aW9uOmUub3BlcmF0aW9uLGR1cmF0aW9uOm4sZGV0YWlsczp7Li4uZS5kZXRhaWxzLC4uLnR9LG5lc3RlZExldmVsOmUubmVzdGVkTGV2ZWwsdGltZXN0YW1wOmUuc3RhcnRUaW1lfSl9Z2V0VGltaW5ncygpe3JldHVybiB0aGlzLnRpbWluZ3N9Z2V0VGltaW5nc0J5Q2F0ZWdvcnkoKXtjb25zdCBlPXt9O2Zvcihjb25zdCB0IG9mIHRoaXMudGltaW5ncyllW3QuY2F0ZWdvcnldfHwoZVt0LmNhdGVnb3J5XT1bXSksZVt0LmNhdGVnb3J5XS5wdXNoKHQpO3JldHVybiBlfWdldFN1bW1hcnkoKXtjb25zdCBlPXt9O2Zvcihjb25zdCB0IG9mIHRoaXMudGltaW5ncyl7Y29uc3Qgbj1gJHt0LmNhdGVnb3J5fS4ke3Qub3BlcmF0aW9ufWA7ZVtuXXx8KGVbbl09e2NhdGVnb3J5OnQuY2F0ZWdvcnksb3BlcmF0aW9uOnQub3BlcmF0aW9uLGNvdW50OjAsdG90YWw6MCxtaW46MS8wLG1heDotMS8wLGF2ZzowfSk7Y29uc3Qgcj1lW25dO3IuY291bnQrKyxyLnRvdGFsKz10LmR1cmF0aW9uLHIubWluPU1hdGgubWluKHIubWluLHQuZHVyYXRpb24pLHIubWF4PU1hdGgubWF4KHIubWF4LHQuZHVyYXRpb24pLHIuYXZnPXIudG90YWwvci5jb3VudH1yZXR1cm4gT2JqZWN0LnZhbHVlcyhlKX1jbGVhcigpe3RoaXMudGltaW5ncz1bXSx0aGlzLm5lc3RlZExldmVsPTB9Zm9ybWF0VGltaW5ncygpe2NvbnN0IGU9dGhpcy5nZXRTdW1tYXJ5KCk7aWYoMD09PWUubGVuZ3RoKXJldHVybiJObyB0aW1pbmcgZGF0YSBjb2xsZWN0ZWQiO2xldCB0PSJcbiIrIj0iLnJlcGVhdCg4MCkrIlxuIjt0Kz0iUEVSRk9STUFOQ0UgVElNSU5HIFJFUE9SVFxuIix0Kz0iPSIucmVwZWF0KDgwKSsiXG5cbiI7Y29uc3Qgbj17fTtmb3IoY29uc3QgciBvZiBlKW5bci5jYXRlZ29yeV18fChuW3IuY2F0ZWdvcnldPVtdKSxuW3IuY2F0ZWdvcnldLnB1c2gocik7Zm9yKGNvbnN0W3IsaV1vZiBPYmplY3QuZW50cmllcyhuKSl7dCs9YCR7ci50b1VwcGVyQ2FzZSgpfVxuYCx0Kz0iLSIucmVwZWF0KDgwKSsiXG4iLHQrPSJPcGVyYXRpb24iLnBhZEVuZCgzMCkrIkNvdW50Ii5wYWRTdGFydCg4KSsiVG90YWwobXMpIi5wYWRTdGFydCgxMikrIkF2ZyhtcykiLnBhZFN0YXJ0KDEyKSsiTWluKG1zKSIucGFkU3RhcnQoMTIpKyJNYXgobXMpIi5wYWRTdGFydCgxMikrIlxuIix0Kz0iLSIucmVwZWF0KDgwKSsiXG4iO2Zvcihjb25zdCBlIG9mIGkpdCs9ZS5vcGVyYXRpb24ucGFkRW5kKDMwKStlLmNvdW50LnRvU3RyaW5nKCkucGFkU3RhcnQoOCkrZS50b3RhbC50b0ZpeGVkKDMpLnBhZFN0YXJ0KDEyKStlLmF2Zy50b0ZpeGVkKDMpLnBhZFN0YXJ0KDEyKStlLm1pbi50b0ZpeGVkKDMpLnBhZFN0YXJ0KDEyKStlLm1heC50b0ZpeGVkKDMpLnBhZFN0YXJ0KDEyKSsiXG4iO3QrPSJcbiJ9cmV0dXJuIHQrPSI9Ii5yZXBlYXQoODApKyJcbiIsdH19KCExKTtjbGFzcyBxdCBleHRlbmRzIG4uRXZlbnRFbWl0dGVye2NvbnN0cnVjdG9yKGUsdCxuPXt9KXtzdXBlcigpLHRoaXMuZGI9ZSx0aGlzLm5hbWU9dCx0aGlzLnBhdGg9YCR7dGhpcy5kYi5iYXNlRm9sZGVyfS8ke3RoaXMuZGIuZGJOYW1lfS8ke3RoaXMubmFtZX1gLHRoaXMuZG9jdW1lbnRzUGF0aD1gJHt0aGlzLnBhdGh9L2RvY3VtZW50cy5ianNvbmAsdGhpcy5kb2N1bWVudHNWZXJzaW9uZWRQYXRoPW51bGwsdGhpcy5kb2N1bWVudHNWZXJzaW9uPTAsdGhpcy5fcmVsZWFzZURvY3VtZW50cz1udWxsLHRoaXMub3JkZXI9bi5iUGx1c1RyZWVPcmRlcnx8NTAsdGhpcy5kb2N1bWVudHM9bnVsbCx0aGlzLmluZGV4ZXM9LyogQF9fUFVSRV9fICovbmV3IE1hcCx0aGlzLl9pbml0aWFsaXplZD0hMSx0aGlzLmlzQ29sbGVjdGlvbj0hMCx0aGlzLnF1ZXJ5UGxhbm5lcj1uZXcgenQodGhpcy5pbmRleGVzKX1hc3luYyBfaW5pdGlhbGl6ZSgpe2lmKHRoaXMuX2luaXRpYWxpemVkKXJldHVybjtpZighZ2xvYmFsVGhpcy5uYXZpZ2F0b3J8fCFnbG9iYWxUaGlzLm5hdmlnYXRvci5zdG9yYWdlfHwiZnVuY3Rpb24iIT10eXBlb2YgZ2xvYmFsVGhpcy5uYXZpZ2F0b3Iuc3RvcmFnZS5nZXREaXJlY3RvcnkpdGhyb3cgbmV3IEVycm9yKCJPUEZTIG5vdCBhdmFpbGFibGU6IG5hdmlnYXRvci5zdG9yYWdlLmdldERpcmVjdG9yeSBpcyBtaXNzaW5nIik7Y29uc3R7dmVyc2lvbjplLHBhdGg6dH09YXdhaXQgdnQodGhpcy5kb2N1bWVudHNQYXRoKTt0aGlzLmRvY3VtZW50c1ZlcnNpb249ZSx0aGlzLmRvY3VtZW50c1ZlcnNpb25lZFBhdGg9dCx0aGlzLl9yZWxlYXNlRG9jdW1lbnRzPSgpPT4kdCh0aGlzLmRvY3VtZW50c1BhdGgsZSk7bGV0IG49YXdhaXQgdGhpcy5fZW5zdXJlRGlyZWN0b3J5Rm9yRmlsZSh0aGlzLmRvY3VtZW50c1ZlcnNpb25lZFBhdGgpO258fChuPWF3YWl0IGdsb2JhbFRoaXMubmF2aWdhdG9yLnN0b3JhZ2UuZ2V0RGlyZWN0b3J5KCkpO2NvbnN0IHI9dGhpcy5kb2N1bWVudHNWZXJzaW9uZWRQYXRoLnNwbGl0KCIvIikuZmlsdGVyKEJvb2xlYW4pLGk9cltyLmxlbmd0aC0xXTtpZighaSl0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgZG9jdW1lbnRzIHBhdGg6ICR7dGhpcy5kb2N1bWVudHNWZXJzaW9uZWRQYXRofWApO2NvbnN0IHM9YXdhaXQgbi5nZXRGaWxlSGFuZGxlKGkse2NyZWF0ZTohMH0pLG89YXdhaXQgcy5jcmVhdGVTeW5jQWNjZXNzSGFuZGxlKCk7dGhpcy5kb2N1bWVudHM9bmV3IHhlKG8sdGhpcy5vcmRlciksYXdhaXQgdGhpcy5kb2N1bWVudHMub3BlbigpLGF3YWl0IHRoaXMuX2xvYWRJbmRleGVzKCksdGhpcy5faW5pdGlhbGl6ZWQ9ITB9YXN5bmMgX2Vuc3VyZURpcmVjdG9yeUZvckZpbGUoZSl7aWYoIWUpcmV0dXJuO2NvbnN0IHQ9ZS5zcGxpdCgiLyIpLmZpbHRlcihCb29sZWFuKTtpZih0LnBvcCgpLDAhPT10Lmxlbmd0aCl0cnl7bGV0IGU9YXdhaXQgZ2xvYmFsVGhpcy5uYXZpZ2F0b3Iuc3RvcmFnZS5nZXREaXJlY3RvcnkoKTtmb3IoY29uc3QgbiBvZiB0KWU9YXdhaXQgZS5nZXREaXJlY3RvcnlIYW5kbGUobix7Y3JlYXRlOiEwfSk7cmV0dXJuIGV9Y2F0Y2gobil7aWYoIkVFWElTVCIhPT1uLmNvZGUpdGhyb3cgbn19YXN5bmMgX2xvYWRJbmRleGVzKCl7bGV0IGU7dHJ5e2NvbnN0IHQ9dGhpcy5wYXRoLnNwbGl0KCIvIikuZmlsdGVyKEJvb2xlYW4pO2xldCBuPWF3YWl0IGdsb2JhbFRoaXMubmF2aWdhdG9yLnN0b3JhZ2UuZ2V0RGlyZWN0b3J5KCk7Zm9yKGNvbnN0IGUgb2YgdCluPWF3YWl0IG4uZ2V0RGlyZWN0b3J5SGFuZGxlKGUse2NyZWF0ZTohMX0pO2U9bn1jYXRjaCh0KXtpZigiTm90Rm91bmRFcnJvciI9PT10Py5uYW1lfHwiRU5PRU5UIj09PXQ/LmNvZGUpcmV0dXJuO3Rocm93IHR9Zm9yIGF3YWl0KGNvbnN0W24scl1vZiBlLmVudHJpZXMoKSl7aWYoImZpbGUiIT09ci5raW5kKWNvbnRpbnVlO2NvbnN0IGU9L1wudlxkKyg/PS18JCkvLGk9bi5yZXBsYWNlKGUsIiIpO2xldCBzO2lmKGkuZW5kc1dpdGgoIi50ZXh0aW5kZXgtZG9jdW1lbnRzLmJqc29uIikpcz0idGV4dCI7ZWxzZSBpZihpLmVuZHNXaXRoKCIucnRyZWUuYmpzb24iKSlzPSJnZW9zcGF0aWFsIjtlbHNle2lmKCFpLmVuZHNXaXRoKCIuYnBsdXN0cmVlLmJqc29uIikpY29udGludWU7cz0icmVndWxhciJ9Y29uc3Qgbz1pLnJlcGxhY2UoL1wudGV4dGluZGV4LWRvY3VtZW50c1wuYmpzb24kLywiIikucmVwbGFjZSgvXC5ydHJlZVwuYmpzb24kLywiIikucmVwbGFjZSgvXC5icGx1c3RyZWVcLmJqc29uJC8sIiIpO2lmKHRoaXMuaW5kZXhlcy5oYXMobykpY29udGludWU7Y29uc3QgYT10aGlzLl9wYXJzZUluZGV4TmFtZShvLHMpO2lmKCFhKWNvbnRpbnVlO2xldCBjO2lmKCJ0ZXh0Ij09PXMpe2NvbnN0IGU9YXdhaXQgdGhpcy5fZ2V0SW5kZXhQYXRoKG8scyk7Yz1uZXcgRXQobyxhLGUse30pfWVsc2UgaWYoImdlb3NwYXRpYWwiPT09cyl7Y29uc3QgZT1hd2FpdCB0aGlzLl9nZXRJbmRleFBhdGgobyxzKTtjPW5ldyBGdChvLGEsZSx7fSl9ZWxzZXtjb25zdCBlPWF3YWl0IHRoaXMuX2dldEluZGV4UGF0aChvLHMpO2M9bmV3IEF0KG8sYSxlLHt9KX10cnl7YXdhaXQgYy5vcGVuKCksdGhpcy5pbmRleGVzLnNldChvLGMpfWNhdGNoKHQpe319fV9wYXJzZUluZGV4TmFtZShlLHQpe2NvbnN0IG49ZS5zcGxpdCgiXyIpO2lmKG4ubGVuZ3RoPDJ8fG4ubGVuZ3RoJTIhPTApcmV0dXJuIG51bGw7Y29uc3Qgcj17fTtmb3IobGV0IGk9MDtpPG4ubGVuZ3RoO2krPTIpe2NvbnN0IGU9bltpXSxzPW5baSsxXTtpZighZXx8dm9pZCAwPT09cylyZXR1cm4gbnVsbDtpZigidGV4dCI9PT10fHwidGV4dCI9PT1zKXJbZV09InRleHQiO2Vsc2UgaWYoImdlb3NwYXRpYWwiPT09dHx8IjJkc3BoZXJlIj09PXN8fCIyZCI9PT1zKXJbZV09IjJkIj09PXM/IjJkIjoiMmRzcGhlcmUiO2Vsc2V7Y29uc3QgdD1OdW1iZXIocyk7aWYoTnVtYmVyLmlzTmFOKHQpfHwxIT09dCYmLTEhPT10KXJldHVybiBudWxsO3JbZV09dH19cmV0dXJuIHJ9YXN5bmMgY2xvc2UoKXtpZih0aGlzLl9pbml0aWFsaXplZCl7Zm9yKGNvbnN0W2UsdF1vZiB0aGlzLmluZGV4ZXMpYXdhaXQgdC5jbG9zZSgpO2F3YWl0IHRoaXMuX21heWJlQ29tcGFjdERvY3VtZW50cygpLGF3YWl0IHRoaXMuZG9jdW1lbnRzLmNsb3NlKCksdGhpcy5fcmVsZWFzZURvY3VtZW50cyYmKGF3YWl0IHRoaXMuX3JlbGVhc2VEb2N1bWVudHMoKSx0aGlzLl9yZWxlYXNlRG9jdW1lbnRzPW51bGwpfX1hc3luYyBfbWF5YmVDb21wYWN0RG9jdW1lbnRzKCl7aWYoIXRoaXMuZG9jdW1lbnRzfHwhdGhpcy5kb2N1bWVudHMuZmlsZSlyZXR1cm47Y29uc3QgZT1hd2FpdCBOdCh0aGlzLmRvY3VtZW50c1BhdGgpO2lmKGUhPT10aGlzLmRvY3VtZW50c1ZlcnNpb24pcmV0dXJuO2NvbnN0IHQ9dGhpcy5kb2N1bWVudHMuZmlsZS5nZXRGaWxlU2l6ZSgpO2lmKCF0fHx0PGZ0KXJldHVybjtjb25zdCBuPWUrMSxyPWR0KHRoaXMuZG9jdW1lbnRzUGF0aCxuKSxpPWF3YWl0IE90KHIse3Jlc2V0OiEwfSk7YXdhaXQgdGhpcy5kb2N1bWVudHMuY29tcGFjdChpKSxhd2FpdCBJdCh0aGlzLmRvY3VtZW50c1BhdGgsbixlKX1nZW5lcmF0ZUluZGV4TmFtZShlKXtjb25zdCB0PVtdO2Zvcihjb25zdCBuIGluIGUpZS5oYXNPd25Qcm9wZXJ0eShuKSYmdC5wdXNoKG4rIl8iK2Vbbl0pO3JldHVybiB0LmpvaW4oIl8iKX1pc1RleHRJbmRleChlKXtmb3IoY29uc3QgdCBpbiBlKWlmKCJ0ZXh0Ij09PWVbdF0pcmV0dXJuITA7cmV0dXJuITF9aXNHZW9zcGF0aWFsSW5kZXgoZSl7Zm9yKGNvbnN0IHQgaW4gZSlpZigiMmRzcGhlcmUiPT09ZVt0XXx8IjJkIj09PWVbdF0pcmV0dXJuITA7cmV0dXJuITF9YXN5bmMgX2dldEluZGV4UGF0aChlLHQpe2NvbnN0IG49U3RyaW5nKGUpLnJlcGxhY2UoL1teYS16QS1aMC05Xy1dL2csIl8iKTtyZXR1cm4idGV4dCI9PT10P2Ake3RoaXMucGF0aH0vJHtufS50ZXh0aW5kZXhgOiJnZW9zcGF0aWFsIj09PXQ/YCR7dGhpcy5wYXRofS8ke259LnJ0cmVlLmJqc29uYDpgJHt0aGlzLnBhdGh9LyR7bn0uYnBsdXN0cmVlLmJqc29uYH1hc3luYyBfYnVpbGRJbmRleChlLHQsbj17fSl7bGV0IHIsaSxzO3RoaXMuX2luaXRpYWxpemVkfHxhd2FpdCB0aGlzLl9pbml0aWFsaXplKCksdGhpcy5pc1RleHRJbmRleCh0KT8ocz0idGV4dCIsaT1hd2FpdCB0aGlzLl9nZXRJbmRleFBhdGgoZSxzKSxyPW5ldyBFdChlLHQsaSxuKSk6dGhpcy5pc0dlb3NwYXRpYWxJbmRleCh0KT8ocz0iZ2Vvc3BhdGlhbCIsaT1hd2FpdCB0aGlzLl9nZXRJbmRleFBhdGgoZSxzKSxyPW5ldyBGdChlLHQsaSxuKSk6KHM9InJlZ3VsYXIiLGk9YXdhaXQgdGhpcy5fZ2V0SW5kZXhQYXRoKGUscykscj1uZXcgQXQoZSx0LGksbikpLGF3YWl0IHIub3BlbigpLCJmdW5jdGlvbiI9PXR5cGVvZiByLmNsZWFyJiZhd2FpdCByLmNsZWFyKCk7Zm9yIGF3YWl0KGNvbnN0IG8gb2YgdGhpcy5kb2N1bWVudHMpbyYmby52YWx1ZSYmYXdhaXQgci5hZGQoby52YWx1ZSk7cmV0dXJuIHRoaXMuaW5kZXhlcy5zZXQoZSxyKSxyfWFzeW5jIHVwZGF0ZUluZGV4ZXNPbkluc2VydChlKXtjb25zdCB0PVtdO2Zvcihjb25zdFtuLHJdb2YgdGhpcy5pbmRleGVzKXQucHVzaCgoYXN5bmMoKT0+e2F3YWl0IHRoaXMuX2Vuc3VyZUluZGV4T3BlbihyKSxhd2FpdCByLmFkZChlKX0pKCkpO3QubGVuZ3RoPjAmJmF3YWl0IFByb21pc2UuYWxsKHQpfWFzeW5jIHVwZGF0ZUluZGV4ZXNPbkRlbGV0ZShlKXtjb25zdCB0PVtdO2Zvcihjb25zdFtuLHJdb2YgdGhpcy5pbmRleGVzKXQucHVzaCgoYXN5bmMoKT0+e2F3YWl0IHRoaXMuX2Vuc3VyZUluZGV4T3BlbihyKSxhd2FpdCByLnJlbW92ZShlKX0pKCkpO3QubGVuZ3RoPjAmJmF3YWl0IFByb21pc2UuYWxsKHQpfWFzeW5jIF9lbnN1cmVJbmRleE9wZW4oZSl7ZSYmImZ1bmN0aW9uIj09dHlwZW9mIGUub3BlbiYmIWUuaXNPcGVuJiZhd2FpdCBlLm9wZW4oKX1wbGFuUXVlcnkoZSl7Y29uc3QgdD10aGlzLnF1ZXJ5UGxhbm5lci5wbGFuKGUpO3JldHVybnt1c2VJbmRleDoiZnVsbF9zY2FuIiE9PXQudHlwZSxwbGFuVHlwZTp0LnR5cGUsaW5kZXhOYW1lczp0LmluZGV4ZXMsZG9jSWRzOm51bGwsZXN0aW1hdGVkQ29zdDp0LmVzdGltYXRlZENvc3QsaW5kZXhPbmx5OnQuaW5kZXhPbmx5fHwhMX19YXN5bmMgcGxhblF1ZXJ5QXN5bmMoZSl7Y29uc3QgdD10aGlzLnF1ZXJ5UGxhbm5lci5wbGFuKGUpLG49YXdhaXQgdGhpcy5xdWVyeVBsYW5uZXIuZXhlY3V0ZSh0KTtyZXR1cm57dXNlSW5kZXg6ImZ1bGxfc2NhbiIhPT10LnR5cGUscGxhblR5cGU6dC50eXBlLGluZGV4TmFtZXM6dC5pbmRleGVzLGRvY0lkczpuLGVzdGltYXRlZENvc3Q6dC5lc3RpbWF0ZWRDb3N0LGluZGV4T25seTp0LmluZGV4T25seXx8ITF9fWdldFRleHRJbmRleChlKXtmb3IoY29uc3RbdCxuXW9mIHRoaXMuaW5kZXhlcylpZihuIGluc3RhbmNlb2YgRXQmJm4uaW5kZXhlZEZpZWxkcy5pbmNsdWRlcyhlKSlyZXR1cm4gbjtyZXR1cm4gbnVsbH1hc3luYyBhZ2dyZWdhdGUoZSl7Y29uc3QgdD1SdC5zdGFydCgiY29sbGVjdGlvbiIsImFnZ3JlZ2F0ZSIse2NvbGxlY3Rpb246dGhpcy5uYW1lLHN0YWdlQ291bnQ6ZT8ubGVuZ3RofHwwfSk7aWYoIWV8fCFOKGUpKXRocm93IG5ldyBWKCJQaXBlbGluZSBtdXN0IGJlIGFuIGFycmF5Iix7Y29sbGVjdGlvbjp0aGlzLm5hbWUsY29kZTprfSk7Y29uc3Qgbj1SdC5zdGFydCgiY29sbGVjdGlvbiIsImFnZ3JlZ2F0ZS5sb2FkRG9jdW1lbnRzIik7bGV0IHI9W107Y29uc3QgaT10aGlzLmZpbmQoe30pO2Zvcihhd2FpdCBpLl9lbnN1cmVJbml0aWFsaXplZCgpO2F3YWl0IGkuaGFzTmV4dCgpOylyLnB1c2goYXdhaXQgaS5uZXh0KCkpO1J0LmVuZChuLHtkb2NDb3VudDpyLmxlbmd0aH0pO2ZvcihsZXQgcz0wO3M8ZS5sZW5ndGg7cysrKXtjb25zdCB0PWVbc10sbj1PYmplY3Qua2V5cyh0KTtpZigxIT09bi5sZW5ndGgpdGhyb3cgbmV3IFYoIkVhY2ggcGlwZWxpbmUgc3RhZ2UgbXVzdCBoYXZlIGV4YWN0bHkgb25lIGtleSIse2NvbGxlY3Rpb246dGhpcy5uYW1lLGNvZGU6a30pO2NvbnN0IGk9blswXSxvPXRbaV0sYT1SdC5zdGFydCgiY29sbGVjdGlvbiIsYGFnZ3JlZ2F0ZS4ke2l9YCx7aW5wdXREb2NzOnIubGVuZ3RofSk7aWYoIiRtYXRjaCI9PT1pKXtjb25zdCBlPVtdO2ZvcihsZXQgdD0wO3Q8ci5sZW5ndGg7dCsrKVllKHJbdF0sbykmJmUucHVzaChyW3RdKTtyPWUsUnQuZW5kKGEse291dHB1dERvY3M6ci5sZW5ndGh9KX1lbHNlIGlmKCIkcHJvamVjdCI9PT1pKXtjb25zdCBlPVtdO2ZvcihsZXQgdD0wO3Q8ci5sZW5ndGg7dCsrKWUucHVzaChWdChvLHJbdF0pKTtyPWUsUnQuZW5kKGEse291dHB1dERvY3M6ci5sZW5ndGh9KX1lbHNlIGlmKCIkYWRkRmllbGRzIj09PWl8fCIkc2V0Ij09PWkpe2NvbnN0IGU9W107Zm9yKGxldCB0PTA7dDxyLmxlbmd0aDt0Kyspe2NvbnN0IG49XyhyW3RdKTtmb3IoY29uc3QgZSBpbiBvKXtjb25zdCBpPW9bZV07bltlXT1JZShpLHJbdF0pfWUucHVzaChuKX1yPWUsUnQuZW5kKGEse291dHB1dERvY3M6ci5sZW5ndGh9KX1lbHNlIGlmKCIkdW5zZXQiPT09aSl7Y29uc3QgZT1bXTtsZXQgdD1bXTsic3RyaW5nIj09dHlwZW9mIG8/dD1bb106QXJyYXkuaXNBcnJheShvKT90PW86Im9iamVjdCI9PXR5cGVvZiBvJiYodD1PYmplY3Qua2V5cyhvKSk7Zm9yKGxldCBuPTA7bjxyLmxlbmd0aDtuKyspe2NvbnN0IGk9XyhyW25dKTtmb3IobGV0IGU9MDtlPHQubGVuZ3RoO2UrKyl7Y29uc3Qgbj10W2VdLHI9bi5zcGxpdCgiLiIpO2lmKDE9PT1yLmxlbmd0aClkZWxldGUgaVtuXTtlbHNle2xldCBlPWk7Zm9yKGxldCB0PTA7dDxyLmxlbmd0aC0xJiYobnVsbCE9ZSYmbnVsbCE9ZSk7dCsrKWU9ZVtyW3RdXTtudWxsIT1lJiZudWxsIT1lJiZkZWxldGUgZVtyW3IubGVuZ3RoLTFdXX19ZS5wdXNoKGkpfXI9ZSxSdC5lbmQoYSx7b3V0cHV0RG9jczpyLmxlbmd0aH0pfWVsc2UgaWYoIiRzb3J0Ij09PWkpe2NvbnN0IGU9T2JqZWN0LmtleXMobyk7ci5zb3J0KGZ1bmN0aW9uKHQsbil7Zm9yKGxldCByPTA7cjxlLmxlbmd0aDtyKyspe2NvbnN0IGk9ZVtyXTtpZih2b2lkIDA9PT10W2ldJiZ2b2lkIDAhPT1uW2ldKXJldHVybi0xKm9baV07aWYodm9pZCAwIT09dFtpXSYmdm9pZCAwPT09bltpXSlyZXR1cm4gMSpvW2ldO2lmKHRbaV08bltpXSlyZXR1cm4tMSpvW2ldO2lmKHRbaV0+bltpXSlyZXR1cm4gMSpvW2ldfXJldHVybiAwfSksUnQuZW5kKGEse291dHB1dERvY3M6ci5sZW5ndGh9KX1lbHNlIGlmKCIkbGltaXQiPT09aSlyPXIuc2xpY2UoMCxvKSxSdC5lbmQoYSx7b3V0cHV0RG9jczpyLmxlbmd0aH0pO2Vsc2UgaWYoIiRza2lwIj09PWkpcj1yLnNsaWNlKG8pLFJ0LmVuZChhLHtvdXRwdXREb2NzOnIubGVuZ3RofSk7ZWxzZSBpZigiJGdyb3VwIj09PWkpe2NvbnN0IGU9e30sdD1vLl9pZDtmb3IobGV0IGk9MDtpPHIubGVuZ3RoO2krKyl7Y29uc3Qgbj1yW2ldO2xldCBzO3M9bnVsbD09dD9udWxsOkllKHQsbik7Y29uc3Qgbz1KU09OLnN0cmluZ2lmeShzKTtlW29dfHwoZVtvXT17X2lkOnMsZG9jczpbXSxhY2N1bXVsYXRvcnM6e319KSxlW29dLmRvY3MucHVzaChuKX1jb25zdCBuPVtdO2Zvcihjb25zdCByIGluIGUpe2NvbnN0IHQ9ZVtyXSxpPXtfaWQ6dC5faWR9O2Zvcihjb25zdCBlIGluIG8pe2lmKCJfaWQiPT09ZSljb250aW51ZTtjb25zdCBuPW9bZV0scj1PYmplY3Qua2V5cyhuKTtpZigxIT09ci5sZW5ndGgpY29udGludWU7Y29uc3Qgcz1yWzBdLGE9bltzXTtpZigiJHN1bSI9PT1zKXtsZXQgbj0wO2ZvcihsZXQgZT0wO2U8dC5kb2NzLmxlbmd0aDtlKyspe2NvbnN0IHI9SWUoYSx0LmRvY3NbZV0pOyJudW1iZXIiPT10eXBlb2Ygcj9uKz1yOm51bGwhPXImJihuKz1OdW1iZXIocil8fDApfWlbZV09bn1lbHNlIGlmKCIkYXZnIj09PXMpe2xldCBuPTAscj0wO2ZvcihsZXQgZT0wO2U8dC5kb2NzLmxlbmd0aDtlKyspe2NvbnN0IGk9SWUoYSx0LmRvY3NbZV0pO251bGwhPWkmJihuKz1OdW1iZXIoaSl8fDAscisrKX1pW2VdPXI+MD9uL3I6MH1lbHNlIGlmKCIkbWluIj09PXMpe2xldCBuO2ZvcihsZXQgZT0wO2U8dC5kb2NzLmxlbmd0aDtlKyspe2NvbnN0IHI9SWUoYSx0LmRvY3NbZV0pO3ZvaWQgMCE9PXImJih2b2lkIDA9PT1ufHxyPG4pJiYobj1yKX1pW2VdPW59ZWxzZSBpZigiJG1heCI9PT1zKXtsZXQgbjtmb3IobGV0IGU9MDtlPHQuZG9jcy5sZW5ndGg7ZSsrKXtjb25zdCByPUllKGEsdC5kb2NzW2VdKTt2b2lkIDAhPT1yJiYodm9pZCAwPT09bnx8cj5uKSYmKG49cil9aVtlXT1ufWVsc2UgaWYoIiRwdXNoIj09PXMpe2NvbnN0IG49W107Zm9yKGxldCBlPTA7ZTx0LmRvY3MubGVuZ3RoO2UrKyl7Y29uc3Qgcj1JZShhLHQuZG9jc1tlXSk7bi5wdXNoKHIpfWlbZV09bn1lbHNlIGlmKCIkYWRkVG9TZXQiPT09cyl7Y29uc3Qgbj17fTtmb3IobGV0IGU9MDtlPHQuZG9jcy5sZW5ndGg7ZSsrKXtjb25zdCByPUllKGEsdC5kb2NzW2VdKTtuW0pTT04uc3RyaW5naWZ5KHIpXT1yfWNvbnN0IHI9W107Zm9yKGNvbnN0IGUgaW4gbilyLnB1c2gobltlXSk7aVtlXT1yfWVsc2UgaWYoIiRmaXJzdCI9PT1zKXQuZG9jcy5sZW5ndGg+MCYmKGlbZV09SWUoYSx0LmRvY3NbMF0pKTtlbHNlIGlmKCIkbGFzdCI9PT1zKXQuZG9jcy5sZW5ndGg+MCYmKGlbZV09SWUoYSx0LmRvY3NbdC5kb2NzLmxlbmd0aC0xXSkpO2Vsc2UgaWYoIiRzdGREZXZQb3AiPT09cyl7Y29uc3Qgbj1bXTtmb3IobGV0IGU9MDtlPHQuZG9jcy5sZW5ndGg7ZSsrKXtjb25zdCByPUllKGEsdC5kb2NzW2VdKTsibnVtYmVyIj09dHlwZW9mIHImJm4ucHVzaChyKX1pZihuLmxlbmd0aD4wKXtjb25zdCB0PW4ucmVkdWNlKChlLHQpPT5lK3QsMCkvbi5sZW5ndGgscj1uLnJlZHVjZSgoZSxuKT0+ZStNYXRoLnBvdyhuLXQsMiksMCkvbi5sZW5ndGg7aVtlXT1NYXRoLnNxcnQocil9ZWxzZSBpW2VdPTB9ZWxzZSBpZigiJHN0ZERldlNhbXAiPT09cyl7Y29uc3Qgbj1bXTtmb3IobGV0IGU9MDtlPHQuZG9jcy5sZW5ndGg7ZSsrKXtjb25zdCByPUllKGEsdC5kb2NzW2VdKTsibnVtYmVyIj09dHlwZW9mIHImJm4ucHVzaChyKX1pZihuLmxlbmd0aD4xKXtjb25zdCB0PW4ucmVkdWNlKChlLHQpPT5lK3QsMCkvbi5sZW5ndGgscj1uLnJlZHVjZSgoZSxuKT0+ZStNYXRoLnBvdyhuLXQsMiksMCkvKG4ubGVuZ3RoLTEpO2lbZV09TWF0aC5zcXJ0KHIpfWVsc2UgaVtlXT0wfWVsc2UgaWYoIiRtZXJnZU9iamVjdHMiPT09cyl7Y29uc3Qgbj17fTtmb3IobGV0IGU9MDtlPHQuZG9jcy5sZW5ndGg7ZSsrKXtjb25zdCByPUllKGEsdC5kb2NzW2VdKTsib2JqZWN0IiE9dHlwZW9mIHJ8fG51bGw9PT1yfHxBcnJheS5pc0FycmF5KHIpfHxPYmplY3QuYXNzaWduKG4scil9aVtlXT1ufX1uLnB1c2goaSl9cj1uLFJ0LmVuZChhLHtvdXRwdXREb2NzOnIubGVuZ3RoLGdyb3VwQ291bnQ6T2JqZWN0LmtleXMoZSkubGVuZ3RofSl9ZWxzZSBpZigiJGNvdW50Ij09PWkpcj1be1tvXTpyLmxlbmd0aH1dLFJ0LmVuZChhLHtvdXRwdXREb2NzOnIubGVuZ3RofSk7ZWxzZSBpZigiJHVud2luZCI9PT1pKXtjb25zdCBlPVtdO2xldCB0PW87InN0cmluZyI9PXR5cGVvZiB0JiYiJCI9PT10LmNoYXJBdCgwKSYmKHQ9dC5zdWJzdHJpbmcoMSkpO2ZvcihsZXQgbj0wO248ci5sZW5ndGg7bisrKXtjb25zdCBpPXJbbl0scz12KGksdCk7aWYocyYmTihzKSYmcy5sZW5ndGg+MClmb3IobGV0IG49MDtuPHMubGVuZ3RoO24rKyl7Y29uc3Qgcj1fKGkpLG89dC5zcGxpdCgiLiIpO2xldCBhPXI7Zm9yKGxldCBlPTA7ZTxvLmxlbmd0aC0xO2UrKylhW29bZV1dfHwoYVtvW2VdXT17fSksYT1hW29bZV1dO2Fbb1tvLmxlbmd0aC0xXV09c1tuXSxlLnB1c2gocil9fXI9ZSxSdC5lbmQoYSx7b3V0cHV0RG9jczpyLmxlbmd0aH0pfWVsc2UgaWYoIiRzb3J0QnlDb3VudCI9PT1pKXtjb25zdCBlPXt9O2ZvcihsZXQgdD0wO3Q8ci5sZW5ndGg7dCsrKXtjb25zdCBuPXJbdF0saT1JZShvLG4pLHM9SlNPTi5zdHJpbmdpZnkoaSk7ZVtzXXx8KGVbc109e19pZDppLGNvdW50OjB9KSxlW3NdLmNvdW50Kyt9cj1PYmplY3QudmFsdWVzKGUpLnNvcnQoKGUsdCk9PnQuY291bnQtZS5jb3VudCl9ZWxzZSBpZigiJHJlcGxhY2VSb290Ij09PWl8fCIkcmVwbGFjZVdpdGgiPT09aSl7Y29uc3QgZT1bXSx0PSIkcmVwbGFjZVJvb3QiPT09aT9vLm5ld1Jvb3Q6bztmb3IobGV0IG49MDtuPHIubGVuZ3RoO24rKyl7Y29uc3QgaT1JZSh0LHJbbl0pO2lmKCJvYmplY3QiIT10eXBlb2YgaXx8bnVsbD09PWl8fEFycmF5LmlzQXJyYXkoaSkpdGhyb3cgbmV3IFYoIiRyZXBsYWNlUm9vdCBleHByZXNzaW9uIG11c3QgZXZhbHVhdGUgdG8gYW4gb2JqZWN0Iix7Y29sbGVjdGlvbjp0aGlzLm5hbWUsY29kZTprfSk7ZS5wdXNoKGkpfXI9ZX1lbHNlIGlmKCIkc2FtcGxlIj09PWkpe2NvbnN0IGU9by5zaXplfHwxO2lmKCJudW1iZXIiIT10eXBlb2YgZXx8ZTwwKXRocm93IG5ldyBWKCIkc2FtcGxlIHNpemUgbXVzdCBiZSBhIG5vbi1uZWdhdGl2ZSBudW1iZXIiLHtjb2xsZWN0aW9uOnRoaXMubmFtZSxjb2RlOmt9KTtjb25zdCB0PVsuLi5yXTtmb3IobGV0IG49dC5sZW5ndGgtMTtuPjA7bi0tKXtjb25zdCBlPU1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSoobisxKSk7W3Rbbl0sdFtlXV09W3RbZV0sdFtuXV19cj10LnNsaWNlKDAsTWF0aC5taW4oZSx0Lmxlbmd0aCkpfWVsc2UgaWYoIiRidWNrZXQiPT09aSl7aWYoIW8uZ3JvdXBCeXx8IW8uYm91bmRhcmllcyl0aHJvdyBuZXcgVigiJGJ1Y2tldCByZXF1aXJlcyBncm91cEJ5IGFuZCBib3VuZGFyaWVzIix7Y29sbGVjdGlvbjp0aGlzLm5hbWUsY29kZTprfSk7Y29uc3QgZT1vLmJvdW5kYXJpZXMsdD1vLmRlZmF1bHQsbj1vLm91dHB1dHx8e2NvdW50Onskc3VtOjF9fSxpPXt9O2ZvcihsZXQgcj0wO3I8ZS5sZW5ndGgtMTtyKyspe2lbSlNPTi5zdHJpbmdpZnkoZVtyXSldPXtfaWQ6ZVtyXSxkb2NzOltdfX12b2lkIDAhPT10JiYoaS5kZWZhdWx0PXtfaWQ6dCxkb2NzOltdfSk7Zm9yKGxldCBhPTA7YTxyLmxlbmd0aDthKyspe2NvbnN0IG49clthXSxzPUllKG8uZ3JvdXBCeSxuKTtsZXQgYz0hMTtmb3IobGV0IHQ9MDt0PGUubGVuZ3RoLTE7dCsrKWlmKHM+PWVbdF0mJnM8ZVt0KzFdKXtpW0pTT04uc3RyaW5naWZ5KGVbdF0pXS5kb2NzLnB1c2gobiksYz0hMDticmVha31jfHx2b2lkIDA9PT10fHxpLmRlZmF1bHQuZG9jcy5wdXNoKG4pfWNvbnN0IHM9W107Zm9yKGNvbnN0IHIgaW4gaSl7Y29uc3QgZT1pW3JdO2lmKDA9PT1lLmRvY3MubGVuZ3RoKWNvbnRpbnVlO2NvbnN0IHQ9e19pZDplLl9pZH07Zm9yKGNvbnN0IHIgaW4gbil7Y29uc3QgaT1uW3JdLHM9T2JqZWN0LmtleXMoaSk7aWYoMSE9PXMubGVuZ3RoKWNvbnRpbnVlO2NvbnN0IG89c1swXSxhPWlbb107aWYoIiRzdW0iPT09byl7bGV0IG49MDtmb3IobGV0IHQ9MDt0PGUuZG9jcy5sZW5ndGg7dCsrKXtjb25zdCByPUllKGEsZS5kb2NzW3RdKTsibnVtYmVyIj09dHlwZW9mIHI/bis9cjpudWxsIT1yJiYobis9TnVtYmVyKHIpfHwwKX10W3JdPW59ZWxzZSBpZigiJGF2ZyI9PT1vKXtsZXQgbj0wLGk9MDtmb3IobGV0IHQ9MDt0PGUuZG9jcy5sZW5ndGg7dCsrKXtjb25zdCByPUllKGEsZS5kb2NzW3RdKTtudWxsIT1yJiYobis9TnVtYmVyKHIpfHwwLGkrKyl9dFtyXT1pPjA/bi9pOjB9ZWxzZSBpZigiJHB1c2giPT09byl7Y29uc3Qgbj1bXTtmb3IobGV0IHQ9MDt0PGUuZG9jcy5sZW5ndGg7dCsrKXtjb25zdCByPUllKGEsZS5kb2NzW3RdKTtuLnB1c2gocil9dFtyXT1ufWVsc2UgaWYoIiRhZGRUb1NldCI9PT1vKXtjb25zdCBuPXt9O2ZvcihsZXQgdD0wO3Q8ZS5kb2NzLmxlbmd0aDt0Kyspe2NvbnN0IHI9SWUoYSxlLmRvY3NbdF0pO25bSlNPTi5zdHJpbmdpZnkocildPXJ9dFtyXT1PYmplY3QudmFsdWVzKG4pfX1zLnB1c2godCl9cj1zLnNvcnQoKGUsdCk9PmUuX2lkPHQuX2lkPy0xOmUuX2lkPnQuX2lkPzE6MCl9ZWxzZSBpZigiJGJ1Y2tldEF1dG8iPT09aSl7aWYoIW8uZ3JvdXBCeXx8IW8uYnVja2V0cyl0aHJvdyBuZXcgVigiJGJ1Y2tldEF1dG8gcmVxdWlyZXMgZ3JvdXBCeSBhbmQgYnVja2V0cyIse2NvbGxlY3Rpb246dGhpcy5uYW1lLGNvZGU6a30pO2NvbnN0IGU9by5idWNrZXRzLHQ9by5vdXRwdXR8fHtjb3VudDp7JHN1bToxfX07aWYoMD09PXIubGVuZ3RoKXI9W107ZWxzZXtjb25zdCBuPXIubWFwKGU9Pih7dmFsdWU6SWUoby5ncm91cEJ5LGUpLGRvYzplfSkpLnNvcnQoKGUsdCk9PmUudmFsdWU8dC52YWx1ZT8tMTplLnZhbHVlPnQudmFsdWU/MTowKSxpPU1hdGguY2VpbChuLmxlbmd0aC9lKSxzPVtdO2ZvcihsZXQgdD0wO3Q8ZSYmdCppPG4ubGVuZ3RoO3QrKyl7Y29uc3QgZT10Kmkscj1NYXRoLm1pbigodCsxKSppLG4ubGVuZ3RoKSxvPW4uc2xpY2UoZSxyKTtpZigwPT09by5sZW5ndGgpY29udGludWU7Y29uc3QgYT17X2lkOnttaW46b1swXS52YWx1ZSxtYXg6KG4ubGVuZ3RoLG9bby5sZW5ndGgtMV0udmFsdWUpfSxkb2NzOm8ubWFwKGU9PmUuZG9jKX07cy5wdXNoKGEpfWNvbnN0IGE9W107Zm9yKGxldCBlPTA7ZTxzLmxlbmd0aDtlKyspe2NvbnN0IG49c1tlXSxyPXtfaWQ6bi5faWR9O2Zvcihjb25zdCBlIGluIHQpe2NvbnN0IGk9dFtlXSxzPU9iamVjdC5rZXlzKGkpO2lmKDEhPT1zLmxlbmd0aCljb250aW51ZTtjb25zdCBvPXNbMF0sYT1pW29dO2lmKCIkc3VtIj09PW8pe2xldCB0PTA7Zm9yKGxldCBlPTA7ZTxuLmRvY3MubGVuZ3RoO2UrKyl7Y29uc3Qgcj1JZShhLG4uZG9jc1tlXSk7Im51bWJlciI9PXR5cGVvZiByP3QrPXI6bnVsbCE9ciYmKHQrPU51bWJlcihyKXx8MCl9cltlXT10fWVsc2UgaWYoIiRhdmciPT09byl7bGV0IHQ9MCxpPTA7Zm9yKGxldCBlPTA7ZTxuLmRvY3MubGVuZ3RoO2UrKyl7Y29uc3Qgcj1JZShhLG4uZG9jc1tlXSk7bnVsbCE9ciYmKHQrPU51bWJlcihyKXx8MCxpKyspfXJbZV09aT4wP3QvaTowfWVsc2UgaWYoIiRwdXNoIj09PW8pe2NvbnN0IHQ9W107Zm9yKGxldCBlPTA7ZTxuLmRvY3MubGVuZ3RoO2UrKyl7Y29uc3Qgcj1JZShhLG4uZG9jc1tlXSk7dC5wdXNoKHIpfXJbZV09dH19YS5wdXNoKHIpfXI9YX19ZWxzZSBpZigiJG91dCI9PT1pKXtjb25zdCBlPW87aWYoInN0cmluZyIhPXR5cGVvZiBlKXRocm93IG5ldyBWKCIkb3V0IHJlcXVpcmVzIGEgc3RyaW5nIGNvbGxlY3Rpb24gbmFtZSIse2NvbGxlY3Rpb246dGhpcy5uYW1lLGNvZGU6a30pO3RoaXMuZGIuY29sbGVjdGlvbnMuaGFzKGUpJiZhd2FpdCB0aGlzLmRiLmRyb3BDb2xsZWN0aW9uKGUpO2NvbnN0IHQ9dGhpcy5kYltlXTtmb3IobGV0IG49MDtuPHIubGVuZ3RoO24rKyl7Y29uc3QgZT1yW25dLGk9ZS5faWQ7Im9iamVjdCI9PXR5cGVvZiBpJiZpLnRvU3RyaW5nP2kudG9TdHJpbmcoKTpTdHJpbmcoaSksYXdhaXQgdC5pbnNlcnRPbmUoZSl9cj1bXX1lbHNlIGlmKCIkbWVyZ2UiPT09aSl7bGV0IGUsdD0iX2lkIixuPSJtZXJnZSIsaT0iaW5zZXJ0IjtpZigic3RyaW5nIj09dHlwZW9mIG8/ZT1vOiJvYmplY3QiPT10eXBlb2YgbyYmKGU9by5pbnRvLHQ9by5vbnx8dCxuPW8ud2hlbk1hdGNoZWR8fG4saT1vLndoZW5Ob3RNYXRjaGVkfHxpKSwhZSl0aHJvdyBuZXcgVigiJG1lcmdlIHJlcXVpcmVzIGEgdGFyZ2V0IGNvbGxlY3Rpb24iLHtjb2xsZWN0aW9uOnRoaXMubmFtZSxjb2RlOmt9KTtjb25zdCBzPXRoaXMuZGJbZV07Zm9yKGxldCBvPTA7bzxyLmxlbmd0aDtvKyspe2NvbnN0IGU9cltvXSxhPSJzdHJpbmciPT10eXBlb2YgdD90OnRbMF0sYz12KGUsYSksbD1zLmZpbmQoe1thXTpjfSk7YXdhaXQgbC5fZW5zdXJlSW5pdGlhbGl6ZWQoKTtjb25zdCB1PWF3YWl0IGwuaGFzTmV4dCgpP2F3YWl0IGwubmV4dCgpOm51bGw7aWYodSl7aWYoInJlcGxhY2UiPT09bilhd2FpdCBzLnJlcGxhY2VPbmUoe19pZDp1Ll9pZH0sZSk7ZWxzZSBpZigibWVyZ2UiPT09bil7Y29uc3QgdD1PYmplY3QuYXNzaWduKHt9LHUsZSk7YXdhaXQgcy5yZXBsYWNlT25lKHtfaWQ6dS5faWR9LHQpfWVsc2UgaWYoImtlZXBFeGlzdGluZyI9PT1uKTtlbHNlIGlmKCJmYWlsIj09PW4pdGhyb3cgbmV3IFYoIiRtZXJnZSBmYWlsZWQ6IGR1cGxpY2F0ZSBrZXkiLHtjb2xsZWN0aW9uOnRoaXMubmFtZSxjb2RlOlR9KX1lbHNlIGlmKCJpbnNlcnQiPT09aSlhd2FpdCBzLmluc2VydE9uZShlKTtlbHNlIGlmKCJkaXNjYXJkIj09PWkpO2Vsc2UgaWYoImZhaWwiPT09aSl0aHJvdyBuZXcgVigiJG1lcmdlIGZhaWxlZDogZG9jdW1lbnQgbm90IGZvdW5kIix7Y29sbGVjdGlvbjp0aGlzLm5hbWUsY29kZTprfSl9cj1bXX1lbHNlIGlmKCIkbG9va3VwIj09PWkpe2lmKCEoby5mcm9tJiZvLmxvY2FsRmllbGQmJm8uZm9yZWlnbkZpZWxkJiZvLmFzKSl0aHJvdyBuZXcgVigiJGxvb2t1cCByZXF1aXJlcyBmcm9tLCBsb2NhbEZpZWxkLCBmb3JlaWduRmllbGQsIGFuZCBhcyIse2NvbGxlY3Rpb246dGhpcy5uYW1lLGNvZGU6a30pO2lmKCF0aGlzLmRiLmdldENvbGxlY3Rpb25OYW1lcygpLmluY2x1ZGVzKG8uZnJvbSkpdGhyb3cgbmV3IFYoIiRsb29rdXA6IGNvbGxlY3Rpb24gbm90IGZvdW5kOiAiK28uZnJvbSx7Y29sbGVjdGlvbjp0aGlzLm5hbWUsY29kZTpQfSk7Y29uc3QgZT10aGlzLmRiW28uZnJvbV0sdD1bXTtmb3IobGV0IG49MDtuPHIubGVuZ3RoO24rKyl7Y29uc3QgaT1fKHJbbl0pLHM9dihpLG8ubG9jYWxGaWVsZCksYT1bXSxjPWUuZmluZCh7W28uZm9yZWlnbkZpZWxkXTpzfSk7Zm9yKGF3YWl0IGMuX2Vuc3VyZUluaXRpYWxpemVkKCk7YXdhaXQgYy5oYXNOZXh0KCk7KWEucHVzaChhd2FpdCBjLm5leHQoKSk7aVtvLmFzXT1hLHQucHVzaChpKX1yPXR9ZWxzZSBpZigiJGdyYXBoTG9va3VwIj09PWkpe2lmKCEoby5mcm9tJiZvLnN0YXJ0V2l0aCYmby5jb25uZWN0RnJvbUZpZWxkJiZvLmNvbm5lY3RUb0ZpZWxkJiZvLmFzKSl0aHJvdyBuZXcgVigiJGdyYXBoTG9va3VwIHJlcXVpcmVzIGZyb20sIHN0YXJ0V2l0aCwgY29ubmVjdEZyb21GaWVsZCwgY29ubmVjdFRvRmllbGQsIGFuZCBhcyIse2NvbGxlY3Rpb246dGhpcy5uYW1lLGNvZGU6a30pO2lmKCF0aGlzLmRiLmdldENvbGxlY3Rpb25OYW1lcygpLmluY2x1ZGVzKG8uZnJvbSkpdGhyb3cgbmV3IFYoIiRncmFwaExvb2t1cDogY29sbGVjdGlvbiBub3QgZm91bmQ6ICIrby5mcm9tLHtjb2xsZWN0aW9uOnRoaXMubmFtZSxjb2RlOlB9KTtjb25zdCBlPXRoaXMuZGJbby5mcm9tXSx0PXZvaWQgMCE9PW8ubWF4RGVwdGg/by5tYXhEZXB0aDpOdW1iZXIuTUFYX1NBRkVfSU5URUdFUixuPW8uZGVwdGhGaWVsZCxpPW8ucmVzdHJpY3RTZWFyY2hXaXRoTWF0Y2gscz1bXTtmb3IobGV0IGE9MDthPHIubGVuZ3RoO2ErKyl7Y29uc3QgYz1fKHJbYV0pLGw9SWUoby5zdGFydFdpdGgsclthXSksdT0vKiBAX19QVVJFX18gKi9uZXcgU2V0LGg9W10sZj1be3ZhbHVlOmwsZGVwdGg6MH1dO2Zvcig7Zi5sZW5ndGg+MDspe2NvbnN0e3ZhbHVlOnIsZGVwdGg6c309Zi5zaGlmdCgpO2lmKHM+dCljb250aW51ZTtjb25zdCBhPUpTT04uc3RyaW5naWZ5KHIpO2lmKHUuaGFzKGEpKWNvbnRpbnVlO3UuYWRkKGEpO2xldCBjPXtbby5jb25uZWN0VG9GaWVsZF06cn07aSYmKGM9eyRhbmQ6W2MsaV19KTtjb25zdCBsPWUuZmluZChjKTtmb3IoYXdhaXQgbC5fZW5zdXJlSW5pdGlhbGl6ZWQoKTthd2FpdCBsLmhhc05leHQoKTspe2NvbnN0IGU9YXdhaXQgbC5uZXh0KCksdD1fKGUpO24mJih0W25dPXMpLGgucHVzaCh0KTtjb25zdCByPXYoZSxvLmNvbm5lY3RGcm9tRmllbGQpO251bGwhPXImJmYucHVzaCh7dmFsdWU6cixkZXB0aDpzKzF9KX19Y1tvLmFzXT1oLHMucHVzaChjKX1yPXN9ZWxzZSBpZigiJGZhY2V0Ij09PWkpe2lmKCJvYmplY3QiIT10eXBlb2Ygb3x8QXJyYXkuaXNBcnJheShvKSl0aHJvdyBuZXcgVigiJGZhY2V0IHJlcXVpcmVzIGFuIG9iamVjdCB3aXRoIHBpcGVsaW5lIGRlZmluaXRpb25zIix7Y29sbGVjdGlvbjp0aGlzLm5hbWUsY29kZTprfSk7Y29uc3QgZT17fTtmb3IoY29uc3QgdCBpbiBvKXtjb25zdCBuPW9bdF07aWYoIUFycmF5LmlzQXJyYXkobikpdGhyb3cgbmV3IFYoIiRmYWNldCBwaXBlbGluZSBtdXN0IGJlIGFuIGFycmF5Iix7Y29sbGVjdGlvbjp0aGlzLm5hbWUsY29kZTprfSk7bGV0IGk9ci5tYXAoZT0+XyhlKSk7Zm9yKGxldCBlPTA7ZTxuLmxlbmd0aDtlKyspe2NvbnN0IHQ9bltlXSxyPU9iamVjdC5rZXlzKHQpO2lmKDEhPT1yLmxlbmd0aCl0aHJvdyBuZXcgVigiRWFjaCBwaXBlbGluZSBzdGFnZSBtdXN0IGhhdmUgZXhhY3RseSBvbmUga2V5Iix7Y29sbGVjdGlvbjp0aGlzLm5hbWUsY29kZTprfSk7Y29uc3Qgcz1yWzBdLG89dFtzXTtpZigiJG1hdGNoIj09PXMpe2NvbnN0IGU9W107Zm9yKGxldCB0PTA7dDxpLmxlbmd0aDt0KyspWWUoaVt0XSxvKSYmZS5wdXNoKGlbdF0pO2k9ZX1lbHNlIGlmKCIkcHJvamVjdCI9PT1zKXtjb25zdCBlPVtdO2ZvcihsZXQgdD0wO3Q8aS5sZW5ndGg7dCsrKWUucHVzaChWdChvLGlbdF0pKTtpPWV9ZWxzZSBpZigiJGxpbWl0Ij09PXMpaT1pLnNsaWNlKDAsbyk7ZWxzZSBpZigiJHNraXAiPT09cylpPWkuc2xpY2Uobyk7ZWxzZSBpZigiJHNvcnQiPT09cyl7Y29uc3QgZT1PYmplY3Qua2V5cyhvKTtpLnNvcnQoZnVuY3Rpb24odCxuKXtmb3IobGV0IHI9MDtyPGUubGVuZ3RoO3IrKyl7Y29uc3QgaT1lW3JdO2lmKHZvaWQgMD09PXRbaV0mJnZvaWQgMCE9PW5baV0pcmV0dXJuLTEqb1tpXTtpZih2b2lkIDAhPT10W2ldJiZ2b2lkIDA9PT1uW2ldKXJldHVybiAxKm9baV07aWYodFtpXTxuW2ldKXJldHVybi0xKm9baV07aWYodFtpXT5uW2ldKXJldHVybiAxKm9baV19cmV0dXJuIDB9KX1lbHNlIGlmKCIkY291bnQiPT09cylpPVt7W29dOmkubGVuZ3RofV07ZWxzZSBpZigiJGdyb3VwIj09PXMpe2NvbnN0IGU9e30sdD1vLl9pZDtmb3IobGV0IHI9MDtyPGkubGVuZ3RoO3IrKyl7Y29uc3Qgbj1pW3JdO2xldCBzO3M9bnVsbD09dD9udWxsOkllKHQsbik7Y29uc3Qgbz1KU09OLnN0cmluZ2lmeShzKTtlW29dfHwoZVtvXT17X2lkOnMsZG9jczpbXSxhY2N1bXVsYXRvcnM6e319KSxlW29dLmRvY3MucHVzaChuKX1jb25zdCBuPVtdO2Zvcihjb25zdCByIGluIGUpe2NvbnN0IHQ9ZVtyXSxpPXtfaWQ6dC5faWR9O2Zvcihjb25zdCBlIGluIG8pe2lmKCJfaWQiPT09ZSljb250aW51ZTtjb25zdCBuPW9bZV0scj1PYmplY3Qua2V5cyhuKTtpZigxIT09ci5sZW5ndGgpY29udGludWU7Y29uc3Qgcz1yWzBdLGE9bltzXTtpZigiJHN1bSI9PT1zKXtsZXQgbj0wO2ZvcihsZXQgZT0wO2U8dC5kb2NzLmxlbmd0aDtlKyspe2NvbnN0IHI9SWUoYSx0LmRvY3NbZV0pOyJudW1iZXIiPT10eXBlb2Ygcj9uKz1yOm51bGwhPXImJihuKz1OdW1iZXIocil8fDApfWlbZV09bn1lbHNlIGlmKCIkYXZnIj09PXMpe2xldCBuPTAscj0wO2ZvcihsZXQgZT0wO2U8dC5kb2NzLmxlbmd0aDtlKyspe2NvbnN0IGk9SWUoYSx0LmRvY3NbZV0pO251bGwhPWkmJihuKz1OdW1iZXIoaSl8fDAscisrKX1pW2VdPXI+MD9uL3I6MH1lbHNlIGlmKCIkbWF4Ij09PXMpe2xldCBuO2ZvcihsZXQgZT0wO2U8dC5kb2NzLmxlbmd0aDtlKyspe2NvbnN0IHI9SWUoYSx0LmRvY3NbZV0pO3ZvaWQgMCE9PXImJih2b2lkIDA9PT1ufHxyPm4pJiYobj1yKX1pW2VdPW59fW4ucHVzaChpKX1pPW59ZWxzZSBpZigiJHNvcnRCeUNvdW50Ij09PXMpe2NvbnN0IGU9e307Zm9yKGxldCB0PTA7dDxpLmxlbmd0aDt0Kyspe2NvbnN0IG49aVt0XSxyPUllKG8sbikscz1KU09OLnN0cmluZ2lmeShyKTtlW3NdfHwoZVtzXT17X2lkOnIsY291bnQ6MH0pLGVbc10uY291bnQrK31pPU9iamVjdC52YWx1ZXMoZSkuc29ydCgoZSx0KT0+dC5jb3VudC1lLmNvdW50KX1lbHNlIGlmKCIkc2FtcGxlIj09PXMpe2NvbnN0IGU9by5zaXplfHwxLHQ9Wy4uLmldO2ZvcihsZXQgbj10Lmxlbmd0aC0xO24+MDtuLS0pe2NvbnN0IGU9TWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKihuKzEpKTtbdFtuXSx0W2VdXT1bdFtlXSx0W25dXX1pPXQuc2xpY2UoMCxNYXRoLm1pbihlLHQubGVuZ3RoKSl9ZWxzZSBpZigiJGJ1Y2tldCI9PT1zKXtjb25zdCBlPW8uYm91bmRhcmllcyx0PW8uZGVmYXVsdCxuPW8ub3V0cHV0fHx7Y291bnQ6eyRzdW06MX19LHI9e307Zm9yKGxldCBpPTA7aTxlLmxlbmd0aC0xO2krKyl7cltKU09OLnN0cmluZ2lmeShlW2ldKV09e19pZDplW2ldLGRvY3M6W119fXZvaWQgMCE9PXQmJihyLmRlZmF1bHQ9e19pZDp0LGRvY3M6W119KTtmb3IobGV0IGE9MDthPGkubGVuZ3RoO2ErKyl7Y29uc3Qgbj1pW2FdLHM9SWUoby5ncm91cEJ5LG4pO2xldCBjPSExO2ZvcihsZXQgdD0wO3Q8ZS5sZW5ndGgtMTt0KyspaWYocz49ZVt0XSYmczxlW3QrMV0pe3JbSlNPTi5zdHJpbmdpZnkoZVt0XSldLmRvY3MucHVzaChuKSxjPSEwO2JyZWFrfWN8fHZvaWQgMD09PXR8fHIuZGVmYXVsdC5kb2NzLnB1c2gobil9Y29uc3Qgcz1bXTtmb3IoY29uc3QgaSBpbiByKXtjb25zdCBlPXJbaV07aWYoMD09PWUuZG9jcy5sZW5ndGgpY29udGludWU7Y29uc3QgdD17X2lkOmUuX2lkfTtmb3IoY29uc3QgciBpbiBuKXtjb25zdCBpPW5bcl0scz1PYmplY3Qua2V5cyhpKTtpZigxIT09cy5sZW5ndGgpY29udGludWU7Y29uc3Qgbz1zWzBdLGE9aVtvXTtpZigiJHN1bSI9PT1vKXtsZXQgbj0wO2ZvcihsZXQgdD0wO3Q8ZS5kb2NzLmxlbmd0aDt0Kyspe2NvbnN0IHI9SWUoYSxlLmRvY3NbdF0pOyJudW1iZXIiPT10eXBlb2Ygcj9uKz1yOm51bGwhPXImJihuKz1OdW1iZXIocil8fDApfXRbcl09bn19cy5wdXNoKHQpfWk9cy5zb3J0KChlLHQpPT5lLl9pZDx0Ll9pZD8tMTplLl9pZD50Ll9pZD8xOjApfX1lW3RdPWl9cj1bZV19ZWxzZSBpZigiJHJlZGFjdCI9PT1pKXtjb25zdCBlPVtdO2ZvcihsZXQgdD0wO3Q8ci5sZW5ndGg7dCsrKXtjb25zdCBuPXJbdF0saT1JZShvLG4pO2lmKCIkJERFU0NFTkQiPT09aSllLnB1c2gobik7ZWxzZXtpZigiJCRQUlVORSI9PT1pKWNvbnRpbnVlOygiJCRLRUVQIj09PWl8fGkpJiZlLnB1c2gobil9fXI9ZX1lbHNle2lmKCIkZ2VvTmVhciIhPT1pKXRocm93IFJ0LmVuZChhLHtlcnJvcjohMCxzdGFnZVR5cGU6aX0pLG5ldyBWKCJVbnN1cHBvcnRlZCBhZ2dyZWdhdGlvbiBzdGFnZTogIitpLHtjb2xsZWN0aW9uOnRoaXMubmFtZSxjb2RlOmt9KTt7aWYoIW8ubmVhcnx8IW8uZGlzdGFuY2VGaWVsZCl0aHJvdyBuZXcgVigiJGdlb05lYXIgcmVxdWlyZXMgbmVhciBhbmQgZGlzdGFuY2VGaWVsZCIse2NvbGxlY3Rpb246dGhpcy5uYW1lLGNvZGU6a30pO2NvbnN0IGU9by5uZWFyLHQ9by5kaXN0YW5jZUZpZWxkLG49by5tYXhEaXN0YW5jZSxpPW8ubWluRGlzdGFuY2V8fDAscz0hMSE9PW8uc3BoZXJpY2FsLGM9by5rZXl8fCJsb2NhdGlvbiIsbD1bXTtmb3IobGV0IG89MDtvPHIubGVuZ3RoO28rKyl7Y29uc3QgYT1fKHJbb10pLHU9dihhLGMpO2lmKCF1fHwhQXJyYXkuaXNBcnJheSh1KXx8dS5sZW5ndGg8Miljb250aW51ZTtsZXQgaDtpZihzKXtjb25zdCB0PTYzNzFlMyxuPWVbMV0qTWF0aC5QSS8xODAscj11WzFdKk1hdGguUEkvMTgwLGk9KHVbMV0tZVsxXSkqTWF0aC5QSS8xODAscz0odVswXS1lWzBdKSpNYXRoLlBJLzE4MCxvPU1hdGguc2luKGkvMikqTWF0aC5zaW4oaS8yKStNYXRoLmNvcyhuKSpNYXRoLmNvcyhyKSpNYXRoLnNpbihzLzIpKk1hdGguc2luKHMvMik7aD10KigyKk1hdGguYXRhbjIoTWF0aC5zcXJ0KG8pLE1hdGguc3FydCgxLW8pKSl9ZWxzZXtjb25zdCB0PXVbMF0tZVswXSxuPXVbMV0tZVsxXTtoPU1hdGguc3FydCh0KnQrbipuKX1oPj1pJiYoIW58fGg8PW4pJiYoYVt0XT1oLGwucHVzaChhKSl9bC5zb3J0KChlLG4pPT5lW3RdLW5bdF0pLHI9by5saW1pdD9sLnNsaWNlKDAsby5saW1pdCk6bCxSdC5lbmQoYSx7b3V0cHV0RG9jczpyLmxlbmd0aH0pfX19cmV0dXJuIFJ0LmVuZCh0LHtyZXN1bHRDb3VudDpyLmxlbmd0aH0pLHJ9YXN5bmMgYnVsa1dyaXRlKCl7dGhyb3cgbmV3IEgoImJ1bGtXcml0ZSIse2NvbGxlY3Rpb246dGhpcy5uYW1lfSl9YXN5bmMgY291bnQoKXt0aGlzLl9pbml0aWFsaXplZHx8YXdhaXQgdGhpcy5faW5pdGlhbGl6ZSgpO2xldCBlPTA7Zm9yIGF3YWl0KGNvbnN0IHQgb2YgdGhpcy5kb2N1bWVudHMpZSsrO3JldHVybiBlfWFzeW5jIGNvcHlUbyhlKXt0aGlzLmRiLmNyZWF0ZUNvbGxlY3Rpb24oZSk7Y29uc3QgdD10aGlzLmRiLmdldENvbGxlY3Rpb24oZSk7bGV0IG49MDtjb25zdCByPXRoaXMuZmluZCh7fSk7Zm9yKGF3YWl0IHIuX2Vuc3VyZUluaXRpYWxpemVkKCk7YXdhaXQgci5oYXNOZXh0KCk7KWF3YWl0IHQuaW5zZXJ0T25lKGF3YWl0IHIubmV4dCgpKSxuKys7cmV0dXJuIG59YXN5bmMgY3JlYXRlSW5kZXgoZSx0KXtpZih0aGlzLl9pbml0aWFsaXplZHx8YXdhaXQgdGhpcy5faW5pdGlhbGl6ZSgpLCFlfHwib2JqZWN0IiE9dHlwZW9mIGV8fEFycmF5LmlzQXJyYXkoZSkpdGhyb3cgbmV3IFcoImtleXMiLGUsImNyZWF0ZUluZGV4IHJlcXVpcmVzIGEga2V5IHNwZWNpZmljYXRpb24gb2JqZWN0Iix7Y29sbGVjdGlvbjp0aGlzLm5hbWV9KTtjb25zdCBuPXQmJnQubmFtZT90Lm5hbWU6dGhpcy5nZW5lcmF0ZUluZGV4TmFtZShlKTtpZih0aGlzLmluZGV4ZXMuaGFzKG4pKXtjb25zdCB0PXRoaXMuaW5kZXhlcy5nZXQobik7aWYoSlNPTi5zdHJpbmdpZnkodC5rZXlzKSE9PUpTT04uc3RyaW5naWZ5KGUpKXRocm93IG5ldyBSKCJJbmRleCB3aXRoIG5hbWUgJyIrbisiJyBhbHJlYWR5IGV4aXN0cyB3aXRoIGEgZGlmZmVyZW50IGtleSBzcGVjaWZpY2F0aW9uIix7Y29kZTpMLGluZGV4Om4sY29sbGVjdGlvbjp0aGlzLm5hbWV9KTtyZXR1cm4gbn1yZXR1cm4gYXdhaXQgdGhpcy5fYnVpbGRJbmRleChuLGUsdCksbn1kYXRhU2l6ZSgpe3Rocm93IG5ldyBIKCJkYXRhU2l6ZSIse2NvbGxlY3Rpb246dGhpcy5uYW1lfSl9YXN5bmMgZGVsZXRlT25lKGUpe2NvbnN0IHQ9YXdhaXQgdGhpcy5maW5kT25lKGUpO3JldHVybiB0Pyhhd2FpdCB0aGlzLnVwZGF0ZUluZGV4ZXNPbkRlbGV0ZSh0KSxhd2FpdCB0aGlzLmRvY3VtZW50cy5kZWxldGUodC5faWQudG9TdHJpbmcoKSksdGhpcy5lbWl0KCJkZWxldGUiLHtfaWQ6dC5faWR9KSx7ZGVsZXRlZENvdW50OjF9KTp7ZGVsZXRlZENvdW50OjB9fWFzeW5jIGRlbGV0ZU1hbnkoZSl7Y29uc3QgdD10aGlzLmZpbmQoZSk7YXdhaXQgdC5fZW5zdXJlSW5pdGlhbGl6ZWQoKTtjb25zdCBuPVtdLHI9W107Zm9yKDthd2FpdCB0Lmhhc05leHQoKTspe2NvbnN0IGU9YXdhaXQgdC5uZXh0KCk7bi5wdXNoKGUuX2lkKSxyLnB1c2goZSl9Y29uc3QgaT1uLmxlbmd0aDtmb3IobGV0IHM9MDtzPG4ubGVuZ3RoO3MrKylhd2FpdCB0aGlzLnVwZGF0ZUluZGV4ZXNPbkRlbGV0ZShyW3NdKSx0aGlzLmRvY3VtZW50cy5kZWxldGUobltzXS50b1N0cmluZygpKSx0aGlzLmVtaXQoImRlbGV0ZSIse19pZDpuW3NdfSk7cmV0dXJue2RlbGV0ZWRDb3VudDppfX1hc3luYyBkaXN0aW5jdChlLHQpe2NvbnN0IG49e30scj10aGlzLmZpbmQodCk7Zm9yKGF3YWl0IHIuX2Vuc3VyZUluaXRpYWxpemVkKCk7YXdhaXQgci5oYXNOZXh0KCk7KXtjb25zdCB0PWF3YWl0IHIubmV4dCgpO3RbZV0mJihuW3RbZV1dPSEwKX1yZXR1cm4gT2JqZWN0LmtleXMobil9YXN5bmMgZHJvcCgpe3RoaXMuX2luaXRpYWxpemVkfHxhd2FpdCB0aGlzLl9pbml0aWFsaXplKCk7Zm9yKGNvbnN0W2ksc11vZiB0aGlzLmluZGV4ZXMpcyYmImZ1bmN0aW9uIj09dHlwZW9mIHMuY2xvc2UmJmF3YWl0IHMuY2xvc2UoKTt0aGlzLmRvY3VtZW50cyYmImZ1bmN0aW9uIj09dHlwZW9mIHRoaXMuZG9jdW1lbnRzLmNsb3NlJiZhd2FpdCB0aGlzLmRvY3VtZW50cy5jbG9zZSgpLHRoaXMuX3JlbGVhc2VEb2N1bWVudHMmJihhd2FpdCB0aGlzLl9yZWxlYXNlRG9jdW1lbnRzKCksdGhpcy5fcmVsZWFzZURvY3VtZW50cz1udWxsKTt0cnl7Y29uc3QgZT10aGlzLnBhdGguc3BsaXQoIi8iKS5maWx0ZXIoQm9vbGVhbik7bGV0IHQ9YXdhaXQgZ2xvYmFsVGhpcy5uYXZpZ2F0b3Iuc3RvcmFnZS5nZXREaXJlY3RvcnkoKTtmb3IoY29uc3QgbiBvZiBlKXQ9YXdhaXQgdC5nZXREaXJlY3RvcnlIYW5kbGUobix7Y3JlYXRlOiExfSk7Y29uc3Qgcj1bXTtmb3IgYXdhaXQoY29uc3RbbixpXW9mIHQuZW50cmllcygpKXIucHVzaChuKTtmb3IoY29uc3QgaSBvZiByKXRyeXthd2FpdCB0LnJlbW92ZUVudHJ5KGkse3JlY3Vyc2l2ZTohMX0pfWNhdGNoKG4pe319Y2F0Y2gocil7fWNvbnN0IGU9dGhpcy5wYXRoLnNwbGl0KCIvIikuZmlsdGVyKEJvb2xlYW4pLHQ9ZS5wb3AoKTt0cnl7bGV0IHI9YXdhaXQgZ2xvYmFsVGhpcy5uYXZpZ2F0b3Iuc3RvcmFnZS5nZXREaXJlY3RvcnkoKTtmb3IoY29uc3QgdCBvZiBlKXI9YXdhaXQgci5nZXREaXJlY3RvcnlIYW5kbGUodCx7Y3JlYXRlOiExfSk7dHJ5e2F3YWl0IHIucmVtb3ZlRW50cnkodCx7cmVjdXJzaXZlOiEwfSl9Y2F0Y2gobil7aWYoIlR5cGVFcnJvciIhPT1uLm5hbWUmJiFuLm1lc3NhZ2U/LmluY2x1ZGVzKCJyZWN1cnNpdmUiKSl0aHJvdyBuO2F3YWl0IHIucmVtb3ZlRW50cnkodCl9fWNhdGNoKHIpe2lmKCJOb3RGb3VuZEVycm9yIiE9PXIubmFtZSYmIkVOT0VOVCIhPT1yLmNvZGUpdGhyb3cgcn1yZXR1cm4gdGhpcy5kb2N1bWVudHM9bnVsbCx0aGlzLmluZGV4ZXMuY2xlYXIoKSx0aGlzLl9pbml0aWFsaXplZD0hMSx0aGlzLmRiLmNvbGxlY3Rpb25zLmRlbGV0ZSh0aGlzLm5hbWUpLHRoaXMuZW1pdCgiZHJvcCIse2NvbGxlY3Rpb246dGhpcy5uYW1lfSkse29rOjF9fWFzeW5jIGRyb3BJbmRleChlKXtpZighdGhpcy5pbmRleGVzLmhhcyhlKSl0aHJvdyBuZXcgcShlLHtjb2xsZWN0aW9uOnRoaXMubmFtZX0pO2NvbnN0IHQ9dGhpcy5pbmRleGVzLmdldChlKTtyZXR1cm4gdCYmImZ1bmN0aW9uIj09dHlwZW9mIHQuY2xlYXImJmF3YWl0IHQuY2xlYXIoKSx0JiYiZnVuY3Rpb24iPT10eXBlb2YgdC5jbG9zZSYmYXdhaXQgdC5jbG9zZSgpLHRoaXMuaW5kZXhlcy5kZWxldGUoZSkse25JbmRleGVzV2FzOnRoaXMuaW5kZXhlcy5zaXplKzEsb2s6MX19YXN5bmMgZHJvcEluZGV4ZXMoKXtjb25zdCBlPXRoaXMuaW5kZXhlcy5zaXplO2Zvcihjb25zdFt0LG5db2YgdGhpcy5pbmRleGVzKW4mJiJmdW5jdGlvbiI9PXR5cGVvZiBuLmNsZWFyJiZhd2FpdCBuLmNsZWFyKCksbiYmImZ1bmN0aW9uIj09dHlwZW9mIG4uY2xvc2UmJmF3YWl0IG4uY2xvc2UoKTtyZXR1cm4gdGhpcy5pbmRleGVzLmNsZWFyKCkse25JbmRleGVzV2FzOmUsbXNnOiJub24tX2lkIGluZGV4ZXMgZHJvcHBlZCIsb2s6MX19ZW5zdXJlSW5kZXgoKXt0aHJvdyBuZXcgSCgiZW5zdXJlSW5kZXgiLHtjb2xsZWN0aW9uOnRoaXMubmFtZX0pfWV4cGxhaW4oKXt0aHJvdyBuZXcgSCgiZXhwbGFpbiIse2NvbGxlY3Rpb246dGhpcy5uYW1lfSl9ZmluZChlLHQpe3RoaXMuX3ZhbGlkYXRlUHJvamVjdGlvbih0KTtjb25zdCBuPXRoaXMuX2ZpbmRJbnRlcm5hbChlLHQpO3JldHVybiBuZXcgUSh0aGlzLGUsdCxuLEopfV92YWxpZGF0ZVByb2plY3Rpb24oZSl7aWYoIWV8fDA9PT1PYmplY3Qua2V5cyhlKS5sZW5ndGgpcmV0dXJuO2NvbnN0IHQ9T2JqZWN0LmtleXMoZSk7bGV0IG49ITEscj0hMTtmb3IoY29uc3QgaSBvZiB0KWlmKCJfaWQiIT09aSYmKGVbaV0/bj0hMDpyPSEwLG4mJnIpKWJyZWFrO2lmKG4mJnIpdGhyb3cgbmV3IFYoIkNhbm5vdCBkbyBleGNsdXNpb24gb24gZmllbGQgaW4gaW5jbHVzaW9uIHByb2plY3Rpb24iLHtjb2RlOkIsY29sbGVjdGlvbjp0aGlzLm5hbWV9KX1hc3luYyBfZmluZEludGVybmFsKGUsdCl7Y29uc3Qgbj1SdC5zdGFydCgiY29sbGVjdGlvbiIsImZpbmQiLHtjb2xsZWN0aW9uOnRoaXMubmFtZX0pO3RoaXMuX2luaXRpYWxpemVkfHxhd2FpdCB0aGlzLl9pbml0aWFsaXplKCk7Y29uc3Qgcj1udWxsPT1lP3t9OmUsaT10aGlzLl9leHRyYWN0TmVhclNwZWMocikscz1bXSxvPXt9O2lmKHRoaXMuaW5kZXhlcy5zaXplPjApe2NvbnN0IGU9UnQuc3RhcnQoImNvbGxlY3Rpb24iLCJmaW5kLnF1ZXJ5UGxhbm5pbmciKSx0PWF3YWl0IHRoaXMucGxhblF1ZXJ5QXN5bmMocik7aWYoUnQuZW5kKGUse3VzZUluZGV4OnQudXNlSW5kZXgsZG9jSWRzQ291bnQ6dC5kb2NJZHM/Lmxlbmd0aHx8MH0pLHQudXNlSW5kZXgmJnQuZG9jSWRzJiZ0LmRvY0lkcy5sZW5ndGg+MCl7Y29uc3QgZT1SdC5zdGFydCgiY29sbGVjdGlvbiIsImZpbmQuaW5kZXhMb29rdXAiKTtmb3IoY29uc3QgbiBvZiB0LmRvY0lkcylpZighb1tuXSl7Y29uc3QgZT1hd2FpdCB0aGlzLmRvY3VtZW50cy5zZWFyY2gobik7ZSYmWWUoZSxyKSYmKG9bbl09ITAscy5wdXNoKGUpKX1SdC5lbmQoZSx7ZG9jc0ZvdW5kOnMubGVuZ3RofSl9ZWxzZXtjb25zdCBlPVJ0LnN0YXJ0KCJjb2xsZWN0aW9uIiwiZmluZC5mdWxsU2NhbiIpO2ZvciBhd2FpdChjb25zdCB0IG9mIHRoaXMuZG9jdW1lbnRzKXQmJnQudmFsdWUmJiFvW3QudmFsdWUuX2lkXSYmWWUodC52YWx1ZSxyKSYmKG9bdC52YWx1ZS5faWRdPSEwLHMucHVzaCh0LnZhbHVlKSk7UnQuZW5kKGUse2RvY3NGb3VuZDpzLmxlbmd0aH0pfX1lbHNle2NvbnN0IGU9UnQuc3RhcnQoImNvbGxlY3Rpb24iLCJmaW5kLmZ1bGxTY2FuIik7Zm9yIGF3YWl0KGNvbnN0IHQgb2YgdGhpcy5kb2N1bWVudHMpdCYmdC52YWx1ZSYmIW9bdC52YWx1ZS5faWRdJiZZZSh0LnZhbHVlLHIpJiYob1t0LnZhbHVlLl9pZF09ITAscy5wdXNoKHQudmFsdWUpKTtSdC5lbmQoZSx7ZG9jc0ZvdW5kOnMubGVuZ3RofSl9aWYoaSl7Y29uc3QgZT1SdC5zdGFydCgiY29sbGVjdGlvbiIsImZpbmQubmVhclNvcnQiKTt0aGlzLl9zb3J0QnlOZWFyRGlzdGFuY2UocyxpKSxSdC5lbmQoZSl9Y29uc3QgYT1SdC5zdGFydCgiY29sbGVjdGlvbiIsImZpbmQucHJvamVjdGlvbiIpLGM9cy5tYXAoZT0+dD9FKHQsXyhlKSk6XyhlKSk7cmV0dXJuIFJ0LmVuZChhLHtkb2NzUHJvY2Vzc2VkOmMubGVuZ3RofSksUnQuZW5kKG4se2RvY3NSZXR1cm5lZDpjLmxlbmd0aCxoYXNJbmRleGVzOnRoaXMuaW5kZXhlcy5zaXplPjB9KSxjfV9leHRyYWN0TmVhclNwZWMoZSl7Zm9yKGNvbnN0IHQgb2YgT2JqZWN0LmtleXMoZXx8e30pKXtpZih0LnN0YXJ0c1dpdGgoIiQiKSljb250aW51ZTtjb25zdCBuPWVbdF07aWYobiYmIm9iamVjdCI9PXR5cGVvZiBuKXtpZihuLiRuZWFyKXtjb25zdCBlPXRoaXMuX3BhcnNlTmVhckNvb3JkaW5hdGVzKG4uJG5lYXIpO2lmKGUpcmV0dXJue2ZpZWxkOnQsLi4uZX19aWYobi4kbmVhclNwaGVyZSl7Y29uc3QgZT10aGlzLl9wYXJzZU5lYXJDb29yZGluYXRlcyhuLiRuZWFyU3BoZXJlKTtpZihlKXJldHVybntmaWVsZDp0LC4uLmV9fX19cmV0dXJuIG51bGx9X3BhcnNlTmVhckNvb3JkaW5hdGVzKGUpe2xldCB0O2lmKGUmJiJvYmplY3QiPT10eXBlb2YgZSYmKGUuJGdlb21ldHJ5JiZlLiRnZW9tZXRyeS5jb29yZGluYXRlcz90PWUuJGdlb21ldHJ5LmNvb3JkaW5hdGVzOmUuY29vcmRpbmF0ZXM/dD1lLmNvb3JkaW5hdGVzOkFycmF5LmlzQXJyYXkoZSkmJih0PWUpKSwhdHx8dC5sZW5ndGg8MilyZXR1cm4gbnVsbDtjb25zdFtuLHJdPXQ7cmV0dXJuIm51bWJlciIhPXR5cGVvZiByfHwibnVtYmVyIiE9dHlwZW9mIG4/bnVsbDp7bGF0OnIsbG5nOm59fV9leHRyYWN0UG9pbnRDb29yZGluYXRlcyhlKXtpZighZSlyZXR1cm4gbnVsbDtpZigiRmVhdHVyZUNvbGxlY3Rpb24iPT09ZS50eXBlJiZBcnJheS5pc0FycmF5KGUuZmVhdHVyZXMpJiZlLmZlYXR1cmVzLmxlbmd0aD4wKXJldHVybiB0aGlzLl9leHRyYWN0UG9pbnRDb29yZGluYXRlcyhlLmZlYXR1cmVzWzBdLmdlb21ldHJ5KTtpZigiRmVhdHVyZSI9PT1lLnR5cGUmJmUuZ2VvbWV0cnkpcmV0dXJuIHRoaXMuX2V4dHJhY3RQb2ludENvb3JkaW5hdGVzKGUuZ2VvbWV0cnkpO2lmKCJQb2ludCI9PT1lLnR5cGUmJkFycmF5LmlzQXJyYXkoZS5jb29yZGluYXRlcykmJmUuY29vcmRpbmF0ZXMubGVuZ3RoPj0yKXtjb25zdFt0LG5dPWUuY29vcmRpbmF0ZXM7aWYoIm51bWJlciI9PXR5cGVvZiBuJiYibnVtYmVyIj09dHlwZW9mIHQpcmV0dXJue2xhdDpuLGxuZzp0fX1yZXR1cm4gbnVsbH1fc29ydEJ5TmVhckRpc3RhbmNlKGUsdCl7Y29uc3R7ZmllbGQ6bixsYXQ6cixsbmc6aX09dDtlLnNvcnQoKGUsdCk9Pntjb25zdCBzPXRoaXMuX2V4dHJhY3RQb2ludENvb3JkaW5hdGVzKHYoZSxuKSksbz10aGlzLl9leHRyYWN0UG9pbnRDb29yZGluYXRlcyh2KHQsbikpO3JldHVybihzP3RoaXMuX2hhdmVyc2luZURpc3RhbmNlKHMubGF0LHMubG5nLHIsaSk6MS8wKS0obz90aGlzLl9oYXZlcnNpbmVEaXN0YW5jZShvLmxhdCxvLmxuZyxyLGkpOjEvMCl9KX1faGF2ZXJzaW5lRGlzdGFuY2UoZSx0LG4scil7Y29uc3QgaT0obi1lKSpNYXRoLlBJLzE4MCxzPShyLXQpKk1hdGguUEkvMTgwLG89TWF0aC5zaW4oaS8yKSpNYXRoLnNpbihpLzIpK01hdGguY29zKGUqTWF0aC5QSS8xODApKk1hdGguY29zKG4qTWF0aC5QSS8xODApKk1hdGguc2luKHMvMikqTWF0aC5zaW4ocy8yKTtyZXR1cm4gNjM3MSooMipNYXRoLmF0YW4yKE1hdGguc3FydChvKSxNYXRoLnNxcnQoMS1vKSkpfWZpbmRBbmRNb2RpZnkoKXt0aHJvdyBuZXcgSCgiZmluZEFuZE1vZGlmeSIse2NvbGxlY3Rpb246dGhpcy5uYW1lfSl9YXN5bmMgZmluZE9uZShlLHQpe2NvbnN0IG49dGhpcy5maW5kKGUsdCk7cmV0dXJuIGF3YWl0IG4uX2Vuc3VyZUluaXRpYWxpemVkKCksYXdhaXQgbi5oYXNOZXh0KCk/YXdhaXQgbi5uZXh0KCk6bnVsbH1hc3luYyBmaW5kT25lQW5kRGVsZXRlKGUsdCl7bGV0IG49dGhpcy5maW5kKGUpO2lmKHQmJnQuc29ydD8obj1uLnNvcnQodC5zb3J0KSxhd2FpdCBuLl9lbnN1cmVJbml0aWFsaXplZCgpKTphd2FpdCBuLl9lbnN1cmVJbml0aWFsaXplZCgpLCEoYXdhaXQgbi5oYXNOZXh0KCkpKXJldHVybiBudWxsO2NvbnN0IHI9YXdhaXQgbi5uZXh0KCk7cmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRzLmRlbGV0ZShyLl9pZC50b1N0cmluZygpKSx0JiZ0LnByb2plY3Rpb24/RSh0LnByb2plY3Rpb24scik6cn1hc3luYyBmaW5kT25lQW5kUmVwbGFjZShlLHQsbil7bGV0IHI9dGhpcy5maW5kKGUpO2lmKG4mJm4uc29ydD8ocj1yLnNvcnQobi5zb3J0KSxhd2FpdCByLl9lbnN1cmVJbml0aWFsaXplZCgpKTphd2FpdCByLl9lbnN1cmVJbml0aWFsaXplZCgpLCEoYXdhaXQgci5oYXNOZXh0KCkpKXJldHVybiBudWxsO2NvbnN0IGk9YXdhaXQgci5uZXh0KCk7cmV0dXJuIHQuX2lkPWkuX2lkLGF3YWl0IHRoaXMuZG9jdW1lbnRzLmFkZChpLl9pZC50b1N0cmluZygpLHQpLG4mJm4ucmV0dXJuTmV3RG9jdW1lbnQ/biYmbi5wcm9qZWN0aW9uP0Uobi5wcm9qZWN0aW9uLHQpOnQ6biYmbi5wcm9qZWN0aW9uP0Uobi5wcm9qZWN0aW9uLGkpOml9YXN5bmMgZmluZE9uZUFuZFVwZGF0ZShlLHQsbil7bGV0IHI9dGhpcy5maW5kKGUpO2lmKG4mJm4uc29ydD8ocj1yLnNvcnQobi5zb3J0KSxhd2FpdCByLl9lbnN1cmVJbml0aWFsaXplZCgpKTphd2FpdCByLl9lbnN1cmVJbml0aWFsaXplZCgpLCEoYXdhaXQgci5oYXNOZXh0KCkpKXJldHVybiBudWxsO2NvbnN0IGk9YXdhaXQgci5uZXh0KCkscz1PYmplY3QuYXNzaWduKHt9LGkpO3JldHVybiBjdCh0LHMsITEsWGUoaSxlKS5hcnJheUZpbHRlcnMsbiYmbi5hcnJheUZpbHRlcnMpLGF3YWl0IHRoaXMuZG9jdW1lbnRzLmFkZChpLl9pZC50b1N0cmluZygpLHMpLG4mJm4ucmV0dXJuTmV3RG9jdW1lbnQ/biYmbi5wcm9qZWN0aW9uP0Uobi5wcm9qZWN0aW9uLHMpOnM6biYmbi5wcm9qZWN0aW9uP0Uobi5wcm9qZWN0aW9uLGkpOml9Z2V0SW5kZXhlcygpe2NvbnN0IGU9W107Zm9yKGNvbnN0W3Qsbl1vZiB0aGlzLmluZGV4ZXMpZS5wdXNoKG4uZ2V0U3BlYygpKTtyZXR1cm4gZX1nZXRTaGFyZERpc3RyaWJ1dGlvbigpe3Rocm93IG5ldyBIKCJnZXRTaGFyZERpc3RyaWJ1dGlvbiIse2NvbGxlY3Rpb246dGhpcy5uYW1lfSl9Z2V0U2hhcmRWZXJzaW9uKCl7dGhyb3cgbmV3IEgoImdldFNoYXJkVmVyc2lvbiIse2NvbGxlY3Rpb246dGhpcy5uYW1lfSl9Z2V0U3RvcmUoKXtyZXR1cm4gdGhpcy5kb2N1bWVudHN9Z3JvdXAoKXt0aHJvdyBuZXcgSCgiZ3JvdXAiLHtjb2xsZWN0aW9uOnRoaXMubmFtZX0pfWFzeW5jIGluc2VydChlKXtyZXR1cm4gQXJyYXk9PWUuY29uc3RydWN0b3I/YXdhaXQgdGhpcy5pbnNlcnRNYW55KGUpOmF3YWl0IHRoaXMuaW5zZXJ0T25lKGUpfWFzeW5jIGluc2VydE9uZShlKXtjb25zdCB0PVJ0LnN0YXJ0KCJjb2xsZWN0aW9uIiwiaW5zZXJ0T25lIix7Y29sbGVjdGlvbjp0aGlzLm5hbWV9KTt0aGlzLl9pbml0aWFsaXplZHx8YXdhaXQgdGhpcy5faW5pdGlhbGl6ZSgpLG51bGw9PWUuX2lkJiYoZS5faWQ9bmV3IGcpO2NvbnN0IG49UnQuc3RhcnQoImNvbGxlY3Rpb24iLCJpbnNlcnRPbmUuc3RvcmUiKTthd2FpdCB0aGlzLmRvY3VtZW50cy5hZGQoZS5faWQudG9TdHJpbmcoKSxlKSxSdC5lbmQobik7Y29uc3Qgcj1SdC5zdGFydCgiY29sbGVjdGlvbiIsImluc2VydE9uZS51cGRhdGVJbmRleGVzIik7cmV0dXJuIGF3YWl0IHRoaXMudXBkYXRlSW5kZXhlc09uSW5zZXJ0KGUpLFJ0LmVuZChyLHtpbmRleENvdW50OnRoaXMuaW5kZXhlcy5zaXplfSksdGhpcy5lbWl0KCJpbnNlcnQiLGUpLFJ0LmVuZCh0KSx7aW5zZXJ0ZWRJZDplLl9pZH19YXN5bmMgaW5zZXJ0TWFueShlKXtjb25zdCB0PVJ0LnN0YXJ0KCJjb2xsZWN0aW9uIiwiaW5zZXJ0TWFueSIse2NvbGxlY3Rpb246dGhpcy5uYW1lLGRvY0NvdW50OmUubGVuZ3RofSk7dGhpcy5faW5pdGlhbGl6ZWR8fGF3YWl0IHRoaXMuX2luaXRpYWxpemUoKTtjb25zdCBuPVtdO2ZvcihsZXQgcj0wO3I8ZS5sZW5ndGg7cisrKXtjb25zdCB0PWF3YWl0IHRoaXMuaW5zZXJ0T25lKGVbcl0pO24ucHVzaCh0Lmluc2VydGVkSWQpfXJldHVybiBSdC5lbmQodCx7aW5zZXJ0ZWRDb3VudDpuLmxlbmd0aH0pLHtpbnNlcnRlZElkczpufX1pc0NhcHBlZCgpe3Rocm93IG5ldyBIKCJpc0NhcHBlZCIse2NvbGxlY3Rpb246dGhpcy5uYW1lfSl9bWFwUmVkdWNlKCl7dGhyb3cgbmV3IEgoIm1hcFJlZHVjZSIse2NvbGxlY3Rpb246dGhpcy5uYW1lfSl9cmVJbmRleCgpe3Rocm93IG5ldyBIKCJyZUluZGV4Iix7Y29sbGVjdGlvbjp0aGlzLm5hbWV9KX1hc3luYyByZXBsYWNlT25lKGUsdCxuKXtjb25zdCByPXt9LGk9dGhpcy5maW5kKGUpO2lmKGF3YWl0IGkuX2Vuc3VyZUluaXRpYWxpemVkKCksci5tYXRjaGVkQ291bnQ9YXdhaXQgaS5jb3VudCgpLDA9PXIubWF0Y2hlZENvdW50KXtpZihyLm1vZGlmaWVkQ291bnQ9MCxuJiZuLnVwc2VydCl7Y29uc3QgZT10O2UuX2lkPW5ldyBnLGF3YWl0IHRoaXMuZG9jdW1lbnRzLmFkZChlLl9pZC50b1N0cmluZygpLGUpLGF3YWl0IHRoaXMudXBkYXRlSW5kZXhlc09uSW5zZXJ0KGUpLHRoaXMuZW1pdCgiaW5zZXJ0IixlKSxyLnVwc2VydGVkSWQ9ZS5faWR9fWVsc2V7ci5tb2RpZmllZENvdW50PTE7Y29uc3QgZT1hd2FpdCBpLm5leHQoKTthd2FpdCB0aGlzLnVwZGF0ZUluZGV4ZXNPbkRlbGV0ZShlKSx0Ll9pZD1lLl9pZCx0aGlzLmRvY3VtZW50cy5hZGQoZS5faWQudG9TdHJpbmcoKSx0KSxhd2FpdCB0aGlzLnVwZGF0ZUluZGV4ZXNPbkluc2VydCh0KSx0aGlzLmVtaXQoInJlcGxhY2UiLHQpfXJldHVybiByfWFzeW5jIHJlbW92ZShlLHQpe2NvbnN0IG49dGhpcy5maW5kKGUpO2lmKGF3YWl0IG4uX2Vuc3VyZUluaXRpYWxpemVkKCksYXdhaXQgbi5oYXNOZXh0KCkpaWYoITA9PT10fHx0JiZ0Lmp1c3RPbmUpe2NvbnN0IGU9YXdhaXQgbi5uZXh0KCk7YXdhaXQgdGhpcy51cGRhdGVJbmRleGVzT25EZWxldGUoZSksdGhpcy5kb2N1bWVudHMuZGVsZXRlKGUuX2lkLnRvU3RyaW5nKCkpfWVsc2UgZm9yKDthd2FpdCBuLmhhc05leHQoKTspe2NvbnN0IGU9YXdhaXQgbi5uZXh0KCk7YXdhaXQgdGhpcy51cGRhdGVJbmRleGVzT25EZWxldGUoZSksdGhpcy5kb2N1bWVudHMuZGVsZXRlKGUuX2lkLnRvU3RyaW5nKCkpfX1yZW5hbWVDb2xsZWN0aW9uKCl7dGhyb3cgbmV3IEgoInJlbmFtZUNvbGxlY3Rpb24iLHtjb2xsZWN0aW9uOnRoaXMubmFtZX0pfXNhdmUoKXt0aHJvdyBuZXcgSCgic2F2ZSIse2NvbGxlY3Rpb246dGhpcy5uYW1lfSl9c3RhdHMoKXt0aHJvdyBuZXcgSCgic3RhdHMiLHtjb2xsZWN0aW9uOnRoaXMubmFtZX0pfXN0b3JhZ2VTaXplKCl7dGhyb3cgbmV3IEgoInN0b3JhZ2VTaXplIix7Y29sbGVjdGlvbjp0aGlzLm5hbWV9KX10b3RhbFNpemUoKXt0aHJvdyBuZXcgSCgidG90YWxTaXplIix7Y29sbGVjdGlvbjp0aGlzLm5hbWV9KX10b3RhbEluZGV4U2l6ZSgpe3Rocm93IG5ldyBIKCJ0b3RhbEluZGV4U2l6ZSIse2NvbGxlY3Rpb246dGhpcy5uYW1lfSl9YXN5bmMgdXBkYXRlKGUsdCxuKXtjb25zdCByPXRoaXMuZmluZChlKTtpZihhd2FpdCByLl9lbnN1cmVJbml0aWFsaXplZCgpLGF3YWl0IHIuaGFzTmV4dCgpKWlmKG4mJm4ubXVsdGkpZm9yKDthd2FpdCByLmhhc05leHQoKTspe2NvbnN0IGk9YXdhaXQgci5uZXh0KCkscz1YZShpLGUpLmFycmF5RmlsdGVycyxvPW4mJm4uYXJyYXlGaWx0ZXJzO2F3YWl0IHRoaXMudXBkYXRlSW5kZXhlc09uRGVsZXRlKGkpLGN0KHQsaSwhMSxzLG8pLGF3YWl0IHRoaXMuZG9jdW1lbnRzLmFkZChpLl9pZC50b1N0cmluZygpLGkpLGF3YWl0IHRoaXMudXBkYXRlSW5kZXhlc09uSW5zZXJ0KGkpfWVsc2V7Y29uc3QgaT1hd2FpdCByLm5leHQoKSxzPVhlKGksZSkuYXJyYXlGaWx0ZXJzLG89biYmbi5hcnJheUZpbHRlcnM7YXdhaXQgdGhpcy51cGRhdGVJbmRleGVzT25EZWxldGUoaSksY3QodCxpLCExLHMsbyksYXdhaXQgdGhpcy5kb2N1bWVudHMuYWRkKGkuX2lkLnRvU3RyaW5nKCksaSksYXdhaXQgdGhpcy51cGRhdGVJbmRleGVzT25JbnNlcnQoaSl9ZWxzZSBpZihuJiZuLnVwc2VydCl7Y29uc3Qgbj1sdChlLHQsbmV3IGcpO2F3YWl0IHRoaXMuZG9jdW1lbnRzLmFkZChuLl9pZC50b1N0cmluZygpLG4pLGF3YWl0IHRoaXMudXBkYXRlSW5kZXhlc09uSW5zZXJ0KG4pfX1hc3luYyB1cGRhdGVPbmUoZSx0LG4pe2NvbnN0IHI9UnQuc3RhcnQoImNvbGxlY3Rpb24iLCJ1cGRhdGVPbmUiLHtjb2xsZWN0aW9uOnRoaXMubmFtZX0pLGk9UnQuc3RhcnQoImNvbGxlY3Rpb24iLCJ1cGRhdGVPbmUuZmluZCIpLHM9dGhpcy5maW5kKGUpO2lmKGF3YWl0IHMuX2Vuc3VyZUluaXRpYWxpemVkKCksUnQuZW5kKGkpLGF3YWl0IHMuaGFzTmV4dCgpKXtjb25zdCByPWF3YWl0IHMubmV4dCgpLGk9SlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShyKSksbz1YZShyLGUpLmFycmF5RmlsdGVycyxhPW4mJm4uYXJyYXlGaWx0ZXJzLGM9UnQuc3RhcnQoImNvbGxlY3Rpb24iLCJ1cGRhdGVPbmUudXBkYXRlSW5kZXhlc09uRGVsZXRlIik7YXdhaXQgdGhpcy51cGRhdGVJbmRleGVzT25EZWxldGUociksUnQuZW5kKGMpO2NvbnN0IGw9UnQuc3RhcnQoImNvbGxlY3Rpb24iLCJ1cGRhdGVPbmUuYXBwbHlVcGRhdGVzIik7Y3QodCxyLCExLG8sYSksUnQuZW5kKGwpO2NvbnN0IHU9UnQuc3RhcnQoImNvbGxlY3Rpb24iLCJ1cGRhdGVPbmUuc3RvcmUiKTt0aGlzLmRvY3VtZW50cy5hZGQoci5faWQudG9TdHJpbmcoKSxyKSxSdC5lbmQodSk7Y29uc3QgaD1SdC5zdGFydCgiY29sbGVjdGlvbiIsInVwZGF0ZU9uZS51cGRhdGVJbmRleGVzT25JbnNlcnQiKTthd2FpdCB0aGlzLnVwZGF0ZUluZGV4ZXNPbkluc2VydChyKSxSdC5lbmQoaCx7aW5kZXhDb3VudDp0aGlzLmluZGV4ZXMuc2l6ZX0pO2NvbnN0IGY9dGhpcy5fZ2V0VXBkYXRlRGVzY3JpcHRpb24oaSxyKTt0aGlzLmVtaXQoInVwZGF0ZSIscixmKX1lbHNlIGlmKG4mJm4udXBzZXJ0KXtjb25zdCBuPWx0KGUsdCxuZXcgZyk7dGhpcy5kb2N1bWVudHMuYWRkKG4uX2lkLnRvU3RyaW5nKCksbiksYXdhaXQgdGhpcy51cGRhdGVJbmRleGVzT25JbnNlcnQobiksdGhpcy5lbWl0KCJpbnNlcnQiLG4pfVJ0LmVuZChyKX1hc3luYyB1cGRhdGVNYW55KGUsdCxuKXtjb25zdCByPVJ0LnN0YXJ0KCJjb2xsZWN0aW9uIiwidXBkYXRlTWFueSIse2NvbGxlY3Rpb246dGhpcy5uYW1lfSksaT1SdC5zdGFydCgiY29sbGVjdGlvbiIsInVwZGF0ZU1hbnkuZmluZCIpLHM9dGhpcy5maW5kKGUpO2F3YWl0IHMuX2Vuc3VyZUluaXRpYWxpemVkKCksUnQuZW5kKGkpO2xldCBvPTA7aWYoYXdhaXQgcy5oYXNOZXh0KCkpZm9yKDthd2FpdCBzLmhhc05leHQoKTspe2NvbnN0IHI9YXdhaXQgcy5uZXh0KCksaT1KU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHIpKSxhPVhlKHIsZSkuYXJyYXlGaWx0ZXJzLGM9biYmbi5hcnJheUZpbHRlcnM7YXdhaXQgdGhpcy51cGRhdGVJbmRleGVzT25EZWxldGUociksY3QodCxyLCExLGEsYyksdGhpcy5kb2N1bWVudHMuYWRkKHIuX2lkLnRvU3RyaW5nKCksciksYXdhaXQgdGhpcy51cGRhdGVJbmRleGVzT25JbnNlcnQocik7Y29uc3QgbD10aGlzLl9nZXRVcGRhdGVEZXNjcmlwdGlvbihpLHIpO3RoaXMuZW1pdCgidXBkYXRlIixyLGwpLG8rK31lbHNlIGlmKG4mJm4udXBzZXJ0KXtjb25zdCBuPWx0KGUsdCxuZXcgZyk7dGhpcy5kb2N1bWVudHMuYWRkKG4uX2lkLnRvU3RyaW5nKCksbiksYXdhaXQgdGhpcy51cGRhdGVJbmRleGVzT25JbnNlcnQobiksdGhpcy5lbWl0KCJpbnNlcnQiLG4pfVJ0LmVuZChyLHt1cGRhdGVkQ291bnQ6b30pfXZhbGlkYXRlKCl7dGhyb3cgbmV3IEgoInZhbGlkYXRlIix7Y29sbGVjdGlvbjp0aGlzLm5hbWV9KX1fZ2V0VXBkYXRlRGVzY3JpcHRpb24oZSx0KXtjb25zdCBuPXt9LHI9W107Zm9yKGNvbnN0IGkgaW4gdCkiX2lkIiE9PWkmJkpTT04uc3RyaW5naWZ5KGVbaV0pIT09SlNPTi5zdHJpbmdpZnkodFtpXSkmJihuW2ldPXRbaV0pO2Zvcihjb25zdCBpIGluIGUpIl9pZCIhPT1pJiYoaSBpbiB0fHxyLnB1c2goaSkpO3JldHVybnt1cGRhdGVkRmllbGRzOm4scmVtb3ZlZEZpZWxkczpyLHRydW5jYXRlZEFycmF5czpbXX19d2F0Y2goZT1bXSx0PXt9KXtyZXR1cm4gbmV3IFV0KHRoaXMsZSx0KX19ZnVuY3Rpb24gVnQoZSx0KXtjb25zdCBuPXt9LHI9T2JqZWN0LmtleXMoZSk7bGV0IGk9ITEscz0hMTtmb3IoY29uc3QgbyBvZiByKXtpZigiX2lkIj09PW8pY29udGludWU7Y29uc3QgdD1lW29dOzE9PT10fHwhMD09PXQ/aT0hMDowPT09dHx8ITE9PT10fHwocz0hMCl9aWYoc3x8aSl7MCE9PWUuX2lkJiYhMSE9PWUuX2lkJiYobi5faWQ9dC5faWQpO2Zvcihjb25zdCBpIG9mIHIpe2NvbnN0IHI9ZVtpXTsiX2lkIj09PWk/MCE9PXImJiExIT09cnx8ZGVsZXRlIG4uX2lkOm5baV09MT09PXJ8fCEwPT09cj92KHQsaSk6SWUocix0KX19ZWxzZXtmb3IoY29uc3QgZSBpbiB0KXQuaGFzT3duUHJvcGVydHkoZSkmJihuW2VdPXRbZV0pO2Zvcihjb25zdCB0IG9mIHIpMCE9PWVbdF0mJiExIT09ZVt0XXx8ZGVsZXRlIG5bdF19cmV0dXJuIG59Y2xhc3MgSHR7Y29uc3RydWN0b3IoZSl7dGhpcy5vcHRpb25zPWV8fHt9LHRoaXMuYmFzZUZvbGRlcj10aGlzLm9wdGlvbnMuYmFzZUZvbGRlcnx8Im1pY3JvLW1vbmdvIix0aGlzLmRiTmFtZT10aGlzLm9wdGlvbnMuZGJOYW1lfHwiZGVmYXVsdCIsdGhpcy5kYkZvbGRlcj1gJHt0aGlzLmJhc2VGb2xkZXJ9LyR7dGhpcy5kYk5hbWV9YCx0aGlzLmNvbGxlY3Rpb25zPS8qIEBfX1BVUkVfXyAqL25ldyBNYXA7Y29uc3QgdD1uZXcgUHJveHkodGhpcyx7Z2V0OihlLHQsbik9PnQgaW4gZT9SZWZsZWN0LmdldChlLHQsbik6InN5bWJvbCI9PXR5cGVvZiB0fHx0LnN0YXJ0c1dpdGgoIl8iKT92b2lkIDA6InN0cmluZyI9PXR5cGVvZiB0P2UuZ2V0Q29sbGVjdGlvbih0KTp2b2lkIDB9KTtyZXR1cm4gdGhpcy5fcHJveHk9dCx0fWFzeW5jIGNsb3NlKCl7Zm9yKGNvbnN0W2UsdF1vZiB0aGlzLmNvbGxlY3Rpb25zKWF3YWl0IHQuY2xvc2UoKX1jbG9uZUNvbGxlY3Rpb24oKXt0aHJvdyBuZXcgSCgiY2xvbmVDb2xsZWN0aW9uIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX1jbG9uZURhdGFiYXNlKCl7dGhyb3cgbmV3IEgoImNsb25lRGF0YWJhc2UiLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfWNvbW1hbmRIZWxwKCl7dGhyb3cgbmV3IEgoImNvbW1hbmRIZWxwIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX1jb3B5RGF0YWJhc2UoKXt0aHJvdyBuZXcgSCgiY29weURhdGFiYXNlIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX1jcmVhdGVDb2xsZWN0aW9uKGUpe3JldHVybiB0aGlzLmNvbGxlY3Rpb25zLmhhcyhlKXx8dGhpcy5jb2xsZWN0aW9ucy5zZXQoZSxuZXcgcXQodGhpcyxlKSkse29rOjF9fWN1cnJlbnRPcCgpe3Rocm93IG5ldyBIKCJjdXJyZW50T3AiLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfWFzeW5jIGRyb3BDb2xsZWN0aW9uKGUpe2lmKHRoaXMuY29sbGVjdGlvbnMuaGFzKGUpKXtjb25zdCB0PXRoaXMuY29sbGVjdGlvbnMuZ2V0KGUpOyJmdW5jdGlvbiI9PXR5cGVvZiB0LmRyb3AmJmF3YWl0IHQuZHJvcCgpLHRoaXMuY29sbGVjdGlvbnMuZGVsZXRlKGUpfX1hc3luYyBkcm9wRGF0YWJhc2UoKXtmb3IoY29uc3RbcixpXW9mIHRoaXMuY29sbGVjdGlvbnMpYXdhaXQgaS5kcm9wKCk7dGhpcy5jb2xsZWN0aW9ucy5jbGVhcigpO2NvbnN0IGU9dGhpcy5kYkZvbGRlci5zcGxpdCgiLyIpLmZpbHRlcihCb29sZWFuKSx0PWUucG9wKCk7dHJ5e2xldCBuPWF3YWl0IGdsb2JhbFRoaXMubmF2aWdhdG9yLnN0b3JhZ2UuZ2V0RGlyZWN0b3J5KCk7Zm9yKGNvbnN0IHQgb2YgZSluPWF3YWl0IG4uZ2V0RGlyZWN0b3J5SGFuZGxlKHQse2NyZWF0ZTohMX0pO2F3YWl0IG4ucmVtb3ZlRW50cnkodCx7cmVjdXJzaXZlOiEwfSl9Y2F0Y2gobil7aWYoIk5vdEZvdW5kRXJyb3IiIT09bi5uYW1lJiYiRU5PRU5UIiE9PW4uY29kZSl0aHJvdyBufXJldHVybntvazoxfX1ldmFsKCl7dGhyb3cgbmV3IEgoImV2YWwiLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfWZzeW5jTG9jaygpe3Rocm93IG5ldyBIKCJmc3luY0xvY2siLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfWZzeW5jVW5sb2NrKCl7dGhyb3cgbmV3IEgoImZzeW5jVW5sb2NrIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX1nZXRDb2xsZWN0aW9uKGUpe2lmKCF0aGlzLmNvbGxlY3Rpb25zLmhhcyhlKSl7Y29uc3QgdD10aGlzLl9wcm94eXx8dGhpczt0aGlzLmNvbGxlY3Rpb25zLnNldChlLG5ldyBxdCh0LGUpKX1yZXR1cm4gdGhpcy5jb2xsZWN0aW9ucy5nZXQoZSl9Y29sbGVjdGlvbihlKXtyZXR1cm4gdGhpcy5nZXRDb2xsZWN0aW9uKGUpfWdldENvbGxlY3Rpb25JbmZvcygpe3Rocm93IG5ldyBIKCJnZXRDb2xsZWN0aW9uSW5mb3MiLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfWdldENvbGxlY3Rpb25OYW1lcygpe3JldHVybiBBcnJheS5mcm9tKHRoaXMuY29sbGVjdGlvbnMua2V5cygpKX1nZXRMYXN0RXJyb3IoKXt0aHJvdyBuZXcgSCgiZ2V0TGFzdEVycm9yIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX1nZXRMYXN0RXJyb3JPYmooKXt0aHJvdyBuZXcgSCgiZ2V0TGFzdEVycm9yT2JqIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX1nZXRMb2dDb21wb25lbnRzKCl7dGhyb3cgbmV3IEgoImdldExvZ0NvbXBvbmVudHMiLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfWdldE1vbmdvKCl7dGhyb3cgbmV3IEgoImdldE1vbmdvIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX1nZXROYW1lKCl7dGhyb3cgbmV3IEgoImdldE5hbWUiLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfWdldFByZXZFcnJvcigpe3Rocm93IG5ldyBIKCJnZXRQcmV2RXJyb3IiLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfWdldFByb2ZpbGluZ0xldmVsKCl7dGhyb3cgbmV3IEgoImdldFByb2ZpbGluZ0xldmVsIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX1nZXRQcm9maWxpbmdTdGF0dXMoKXt0aHJvdyBuZXcgSCgiZ2V0UHJvZmlsaW5nU3RhdHVzIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX1nZXRSZXBsaWNhdGlvbkluZm8oKXt0aHJvdyBuZXcgSCgiZ2V0UmVwbGljYXRpb25JbmZvIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX1nZXRTaWJsaW5nREIoKXt0aHJvdyBuZXcgSCgiZ2V0U2libGluZ0RCIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX1oZWxwKCl7Y29uc29sZS5sb2coIiAgICAgICAgaGVscCBtciAgICAgICAgICAgICAgICAgICAgICBtYXByZWR1Y2UiKSxjb25zb2xlLmxvZygiICAgICAgICBkYi5mb28uZmluZCgpICAgICAgICAgICAgICAgIGxpc3Qgb2JqZWN0cyBpbiBjb2xsZWN0aW9uIGZvbyIpLGNvbnNvbGUubG9nKCIgICAgICAgIGRiLmZvby5maW5kKCB7IGEgOiAxIH0gKSAgICAgbGlzdCBvYmplY3RzIGluIGZvbyB3aGVyZSBhID09IDEiKSxjb25zb2xlLmxvZygiICAgICAgICBpdCAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCBvZiB0aGUgbGFzdCBsaW5lIGV2YWx1YXRlZDsgdXNlIHRvIGZ1cnRoZXIgaXRlcmF0ZSIpfWhvc3RJbmZvKCl7dGhyb3cgbmV3IEgoImhvc3RJbmZvIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX1pc01hc3Rlcigpe3Rocm93IG5ldyBIKCJpc01hc3RlciIse2RhdGFiYXNlOnRoaXMuZGJOYW1lfSl9a2lsbE9wKCl7dGhyb3cgbmV3IEgoImtpbGxPcCIse2RhdGFiYXNlOnRoaXMuZGJOYW1lfSl9bGlzdENvbW1hbmRzKCl7dGhyb3cgbmV3IEgoImxpc3RDb21tYW5kcyIse2RhdGFiYXNlOnRoaXMuZGJOYW1lfSl9bG9hZFNlcnZlclNjcmlwdHMoKXt0aHJvdyBuZXcgSCgibG9hZFNlcnZlclNjcmlwdHMiLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfWxvZ291dCgpe3Rocm93IG5ldyBIKCJsb2dvdXQiLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfXByaW50Q29sbGVjdGlvblN0YXRzKCl7dGhyb3cgbmV3IEgoInByaW50Q29sbGVjdGlvblN0YXRzIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX1wcmludFJlcGxpY2F0aW9uSW5mbygpe3Rocm93IG5ldyBIKCJwcmludFJlcGxpY2F0aW9uSW5mbyIse2RhdGFiYXNlOnRoaXMuZGJOYW1lfSl9cHJpbnRTaGFyZGluZ1N0YXR1cygpe3Rocm93IG5ldyBIKCJwcmludFNoYXJkaW5nU3RhdHVzIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX1wcmludFNsYXZlUmVwbGljYXRpb25JbmZvKCl7dGhyb3cgbmV3IEgoInByaW50U2xhdmVSZXBsaWNhdGlvbkluZm8iLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfXJlcGFpckRhdGFiYXNlKCl7dGhyb3cgbmV3IEgoInJlcGFpckRhdGFiYXNlIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX1yZXNldEVycm9yKCl7dGhyb3cgbmV3IEgoInJlc2V0RXJyb3IiLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfXJ1bkNvbW1hbmQoKXt0aHJvdyBuZXcgSCgicnVuQ29tbWFuZCIse2RhdGFiYXNlOnRoaXMuZGJOYW1lfSl9c2VydmVyQnVpbGRJbmZvKCl7dGhyb3cgbmV3IEgoInNlcnZlckJ1aWxkSW5mbyIse2RhdGFiYXNlOnRoaXMuZGJOYW1lfSl9c2VydmVyQ21kTGluZU9wdHMoKXt0aHJvdyBuZXcgSCgic2VydmVyQ21kTGluZU9wdHMiLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfXNlcnZlclN0YXR1cygpe3Rocm93IG5ldyBIKCJzZXJ2ZXJTdGF0dXMiLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfXNldExvZ0xldmVsKCl7dGhyb3cgbmV3IEgoInNldExvZ0xldmVsIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX1zZXRQcm9maWxpbmdMZXZlbCgpe3Rocm93IG5ldyBIKCJzZXRQcm9maWxpbmdMZXZlbCIse2RhdGFiYXNlOnRoaXMuZGJOYW1lfSl9c2h1dGRvd25TZXJ2ZXIoKXt0aHJvdyBuZXcgSCgic2h1dGRvd25TZXJ2ZXIiLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfXN0YXRzKCl7dGhyb3cgbmV3IEgoInN0YXRzIix7ZGF0YWJhc2U6dGhpcy5kYk5hbWV9KX12ZXJzaW9uKCl7dGhyb3cgbmV3IEgoInZlcnNpb24iLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfXVwZ3JhZGVDaGVjaygpe3Rocm93IG5ldyBIKCJ1cGdyYWRlQ2hlY2siLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfXVwZ3JhZGVDaGVja0FsbERCcygpe3Rocm93IG5ldyBIKCJ1cGdyYWRlQ2hlY2tBbGxEQnMiLHtkYXRhYmFzZTp0aGlzLmRiTmFtZX0pfXdhdGNoKGU9W10sdD17fSl7cmV0dXJuIG5ldyBVdCh0aGlzLGUsdCl9fWNsYXNzIFd0e2NvbnN0cnVjdG9yKGU9e30sdD0oKT0+e30pe3RoaXMub3B0aW9ucz1lLHRoaXMuZGF0YWJhc2VzPS8qIEBfX1BVUkVfXyAqL25ldyBNYXAsdGhpcy5wb3N0RXZlbnQ9dCx0aGlzLmN1cnNvcnM9LyogQF9fUFVSRV9fICovbmV3IE1hcCx0aGlzLmN1cnNvckNvdW50ZXI9MSx0aGlzLnN0cmVhbXM9LyogQF9fUFVSRV9fICovbmV3IE1hcCx0aGlzLnN0cmVhbUNvdW50ZXI9MX1hc3luYyBkaXNwYXRjaChlKXtjb25zdHt0YXJnZXQ6dCxkYXRhYmFzZTpuLGNvbGxlY3Rpb246cixtZXRob2Q6aSxhcmdzOnM9W10sY3Vyc29ySWQ6byxzdHJlYW1JZDphLGN1cnNvck9wdHM6Y309ZTtpZigiY3Vyc29yIj09PXQpcmV0dXJuIGF3YWl0IHRoaXMuX2N1cnNvck9wKG8saSxzKTtpZigiY2hhbmdlc3RyZWFtIj09PXQpcmV0dXJuIGF3YWl0IHRoaXMuX2NoYW5nZVN0cmVhbU9wKGEsaSxzKTtpZigiY2xpZW50Ij09PXQpcmV0dXJuIGF3YWl0IHRoaXMuX2NhbGwodGhpcyxpLHMpO2lmKCF0fHwhbnx8IWkpdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIHJlcXVlc3QgcGF5bG9hZCIpO2NvbnN0IGw9dGhpcy5fZ2V0REIobik7aWYoImRiIj09PXQpcmV0dXJuIGF3YWl0IHRoaXMuX2NhbGwobCxpLHMpO2lmKCJjb2xsZWN0aW9uIj09PXQpe2lmKCFyKXRocm93IG5ldyBFcnJvcigiQ29sbGVjdGlvbiBuYW1lIHJlcXVpcmVkIGZvciBjb2xsZWN0aW9uIHRhcmdldCIpO2NvbnN0IGU9bC5jb2xsZWN0aW9uKHIpO3JldHVybiBhd2FpdCB0aGlzLl9jYWxsKGUsaSxzLGMpfXRocm93IG5ldyBFcnJvcihgVW5rbm93biB0YXJnZXQ6ICR7dH1gKX1fZ2V0REIoZSl7aWYodGhpcy5kYXRhYmFzZXMuaGFzKGUpKXJldHVybiB0aGlzLmRhdGFiYXNlcy5nZXQoZSk7Y29uc3QgdD1uZXcgSHQoey4uLnRoaXMub3B0aW9ucyxkYk5hbWU6ZX0pO3JldHVybiB0aGlzLmRhdGFiYXNlcy5zZXQoZSx0KSx0fWFzeW5jIF9jYWxsKGUsdCxuLHIpe2lmKCJmdW5jdGlvbiIhPXR5cGVvZiBlW3RdKXRocm93IG5ldyBFcnJvcihgTWV0aG9kICR7dH0gbm90IGZvdW5kIG9uIHRhcmdldGApO2NvbnN0IGk9ZVt0XSguLi5ufHxbXSkscz1pJiYiZnVuY3Rpb24iPT10eXBlb2YgaS50aGVuP2F3YWl0IGk6aTtyZXR1cm4gcyYmImZ1bmN0aW9uIj09dHlwZW9mIHMuaGFzTmV4dCYmImZ1bmN0aW9uIj09dHlwZW9mIHMubmV4dD9hd2FpdCB0aGlzLl9yZWdpc3RlckN1cnNvcihzLHIpOiJhZ2dyZWdhdGUiPT09dCYmQXJyYXkuaXNBcnJheShzKT9hd2FpdCB0aGlzLl9yZWdpc3RlckFycmF5QXNDdXJzb3Iocyk6cyYmIkNoYW5nZVN0cmVhbSI9PT1zLmNvbnN0cnVjdG9yPy5uYW1lfHxzJiYiZnVuY3Rpb24iPT10eXBlb2Ygcy5vbiYmcy5oYXNPd25Qcm9wZXJ0eSgicGlwZWxpbmUiKSYmcy5oYXNPd25Qcm9wZXJ0eSgiX2NoYW5nZUNvdW50ZXIiKT90aGlzLl9yZWdpc3RlckNoYW5nZVN0cmVhbShzKTpzfWFzeW5jIF9yZWdpc3RlckN1cnNvcihlLHQ9e30pe3Quc29ydCYmKGU9ZS5zb3J0KHQuc29ydCkpLHQuc2tpcCYmKGU9YXdhaXQgZS5za2lwKHQuc2tpcCkpLHQubGltaXQmJihlPWF3YWl0IGUubGltaXQodC5saW1pdCkpLHQubWluJiZlLm1pbiYmKGU9ZS5taW4odC5taW4pKSx0Lm1heCYmZS5tYXgmJihlPWUubWF4KHQubWF4KSksdC5oaW50JiZlLmhpbnQmJihlPWUuaGludCh0LmhpbnQpKSx0LmNvbW1lbnQmJmUuY29tbWVudCYmKGU9ZS5jb21tZW50KHQuY29tbWVudCkpLHQubWF4VGltZU1TJiZlLm1heFRpbWVNUyYmKGU9ZS5tYXhUaW1lTVModC5tYXhUaW1lTVMpKSx0Lm1heFNjYW4mJmUubWF4U2NhbiYmKGU9ZS5tYXhTY2FuKHQubWF4U2NhbikpLHQucmV0dXJuS2V5JiZlLnJldHVybktleSYmKGU9ZS5yZXR1cm5LZXkodC5yZXR1cm5LZXkpKSx0LnNob3dSZWNvcmRJZCYmZS5zaG93UmVjb3JkSWQmJihlPWUuc2hvd1JlY29yZElkKHQuc2hvd1JlY29yZElkKSksdC5jb2xsYXRpb24mJmUuY29sbGF0aW9uJiYoZT1lLmNvbGxhdGlvbih0LmNvbGxhdGlvbikpO2NvbnN0IG49ImN1cl8iK3RoaXMuY3Vyc29yQ291bnRlcisrLHI9dGhpcy5vcHRpb25zLmJhdGNoU2l6ZXx8MTAwLGk9W107Zm9yKDtpLmxlbmd0aDxyJiZhd2FpdCBlLmhhc05leHQoKTspaS5wdXNoKGF3YWl0IGUubmV4dCgpKTtjb25zdCBzPSEoYXdhaXQgZS5oYXNOZXh0KCkpO3JldHVybiBzfHx0aGlzLmN1cnNvcnMuc2V0KG4sZSkse2N1cnNvcklkOm4sYmF0Y2g6aSxleGhhdXN0ZWQ6cyxiYXRjaFNpemU6cn19YXN5bmMgX3JlZ2lzdGVyQXJyYXlBc0N1cnNvcihlKXtjb25zdCB0PSJjdXJfIit0aGlzLmN1cnNvckNvdW50ZXIrKyxuPXRoaXMub3B0aW9ucy5iYXRjaFNpemV8fDEwMCxyPWUuc2xpY2UoMCxuKSxpPWUubGVuZ3RoPD1uO2lmKCFpKXtjb25zdCByPXtwb3NpdGlvbjpuLGFycmF5OmUsYXN5bmMgaGFzTmV4dCgpe3JldHVybiB0aGlzLnBvc2l0aW9uPHRoaXMuYXJyYXkubGVuZ3RofSxhc3luYyBuZXh0KCl7aWYodGhpcy5wb3NpdGlvbj49dGhpcy5hcnJheS5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKCJObyBtb3JlIGRvY3VtZW50cyIpO3JldHVybiB0aGlzLmFycmF5W3RoaXMucG9zaXRpb24rK119fTt0aGlzLmN1cnNvcnMuc2V0KHQscil9cmV0dXJue2N1cnNvcklkOnQsYmF0Y2g6cixleGhhdXN0ZWQ6aSxiYXRjaFNpemU6bn19YXN5bmMgX2N1cnNvck9wKGUsdCxuPVtdKXtpZighZSl0aHJvdyBuZXcgRXJyb3IoImN1cnNvcklkIHJlcXVpcmVkIik7Y29uc3Qgcj10aGlzLmN1cnNvcnMuZ2V0KGUpO2lmKCFyKXtpZigiY2xvc2UiPT09dClyZXR1cm57Y2xvc2VkOiEwfTt0aHJvdyBuZXcgRXJyb3IoYEN1cnNvciBub3QgZm91bmQ6ICR7ZX1gKX1pZigiY2xvc2UiPT09dClyZXR1cm4gdGhpcy5jdXJzb3JzLmRlbGV0ZShlKSx7Y2xvc2VkOiEwfTtpZigiZ2V0TW9yZSI9PT10KXtjb25zdCB0PShuPy5bMF18fHt9KS5iYXRjaFNpemV8fDEwMCxpPVtdO2Zvcig7aS5sZW5ndGg8dCYmYXdhaXQgci5oYXNOZXh0KCk7KWkucHVzaChhd2FpdCByLm5leHQoKSk7Y29uc3Qgcz0hKGF3YWl0IHIuaGFzTmV4dCgpKTtyZXR1cm4gcyYmdGhpcy5jdXJzb3JzLmRlbGV0ZShlKSx7YmF0Y2g6aSxleGhhdXN0ZWQ6cyxiYXRjaFNpemU6dH19dGhyb3cgbmV3IEVycm9yKGBVbmtub3duIGN1cnNvciBtZXRob2Q6ICR7dH1gKX1fcmVnaXN0ZXJDaGFuZ2VTdHJlYW0oZSl7Y29uc3QgdD0iY3NfIit0aGlzLnN0cmVhbUNvdW50ZXIrKyxuPXtjaGFuZ2U6ZT0+dGhpcy5wb3N0RXZlbnQoe3R5cGU6ImV2ZW50IixldmVudDoiY2hhbmdlU3RyZWFtIixwYXlsb2FkOntzdHJlYW1JZDp0LHR5cGU6ImNoYW5nZSIsZGF0YTplfX0pLGVycm9yOmU9PnRoaXMucG9zdEV2ZW50KHt0eXBlOiJldmVudCIsZXZlbnQ6ImNoYW5nZVN0cmVhbSIscGF5bG9hZDp7c3RyZWFtSWQ6dCx0eXBlOiJlcnJvciIsZGF0YTp7bmFtZTplPy5uYW1lLG1lc3NhZ2U6ZT8ubWVzc2FnZSxzdGFjazplPy5zdGFja319fSksY2xvc2U6KCk9PnRoaXMucG9zdEV2ZW50KHt0eXBlOiJldmVudCIsZXZlbnQ6ImNoYW5nZVN0cmVhbSIscGF5bG9hZDp7c3RyZWFtSWQ6dCx0eXBlOiJjbG9zZSJ9fSl9O3JldHVybiBlLm9uKCJjaGFuZ2UiLG4uY2hhbmdlKSxlLm9uKCJlcnJvciIsbi5lcnJvciksZS5vbigiY2xvc2UiLG4uY2xvc2UpLHRoaXMuc3RyZWFtcy5zZXQodCx7c3RyZWFtOmUsaGFuZGxlcnM6bn0pLHtzdHJlYW1JZDp0fX1hc3luYyBfY2hhbmdlU3RyZWFtT3AoZSx0KXtpZighZSl0aHJvdyBuZXcgRXJyb3IoInN0cmVhbUlkIHJlcXVpcmVkIik7Y29uc3Qgbj10aGlzLnN0cmVhbXMuZ2V0KGUpO2lmKCFuKXJldHVybntjbG9zZWQ6ITB9O2lmKCJjbG9zZSI9PT10KXtjb25zdHtzdHJlYW06dCxoYW5kbGVyczpyfT1uO3JldHVybiB0Lm9mZigiY2hhbmdlIixyLmNoYW5nZSksdC5vZmYoImVycm9yIixyLmVycm9yKSx0Lm9mZigiY2xvc2UiLHIuY2xvc2UpLCJmdW5jdGlvbiI9PXR5cGVvZiB0LmNsb3NlJiZhd2FpdCB0LmNsb3NlKCksdGhpcy5zdHJlYW1zLmRlbGV0ZShlKSx7Y2xvc2VkOiEwfX10aHJvdyBuZXcgRXJyb3IoYFVua25vd24gY2hhbmdlIHN0cmVhbSBtZXRob2Q6ICR7dH1gKX13YXRjaChlPVtdLHQ9e30pe3JldHVybiBuZXcgVXQodGhpcyxlLHQpfX1mdW5jdGlvbiBRdChlLHQ9LyogQF9fUFVSRV9fICovbmV3IFdlYWtTZXQpe2lmKG51bGw9PWUpcmV0dXJuIGU7aWYoImZ1bmN0aW9uIj09dHlwZW9mIGUpcmV0dXJue19fZnVuY3Rpb246ZS50b1N0cmluZygpfTtpZihlJiYib2JqZWN0Ij09dHlwZW9mIGUmJiJmdW5jdGlvbiI9PXR5cGVvZiBlLnRvU3RyaW5nKXRyeXtjb25zdCB0PWUudG9TdHJpbmcoKTtpZih0JiYyND09PXQubGVuZ3RoJiYvXlswLTlhLWZdezI0fSQvaS50ZXN0KHQpJiZlLmNvbnN0cnVjdG9yJiYiT2JqZWN0SWQiPT09ZS5jb25zdHJ1Y3Rvci5uYW1lKXJldHVybntfX29iamVjdElkOnR9fWNhdGNoKG4pe31pZihlIGluc3RhbmNlb2YgZylyZXR1cm57X19vYmplY3RJZDplLnRvU3RyaW5nKCl9O2lmKGUgaW5zdGFuY2VvZiBEYXRlKXJldHVybntfX2RhdGU6ZS50b0lTT1N0cmluZygpfTtpZigib2JqZWN0Ij09dHlwZW9mIGUpe2lmKHQuaGFzKGUpKXJldHVybjt0LmFkZChlKX1pZihBcnJheS5pc0FycmF5KGUpKXJldHVybiBlLm1hcChlPT5RdChlLHQpKTtpZigib2JqZWN0Ij09dHlwZW9mIGUpe2NvbnN0IG49e307Zm9yKGNvbnN0W3IsaV1vZiBPYmplY3QuZW50cmllcyhlKSluW3JdPVF0KGksdCk7cmV0dXJuIG59cmV0dXJuIGV9ZnVuY3Rpb24gSnQoZSl7aWYobnVsbD09ZSlyZXR1cm4gZTtpZigib2JqZWN0Ij09dHlwZW9mIGUmJmUuX19mdW5jdGlvbilyZXR1cm4ic3RyaW5nIj09dHlwZW9mIGUuX19mdW5jdGlvbj9gKCR7ZS5fX2Z1bmN0aW9ufSkuY2FsbCh0aGlzKWA6dm9pZCAwO2lmKCJvYmplY3QiPT10eXBlb2YgZSYmZS5fX29iamVjdElkKXJldHVybiBuZXcgZyhlLl9fb2JqZWN0SWQpO2lmKCJvYmplY3QiPT10eXBlb2YgZSYmZS5fX2RhdGUpcmV0dXJuIG5ldyBEYXRlKGUuX19kYXRlKTtpZihBcnJheS5pc0FycmF5KGUpKXJldHVybiBlLm1hcChKdCk7aWYoIm9iamVjdCI9PXR5cGVvZiBlKXtjb25zdCB0PXt9O2Zvcihjb25zdFtuLHJdb2YgT2JqZWN0LmVudHJpZXMoZSkpdFtuXT1KdChyKTtyZXR1cm4gdH1yZXR1cm4gZX1jb25zdCBLdD0idW5kZWZpbmVkIiE9dHlwZW9mIHByb2Nlc3MmJiEhcHJvY2Vzcy52ZXJzaW9ucz8ubm9kZTtsZXQgR3QsWXQ9bnVsbDthc3luYyBmdW5jdGlvbiBYdChlLHQpe2lmKCFlfHwicmVxdWVzdCIhPT1lLnR5cGUpcmV0dXJuO1l0JiZhd2FpdCBZdDtjb25zdHtpZDpuLHBheWxvYWQ6cn09ZSxpPUp0KHIpLHM9ZnVuY3Rpb24oZSl7cmV0dXJuIEd0fHwoR3Q9bmV3IFd0KHt9LGUpKSxHdH0odCk7dHJ5e2NvbnN0IGU9YXdhaXQgcy5kaXNwYXRjaChpKTt0KHt0eXBlOiJyZXNwb25zZSIsaWQ6bixzdWNjZXNzOiEwLHJlc3VsdDpRdChlKX0pfWNhdGNoKG8pe3Qoe3R5cGU6InJlc3BvbnNlIixpZDpuLHN1Y2Nlc3M6ITEsZXJyb3I6e25hbWU6bz8ubmFtZSxtZXNzYWdlOm8/Lm1lc3NhZ2Usc3RhY2s6bz8uc3RhY2ssY29kZTpvPy5jb2RlLCRlcnI6bz8uJGVycn19KX19S3QmJihZdD1Qcm9taXNlLnJlc29sdmUoKS50aGVuKCgpPT57Y29uc3QgZT1uZXcgRnVuY3Rpb24oInNwZWMiLCJyZXR1cm4gaW1wb3J0KHNwZWMpIik7cmV0dXJuIFByb21pc2UuYWxsKFtlKCJwYXRoIiksZSgidXJsIiksZSgibm9kZS1vcGZzIildKX0pLnRoZW4oKFtlLHQsbl0pPT57Y29uc3Qgcj1lLmRlZmF1bHQse2ZpbGVVUkxUb1BhdGg6aX09dCx7U3RvcmFnZU1hbmFnZXI6c309bixvPWkoaW1wb3J0Lm1ldGEudXJsKSxhPXIuZGlybmFtZShvKSxjPXIucmVzb2x2ZShhLCIuLiIpLGw9bmV3IHMoci5qb2luKGMsIi5vcGZzIikpLHU9e3N0b3JhZ2U6e2dldERpcmVjdG9yeTooKT0+bC5nZXREaXJlY3RvcnkoKX19O3ZvaWQgMD09PWdsb2JhbFRoaXMubmF2aWdhdG9yP2dsb2JhbFRoaXMubmF2aWdhdG9yPXU6Z2xvYmFsVGhpcy5uYXZpZ2F0b3Iuc3RvcmFnZT11LnN0b3JhZ2V9KS5jYXRjaCgoKT0+e30pKSxhc3luYyBmdW5jdGlvbigpe2lmKEt0KXtjb25zdHtwYXJlbnRQb3J0OmV9PWF3YWl0IGltcG9ydCgid29ya2VyX3RocmVhZHMiKSx0PXQ9PmUucG9zdE1lc3NhZ2UodCk7ZS5vbigibWVzc2FnZSIsZT0+WHQoZSx0KSl9ZWxzZXtjb25zdCBlPWU9PnNlbGYucG9zdE1lc3NhZ2UoZSk7c2VsZi5vbm1lc3NhZ2U9dD0+WHQodC5kYXRhLGUpfX0oKS5jYXRjaChlPT57Y29uc29sZS5lcnJvcigiV29ya2VyIGluaXRpYWxpemF0aW9uIGZhaWxlZDoiLGUpLCJ1bmRlZmluZWQiIT10eXBlb2YgcHJvY2Vzcz9wcm9jZXNzLmV4aXQoMSk6c2VsZi5wb3N0TWVzc2FnZSh7dHlwZToiZXJyb3IiLGVycm9yOmUubWVzc2FnZX0pfSk7Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPW1pY3JvLW1vbmdvLXNlcnZlci13b3JrZXIuanMubWFwCg==",import.meta.url))}const c=new b(Z,{workerData:l.workerData});return new fl(c)}sendRequest(l,b={}){const d=vl.start("ipc","serialize"),Z=this._nextId++,c=Tl(l);vl.end(d);const m={type:"request",id:Z,payload:c};return new Promise((l,d)=>{let c;b.timeout&&(c=setTimeout(()=>{this._pending.delete(Z),d(new Error(`Worker request timed out after ${b.timeout}ms`))},b.timeout));const i=vl.start("ipc","roundtrip",{requestId:Z}),G=l,X=d;l=l=>{vl.end(i),G(l)},d=l=>{vl.end(i),X(l)},this._pending.set(Z,{resolve:l,reject:d,timeoutHandle:c}),this._post(m)})}async terminate(){this._terminating=!0;for(const[l,b]of this._pending.entries())clearTimeout(b.timeoutHandle);this._pending.clear(),await this._terminateImpl()}_handleMessage(l){const b=l?.data??l;if(b){if("response"===b.type){const l=this._pending.get(b.id);if(!l)return;if(this._pending.delete(b.id),clearTimeout(l.timeoutHandle),b.success){const d=vl.start("ipc","deserialize"),Z=Bl(b.result);vl.end(d),l.resolve(Z)}else{const d=new Error(b.error?.message||"Worker error");b.error?.name&&(d.name=b.error.name),b.error?.stack&&(d.stack=b.error.stack),b.error?.code&&(d.code=b.error.code),b.error?.$err&&(d.$err=b.error.$err),l.reject(d)}return}if("event"===b.type){const l=Bl(b.payload);this.emit("event",b.event,l)}}}_handleError(l){if(!this._terminating){for(const[b,d]of this._pending.entries())clearTimeout(d.timeoutHandle),d.reject(l);this._pending.clear(),this.emit("error",l)}}_attach(){throw new Error("Not implemented")}_post(){throw new Error("Not implemented")}_terminateImpl(){throw new Error("Not implemented")}}class Ql extends Ul{constructor(l={}){const b=globalThis.Worker;if(!b)throw new Error("Worker API is not available in this environment");super(new b(l.workerUrl||"/build/micro-mongo-server-worker.js",{type:"module"}))}_attach(){this.worker.onmessage=this._handleMessage,this.worker.onerror=this._handleError}_post(l){this.worker.postMessage(l)}_terminateImpl(){this.worker.terminate()}}class fl extends Ul{constructor(l){super(l)}_attach(){this.worker.on("message",this._handleMessage),this.worker.on("error",this._handleError),this.worker.on("exit",l=>{0===l||this._terminating||this._handleError(new Error(`Worker stopped with exit code ${l}`))})}_post(l){this.worker.postMessage(l)}_terminateImpl(){return this.worker.terminate()}}export{K as BadValueError,R as BulkWriteError,W as CannotCreateIndexError,zl as ChangeStream,V as CursorError,y as CursorNotFoundError,X as DuplicateKeyError,Z as ErrorCodes,u as IndexError,n as IndexExistsError,e as IndexNotFoundError,s as InvalidNamespaceError,N as MongoClient,i as MongoDriverError,c as MongoError,r as MongoNetworkError,m as MongoServerError,h as NamespaceError,o as NamespaceNotFoundError,I as NotImplementedError,L as ObjectId,Y as OperationNotSupportedError,Fl as PerformanceTimer,p as QueryError,a as TypeMismatchError,t as ValidationError,Ul as WorkerBridge,G as WriteError,vl as globalTimer};
//# sourceMappingURL=micro-mongo-node.min.js.map
